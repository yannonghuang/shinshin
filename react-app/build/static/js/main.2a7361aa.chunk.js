(this["webpackJsonpreact-app"]=this["webpackJsonpreact-app"]||[]).push([[0],{144:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return H}));var n=a(39),r=a(50),s=a(18),o=a.n(s),c=a(30),l=a(3),i=a(12),u=a(13),d=a(6),m=a(26),h=a(25),p=a(0),g=a.n(p),f=(a(96),a(19)),b=(a(160),a(20),a(10)),v=a(46),y=a(8),E=a(88),j=a(92),C=a(79),O=a(76),S=a(80),w=a(15),k=a(37),N=a(57),I=a(245),P=a.n(I),x=a(34),R=a.n(x),F=["id","photo","file","docFiles","docCategory"],A=["id"],B=["id","photo","file","docFiles","docCategory","startAt","lastVisit"],D=["id","photo","file","docFiles","docCategory","startAt","lastVisit"],H=function(t){Object(m.a)(s,t);var a=Object(h.a)(s);function s(e){var t;return Object(i.a)(this,s),(t=a.call(this,e)).onDrag=function(e){e.preventDefault()},t.onDrop=function(e){e.preventDefault();var a=e.dataTransfer.files[0],n=e.dataTransfer.items[0];if(n&&"file"===n.kind&&0===n.type.indexOf("image/")){t.setState((function(e){return{currentSchool:Object(l.a)(Object(l.a)({},e.currentSchool),{},{file:a})}}));var r=new FileReader;r.readAsDataURL(a),r.onload=function(){return t.setState((function(e){return{currentSchool:Object(l.a)(Object(l.a)({},e.currentSchool),{},{photo:r.result})}}))}}},t.onChangeGenerics=t.onChangeGenerics.bind(Object(d.a)(t)),t.onChangeStartAt=t.onChangeStartAt.bind(Object(d.a)(t)),t.onChangeYPStartAt=t.onChangeYPStartAt.bind(Object(d.a)(t)),t.onChangeLastVisit=t.onChangeLastVisit.bind(Object(d.a)(t)),t.onChangeYPLastVisit=t.onChangeYPLastVisit.bind(Object(d.a)(t)),t.onChangePrincipalId=t.onChangePrincipalId.bind(Object(d.a)(t)),t.onChangeContactId=t.onChangeContactId.bind(Object(d.a)(t)),t.getSchool=t.getSchool.bind(Object(d.a)(t)),t.getSchoolPhoto=t.getSchoolPhoto.bind(Object(d.a)(t)),t.updateSchool=t.updateSchool.bind(Object(d.a)(t)),t.updatePhoto=t.updatePhoto.bind(Object(d.a)(t)),t.deleteSchool=t.deleteSchool.bind(Object(d.a)(t)),t.onDrag=t.onDrag.bind(Object(d.a)(t)),t.onDrop=t.onDrop.bind(Object(d.a)(t)),t.onChangeDocFiles=t.onChangeDocFiles.bind(Object(d.a)(t)),t.saveSchool=t.saveSchool.bind(Object(d.a)(t)),t.newSchool=t.newSchool.bind(Object(d.a)(t)),t.state={currentSchool:{id:null,name:"",code:"",photo:null,file:null,docFiles:[],docCategory:"",startAt:null,lastVisit:null,donor:null,stage:"",status:"",request:"",category:"",principal:"",principalCell:null,principalWechat:null,contact:"",contactCell:null,contactWechat:null,schoolBoard:null,schoolBoardRegisteredName:null,region:"",city:"",county:"",community:"",address:"",phone:"",email:"",studentsCount:0,teachersCount:0,description:"",principalId:null,contactId:null,xr:!1},newschool:!0,readonly:!0,regions:[],docCategories:[],users:[],stages:[],statuses:[],requests:[],categories:[],message:"",submitted:!1,pastedPhotoType:null},t.surveyRef=Object(p.createRef)(),t}return Object(u.a)(s,[{key:"componentDidMount",value:function(){var e=Object(c.a)(o.a.mark((function e(){var t,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=window.location.pathname.includes("add"),this.setState({newschool:t}),this.setState({readonly:window.location.pathname.includes("View")}),a=this.props.match?this.props.match.params.id:this.props.id,t){e.next=9;break}return e.next=7,this.getSchool(a);case 7:return e.next=9,this.getSchoolPhoto(a);case 9:this.getRegions(),this.getDocCategories(),this.getCategories(),this.getRequests(),this.getStatuses(),this.getStages(),this.getUsers(a),this.init();case 17:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"init",value:function(){var e=this;document.onpaste=function(){var t=Object(c.a)(o.a.mark((function t(a){var n,r,s,i;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(a.preventDefault(),n=a.clipboardData.items,r=0;r<n.length;r++)0===n[r].type.indexOf("image")&&function(){s=n[r].getAsFile();var t=n[r].type;(i=new FileReader).readAsDataURL(s),i.onload=Object(c.a)(o.a.mark((function a(){return o.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e.setState((function(e){return{currentSchool:Object(l.a)(Object(l.a)({},e.currentSchool),{},{photo:i.result}),pastedPhotoType:t}}));case 2:return document.getElementById("schoolPhoto").src=i.result,a.abrupt("return");case 4:case"end":return a.stop()}}),a)})))}();case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}},{key:"convert",value:function(e){var t=[];if(e){for(var a=0;a<e.length;a++)t.push({value:e[a].id,label:e[a].chineseName});return t}}},{key:"display",value:function(e){if(this.state.users){for(var t=0;t<this.state.users.length;t++)if(this.state.users[t].value==e)return this.state.users[t];return[]}}},{key:"displayName",value:function(e){if(this.state.users){for(var t=0;t<this.state.users.length;t++)if(this.state.users[t].value==e)return this.state.users[t].label?this.state.users[t].label:"\u4e2d\u6587\u540d";return""}}},{key:"getUsers",value:function(e){var t=this;y.a.getAllSimple({schoolId:e}).then((function(e){t.setState({users:t.convert(e.data)}),console.log(e)})).catch((function(e){console.log(e)}))}},{key:"getCategories",value:function(){var e=this;w.a.getCategories().then((function(t){e.setState({categories:t.data}),console.log(t)})).catch((function(e){console.log(e)}))}},{key:"getRequests",value:function(){var e=this;w.a.getRequests_ss().then((function(t){e.setState({requests:t.data}),console.log(t)})).catch((function(e){console.log(e)}))}},{key:"getStatuses",value:function(){var e=this;w.a.getStatuses_ss().then((function(t){e.setState({statuses:t.data}),console.log(t)})).catch((function(e){console.log(e)}))}},{key:"getStages",value:function(){var e=this;w.a.getStages().then((function(t){e.setState({stages:t.data}),console.log(t)})).catch((function(e){console.log(e)}))}},{key:"getRegions",value:function(){var e=this;w.a.getRegions().then((function(t){e.setState({regions:t.data}),console.log(t)})).catch((function(e){console.log(e)}))}},{key:"getDocCategories",value:function(){var e=this;N.a.getDocCategories().then((function(t){e.setState({docCategories:t.data}),console.log(t)})).catch((function(e){console.log(e)}))}},{key:"onChangePrincipalId",value:function(e){var t=this;this.setState((function(a){return{currentSchool:Object(l.a)(Object(l.a)({},a.currentSchool),{},{principalId:e.value,principal:t.displayName(e.value)})}}))}},{key:"onChangeContactId",value:function(e){this.setState((function(t){return{currentSchool:Object(l.a)(Object(l.a)({},t.currentSchool),{},{contactId:e.value})}}))}},{key:"onChangeGenerics",value:function(e){var t=e.target.name,a="checkbox"===e.target.type?e.target.checked:e.target.value;this.setState((function(e){return{currentSchool:Object(l.a)(Object(l.a)({},e.currentSchool),{},Object(r.a)({},t,a))}}))}},{key:"onChangeStartAt",value:function(e){var t=e.target.value;this.setState((function(e){return{currentSchool:Object(l.a)(Object(l.a)({},e.currentSchool),{},{startAt:t})}}))}},{key:"onChangeYPStartAt",value:function(e){var t=e;this.setState((function(e){return{currentSchool:Object(l.a)(Object(l.a)({},e.currentSchool),{},{startAt:t})}}))}},{key:"onChangeLastVisit",value:function(e){var t=e.target.value;this.setState((function(e){return{currentSchool:Object(l.a)(Object(l.a)({},e.currentSchool),{},{lastVisit:t})}}))}},{key:"onChangeYPLastVisit",value:function(e){var t=e;this.setState((function(e){return{currentSchool:Object(l.a)(Object(l.a)({},e.currentSchool),{},{lastVisit:t})}}))}},{key:"getSchool",value:function(){var e=Object(c.a)(o.a.mark((function e(t){var a,r,s,c,i,u,d,m;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.state.currentSchool,a.id,a.photo,a.file,a.docFiles,a.docCategory,r=Object(n.a)(a,F),e.prev=1,e.next=4,w.a.get(t);case 4:return s=e.sent,e.next=7,k.a.get(t);case 7:return c=e.sent,i=c.data,i.id,u=Object(n.a)(i,A),d=Object(l.a)(Object(l.a)(Object(l.a)({},r),s.data),u),m=w.a.reduce(d,r),e.next=13,this.setState({currentSchool:Object(l.a)(Object(l.a)({},m),{},{id:t})});case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(1),alert(e.t0.message);case 18:case 19:case"end":return e.stop()}}),e,this,[[1,15]])})));return function(t){return e.apply(this,arguments)}}()},{key:"getSchoolPhoto",value:function(t){var a=this;w.a.getPhoto(t).then((function(t){var n="data:image/png;base64,"+new e(t.data.data.photo,"binary").toString("base64");a.setState((function(e){return{currentSchool:Object(l.a)(Object(l.a)({},e.currentSchool),{},{photo:n})}})),console.log(t.data)})).catch((function(e){console.log(e)}))}},{key:"newSchool",value:function(){this.setState((function(e){return{currentSchool:Object(l.a)(Object(l.a)({},e.currentSchool),{},{id:null,name:"",code:"",description:"",principal:"",photo:null,file:null,region:"",address:"",phone:"",email:"",studentsCount:0,teachersCount:0,docFiles:[],docCategory:"",stage:"",status:"",request:"",category:""}),submitted:!1}}))}},{key:"saveSchool",value:function(){var e=this,t=this.state.currentSchool,a=(t.id,t.photo,t.file,t.docFiles,t.docCategory,t.startAt),r=t.lastVisit,s=Object(n.a)(t,B),o=Object(l.a)(Object(l.a)({},s),{},{startAt:a?a+"-01-01":null,lastVisit:r?r+"-01-01":null});w.a.create(o).then((function(t){var n=Object(l.a)(Object(l.a)({},s),{},{startAt:a?a+"-01-01":null,lastVisit:r?r+"-01-01":null,schoolId:t.data.id});k.a.create(n).then((function(a){e.setState((function(e){return{currentSchool:Object(l.a)(Object(l.a)({},e.currentSchool),{},{id:t.data.id}),message:"\u5b66\u6821\u4fe1\u606f\u6210\u529f\u63d0\u4ea4!",submitted:!0}}))})).catch((function(t){var a=t.response&&t.response.data&&t.response.data.message||t.message||t.toString();e.setState({message:"\u5b66\u6821\u4fe1\u606f\u4fdd\u5b58\u5931\u8d25! "+a})})),e.state.currentSchool.file||e.state.pastedPhotoType?e.updatePhoto():e.state.currentSchool.docFiles&&e.uploadDocuments(),console.log(t.data)})).catch((function(t){var a=t.response&&t.response.data&&t.response.data.message||t.message||t.toString();e.setState({message:"\u5b66\u6821\u4fe1\u606f\u4fdd\u5b58\u5931\u8d25! "+a}),console.log(t)}))}},{key:"updateSchool",value:function(){var e=this;this.surveyRef.current&&this.surveyRef.current.updateSurvey();var t=this.state.currentSchool,a=(t.id,t.photo,t.file,t.docFiles,t.docCategory,t.startAt),r=t.lastVisit,s=Object(n.a)(t,D),o=Object(l.a)(Object(l.a)({},s),{},{startAt:a?a+"-01-01":null,lastVisit:r?r+"-01-01":null}),c=Object(l.a)(Object(l.a)({},s),{},{startAt:a?a+"-01-01":null,lastVisit:r?r+"-01-01":null,schoolId:this.state.currentSchool.id});w.a.update(this.state.currentSchool.id,o).then((function(t){console.log(t.data),k.a.update(e.state.currentSchool.id,c).then((function(t){e.setState({message:"\u5b66\u6821\u4fe1\u606f\u6210\u529f\u4fee\u6539!",submitted:!0})})).catch((function(t){var a=t.response&&t.response.data&&t.response.data.message||t.message||t.toString();e.setState({message:"\u5b66\u6821\u4fe1\u606f\u4fee\u6539\u5931\u8d25! "+a})})),e.state.currentSchool.file||e.state.pastedPhotoType?e.updatePhoto():e.state.currentSchool.docFiles&&e.uploadDocuments()})).catch((function(t){var a=t.response&&t.response.data&&t.response.data.message||t.message||t.toString();e.setState({message:"\u5b66\u6821\u4fe1\u606f\u4fee\u6539\u5931\u8d25! "+a}),console.log(t)}))}},{key:"updatePhoto",value:function(){var e=Object(c.a)(o.a.mark((function e(){var t,a,n,r=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=new FormData,!this.state.currentSchool.file){e.next=5;break}t.append("multi-files",this.state.currentSchool.file,this.state.currentSchool.file.name),e.next=13;break;case 5:if(!this.state.pastedPhotoType){e.next=13;break}return e.next=8,fetch(this.state.currentSchool.photo);case 8:return a=e.sent,e.next=11,a.blob();case 11:n=e.sent,t.append("multi-files",new Blob([n],{type:this.state.pastedPhotoType}));case 13:w.a.updatePhoto(this.state.currentSchool.id,t).then((function(e){r.state.currentSchool.docFiles&&r.uploadDocuments(),console.log(e.data)})).catch((function(e){console.log(e)}));case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"uploadDocuments",value:function(){for(var e=this,t=new FormData,a=0;a<this.state.currentSchool.docFiles.length;a++)t.append("multi-files",this.state.currentSchool.docFiles[a],this.state.currentSchool.docFiles[a].name);t.append("docCategory",this.state.currentSchool.docCategory),w.a.uploadDocuments(this.state.currentSchool.id,t).then((function(t){e.setState((function(e){return{message:e.message+" \u5b66\u6821\u4fe1\u606f\u9644\u4ef6\u6210\u529f\u4e0a\u4f20!"}})),console.log(t.data)})).catch((function(e){console.log(e)}))}},{key:"deleteSchool",value:function(){var e=this;w.a.delete(this.state.currentSchool.id).then((function(t){console.log(t.data),e.props.history.push("/schools")})).catch((function(e){console.log(e)}))}},{key:"onChangeDocFiles",value:function(e){e.preventDefault();var t=e.target.files;this.setState((function(e){return{currentSchool:Object(l.a)(Object(l.a)({},e.currentSchool),{},{docFiles:t})}}))}},{key:"renderUpdates",value:function(){return g.a.createElement("div",null,g.a.createElement("button",{className:"badge badge-danger mr-2",onClick:this.deleteSchool},"Delete"),g.a.createElement("button",{type:"submit",className:"badge badge-success",onClick:this.updateSchool},"Update"),g.a.createElement("p",null,this.state.message))}},{key:"render",value:function(){var e=this,t=this.state.currentSchool;return g.a.createElement("div",null,this.state.submitted?g.a.createElement("div",null,g.a.createElement("div",null,this.state.message),g.a.createElement("a",{href:"/schoolsView/"+t.id,class:"btn btn-success"},"\u8fd4\u56de")):g.a.createElement("div",{class:"row"},g.a.createElement("div",{class:"col-sm-4"},g.a.createElement("div",{class:"row"},g.a.createElement("h4",null,"\u5b66\u6821\u57fa\u672c\u4fe1\u606f"),g.a.createElement("div",{contenteditable:"true",onDragOver:this.onDrag,onDrop:this.onDrop},this.state.readonly?"":g.a.createElement("p",{contenteditable:"false"},"\u7f16\u8f91\u5b66\u6821\u7167\u7247\uff08\u62d6\u62fd\u7167\u7247\u6587\u4ef6\u6216\u590d\u5236\u7c98\u8d34\u56fe\u6807\uff09"),g.a.createElement("img",{id:"schoolPhoto",src:t.photo?t.photo:P.a,width:"320",height:"320",class:"responsive",readonly:!!this.state.readonly&&""})),g.a.createElement("div",{class:"form-group"},g.a.createElement("label",{htmlFor:"code"},"\u5b66\u6821\u7f16\u53f7"),g.a.createElement("input",{readonly:!!this.state.readonly&&"",type:"text",class:"form-control",id:"code",required:!0,value:t.code,onChange:this.onChangeGenerics,name:"code"})),g.a.createElement("div",{class:"form-group"},g.a.createElement("label",{htmlFor:"name"},"\u6b23\u6b23\u5b66\u6821\u540d\u79f0"),g.a.createElement("textarea",{readonly:!!this.state.readonly&&"",class:"form-control",id:"name",cols:"31",required:!0,value:t.name,onChange:this.onChangeGenerics,name:"name"})),g.a.createElement("div",{class:"form-group"},g.a.createElement("label",{htmlFor:"schoolBoardRegisteredName"},"\u6559\u80b2\u5c40\u6ce8\u518c\u6821\u540d"),g.a.createElement("textarea",{readonly:!!this.state.readonly&&"",cols:"31",class:"form-control",id:"schoolBoardRegisteredName",required:!0,value:t.schoolBoardRegisteredName,onChange:this.onChangeGenerics,name:"schoolBoardRegisteredName"})),g.a.createElement("div",{class:"form-group"},g.a.createElement("label",{htmlFor:"schoolBoard"},"\u6559\u80b2\u5c40\u540d\u79f0"),g.a.createElement("textarea",{readonly:!!this.state.readonly&&"",cols:"31",class:"form-control",id:"schoolBoard",required:!0,value:t.schoolBoard,onChange:this.onChangeGenerics,name:"schoolBoard"})),g.a.createElement("div",{class:"w-100"}),this.state.readonly&&y.a.getCurrentUser()&&g.a.createElement("div",{class:"box"},y.a.getCurrentUser().schoolId&&g.a.createElement("a",{target:"_blank",href:"/forms",class:"btn btn-primary"},"\u9879\u76ee\u7533\u8bf7"),g.a.createElement("a",{target:"_blank",href:"/users/school/"+t.id,class:"btn btn-primary"},"\u7528\u6237"),!y.a.getCurrentUser().schoolId&&g.a.createElement("a",{target:"_blank",href:"/logs/school/"+t.id,class:"btn btn-primary"},"\u66f4\u65b0\u5386\u53f2"),y.a.getCurrentUser().schoolId&&g.a.createElement("a",{target:"_blank",href:"/surveys/"+t.id,class:"btn btn-primary mb-4"},"\u66f4\u65b0\u4fe1\u606f"),!y.a.getCurrentUser().schoolId&&g.a.createElement("a",{target:"_blank",href:"/schools/"+t.id,class:"btn btn-primary mb-4"},"\u7f16\u8f91")))),g.a.createElement("div",{class:"col-sm-8"},g.a.createElement("div",{class:"row"},g.a.createElement("div",{class:"form-group col-sm-4"},g.a.createElement("div",null,g.a.createElement("div",{class:"side"},g.a.createElement("label",{htmlFor:"startAt"},"\u5efa\u6821\u5e74\u4efd")),g.a.createElement("div",{class:"side"},!this.state.readonly&&g.a.createElement(R.a,{yearArray:["2019","2020"],value:t.startAt,onSelect:this.onChangeYPStartAt,hideInput:!0,minRange:1995,maxRange:2022}))),g.a.createElement("input",{readonly:"",type:"text",class:"form-control",id:"startAt",required:!0,value:t.startAt,onChange:this.onChangeStartAt,name:"startAt"})),g.a.createElement("div",{class:"form-group col-sm-4"},g.a.createElement("label",{htmlFor:"donor"},"\u6350\u6b3e\u4eba"),g.a.createElement("input",{readonly:!!this.state.readonly&&"",type:"text",class:"form-control",id:"donor",required:!0,value:t.donor,onChange:this.onChangeGenerics,name:"donor"})),g.a.createElement("div",{class:"form-group col-sm-4"},g.a.createElement("div",null,g.a.createElement("div",{class:"side"},g.a.createElement("label",{htmlFor:"lastVisit"},"\u6700\u8fd1\u8bbf\u6821\u5e74\u4efd")),g.a.createElement("div",{class:"side"},!this.state.readonly&&g.a.createElement(R.a,{yearArray:["2019","2020"],value:t.lastVisit,onSelect:this.onChangeYPLastVisit,hideInput:!0,minRange:1995,maxRange:2022}))),g.a.createElement("input",{readonly:"",type:"text",class:"form-control",id:"lastVisit",required:!0,value:t.lastVisit,onChange:this.onChangeLastVisit,name:"lastVisit"})),g.a.createElement("div",{class:"w-100"}),g.a.createElement("div",{class:"select-container form-group col-sm-4"},g.a.createElement("label",{htmlFor:"stage"},"\u5b66\u6821\u9636\u6bb5"),g.a.createElement("select",{disabled:!!this.state.readonly&&"disabled",class:"form-control",id:"stage",required:!0,value:t.stage,onChange:this.onChangeGenerics,name:"stage"},g.a.createElement("option",{value:""},this.state.readonly?"":"\u8bf7\u9009\u62e9"),this.state.stages.map((function(e){return g.a.createElement("option",{value:e},e)})))),g.a.createElement("div",{class:"select-container form-group col-sm-4"},g.a.createElement("label",{htmlFor:"status"},"\u5b66\u6821\u72b6\u6001"),g.a.createElement("select",{disabled:!!this.state.readonly&&"disabled",class:"form-control",id:"status",required:!0,value:t.status,onChange:this.onChangeGenerics,name:"status"},g.a.createElement("option",{value:""},this.state.readonly?"":"\u8bf7\u9009\u62e9"),this.state.statuses.map((function(e){return g.a.createElement("option",{value:e},e)})))),g.a.createElement("div",{class:"select-container form-group col-sm-4"},g.a.createElement("label",{htmlFor:"request"},"\u5b66\u6821\u9700\u6c42"),g.a.createElement("select",{disabled:!!this.state.readonly&&"disabled",class:"form-control",id:"request",required:!0,value:t.request,onChange:this.onChangeGenerics,name:"request"},g.a.createElement("option",{value:""},this.state.readonly?"":"\u8bf7\u9009\u62e9"),this.state.requests.map((function(e){return g.a.createElement("option",{value:e},e)})))),g.a.createElement("div",{class:"w-100"}),g.a.createElement("div",{class:"select-container form-group col-sm-3"},g.a.createElement("label",{htmlFor:"region"},"\u7701/\u81ea\u6cbb\u533a/\u76f4\u8f96\u5e02"),g.a.createElement("select",{disabled:!!this.state.readonly&&"disabled",class:"form-control",id:"region",required:!0,value:t.region,onChange:this.onChangeGenerics,name:"region"},g.a.createElement("option",{value:""},this.state.readonly?"":"\u8bf7\u9009\u62e9"),this.state.regions.map((function(e){return g.a.createElement("option",{value:e},e)})))),g.a.createElement("div",{class:"form-group col-sm-3"},g.a.createElement("label",{htmlFor:"city"},"\u5e02"),g.a.createElement("input",{readonly:!!this.state.readonly&&"",type:"text",class:"form-control",id:"city",required:!0,value:t.city,onChange:this.onChangeGenerics,name:"city"})),g.a.createElement("div",{class:"form-group col-sm-3"},g.a.createElement("label",{htmlFor:"county"},"\u533a/\u53bf"),g.a.createElement("input",{readonly:!!this.state.readonly&&"",type:"text",class:"form-control",id:"county",required:!0,value:t.county,onChange:this.onChangeGenerics,name:"county"})),g.a.createElement("div",{class:"form-group col-sm-3"},g.a.createElement("label",{htmlFor:"community"},"\u4e61/\u9547"),g.a.createElement("input",{readonly:!!this.state.readonly&&"",type:"text",class:"form-control",id:"community",required:!0,value:t.community,onChange:this.onChangeGenerics,name:"community"})),g.a.createElement("div",{class:"form-group col-sm-12"},g.a.createElement("label",{htmlFor:"address"},"\u5730\u5740"),g.a.createElement("input",{readonly:!!this.state.readonly&&"",type:"text",class:"form-control",id:"address",required:!0,value:t.address,onChange:this.onChangeGenerics,name:"address"})),g.a.createElement("div",{class:"w-100"}),g.a.createElement("div",{class:"form-group col-sm-4"},g.a.createElement("label",{htmlFor:"phone"},"\u5b66\u6821\u7535\u8bdd"),g.a.createElement("input",{readonly:!!this.state.readonly&&"",type:"text",class:"form-control",id:"phone",required:!0,value:t.phone,onChange:this.onChangeGenerics,name:"phone"})),g.a.createElement("div",{class:"form-group col-sm-4"},g.a.createElement("label",{htmlFor:"email"},"\u5b66\u6821\u7535\u5b50\u90ae\u7bb1"),g.a.createElement("input",{readonly:!!this.state.readonly&&"",type:"text",class:"form-control",id:"email",required:!0,value:t.email,onChange:this.onChangeGenerics,name:"email"})),g.a.createElement("div",{class:"w-100"}),g.a.createElement("div",{class:"form-group col-sm-4"},g.a.createElement("label",{htmlFor:"studentsCount"},"\u5b66\u751f\u4eba\u6570"),g.a.createElement("input",{readonly:!!this.state.readonly&&"",type:"number",class:"form-control",id:"studentsCount",required:!0,value:t.studentsCount,onChange:this.onChangeGenerics,name:"studentsCount"})),g.a.createElement("div",{class:"form-group col-sm-4"},g.a.createElement("label",{htmlFor:"teachersCount"},"\u6559\u5e08\u4eba\u6570"),g.a.createElement("input",{readonly:!!this.state.readonly&&"",type:"number",class:"form-control",id:"teachersCount",required:!0,value:t.teachersCount,onChange:this.onChangeGenerics,name:"teachersCount"})),g.a.createElement("div",{class:"select-container form-group col-sm-4"},g.a.createElement("label",{htmlFor:"category"},"\u5b66\u6821\u7c7b\u578b"),g.a.createElement("select",{disabled:!!this.state.readonly&&"disabled",class:"form-control",id:"category",required:!0,value:t.category,onChange:this.onChangeGenerics,name:"category"},g.a.createElement("option",{value:""},this.state.readonly?"":"\u8bf7\u9009\u62e9"),this.state.categories.map((function(e){return g.a.createElement("option",{value:e},e)})))),g.a.createElement("div",{class:"w-100"}),g.a.createElement("div",{class:"form-group col-sm-4",hidden:!y.a.getCurrentUser()},g.a.createElement("label",{htmlFor:"principalId"},"\u6821\u957f"),this.state.readonly?g.a.createElement(b.b,{to:"/usersView/"+t.principalId,id:"principalId",name:"principalId"},this.displayName(t.principalId)):g.a.createElement(v.a,{onChange:this.onChangePrincipalId.bind(this),class:"form-control",id:"principalId",value:this.display(t.principalId),name:"principalId",options:this.state.users})),g.a.createElement("div",{class:"form-group col-sm-4",hidden:!y.a.getCurrentUser()},g.a.createElement("label",{htmlFor:"contactId"},"\u8054\u7edc\u4eba"),this.state.readonly?g.a.createElement(b.b,{to:"/usersView/"+t.contactId,id:"contactId",name:"contactId"},this.displayName(t.contactId)):g.a.createElement(v.a,{onChange:this.onChangeContactId.bind(this),class:"form-control",id:"contactId",value:this.display(t.contactId),name:"contactId",options:this.state.users})),g.a.createElement("div",{class:"w-100"}),g.a.createElement("div",{class:"form-group col-sm-12"},g.a.createElement("label",{htmlFor:"description"},"\u7b80\u4ecb"),g.a.createElement("textarea",{rows:"4",readonly:!!this.state.readonly&&"",class:"form-control",id:"description",required:!0,value:t.description,onChange:this.onChangeGenerics,name:"description"})))),g.a.createElement("div",{class:"w-100"}),!this.state.readonly&&g.a.createElement("div",null,g.a.createElement("button",{onClick:this.saveSchool,class:"btn btn-primary",hidden:!this.state.newschool},"\u63d0\u4ea4"),g.a.createElement("button",{hidden:this.state.newschool,type:"submit",className:"btn btn-primary",onClick:this.updateSchool},"\u66f4\u65b0"),g.a.createElement("div",{class:"w-100"}),g.a.createElement("form",{ref:"formToSubmit",action:"http://localhost:8080/api/documents-upload",method:"POST",enctype:"multipart/form-data"},g.a.createElement("div",{class:"form-group input-group"},g.a.createElement("label",{for:"input-multi-files"},"\u4e0a\u4f20\u6587\u4ef6:"),g.a.createElement("input",{type:"file",name:"multi-files",multiple:!0,id:"input-multi-files",class:"form-control-file border",onChange:function(t){return e.onChangeDocFiles(t)}}),g.a.createElement("select",{className:"form-control input-group-append",name:"docCategory",id:"docCategory",placeholder:"",value:t.docCategory,onChange:function(t){return e.onChangeGenerics(t)}},g.a.createElement("option",{value:""},"\u9644\u4ef6\u7c7b\u522b"),this.state.docCategories.map((function(e){return g.a.createElement("option",{value:e},e)}))),g.a.createElement("input",{type:"hidden",name:"schoolId",id:"schoolId"}))),g.a.createElement("p",null,this.state.message)),g.a.createElement("div",{class:"w-100"}),!this.state.newschool&&g.a.createElement(f.d,null,g.a.createElement(f.b,null,g.a.createElement(f.a,null,"\u66f4\u591a\u4fe1\u606f ",g.a.createElement("i",{class:"fas fa-hand-point-right"})),g.a.createElement(f.a,null,"\u5b66\u6821\u8be6\u60c5"),g.a.createElement(f.a,null,"\u9879\u76ee\u5217\u8868"),g.a.createElement(f.a,null,"\u9879\u76ee\u7533\u8bf7\u5217\u8868"),g.a.createElement(f.a,null,"\u5b66\u6821\u6587\u6863"),g.a.createElement(f.a,null,"\u5b66\u6821\u7167\u7247"),g.a.createElement(f.a,null,"\u8bc4\u8bba\u533a"),t.xr?g.a.createElement(f.a,null,"\u5411\u8363\u652f\u6301\u9879\u76ee"):null),g.a.createElement(f.c,null),g.a.createElement(f.c,null,g.a.createElement(E.a,{schoolId:t.id,embedded:!0,readonly:this.state.readonly,ref:this.surveyRef})),g.a.createElement(f.c,null,g.a.createElement(C.a,{schoolId:t.id,embedded:!0,readonly:this.state.readonly})),g.a.createElement(f.c,null,g.a.createElement(O.a,{schoolId:t.id,embedded:!0,readonly:this.state.readonly})),g.a.createElement(f.c,null,g.a.createElement(S.a,{schoolId:t.id,docCategory:"!\u7167\u7247",embedded:!0,readonly:this.state.readonly})),g.a.createElement(f.c,null,g.a.createElement(S.a,{schoolId:t.id,docCategory:"\u7167\u7247",embedded:!0,readonly:this.state.readonly})),g.a.createElement(f.c,null,g.a.createElement(j.a,{schoolId:t.id,readonly:this.state.readonly})),t.xr?g.a.createElement(f.c,null,g.a.createElement(C.a,{schoolId:t.id,embedded:!0,readonly:this.state.readonly,xr:!0})):null)))}}]),s}(p.Component)}).call(this,a(22).Buffer)},145:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return w}));var n=a(50),r=a(18),s=a.n(r),o=a(30),c=a(3),l=a(12),i=a(13),u=a(6),d=a(26),m=a(25),h=a(0),p=a.n(h),g=(a(96),a(19)),f=(a(160),a(20),a(10)),b=a(46),v=a(34),y=a.n(v),E=(a(76),a(91)),j=a(23),C=a(69),O=a(15),S=a(8),w=function(t){Object(d.a)(r,t);var a=Object(m.a)(r);function r(e){var t;return Object(l.a)(this,r),(t=a.call(this,e)).onDrag=function(e){e.preventDefault()},t.onDrop=function(e){e.preventDefault();var a=e.dataTransfer.files[0];t.setState((function(e){return{currentProject:Object(c.a)(Object(c.a)({},e.currentProject),{},{file:a})}}));var n=new FileReader;n.readAsDataURL(a),n.onload=function(){return t.setState((function(e){return{currentProject:Object(c.a)(Object(c.a)({},e.currentProject),{},{photo:n.result})}}))}},t.onChangeName=t.onChangeName.bind(Object(u.a)(t)),t.onChangeSchoolId=t.onChangeSchoolId.bind(Object(u.a)(t)),t.onChangeResponseId=t.onChangeResponseId.bind(Object(u.a)(t)),t.onChangeBudget=t.onChangeBudget.bind(Object(u.a)(t)),t.onChangePhoto=t.onChangePhoto.bind(Object(u.a)(t)),t.onChangeStatus=t.onChangeStatus.bind(Object(u.a)(t)),t.onChangeDescription=t.onChangeDescription.bind(Object(u.a)(t)),t.onChangeStartAt=t.onChangeStartAt.bind(Object(u.a)(t)),t.getProject=t.getProject.bind(Object(u.a)(t)),t.getProjectPhoto=t.getProjectPhoto.bind(Object(u.a)(t)),t.updatePublished=t.updatePublished.bind(Object(u.a)(t)),t.updateProject=t.updateProject.bind(Object(u.a)(t)),t.updatePhoto=t.updatePhoto.bind(Object(u.a)(t)),t.deleteProject=t.deleteProject.bind(Object(u.a)(t)),t.onDrag=t.onDrag.bind(Object(u.a)(t)),t.onDrop=t.onDrop.bind(Object(u.a)(t)),t.onChangeDocFiles=t.onChangeDocFiles.bind(Object(u.a)(t)),t.onChangeDocCategory=t.onChangeDocCategory.bind(Object(u.a)(t)),t.saveProject=t.saveProject.bind(Object(u.a)(t)),t.newProject=t.newProject.bind(Object(u.a)(t)),t.state={currentProject:{id:null,name:"",schoolId:null,responseId:null,status:"",budget:0,photo:null,file:null,description:"",startAt:null,xr:window.location.pathname.includes("XR"),docFiles:[],docCategory:""},currentUser:null,schools:[],statuses:[],newproject:!0,readonly:!0,docCategories:[],message:"",submitted:!1},t}return Object(i.a)(r,[{key:"componentDidMount",value:function(){var e=window.location.pathname.includes("add");this.setState({newproject:e}),this.setState({readonly:window.location.pathname.includes("View")}),e||this.getProject(this.props.match.params.id),this.getDocCategories(),this.getSchools(),this.getStatuses()}},{key:"convert",value:function(e){var t=[];if(e){for(var a=0;a<e.length;a++)t.push({value:e[a].id,label:e[a].code+"-"+e[a].name+"-"+e[a].region});return t}}},{key:"display",value:function(e){if(this.state.schools){for(var t=0;t<this.state.schools.length;t++)if(this.state.schools[t].value==e)return this.state.schools[t];return[]}}},{key:"displayName",value:function(e){if(this.state.schools){for(var t=0;t<this.state.schools.length;t++)if(this.state.schools[t].value==e)return this.state.schools[t].label?this.state.schools[t].label:"\u5b66\u6821\u540d";return""}}},{key:"getSchools",value:function(){var e=this;O.a.getAllSimple().then((function(t){e.setState({schools:e.convert(t.data)});var a=S.a.getCurrentUser();a&&(e.setState({currentUser:a}),a.schoolId&&e.setState((function(e){return{currentProject:Object(c.a)(Object(c.a)({},e.currentProject),{},{schoolId:a.schoolId})}}))),console.log(t)})).catch((function(e){console.log(e)}))}},{key:"OLDgetSchools",value:function(){var e=this;O.a.getAllSimple().then((function(t){e.setState({schools:e.convert(t.data)}),console.log(t)})).catch((function(e){console.log(e)}))}},{key:"getStatuses",value:function(){var e=this;j.a.getStatuses().then((function(t){e.setState({statuses:t.data}),console.log(t)})).catch((function(e){console.log(e)}))}},{key:"getDocCategories",value:function(){var e=this;C.a.getDocCategories().then((function(t){e.setState({docCategories:t.data}),console.log(t)})).catch((function(e){console.log(e)}))}},{key:"onChangeName",value:function(e){var t=e.target.value;this.setState((function(e){return{currentProject:Object(c.a)(Object(c.a)({},e.currentProject),{},{name:t})}}))}},{key:"onChangeSchoolId",value:function(e){var t=e.value;this.setState((function(e){return{currentProject:Object(c.a)(Object(c.a)({},e.currentProject),{},{schoolId:t})}}))}},{key:"onChangeResponseId",value:function(e){var t=e.target.value;this.setState((function(e){return{currentProject:Object(c.a)(Object(c.a)({},e.currentProject),{},{responseId:t})}}))}},{key:"onChangeDocCategory",value:function(e){var t=e.target.value;this.setState((function(e){return{currentProject:Object(c.a)(Object(c.a)({},e.currentProject),{},{docCategory:t})}}))}},{key:"onChangeBudget",value:function(e){var t=e.target.value;this.setState((function(e){return{currentProject:Object(c.a)(Object(c.a)({},e.currentProject),{},{budget:t})}}))}},{key:"onChangePhoto",value:function(e){var t=e.target.value;this.setState((function(e){return{currentProject:Object(c.a)(Object(c.a)({},e.currentProject),{},{photo:t})}}))}},{key:"onChangeStatus",value:function(e){var t=e.target.value;this.setState((function(e){return{currentProject:Object(c.a)(Object(c.a)({},e.currentProject),{},{status:t})}}))}},{key:"onChangeDescription",value:function(e){var t=e.target.value;this.setState((function(e){return{currentProject:Object(c.a)(Object(c.a)({},e.currentProject),{},{description:t})}}))}},{key:"onChangeStartAt",value:function(e){var t=e;this.setState((function(e){return{currentProject:Object(c.a)(Object(c.a)({},e.currentProject),{},{startAt:t})}}))}},{key:"getProject",value:function(e){var t=this;j.a.get(e).then((function(a){t.setState({currentProject:a.data}),t.setState((function(e){return{currentProject:Object(c.a)(Object(c.a)({},e.currentProject),{},{schoolId:a.data.school?a.data.school.id:null})}})),t.setState((function(e){return{currentProject:Object(c.a)(Object(c.a)({},e.currentProject),{},{responseId:a.data.response?a.data.response.id:null})}})),t.getProjectPhoto(e),console.log(a.data)})).catch((function(e){console.log(e)}))}},{key:"getProjectPhoto",value:function(t){var a=this;j.a.getPhoto(t).then((function(t){var n="data:image/png;base64,"+new e(t.data.data.photo,"binary").toString("base64");a.setState((function(e){return{currentProject:Object(c.a)(Object(c.a)({},e.currentProject),{},{photo:n})}})),console.log(t.data)})).catch((function(e){console.log(e)}))}},{key:"updatePublished",value:function(e){var t=this,a={id:this.state.currentProject.id,title:this.state.currentProject.title,budget:this.state.currentProject.budget,published:e};j.a.update(this.state.currentProject.id,a).then((function(a){t.setState((function(t){return{currentProject:Object(c.a)(Object(c.a)({},t.currentProject),{},{published:e})}})),console.log(a.data)})).catch((function(e){console.log(e)}))}},{key:"newProject",value:function(){this.setState((function(e){return{currentProject:Object(c.a)(Object(c.a)({},e.currentProject),{},{id:null,name:"",budget:0,photo:null,file:null,status:"",docFiles:[],docCategory:"",description:"",startAt:null}),submitted:!1}}))}},{key:"SAVE_saveProject",value:function(){var e=this,t={name:this.state.currentProject.name,budget:this.state.currentProject.budget,schoolId:this.state.currentProject.schoolId,responseId:this.state.currentProject.responseId,status:this.state.currentProject.status,description:this.state.currentProject.description};j.a.create(t).then((function(t){e.setState((function(e){return{currentProject:Object(c.a)(Object(c.a)({},e.currentProject),{},{id:t.data.id}),submitted:!0}})),e.state.currentProject.file?e.updatePhoto():e.state.currentProject.docFiles&&e.uploadDossiers(),e.setState({message:"\u9879\u76ee\u4fe1\u606f\u6210\u529f\u63d0\u4ea4!"}),console.log(t.data)})).catch((function(e){console.log(e)}))}},{key:"validateSchool",value:function(){return!!this.state.currentProject.schoolId||(this.setState({message:"\u8bf7\u9009\u62e9\u5b66\u6821"}),!1)}},{key:"saveProject",value:function(){var e=Object(o.a)(s.a.mark((function e(){var t,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.validateSchool()){e.next=2;break}return e.abrupt("return");case 2:return t={name:this.state.currentProject.name,budget:this.state.currentProject.budget,schoolId:this.state.currentProject.schoolId,responseId:this.state.currentProject.responseId,status:this.state.currentProject.status,description:this.state.currentProject.description,startAt:this.state.currentProject.startAt?this.state.currentProject.startAt+"-02-01":null,xr:this.state.currentProject.xr},e.prev=3,e.next=6,j.a.create(t);case 6:return a=e.sent,e.next=9,this.setState((function(e){return{currentProject:Object(c.a)(Object(c.a)({},e.currentProject),{},{id:a.data.id})}}));case 9:if(!this.state.currentProject.file){e.next=12;break}return e.next=12,this.updatePhoto();case 12:if(!this.state.currentProject.docFiles){e.next=15;break}return e.next=15,this.uploadDossiers();case 15:this.setState({message:"\u9879\u76ee\u4fe1\u606f\u6210\u529f\u63d0\u4ea4!",submitted:!0}),e.next=22;break;case 18:e.prev=18,e.t0=e.catch(3),console.log(e.t0),this.setState({message:"\u9879\u76ee\u4fe1\u606f\u63d0\u4ea4\u5931\u8d25!"});case 22:case 23:case"end":return e.stop()}}),e,this,[[3,18]])})));return function(){return e.apply(this,arguments)}}()},{key:"updateProject",value:function(){var e=Object(o.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.validateSchool()){e.next=2;break}return e.abrupt("return");case 2:return t={name:this.state.currentProject.name,budget:this.state.currentProject.budget,status:this.state.currentProject.status,schoolId:this.state.currentProject.schoolId,responseId:this.state.currentProject.responseId,description:this.state.currentProject.description,startAt:this.state.currentProject.startAt?this.state.currentProject.startAt+"-02-01":null},e.prev=3,e.next=6,j.a.update(this.state.currentProject.id,t);case 6:if(!this.state.currentProject.file){e.next=9;break}return e.next=9,this.updatePhoto();case 9:if(!this.state.currentProject.docFiles){e.next=12;break}return e.next=12,this.uploadDossiers();case 12:this.setState({message:"\u9879\u76ee\u4fe1\u606f\u6210\u529f\u4fee\u6539!",submitted:!0}),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(3),this.setState({message:"\u9879\u76ee\u4fe1\u606f\u4fee\u6539\u5931\u8d25!"}),console.log(e.t0);case 19:case"end":return e.stop()}}),e,this,[[3,15]])})));return function(){return e.apply(this,arguments)}}()},{key:"SAVE_updateProject",value:function(){var e=this,t={name:this.state.currentProject.name,budget:this.state.currentProject.budget,status:this.state.currentProject.status,schoolId:this.state.currentProject.schoolId,responseId:this.state.currentProject.responseId,description:this.state.currentProject.description};j.a.update(this.state.currentProject.id,t).then((function(t){e.state.currentProject.file?e.updatePhoto():e.state.currentProject.docFiles&&e.uploadDossiers(),e.setState({message:"\u9879\u76ee\u4fe1\u606f\u6210\u529f\u4fee\u6539!",submitted:!0}),console.log(t.data)})).catch((function(e){console.log(e)}))}},{key:"updatePhoto",value:function(){var e=Object(o.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=new FormData).append("multi-files",this.state.currentProject.file,this.state.currentProject.file.name),e.next=4,j.a.updatePhoto(this.state.currentProject.id,t);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"uploadDossiers",value:function(){var e=Object(o.a)(s.a.mark((function e(){var t,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=new FormData,a=0;a<this.state.currentProject.docFiles.length;a++)t.append("multi-files",this.state.currentProject.docFiles[a],this.state.currentProject.docFiles[a].name);return t.append("docCategory",this.state.currentProject.docCategory),e.next=5,j.a.uploadDossiers(this.state.currentProject.id,t);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"deleteProject",value:function(){var e=this;j.a.delete(this.state.currentProject.id).then((function(t){console.log(t.data),e.props.history.push("/projects")})).catch((function(e){console.log(e)}))}},{key:"onChangeDocFiles",value:function(e){e.preventDefault();var t=e.target.files;this.setState((function(e){return{currentProject:Object(c.a)(Object(c.a)({},e.currentProject),{},{docFiles:t})}}))}},{key:"renderUpdates",value:function(){return p.a.createElement("div",null,p.a.createElement("button",{className:"badge badge-danger mr-2",onClick:this.deleteProject},"Delete"),p.a.createElement("button",{type:"submit",className:"badge badge-success",onClick:this.updateProject},"Update"),p.a.createElement("p",null,this.state.message))}},{key:"render",value:function(){var e,t=this,a=this.state.currentProject;return p.a.createElement("div",null,this.state.submitted?p.a.createElement("div",null,p.a.createElement("div",null,this.state.message),p.a.createElement("a",{href:"/projectsView/"+a.id,class:"btn btn-success"},"\u8fd4\u56de")):p.a.createElement("div",{class:"row"},p.a.createElement("div",{class:"col-sm-4"},p.a.createElement("div",{class:"row"},p.a.createElement("div",{onDragOver:this.onDrag,onDrop:this.onDrop},p.a.createElement("p",null,"\u4e0a\u4f20\u7167\u7247\uff08\u62d6\u62fd\u7167\u7247\u6587\u4ef6\u5230\u4e0b\u6846\u4e2d\uff09"),p.a.createElement("img",{src:a.photo,height:"200",width:"300",readonly:!!this.state.readonly&&""})),p.a.createElement("div",{class:"form-group"},p.a.createElement("label",{htmlFor:"name"},a.xr&&"\u5411\u8363\u652f\u6301","\u9879\u76ee\u540d\u79f0"),p.a.createElement("textarea",{readonly:!!this.state.readonly&&"",cols:"26",class:"form-control",id:"name",required:!0,value:a.name,onChange:this.onChangeName,name:"name"}))),this.state.readonly&&localStorage.getItem("user")&&p.a.createElement("div",{class:"box"},p.a.createElement("a",{target:"_blank",href:"/projects/"+a.id,class:"btn btn-primary mb-4"},"\u7f16\u8f91"))),p.a.createElement("div",{class:"col-sm-8"},p.a.createElement("div",{class:"row"},p.a.createElement("div",{class:"form-group col-sm-12"},p.a.createElement("label",{htmlFor:"description"},"\u9879\u76ee\u63cf\u8ff0"),p.a.createElement("textarea",{readonly:!!this.state.readonly&&"",class:"form-control",id:"description",required:!0,value:a.description,onChange:this.onChangeDescription,name:"description"})),p.a.createElement("div",{class:"w-100"}),p.a.createElement("div",{class:"col-sm-8"},p.a.createElement("label",{htmlFor:"schoolId"},"\u5b66\u6821"),this.state.readonly?p.a.createElement(f.b,{to:"/schoolsView/"+a.schoolId,id:"schoolId",name:"schoolId"},this.displayName(a.schoolId)):p.a.createElement(b.a,{onChange:this.onChangeSchoolId.bind(this),readonly:!!this.state.readonly&&"",class:"form-control",required:!0,id:"schoolId",value:this.display(a.schoolId),name:"schoolId",options:this.state.schools})),p.a.createElement("div",{class:"w-100"}),p.a.createElement("div",{class:"col-sm-4"},p.a.createElement("label",{htmlFor:"budget"},"\u8d39\u7528"),p.a.createElement("input",{readonly:!!this.state.readonly&&"",type:"number",min:"0.00",max:"10000.00",step:"0.01",class:"form-control",id:"budget",required:!0,value:a.budget,onChange:this.onChangeBudget,name:"budget"})),a.responseId?p.a.createElement("div",{class:"col-sm-4"},p.a.createElement("label",{htmlFor:"response"},"\u9879\u76ee\u7533\u8bf7"),p.a.createElement(f.b,{to:(this.state.readonly?"/responsesView/":"/responses/")+a.responseId,id:"response",name:"response"},"\u70b9\u51fb\u67e5\u770b\u9879\u76ee\u7533\u8bf7")):"",a.xr?"":p.a.createElement("div",{class:"select-container form-group col-sm-4"},p.a.createElement("label",{htmlFor:"status"},"\u9879\u76ee\u72b6\u6001"),p.a.createElement("select",(e={onChange:this.onChangeStatus,readonly:!!this.state.readonly&&"",class:"form-control",id:"status",required:!0,value:a.status},Object(n.a)(e,"onChange",this.onChangeStatus),Object(n.a)(e,"name","status"),e),p.a.createElement("option",{value:""},"\u8bf7\u9009\u62e9"),this.state.statuses.map((function(e){return p.a.createElement("option",{value:e},e)})))),p.a.createElement("div",{className:"col-sm-4"},p.a.createElement("label",{htmlFor:"startAt"},"\u9879\u76ee\u5e74\u4efd"),this.state.readonly?p.a.createElement("input",{type:"text",id:"startAt",readonly:"",className:"form-control",placeholder:"\u9879\u76ee\u5e74\u4efd",value:a.startAt}):p.a.createElement(y.a,{yearArray:["2019","2020"],value:a.startAt,onSelect:this.onChangeStartAt,minRange:1995,maxRange:2022})))),p.a.createElement("div",{class:"w-100"}),!this.state.readonly&&p.a.createElement("div",null,p.a.createElement("button",{onClick:this.saveProject,class:"btn btn-success",hidden:!this.state.newproject},"\u63d0\u4ea4"),p.a.createElement("button",{hidden:this.state.newproject,type:"submit",className:"btn btn-success",onClick:this.updateProject},"\u66f4\u65b0"),!a.xr&&p.a.createElement("form",{ref:"formToSubmit",action:"http://localhost:8080/api/dossiers-upload",method:"POST",enctype:"multipart/form-data"},p.a.createElement("div",{class:"form-group input-group"},p.a.createElement("label",{for:"input-multi-files"},"\u4e0a\u4f20\u6587\u4ef6:"),p.a.createElement("input",{type:"file",name:"multi-files",multiple:!0,id:"input-multi-files",class:"form-control-file border",onChange:function(e){return t.onChangeDocFiles(e)}}),p.a.createElement("select",{className:"form-control input-group-append",placeholder:"",value:a.docCategory,onChange:function(e){return t.onChangeDocCategory(e)}},p.a.createElement("option",{value:""},"\u9644\u4ef6\u7c7b\u522b"),this.state.docCategories.map((function(e){return p.a.createElement("option",{value:e},e)}))),p.a.createElement("input",{type:"hidden",name:"projectId",id:"projectId"}))),p.a.createElement("p",null,this.state.message)),p.a.createElement("div",{class:"w-100"}),!a.xr&&!this.state.newproject&&p.a.createElement(g.d,null,p.a.createElement(g.b,null,p.a.createElement(g.a,null,"\u66f4\u591a\u4fe1\u606f ",p.a.createElement("i",{class:"fas fa-hand-point-right"})),p.a.createElement(g.a,null,"\u9879\u76ee\u6587\u6863")),p.a.createElement(g.c,null),p.a.createElement(g.c,null,p.a.createElement(E.a,{projectId:a.id,embedded:!0,readonly:this.state.readonly}))),p.a.createElement("div",{class:"w-100"}),p.a.createElement("div",{className:"alert-danger"},p.a.createElement("p",null,p.a.createElement("h4",null,this.state.message)))))}}]),r}(h.Component)}).call(this,a(22).Buffer)},15:function(e,t,a){"use strict";var n=a(50),r=a(12),s=a(13),o=a(4),c=a(5),l=function(){function e(){Object(r.a)(this,e),this.reduce=function(e,t){var a={};return Object.keys(t).forEach((function(t){Object.assign(a,Object(n.a)({},t,e[t]))})),a}}return Object(s.a)(e,[{key:"getAll2",value:function(e){return o.a.post("/schools/all",e)}},{key:"getExport",value:function(e){return o.a.post("/schools/export",e,{headers:Object(c.a)()})}},{key:"getAll",value:function(){return o.a.get("/schools",{headers:Object(c.a)()})}},{key:"getRegions",value:function(){return o.a.get("/schools/regions")}},{key:"getCountsByRegion",value:function(){return o.a.get("/schools/countsByRegion",{headers:Object(c.a)()})}},{key:"getStages",value:function(){return o.a.get("/schools/stages")}},{key:"getStatuses",value:function(){return o.a.get("/schools/statuses")}},{key:"getStatuses_ss",value:function(){return o.a.get("/schools/statuses_ss")}},{key:"getRequests",value:function(){return o.a.get("/schools/requests")}},{key:"getRequests_ss",value:function(){return o.a.get("/schools/requests_ss")}},{key:"getCategories",value:function(){return o.a.get("/schools/categories")}},{key:"get",value:function(e){return o.a.get("/schools/".concat(e))}},{key:"getPrincipal",value:function(e){return o.a.get("/schoolsPrincipal/".concat(e))}},{key:"getPhoto",value:function(e){return o.a.get("/schoolPhoto/".concat(e))}},{key:"create",value:function(e){return o.a.post("/schools",e,{headers:Object(c.a)()})}},{key:"update",value:function(e,t){return o.a.put("/schools/".concat(e),t,{headers:Object(c.a)()})}},{key:"updatePhoto",value:function(e,t){var a=JSON.parse(localStorage.getItem("user"));return o.a.post("/single-upload/".concat(e),t,{headers:{"content-type":"multipart/form-data","x-access-token":a&&a.accessToken?a.accessToken:null}})}},{key:"uploadDocuments",value:function(e,t){var a=JSON.parse(localStorage.getItem("user"));return o.a.post("/documents-upload/".concat(e),t,{headers:{"content-type":"multipart/form-data","x-access-token":a&&a.accessToken?a.accessToken:null}})}},{key:"delete",value:function(e){return o.a.delete("/schools/".concat(e),{headers:Object(c.a)()})}},{key:"deleteAll",value:function(){return o.a.delete("/schools",{headers:Object(c.a)()})}},{key:"findByTitle",value:function(e){return o.a.get("/schools?title=".concat(e),{headers:Object(c.a)()})}},{key:"getAllSimple",value:function(){return o.a.get("/schoolsSimple",{headers:Object(c.a)()})}}]),e}();t.a=new l},23:function(e,t,a){"use strict";var n=a(12),r=a(13),s=a(4),o=a(5),c=function(){function e(){var t=this;Object(n.a)(this,e),this.toCSV=function(e,a){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],s=function(e){if(a)for(var t=0;t<a.length;t++)if(e===a[t].accessor)return a[t].Header;return null};if(!(e instanceof Object)){var o=n.substring(0,n.lastIndexOf("."));return{header:s(o),body:e||""}}if(e instanceof Array){for(var c="",l="",i=0;i<e.length;i++){var u=t.toCSV(e[i],a,n,!1);c=c+u.body+(r?"\n":""),l.endsWith("\n")||(l=l+u.header+(r?"\n":""))}return{header:l,body:c}}if(e instanceof Object){c="",l="";return Object.keys(e).forEach((function(r){var s=t.toCSV(e[r],a,n+r+".",!1);s.header&&(c=c+s.body+",",l.endsWith("\n")||(l=l+s.header+","))})),c=c.substring(0,c.lastIndexOf(",")),{header:l=l.substring(0,l.lastIndexOf(",")),body:c}}},this.exportCSV=function(e,t){for(var a=function(e){return!0===e?"\u662f":!1===e?"\u5426":e?"string"===typeof e?e.replace(/(\r\n|\n|\r)/gm,""):e:""},n=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!(t instanceof Object)){var s=n.substring(0,n.lastIndexOf("."));return{hh:"",header:s,body:a(t)}}if(t instanceof Array){for(var o="",c="",l="",i=0;i<t.length;i++){var u=e(t[i],n,!1);o=o+u.body+(r?"\n":""),(c=c+u.header+(r?"\n":"")).endsWith("\n")&&(l=c.length>l.length?c:l,c="")}return{hh:l,header:c,body:o}}if(t instanceof Object){o="",c="";return Object.keys(t).forEach((function(a){var r=e(t[a],n+a+".",!1);o=o+r.body+",",c=c+r.header+","})),o=o.substring(0,o.lastIndexOf(",")),{hh:"",header:c=c.substring(0,c.lastIndexOf(",")),body:o}}}(e),r=n.hh.trim().split(","),s=[],o=0;o<t.length;o++)for(var c=0;c<r.length;c++)r[c].endsWith(t[o].accessor)&&s.push({mapper:o,data:c});var l=function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e||0==e.trim().length)return"";for(var r=e.split(","),o="",c=0;c<s.length;c++)o=o+(n?t[s[c].mapper].Header:a(r[s[c].data]))+",";return o=o.substring(0,o.lastIndexOf(","))+"\n"},i=n.body.split("\n"),u="";for(o=0;o<i.length;o++)u+=l(i[o]);return l(n.hh,!0)+u}}return Object(r.a)(e,[{key:"getAll2",value:function(e){return s.a.post("/projects/all",e)}},{key:"getAll",value:function(){return s.a.get("/projects",{headers:Object(o.a)()})}},{key:"getRegions",value:function(){return s.a.get("/projects/regions",{headers:Object(o.a)()})}},{key:"getStatuses",value:function(){return s.a.get("/projectsStatuses",{headers:Object(o.a)()})}},{key:"get",value:function(e){return s.a.get("/projects/".concat(e))}},{key:"getPhoto",value:function(e){return s.a.get("/projectPhoto/".concat(e),{headers:Object(o.a)()})}},{key:"create",value:function(e){return s.a.post("/projects",e,{headers:Object(o.a)()})}},{key:"update",value:function(e,t){return s.a.put("/projects/".concat(e),t,{headers:Object(o.a)()})}},{key:"updatePhoto",value:function(e,t){var a=JSON.parse(localStorage.getItem("user"));return s.a.post("/single-project-upload/".concat(e),t,{headers:{"content-type":"multipart/form-data","x-access-token":a&&a.accessToken?a.accessToken:null}})}},{key:"uploadDossiers",value:function(e,t){var a=JSON.parse(localStorage.getItem("user"));return s.a.post("/dossiers-upload/".concat(e),t,{headers:{"content-type":"multipart/form-data","x-access-token":a&&a.accessToken?a.accessToken:null}})}},{key:"delete",value:function(e){return s.a.delete("/projects/".concat(e),{headers:Object(o.a)()})}},{key:"deleteAll",value:function(){return s.a.delete("/projects",{headers:Object(o.a)()})}},{key:"findByTitle",value:function(e){return s.a.get("/projects?title=".concat(e),{headers:Object(o.a)()})}},{key:"getAllSimple",value:function(){return s.a.get("/projectsSimple",{headers:Object(o.a)()})}}]),e}();t.a=new c},243:function(e,t,a){e.exports=a.p+"static/media/shinshin-logo.e8d0faed.png"},245:function(e,t,a){e.exports=a.p+"static/media/defaultPhoto.f4adc5ef.jpg"},255:function(e,t,a){e.exports=a(506)},265:function(e,t,a){},329:function(e,t){},331:function(e,t){},343:function(e,t){},345:function(e,t){},37:function(e,t,a){"use strict";var n=a(12),r=a(13),s=a(4),o=a(5),c=function(){function e(){Object(n.a)(this,e)}return Object(r.a)(e,[{key:"getAll2",value:function(e){return s.a.post("/surveys/all",e,{headers:Object(o.a)()})}},{key:"getAll",value:function(e){return s.a.get("/surveys",{params:e},{headers:Object(o.a)()})}},{key:"get",value:function(e){return s.a.get("/surveys/".concat(e))}},{key:"getUpdatedAt",value:function(e){return s.a.get("/surveysUpdatedAt/".concat(e),{headers:Object(o.a)()})}},{key:"getContent",value:function(e){var t=JSON.parse(localStorage.getItem("user"));return s.a.get("/surveysContent/".concat(e),{headers:{"x-access-token":t&&t.accessToken?t.accessToken:null},responseType:"arraybuffer"})}},{key:"getDocCategories",value:function(){return s.a.get("/surveys/categories",{headers:Object(o.a)()})}},{key:"getCount",value:function(e){return s.a.get("/surveysCount/".concat(e),{headers:Object(o.a)()})}},{key:"create",value:function(e){return s.a.post("/surveys",e,{headers:Object(o.a)()})}},{key:"update",value:function(e,t){return s.a.put("/surveys/".concat(e),t,{headers:Object(o.a)()})}},{key:"delete",value:function(e){return s.a.delete("/surveys/".concat(e),{headers:Object(o.a)()})}},{key:"deleteAll",value:function(){return s.a.delete("/surveys",{headers:Object(o.a)()})}},{key:"findByTitle",value:function(e){return s.a.get("/surveys?title=".concat(e),{headers:Object(o.a)()})}}]),e}();t.a=new c},373:function(e,t){},375:function(e,t){},376:function(e,t){},381:function(e,t){},383:function(e,t){},389:function(e,t){},391:function(e,t){},4:function(e,t,a){"use strict";var n=a(28),r=a.n(n);t.a=r.a.create({baseURL:"/api",headers:{"Content-type":"application/json"}})},410:function(e,t){},422:function(e,t){},425:function(e,t){},5:function(e,t,a){"use strict";function n(){var e=JSON.parse(localStorage.getItem("user"));return e&&e.accessToken?{"x-access-token":e.accessToken}:{}}a.d(t,"a",(function(){return n}))},506:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(49),o=a.n(s),c=a(10),l=a(12),i=a(13),u=a(6),d=a(26),m=a(25),h=a(59),p=(a(96),a(260),a(262),a(263),a(265),a(243)),g=a.n(p),f=a(88),b=a(21),v=a(1),y=a(37),E=a(95),j=a(17),C=function(e){var t=Object(n.useState)([]),a=Object(v.a)(t,2),s=a[0],o=a[1],l=Object(n.useState)(null),i=Object(v.a)(l,2),u=(i[0],i[1],Object(n.useState)(-1)),d=Object(v.a)(u,2),m=(d[0],d[1],Object(n.useState)("")),h=Object(v.a)(m,2),p=h[0],g=h[1],f=Object(n.useState)(e.match?e.match.params.schoolId:e.schoolId),C=Object(v.a)(f,2),O=C[0],S=(C[1],Object(n.useState)(e.match?e.match.params.docCategory:e.docCategory)),w=Object(v.a)(S,2),k=w[0],N=(w[1],Object(n.useState)([])),I=Object(v.a)(N,2),P=I[0],x=I[1],R=Object(n.useState)(!!e.readonly&&e.readonly),F=Object(v.a)(R,2),A=F[0],B=(F[1],Object(n.useState)(!!e.embedded&&e.embedded)),D=Object(v.a)(B,2),H=D[0],T=(D[1],Object(n.useRef)());T.current=s;var U=Object(n.useState)(1),V=Object(v.a)(U,2),q=V[0],G=V[1],L=Object(n.useState)(0),_=Object(v.a)(L,2),M=_[0],W=_[1],J=Object(n.useState)(5),z=Object(v.a)(J,2),Y=z[0],X=z[1],$=function(){var e=function(){var e={};return p&&(e.originalname=p),q&&(e.page=q-1),Y&&(e.size=Y),O&&(e.schoolId=O),k&&(e.docCategory=k),P&&(e.orderby=P),e}();y.a.getAll2(e).then((function(e){var t=e.data,a=t.surveys,n=t.totalPages;o(a),W(n),console.log(e.data)})).catch((function(e){console.log(e)}))};Object(n.useEffect)($,[q,Y,P]);var Q=Object(n.useMemo)((function(){return[{Header:"\u6700\u540e\u4fee\u6539\u65f6\u95f4",accessor:"updatedAt",Cell:function(e){var t=e.row.id,a=new Date(T.current[t].createdAt);return r.a.createElement("div",null,a.toLocaleDateString("zh-cn",{hour12:!0,hour:"2-digit",minute:"2-digit",second:"2-digit"}))}},{Header:"\u5b66\u6821",accessor:"school",disableSortBy:!0,Cell:function(e){var t=e.row.id;return r.a.createElement("div",null,r.a.createElement(c.b,{to:"/schoolsView/"+T.current[t].schoolId,className:"badge badge-success"},T.current[t].schoolId))}},{Header:"\u64cd\u4f5c",accessor:"actions",disableSortBy:!0,Cell:function(e){var t=e.row.id;return r.a.createElement("div",null,r.a.createElement(c.b,{to:"/surveysView/"+T.current[t].schoolId},r.a.createElement("i",{className:"fas fa-eye action mr-2"})),!A&&r.a.createElement(c.b,{to:"/surveys/"+T.current[t].schoolId},r.a.createElement("i",{className:"far fa-edit action mr-2"})),!A&&r.a.createElement("span",{onClick:function(){return window.confirm("\u60a8\u786e\u5b9a\u8981\u5220\u9664\u5417 ?")&&function(e){var t=T.current[e].id;y.a.delete(t).then((function(t){var a=Object(b.a)(T.current);a.splice(e,1),o(a)})).catch((function(e){console.log(e)}))}(t)}},r.a.createElement("i",{className:"fas fa-trash action"})))}}]}),[]),K=Object(j.useTable)({columns:Q,data:s,disableSortRemove:!0,manualSortBy:!0,initialState:{sortBy:[{id:"updatedAt",desc:!1}]}},j.useSortBy),Z=K.getTableProps,ee=K.getTableBodyProps,te=K.headerGroups,ae=K.rows,ne=K.prepareRow,re=K.state.sortBy;return Object(n.useEffect)((function(){re&&re[0]&&x(re)}),[re]),r.a.createElement("div",{className:"list row"},!H&&r.a.createElement("div",{className:"col-sm-8"},r.a.createElement("h4",null,"\u8c03\u67e5\u8868\u5217\u8868"),r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("input",{type:"text",className:"form-control",placeholder:"Search by originalname",value:p,onChange:function(e){var t=e.target.value;g(t)}}),r.a.createElement("div",{className:"input-group-append"},r.a.createElement("button",{className:"btn btn-outline-secondary",type:"button",onClick:function(){G(1),$()}},"Search"))),"\u6bcf\u9875\u663e\u793a\u884c\u6570: ",r.a.createElement("select",{onChange:function(e){X(e.target.value),G(1)},value:Y},[5,10,20].map((function(e){return r.a.createElement("option",{key:e,value:e},e)}))),r.a.createElement(E.a,{className:"my-3",count:M,page:q,siblingCount:1,boundaryCount:1,variant:"outlined",shape:"rounded",onChange:function(e,t){G(t)}})),r.a.createElement("div",{className:"col-sm-12 list"},r.a.createElement("table",Object.assign({className:"table table-striped table-bordered"},Z()),r.a.createElement("thead",null,te.map((function(e){return r.a.createElement("tr",e.getHeaderGroupProps(),e.headers.map((function(e){return r.a.createElement("th",e.getHeaderProps(e.getSortByToggleProps()),e.render("Header"),r.a.createElement("span",null,e.isSorted?e.isSortedDesc?" \ud83d\udd3d":" \ud83d\udd3c":""))})))}))),r.a.createElement("tbody",ee(),ae.map((function(e,t){return ne(e),r.a.createElement("tr",e.getRowProps(),e.cells.map((function(e){return r.a.createElement("td",e.getCellProps(),e.render("Cell"))})))}))))),r.a.createElement("div",{className:"col-sm-8"}))},O=a(144),S=a(3),w=a(15),k=a(23),N=a(34),I=a.n(N),P=Object(h.f)((function(e){var t=Object(n.useState)([]),a=Object(v.a)(t,2),s=a[0],o=a[1],l=Object(n.useState)([]),i=Object(v.a)(l,2),u=(i[0],i[1]),d=Object(n.useState)(null),m=Object(v.a)(d,2),h=(m[0],m[1],Object(n.useState)(localStorage.getItem("user"))),p=Object(v.a)(h,2),g=p[0],f=(p[1],Object(n.useState)(-1)),y=Object(v.a)(f,2),C=(y[0],y[1],Object(n.useState)("")),O=Object(v.a)(C,2),N=O[0],P=O[1],x=Object(n.useState)(""),R=Object(v.a)(x,2),F=R[0],A=R[1],B=Object(n.useState)(e.match?e.match.params.region:e.region),D=Object(v.a)(B,2),H=D[0],T=D[1],U=Object(n.useState)(""),V=Object(v.a)(U,2),q=V[0],G=V[1],L=Object(n.useState)(""),_=Object(v.a)(L,2),M=_[0],W=_[1],J=Object(n.useState)(""),z=Object(v.a)(J,2),Y=z[0],X=z[1],$=Object(n.useState)(""),Q=Object(v.a)($,2),K=Q[0],Z=Q[1],ee=Object(n.useState)(""),te=Object(v.a)(ee,2),ae=te[0],ne=te[1],re=Object(n.useState)(""),se=Object(v.a)(re,2),oe=se[0],ce=se[1],le=Object(n.useState)(null),ie=Object(v.a)(le,2),ue=ie[0],de=ie[1],me=Object(n.useRef)();me.current=s;var he=Object(n.useState)(1),pe=Object(v.a)(he,2),ge=pe[0],fe=pe[1],be=Object(n.useState)(0),ve=Object(v.a)(be,2),ye=ve[0],Ee=ve[1],je=Object(n.useState)(30),Ce=Object(v.a)(je,2),Oe=Ce[0],Se=Ce[1],we=Object(n.useState)(0),ke=Object(v.a)(we,2),Ne=ke[0],Ie=ke[1],Pe=[20,30,50],xe=Object(n.useState)([]),Re=Object(v.a)(xe,2),Fe=Re[0],Ae=Re[1],Be=Object(n.useState)([]),De=Object(v.a)(Be,2),He=De[0],Te=De[1],Ue=Object(n.useState)([]),Ve=Object(v.a)(Ue,2),qe=Ve[0],Ge=Ve[1],Le=Object(n.useState)([]),_e=Object(v.a)(Le,2),Me=_e[0],We=_e[1],Je=Object(n.useState)([]),ze=Object(v.a)(Je,2),Ye=ze[0],Xe=ze[1],$e=function(e){var t={};return N&&(t.name=N),ge&&(t.page=ge-1),Oe&&(t.size=Oe),Fe&&(t.orderby=Fe),F&&(t.code=F),H&&(t.region=H),q&&(t.startAt=q),M&&(t.lastVisit=M),Y&&(t.donor=Y),K&&(t.stage=K),ae&&(t.status=ae),oe&&(t.request=oe),ue&&(t.xr=ue),e&&(t.exportFlag=e),t};Object(n.useEffect)((function(){0==He.length&&w.a.getRegions().then((function(e){Te(e.data),console.log(e)})).catch((function(e){console.log(e)}))}),[Fe]),Object(n.useEffect)((function(){w.a.getStages().then((function(e){Ge(e.data),console.log(e)})).catch((function(e){console.log(e)}))}),[Fe]),Object(n.useEffect)((function(){w.a.getStatuses_ss().then((function(e){We(e.data),console.log(e)})).catch((function(e){console.log(e)}))}),[Fe]),Object(n.useEffect)((function(){w.a.getRequests_ss().then((function(e){Xe(e.data),console.log(e)})).catch((function(e){console.log(e)}))}),[Fe]);var Qe=function(){var e=$e(!1);w.a.getAll2(e).then((function(e){var t=e.data,a=t.schools,n=t.totalPages,r=t.totalItems;o(a),Ee(n),Ie(r),console.log(e.data)})).catch((function(e){console.log(e)}))},Ke=function(e){var t=$e(!0);w.a.getExport(Object(S.a)(Object(S.a)({},e),t)).then((function(t){u(t.data),console.log(t.data);var a=k.a.exportCSV(t.data,at),n=window.URL.createObjectURL(new Blob([a])),r=document.createElement("a");r.href=n,r.setAttribute("download","schools_export"+(e.detail[0]?"_detail":"")+".csv"),document.body.appendChild(r),r.click(),r.remove()})).catch((function(e){var t=e.response&&e.response.data&&e.response.data.message||e.message||e.toString();console.log(e),console.log(t)}))};Object(n.useEffect)(Qe,[ge,Oe,Fe,N,F,H,q,M,Y,K,ae,oe,ue]);var Ze=function(e){for(var t=[],a=0;a<e.length;a++)t.push(e[a].accessor);return t},et=[{Header:"\u5b66\u6821\u7f16\u53f7",accessor:"code"},{Header:"\u5b66\u6821\u540d\u79f0",accessor:"name"},{Header:"\u6559\u80b2\u5c40\u6ce8\u518c\u6821\u540d",accessor:"schoolBoardRegisteredName"},{Header:"\u4e3b\u7ba1\u6559\u80b2\u5c40\u540d\u79f0",accessor:"schoolBoard"},{Header:"\u5efa\u6821\u5e74\u4efd",accessor:"startAt"},{Header:"\u6350\u6b3e\u4eba",accessor:"donor"},{Header:"\u6700\u8fd1\u8bbf\u6821\u5e74\u4efd",accessor:"lastVisit"},{Header:"\u5b66\u6821\u9636\u6bb5",accessor:"stage"},{Header:"\u5b66\u6821\u72b6\u6001",accessor:"status"},{Header:"\u9700\u6c42\u72b6\u6001",accessor:"request"},{Header:"\u7701/\u81ea\u6cbb\u533a/\u76f4\u8f96\u5e02",accessor:"region"},{Header:"\u5e02",accessor:"city"},{Header:"\u533a/\u53bf",accessor:"county"},{Header:"\u4e61/\u9547",accessor:"community"},{Header:"\u5730\u5740",accessor:"address"},{Header:"\u6559\u5e08\u4eba\u6570",accessor:"teachersCount"},{Header:"\u5b66\u751f\u4eba\u6570",accessor:"studentsCount"},{Header:"\u5b66\u6821\u7c7b\u578b",accessor:"category"},{Header:"\u6821\u957f",accessor:"principalId"},{Header:"\u6821\u957f\u7535\u8bdd",accessor:"principalPhone"},{Header:"\u6821\u957f\u5fae\u4fe1",accessor:"principalWechat"},{Header:"\u8054\u7edc\u4eba",accessor:"contactId"},{Header:"\u8054\u7edc\u4eba\u7535\u8bdd",accessor:"contactPhone"},{Header:"\u8054\u7edc\u4eba\u5fae\u4fe1",accessor:"contactWechat"}],tt=[{Header:"\u5b66\u6821\u7535\u8bdd",accessor:"phone"},{Header:"\u5b66\u6821\u7535\u90ae\u5730\u5740",accessor:"email"},{Header:"\u7559\u5b88\u513f\u7ae5\u4eba\u6570",accessor:"stayBehindCount"},{Header:"\u5b66\u751f\u4f4f\u5bbf\u4eba\u6570",accessor:"boarderCount"},{Header:"\u5b66\u524d\u73ed\u7ea7\u6570",accessor:"kClassesCount"},{Header:"\u4e00\u5e74\u7ea7\u73ed\u7ea7\u6570",accessor:"g1ClassesCount"},{Header:"\u4e8c\u5e74\u7ea7\u73ed\u7ea7\u6570",accessor:"g2ClassesCount"},{Header:"\u4e09\u5e74\u7ea7\u73ed\u7ea7\u6570",accessor:"g3ClassesCount"},{Header:"\u56db\u5e74\u7ea7\u73ed\u7ea7\u6570",accessor:"g4ClassesCount"},{Header:"\u4e94\u5e74\u7ea7\u73ed\u7ea7\u6570",accessor:"g5ClassesCount"},{Header:"\u516d\u5e74\u7ea7\u73ed\u7ea7\u6570",accessor:"g6ClassesCount"},{Header:"\u5b66\u524d\u5b66\u751f\u6570",accessor:"kStudentsCount"},{Header:"\u4e00\u5e74\u7ea7\u5b66\u751f\u6570",accessor:"g1StudentsCount"},{Header:"\u4e8c\u5e74\u7ea7\u5b66\u751f\u6570",accessor:"g2StudentsCount"},{Header:"\u4e09\u5e74\u7ea7\u5b66\u751f\u6570",accessor:"g3StudentsCount"},{Header:"\u56db\u5e74\u7ea7\u5b66\u751f\u6570",accessor:"g4StudentsCount"},{Header:"\u4e94\u5e74\u7ea7\u5b66\u751f\u6570",accessor:"g5StudentsCount"},{Header:"\u516d\u5e74\u7ea7\u5b66\u751f\u6570",accessor:"g6StudentsCount"},{Header:"\u5982\u6709\u521d\u4e2d\u5b66\u751f\u6570",accessor:"mStudentsCount"},{Header:"\u529e\u516c\u7528\u7535\u8111\u53f0\u6570",accessor:"computersCount"},{Header:"\u662f\u5426\u6709\u7535\u8111\u5ba4",accessor:"computerRoomExists"},{Header:"\u5171\u6709\u51e0\u53f0\u7535\u8111",accessor:"computerRoomCount"},{Header:"\u53ef\u5426\u4e0a\u7f51",accessor:"internetExists"},{Header:"\u591a\u5a92\u4f53\u4e00\u4f53\u673a\u5957\u6570",accessor:"multimediaSystemsCount"},{Header:"\u662f\u5426\u6709\u56fe\u4e66\u9605\u89c8\u5ba4",accessor:"libraryExists"},{Header:"\u56fe\u4e66\u89d2\u6570\u91cf",accessor:"bookCornersCount"},{Header:"\u56fe\u4e66\u518c\u6570",accessor:"booksCount"}],at=[].concat(et,tt),nt=Object(n.useMemo)((function(){return[{Header:"ID",accessor:"id",disableSortBy:!0},{Header:"\u5b66\u6821\u7f16\u53f7",accessor:"code",Cell:function(e){var t=e.row.id;return r.a.createElement("div",null,r.a.createElement(c.b,{to:"/schoolsView/"+me.current[t].id},me.current[t].code))}},{Header:"\u7701/\u81ea\u6cbb\u533a/\u76f4\u8f96\u5e02",accessor:"region"},{Header:"\u5b66\u6821\u540d\u79f0",accessor:"name"},{Header:"\u5efa\u6821\u5e74\u4efd",accessor:"startAt"},{Header:"\u6700\u8fd1\u8bbf\u6821\u5e74\u4efd",accessor:"lastVisit"},{Header:"\u5b66\u6821\u9636\u6bb5",accessor:"stage"},{Header:"\u5b66\u6821\u72b6\u6001",accessor:"status"},{Header:"\u9700\u6c42\u72b6\u6001",accessor:"request"},{Header:"\u6350\u6b3e\u4eba",accessor:"donor",disableSortBy:!0},{Header:"\u9879\u76ee",accessor:"projectsCount",Cell:function(e){var t=e.row.id;return r.a.createElement("div",null,r.a.createElement(c.b,{to:"/projects/school/"+me.current[t].id,className:"badge badge-success"},me.current[t].projectsCount))}},{Header:"\u9879\u76ee\u7533\u8bf7",accessor:"responsesCount",Cell:function(e){var t=e.row.id;return r.a.createElement("div",null,r.a.createElement(c.b,{to:"/responses/school/"+me.current[t].id,className:"badge badge-success"},me.current[t].responsesCount))}},{Header:"\u5411\u8363\u652f\u6301",accessor:"xr",Cell:function(e){var t=e.row.id;return r.a.createElement("div",null,me.current[t].xr?"\u662f":"\u5426")}},{Header:"\u64cd\u4f5c",accessor:"actions",disableSortBy:!0,Cell:function(e){var t=e.row.id;return r.a.createElement("div",null,r.a.createElement(c.b,{to:"/schoolsView/"+me.current[t].id},r.a.createElement("i",{className:"fas fa-eye action mr-2"})),g&&r.a.createElement(c.b,{to:"/schools/"+me.current[t].id},r.a.createElement("i",{className:"far fa-edit action mr-2"})),g&&r.a.createElement("span",{onClick:function(){return window.confirm("\u60a8\u786e\u5b9a\u8981\u5220\u9664\u5417 ?")&&function(e){var t=me.current[e].id;w.a.delete(t).then((function(t){var a=Object(b.a)(me.current);a.splice(e,1),o(a)})).catch((function(e){console.log(e)}))}(t)}},r.a.createElement("i",{className:"fas fa-trash action"})))}}]}),[]),rt=Object(j.useTable)({columns:nt,data:s,disableSortRemove:!0,manualSortBy:!0,initialState:{sortBy:[{id:"code",desc:!1}]}},j.useSortBy),st=rt.getTableProps,ot=rt.getTableBodyProps,ct=rt.headerGroups,lt=rt.rows,it=rt.prepareRow,ut=(rt.state,rt.state.sortBy),dt=function(e,t){fe(t)},mt=function(e){Se(e.target.value),fe(1)};return Object(n.useEffect)((function(){ut&&ut[0]&&Ae(ut)}),[ut]),r.a.createElement("div",{className:"list row"},r.a.createElement("div",{className:"col-sm-9"},r.a.createElement("h4",null,"\u5b66\u6821\u5217\u8868(\u603b\u6570\uff1a",Ne,")"),r.a.createElement("div",{className:"row mb-3"},r.a.createElement("input",{type:"text",className:"form-control col-sm-2 ml-2",placeholder:"\u5b66\u6821\u7f16\u53f7",value:F,onChange:function(e){var t=e.target.value;A(t)}}),r.a.createElement("select",{className:"form-control col-sm-2 ml-2",placeholder:"....",value:H,onChange:function(e){var t=e.target.value;T(t)}},r.a.createElement("option",{value:""},"\u7701/\u81ea\u6cbb\u533a"),He.map((function(e){return r.a.createElement("option",{value:e},e)}))),r.a.createElement("input",{type:"text",className:"form-control col-sm-4 ml-2",placeholder:"\u5b66\u6821\u540d\u79f0",value:N,onChange:function(e){var t=e.target.value;P(t)}}),r.a.createElement("input",{type:"text",readonly:"",className:"form-control col-sm-1 ml-2",placeholder:"\u5efa\u6821",value:q}),r.a.createElement(I.a,{yearArray:["2019","2020"],value:q,onSelect:function(e){G(e)},hideInput:!0,minRange:1995,maxRange:2022}),r.a.createElement("input",{type:"text",readonly:"",className:"form-control col-sm-1 ml-2",placeholder:"\u8bbf\u6821",value:M}),r.a.createElement(I.a,{yearArray:["2019","2020"],value:M,onSelect:function(e){W(e)},hideInput:!0,minRange:1995,maxRange:2022})),r.a.createElement("div",{className:"row mb-3 "},r.a.createElement("select",{className:"form-control col-sm-2 ml-2",placeholder:"....",value:K,onChange:function(e){var t=e.target.value;Z(t)}},r.a.createElement("option",{value:""},"\u5b66\u6821\u9636\u6bb5"),qe.map((function(e){return r.a.createElement("option",{value:e},e)}))),r.a.createElement("select",{className:"form-control col-sm-2 ml-2",placeholder:"....",value:ae,onChange:function(e){var t=e.target.value;ne(t)}},r.a.createElement("option",{value:""},"\u5b66\u6821\u72b6\u6001"),Me.map((function(e){return r.a.createElement("option",{value:e},e)}))),r.a.createElement("select",{className:"form-control col-sm-2 ml-2",placeholder:"....",value:oe,onChange:function(e){var t=e.target.value;ce(t)}},r.a.createElement("option",{value:""},"\u9700\u6c42\u72b6\u6001"),Ye.map((function(e){return r.a.createElement("option",{value:e},e)}))),r.a.createElement("input",{type:"text",className:"form-control col-sm-2 ml-2",placeholder:"\u6350\u6b3e\u4eba",value:Y,onChange:function(e){var t=e.target.value;X(t)}}),r.a.createElement("select",{className:"form-control col-sm-2 ml-2",value:ue,onChange:function(e){var t=e.target.value;de(t)}},r.a.createElement("option",{value:""},"\u5411\u8363\u652f\u6301?"),r.a.createElement("option",{value:!1},"\u5426"),r.a.createElement("option",{value:!0},"\u662f")),r.a.createElement("div",null,r.a.createElement("button",{className:"btn btn-primary  ml-2",type:"button",onClick:function(e){P(""),A(""),T(""),G(""),W(""),X(""),Z(""),ne(""),ce(""),de(""),Ae([]),u([])}},"\u6e05\u7a7a"))),r.a.createElement("div",{className:"input-group mb-4"},r.a.createElement("div",null,r.a.createElement("button",{className:"btn btn-primary ",type:"button",onClick:function(){fe(1),Qe()}},"\u67e5\u8be2")),r.a.createElement("div",{hidden:!g},r.a.createElement("button",{className:"btn btn-primary ml-2",type:"button",onClick:function(){Ke({main:Ze(et),detail:[]})}},"\u5bfc\u51fa")),r.a.createElement("div",{hidden:!g},r.a.createElement("button",{className:"btn btn-primary ml-2",type:"button",onClick:function(){Ke({main:Ze(et),detail:Ze(tt)})}},"\u8be6\u7ec6\u5bfc\u51fa")))),r.a.createElement("div",{className:"mt-3 col-sm-3"},"\u6bcf\u9875\u663e\u793a\u884c\u6570: ",r.a.createElement("select",{onChange:mt,value:Oe},Pe.map((function(e){return r.a.createElement("option",{key:e,value:e},e)}))),r.a.createElement(E.a,{className:"my-3",count:ye,page:ge,siblingCount:1,boundaryCount:1,variant:"outlined",shape:"rounded",onChange:dt})),r.a.createElement("div",{class:"w-100"}),r.a.createElement("div",{className:"col-sm-12 list"},r.a.createElement("table",Object.assign({className:"table table-striped table-bordered"},st()),r.a.createElement("thead",null,ct.map((function(e){return r.a.createElement("tr",e.getHeaderGroupProps(),e.headers.map((function(e){return r.a.createElement("th",e.getHeaderProps(e.getSortByToggleProps()),e.render("Header"),r.a.createElement("span",null,"code"===e.id||"region"===e.id||"startAt"===e.id||"teachersCount"===e.id||"studentsCount"===e.id||"name"===e.id||"projectsCount"===e.id||"responsesCount"===e.id||"stage"===e.id||"lastVisit"===e.id||"status"===e.id||"request"===e.id||"xr"===e.id?e.isSortedDesc?" \ud83d\udd3d":" \ud83d\udd3c":""))})))}))),r.a.createElement("tbody",ot(),lt.map((function(e,t){return it(e),r.a.createElement("tr",e.getRowProps(),e.cells.map((function(e){return r.a.createElement("td",e.getCellProps(),e.render("Cell"))})))}))))),r.a.createElement("div",{className:"mt-3 col-sm-12"},"\u6bcf\u9875\u663e\u793a\u884c\u6570: ",r.a.createElement("select",{onChange:mt,value:Oe},Pe.map((function(e){return r.a.createElement("option",{key:e,value:e},e)}))),r.a.createElement(E.a,{className:"my-3",count:ye,page:ge,siblingCount:1,boundaryCount:1,variant:"outlined",shape:"rounded",onChange:dt})))})),x=a(80),R=function(e){var t=Object(n.useState)([]),a=Object(v.a)(t,2),s=a[0],o=a[1],l=Object(n.useState)(null),i=Object(v.a)(l,2),u=(i[0],i[1],Object(n.useState)(-1)),d=Object(v.a)(u,2),m=(d[0],d[1],Object(n.useState)("")),h=Object(v.a)(m,2),p=(h[0],h[1],Object(n.useState)(e.match?e.match.params.responseId:e.responseId)),g=Object(v.a)(p,2),f=(g[0],g[1],Object(n.useRef)());f.current=s;var b=Object(n.useState)(1),y=Object(v.a)(b,2),C=y[0],O=y[1],S=Object(n.useState)(0),k=Object(v.a)(S,2),N=k[0],I=k[1],P=Object(n.useState)(5),x=Object(v.a)(P,2),R=x[0],F=x[1],A=function(){var e=function(e,t){var a={};return e&&(a.page=e-1),t&&(a.size=t),a}(C,R);w.a.getCountsByRegion(e).then((function(e){var t=e.data,a=t.schools,n=t.totalPages;o(a),I(n),console.log(e.data)})).catch((function(e){console.log(e)}))};Object(n.useEffect)(A,[C,R]);var B=Object(n.useMemo)((function(){return[{Header:"\u7701\uff08\u81ea\u6cbb\u533a\uff09",accessor:"region"},{Header:"\u5b66\u6821\u6570",accessor:"schoolsCount",Cell:function(e){var t=e.row.id;return r.a.createElement("div",null,r.a.createElement(c.b,{to:f.current[t].region?"/schools/region/"+f.current[t].region:"/schools",className:"badge badge-success"},f.current[t].schoolsCount))}}]}),[]),D=Object(j.useTable)({columns:B,data:s,disableSortRemove:!0},j.useSortBy),H=D.getTableProps,T=D.getTableBodyProps,U=D.headerGroups,V=D.rows,q=D.prepareRow;return r.a.createElement("div",{className:"list row"},r.a.createElement("div",{className:"col-sm-8"},r.a.createElement("h4",null,"\u5730\u533a\u5217\u8868")),r.a.createElement("div",{className:"col-sm-12 list"},r.a.createElement("div",{className:"mt-3"},"\u6bcf\u9875\u663e\u793a\u884c\u6570: ",r.a.createElement("select",{onChange:function(e){F(e.target.value),O(1)},value:R},[5,10,20].map((function(e){return r.a.createElement("option",{key:e,value:e},e)}))),r.a.createElement(E.a,{className:"my-3",count:N,page:C,siblingCount:1,boundaryCount:1,variant:"outlined",shape:"rounded",onChange:function(e,t){O(t)}})),r.a.createElement("table",Object.assign({className:"table table-striped table-bordered"},H()),r.a.createElement("thead",null,U.map((function(e){return r.a.createElement("tr",e.getHeaderGroupProps(),e.headers.map((function(e){return r.a.createElement("th",e.getHeaderProps(e.getSortByToggleProps()),e.render("Header"),r.a.createElement("span",null,e.isSorted?e.isSortedDesc?" \ud83d\udd3d":" \ud83d\udd3c":""))})))}))),r.a.createElement("tbody",T(),V.map((function(e,t){return q(e),r.a.createElement("tr",e.getRowProps(),e.cells.map((function(e){return r.a.createElement("td",e.getCellProps(),e.render("Cell"))})))}))))))},F=a(92),A=a(4),B=a(5),D=new(function(){function e(){Object(l.a)(this,e)}return Object(i.a)(e,[{key:"getAll2",value:function(e){return A.a.post("/logs/all",e,{headers:Object(B.a)()})}},{key:"getAll",value:function(e){return A.a.get("/logs",{params:e},{headers:Object(B.a)()})}},{key:"get",value:function(e){return A.a.get("/logs/".concat(e),{headers:Object(B.a)()})}},{key:"getContent",value:function(e){var t=JSON.parse(localStorage.getItem("user"));return A.a.get("/logsContent/".concat(e),{headers:{"x-access-token":t&&t.accessToken?t.accessToken:null},responseType:"arraybuffer"})}},{key:"getDocCategories",value:function(){return A.a.get("/logs/categories",{headers:Object(B.a)()})}},{key:"getCount",value:function(e){return A.a.get("/logsCount/".concat(e),{headers:Object(B.a)()})}},{key:"create",value:function(e){return A.a.post("/logs",e,{headers:Object(B.a)()})}},{key:"update",value:function(e,t){return A.a.put("/logs/".concat(e),t,{headers:Object(B.a)()})}},{key:"delete",value:function(e){return A.a.delete("/logs/".concat(e),{headers:Object(B.a)()})}},{key:"deleteAll",value:function(){return A.a.delete("/logs",{headers:Object(B.a)()})}},{key:"findByTitle",value:function(e){return A.a.get("/logs?title=".concat(e),{headers:Object(B.a)()})}}]),e}()),H=a(8),T=function(e){var t=Object(n.useState)([]),a=Object(v.a)(t,2),s=a[0],o=a[1],l=Object(n.useState)(null),i=Object(v.a)(l,2),u=(i[0],i[1],Object(n.useState)(-1)),d=Object(v.a)(u,2),m=(d[0],d[1],Object(n.useState)("")),h=Object(v.a)(m,2),p=(h[0],h[1],Object(n.useState)("")),g=Object(v.a)(p,2),f=g[0],y=g[1],C=Object(n.useState)(e.match?e.match.params.schoolId:e.schoolId),O=Object(v.a)(C,2),S=O[0],w=(O[1],Object(n.useState)(H.a.getCurrentUser()?H.a.getCurrentUser().id:null)),k=Object(v.a)(w,2),N=(k[0],k[1],Object(n.useState)([])),I=Object(v.a)(N,2),P=I[0],x=I[1],R=Object(n.useRef)();R.current=s;var F=Object(n.useState)(1),A=Object(v.a)(F,2),B=A[0],T=A[1],U=Object(n.useState)(0),V=Object(v.a)(U,2),q=V[0],G=V[1],L=Object(n.useState)(5),_=Object(v.a)(L,2),M=_[0],W=_[1],J=function(){var e=function(){var e={};return f&&(e.text=f),B&&(e.page=B-1),M&&(e.size=M),S&&(e.schoolId=S),P&&(e.orderby=P),e}();D.getAll2(e).then((function(e){var t=e.data,a=t.logs,n=t.totalPages;o(a),G(n),console.log(e.data)})).catch((function(e){console.log(e)}))};Object(n.useEffect)(J,[B,M,P]);var z=Object(n.useMemo)((function(){return[{Header:"\u65f6\u95f4",accessor:"createdAt",Cell:function(e){var t=e.row.id,a=new Date(R.current[t].createdAt);return r.a.createElement("div",null,a.toLocaleDateString("zh-cn",{hour12:!0,hour:"2-digit",minute:"2-digit",second:"2-digit"}))}},{Header:"\u4fee\u6539\u4eba",accessor:"userId",Cell:function(e){var t=e.row.id;return r.a.createElement("div",null,R.current[t].user?r.a.createElement(c.b,{to:"/usersView/"+R.current[t].user.id,className:"badge badge-success"},R.current[t].user.chineseName?R.current[t].user.chineseName:R.current[t].user.username):"")}},{Header:"\u4fee\u6539\u5b57\u6bb5",accessor:"field",disableSortBy:!0},{Header:"\u8001\u503c",accessor:"oldv"},{Header:"\u65b0\u503c",accessor:"newv"},{Header:"\u5220\u9664",accessor:"actions",disableSortBy:!0,Cell:function(e){var t=e.row.id;return r.a.createElement("div",null,r.a.createElement("span",{onClick:function(){return window.confirm("\u60a8\u786e\u5b9a\u8981\u5220\u9664\u5417 ?")&&function(e){var t=R.current[e].id;D.delete(t).then((function(t){var a=Object(b.a)(R.current);a.splice(e,1),o(a)})).catch((function(e){console.log(e)}))}(t)}},r.a.createElement("i",{className:"fas fa-trash action"})))}}]}),[]),Y=Object(j.useTable)({columns:z,data:s,disableSortRemove:!0,manualSortBy:!0,initialState:{sortBy:[{id:"createdAt",desc:!0}]}},j.useFlexLayout,j.useSortBy),X=Y.getTableProps,$=Y.getTableBodyProps,Q=Y.headerGroups,K=Y.rows,Z=Y.prepareRow,ee=Y.state.sortBy;return Object(n.useEffect)((function(){ee&&ee[0]&&x(ee)}),[ee]),r.a.createElement("div",{className:"list row"},r.a.createElement("div",{className:"col-sm-6"},r.a.createElement("h6",null,"\u4fee\u6539\u8bb0\u5f55"),r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("input",{type:"text",className:"form-control",placeholder:"\u65b0\u503c\u6216\u8001\u503c",value:f,onChange:function(e){var t=e.target.value;y(t)}}),r.a.createElement("div",{className:"input-group-append"},r.a.createElement("button",{className:"btn btn-outline-secondary",type:"button",onClick:function(){T(1),J()}},"\u67e5\u627e"))),r.a.createElement("div",{className:"col-sm-6 mt-3"},"\u6bcf\u9875\u663e\u793a\u884c\u6570: ",r.a.createElement("select",{onChange:function(e){W(e.target.value),T(1)},value:M},[5,10,20].map((function(e){return r.a.createElement("option",{key:e,value:e},e)}))),r.a.createElement(E.a,{className:"my-3",count:q,page:B,siblingCount:1,boundaryCount:1,variant:"outlined",shape:"rounded",onChange:function(e,t){T(t)}}))),r.a.createElement("div",{class:"w-100"}),r.a.createElement("div",{className:"col-sm-12 list"},r.a.createElement("table",Object.assign({className:"table table-striped table-bordered"},X()),r.a.createElement("thead",null,Q.map((function(e){return r.a.createElement("tr",e.getHeaderGroupProps(),e.headers.map((function(e){return r.a.createElement("th",e.getHeaderProps(e.getSortByToggleProps(),{}),e.render("Header"),r.a.createElement("span",null,"createdAt"===e.id||"user.username"===e.id?e.isSortedDesc?" \ud83d\udd3d":" \ud83d\udd3c":""))})))}))),r.a.createElement("tbody",$(),K.map((function(e,t){return Z(e),r.a.createElement("tr",e.getRowProps(),e.cells.map((function(e){return r.a.createElement("td",e.getCellProps({style:{minWidth:e.column.minWidth,width:e.column.width,whiteSpace:"pre-wrap"}}),e.render("Cell"))})))}))))),r.a.createElement("div",{className:"col-sm-8"}))},U=a(145),V=a(79),q=a(91),G=a(39),L=new(function(){function e(){Object(l.a)(this,e)}return Object(i.a)(e,[{key:"getAll2",value:function(e){return A.a.post("/forms/all",e,{headers:Object(B.a)()})}},{key:"getAll",value:function(e){return A.a.get("/forms",{params:e},{headers:Object(B.a)()})}},{key:"get",value:function(e){return A.a.get("/forms/".concat(e),{headers:Object(B.a)()})}},{key:"create",value:function(e){return A.a.post("/forms",e,{headers:Object(B.a)()})}},{key:"update",value:function(e,t){return A.a.put("/forms/".concat(e),t,{headers:Object(B.a)()})}},{key:"delete",value:function(e){return A.a.delete("/forms/".concat(e),{headers:Object(B.a)()})}},{key:"deleteAll",value:function(){return A.a.delete("/forms",{headers:Object(B.a)()})}},{key:"findByTitle",value:function(e){return A.a.get("/forms?title=".concat(e),{headers:Object(B.a)()})}}]),e}()),_=a(20),M=a.n(_),W=["startAt"];window.jQuery=M.a,window.$=M.a,a(161),a(162),document.body.style.margin="30px";var J=function(e){Object(d.a)(a,e);var t=Object(m.a)(a);function a(e){var r;return Object(l.a)(this,a),(r=t.call(this,e)).newFormOptions={id:"shinshin-form-id",action:"http://localhost:8080/multiple-upload",method:"POST",enctype:"multipart/form-data",formData:[{type:"header",subtype:"h4",label:"\u9879\u76ee\u7533\u8bf7\u8868"}],onSave:function(e,t){r.saveForm(t)}},r.oldFormOptions={onSave:function(e,t){r.updateForm()},showActionButtons:!window.location.pathname.includes("View")},r.onChangeTitle=r.onChangeTitle.bind(Object(u.a)(r)),r.onChangeDescription=r.onChangeDescription.bind(Object(u.a)(r)),r.onChangeDeadline=r.onChangeDeadline.bind(Object(u.a)(r)),r.onChangeStartAt=r.onChangeStartAt.bind(Object(u.a)(r)),r.getForm=r.getForm.bind(Object(u.a)(r)),r.updateForm=r.updateForm.bind(Object(u.a)(r)),r.deleteForm=r.deleteForm.bind(Object(u.a)(r)),r.saveForm=r.saveForm.bind(Object(u.a)(r)),r.newForm=r.newForm.bind(Object(u.a)(r)),r.state={currentForm:{id:null,title:"",description:"",published:!1,fdata:null,deadline:null,startAt:null},message:"",newsform:!0,readonly:!0,submitted:!1},r.fb=Object(n.createRef)(),r.fBuilder=null,r.fRender=null,r}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=window.location.pathname.includes("View"),t=window.location.pathname.includes("add");this.setState({newform:t}),this.setState({readonly:e}),t?this.fBuilder=M()(this.fb.current).formBuilder(this.newFormOptions):this.getForm(this.props.match.params.id,e)}},{key:"onChangeStartAt",value:function(e){var t=e;this.setState((function(e){return{currentForm:Object(S.a)(Object(S.a)({},e.currentForm),{},{startAt:t})}}))}},{key:"onChangeTitle",value:function(e){var t=e.target.value;this.setState((function(e){return{currentForm:Object(S.a)(Object(S.a)({},e.currentForm),{},{title:t})}}))}},{key:"onChangeDescription",value:function(e){var t=e.target.value;this.setState((function(e){return{currentForm:Object(S.a)(Object(S.a)({},e.currentForm),{},{description:t})}}))}},{key:"onChangeDeadline",value:function(e){var t=e.target.value;this.setState((function(e){return{currentForm:Object(S.a)(Object(S.a)({},e.currentForm),{},{deadline:t})}}))}},{key:"getForm",value:function(e,t){var a=this;L.get(e).then((function(e){var n=e.data,r=n.startAt,s=Object(G.a)(n,W);if(a.setState({currentForm:Object(S.a)(Object(S.a)({},s),{},{startAt:r?new Date(r).getUTCFullYear():""})}),console.log(e.data),t){var o=e.data.fdata;"string"!==typeof o&&(o=JSON.stringify(e.data.fdata)),a.fRender=M()(a.fb.current).formRender({formData:o})}else M()(a.fb.current).formBuilder(a.oldFormOptions).promise.then((function(t){t.actions.setData(e.data.fdata),a.fBuilder=t}))})).catch((function(e){console.log(e)}))}},{key:"updateForm",value:function(){var e=this;this.setState((function(t){return{currentForm:Object(S.a)(Object(S.a)({},t.currentForm),{},{startAt:t.currentForm.startAt?t.currentForm.startAt+"-02-01":null,fdata:e.fBuilder.actions.getData()})}})),L.update(this.state.currentForm.id,this.state.currentForm).then((function(t){console.log(t.data),e.setState({message:"\u9879\u76ee\u7533\u8bf7\u8868\u6210\u529f\u66f4\u65b0!",submitted:!0})})).catch((function(e){console.log(e)}))}},{key:"saveForm",value:function(e){var t=this,a={title:this.state.currentForm.title,description:this.state.currentForm.description,deadline:this.state.currentForm.deadline,startAt:this.state.currentForm.startAt?this.state.currentForm.startAt+"-02-01":null,fdata:this.fBuilder.actions.getData()};L.create(a).then((function(e){t.setState((function(t){return{currentForm:Object(S.a)(Object(S.a)({},t.currentForm),{},{id:e.data.id}),submitted:!0,message:"\u9879\u76ee\u7533\u8bf7\u8868\u6210\u529f\u63d0\u4ea4!"}})),console.log(e.data)})).catch((function(e){console.log(e)}))}},{key:"newForm",value:function(){this.setState((function(e){return{currentForm:{id:null,title:"",description:"",deadline:null,startAt:null},submitted:!1}}))}},{key:"deleteForm",value:function(){var e=this;L.delete(this.state.currentForm.id).then((function(t){console.log(t.data),e.props.history.push("/forms")})).catch((function(e){console.log(e)}))}},{key:"render",value:function(){var e=this.state.currentForm;return r.a.createElement("div",null,this.state.submitted?r.a.createElement("div",null,r.a.createElement("p",null,r.a.createElement("h4",null,this.state.message))):r.a.createElement("div",null,r.a.createElement("div",{className:"edit-form"},r.a.createElement("h4",null,"\u7533\u8bf7\u8868\u683c\u8bbe\u8ba1"),r.a.createElement("form",null,r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"title"},"\u6807\u9898"),r.a.createElement("input",{readonly:!(this.state.newform||!this.state.readonly)&&"",type:"text",className:"form-control",id:"title",value:e.title,onChange:this.onChangeTitle})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"description"},"\u8bf4\u660e"),r.a.createElement("textarea",{readonly:!(this.state.newform||!this.state.readonly)&&"",className:"form-control",id:"description",value:e.description,onChange:this.onChangeDescription})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"deadline"},"\u622a\u6b62\u65e5\u671f"),r.a.createElement("input",{readonly:!(this.state.newform||!this.state.readonly)&&"",type:"date",className:"form-control",id:"deadline",value:e.deadline,onChange:this.onChangeDeadline})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"startAt"},"\u9879\u76ee\u5e74\u4efd"),!this.state.newform&&this.state.readonly?r.a.createElement("input",{type:"text",id:"startAt",readonly:"",className:"form-control",placeholder:"\u9879\u76ee\u5e74\u4efd",value:e.startAt}):r.a.createElement(I.a,{yearArray:["2019","2020"],value:e.startAt,onSelect:this.onChangeStartAt,minRange:1995,maxRange:2022})))),r.a.createElement("div",{id:"fb-editor",ref:this.fb})))}}]),a}(n.Component),z=function(e){var t=Object(n.useState)([]),a=Object(v.a)(t,2),s=a[0],o=a[1],l=Object(n.useState)(null),i=Object(v.a)(l,2),u=(i[0],i[1],Object(n.useState)(-1)),d=Object(v.a)(u,2),m=(d[0],d[1],Object(n.useState)("")),h=Object(v.a)(m,2),p=h[0],g=h[1],f=Object(n.useState)(""),y=Object(v.a)(f,2),C=y[0],O=y[1],S=Object(n.useRef)();S.current=s;var w=Object(n.useState)(1),k=Object(v.a)(w,2),N=k[0],P=k[1],x=Object(n.useState)(0),R=Object(v.a)(x,2),F=R[0],A=R[1],B=Object(n.useState)(30),D=Object(v.a)(B,2),T=D[0],U=D[1],V=Object(n.useState)([]),q=Object(v.a)(V,2),G=q[0],_=q[1],M=Object(n.useState)(0),W=Object(v.a)(M,2),J=W[0],z=W[1],Y=function(){var e=function(){var e={};return p&&(e.title=p),C&&(e.startAt=C),N&&(e.page=N-1),T&&(e.size=T),G&&(e.orderby=G),e}();L.getAll2(e).then((function(e){var t=e.data,a=t.forms,n=t.totalPages,r=t.totalItems;o(a),A(n),z(r),console.log(e.data)})).catch((function(e){console.log(e)}))};Object(n.useEffect)(Y,[N,T,G,p,C]);var X=function(t){var a=S.current[t].id;e.history.push("/forms/"+a)},$=Object(n.useMemo)((function(){return[{Header:"\u622a\u6b62\u65e5\u671f",accessor:"deadline"},{Header:"\u9879\u76ee\u5e74\u4efd",accessor:"startAt",Cell:function(e){var t=e.row.id,a=null;return S.current[t].startAt&&(a=new Date(S.current[t].startAt)),r.a.createElement("div",null,a?a.getUTCFullYear():"")}},{Header:"\u6807\u9898",accessor:"title",disableSortBy:!0},{Header:"\u9879\u76ee\u7533\u8bf7\u6570\u76ee",accessor:"responsesCount",Cell:function(e){var t=e.row.id;return r.a.createElement("div",null,r.a.createElement(c.b,{to:"/responses/form/"+S.current[t].id,className:"badge badge-success"},S.current[t].responsesCount))}},{Header:"\u64cd\u4f5c",accessor:"actions",disableSortBy:!0,Cell:function(e){var t=e.row.id,a=!!S.current[t].deadline&&new Date(S.current[t].deadline)<new Date;return r.a.createElement("div",null,r.a.createElement(c.b,{to:"/addR/"+S.current[t].id,className:a?"disabled-link":"badge badge-success mr-2"},a?"\u903e\u671f ":"\u7533\u8bf7"),r.a.createElement(c.b,{to:"/formsView/"+S.current[t].id},r.a.createElement("i",{className:"fas fa-eye action mr-2"})),H.a.getCurrentUser()&&!H.a.getCurrentUser().schoolId&&r.a.createElement("span",{onClick:function(){return X(t)}},r.a.createElement("i",{className:"far fa-edit action mr-2"})),H.a.getCurrentUser()&&!H.a.getCurrentUser().schoolId&&r.a.createElement("span",{onClick:function(){return window.confirm("\u60a8\u786e\u5b9a\u8981\u5220\u9664\u5417 ?")&&function(e){var t=S.current[e].id;L.delete(t).then((function(t){var a=Object(b.a)(S.current);a.splice(e,1),o(a)})).catch((function(e){console.log(e)}))}(t)}},r.a.createElement("i",{className:"fas fa-trash action"})))}}]}),[]),Q=Object(j.useTable)({columns:$,data:s,disableSortRemove:!0,manualSortBy:!0,initialState:{sortBy:[{id:"deadline",desc:!0}]}},j.useSortBy),K=Q.getTableProps,Z=Q.getTableBodyProps,ee=Q.headerGroups,te=Q.rows,ae=Q.prepareRow,ne=Q.state.sortBy;return Object(n.useEffect)((function(){ne&&ne[0]&&_(ne)}),[ne]),r.a.createElement("div",{className:"list row"},r.a.createElement("div",{className:"col-sm-8"},r.a.createElement("h4",null,"\u9879\u76ee\u5f81\u96c6\u5217\u8868(\u603b\u6570\uff1a",J,")"),r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("input",{type:"text",readonly:"",className:"form-control",placeholder:"\u9879\u76ee\u5e74\u4efd",value:C,onChange:function(e){O(e)}}),r.a.createElement(I.a,{yearArray:["2019","2020"],value:C,onSelect:function(e){O(e)},hideInput:!0,minRange:1995,maxRange:2022}),r.a.createElement("input",{type:"text",className:"form-control ml-2",placeholder:"\u6807\u9898\u67e5\u627e",value:p,onChange:function(e){var t=e.target.value;g(t)}}),r.a.createElement("div",null,r.a.createElement("button",{className:"btn btn-primary ml-2",type:"button",onClick:function(e){g(""),O(""),_([])}},"\u6e05\u7a7a"))),r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("button",{className:"btn btn-primary ",type:"button",onClick:function(){P(1),Y()}},"\u67e5\u627e"))),r.a.createElement("div",{className:"mt-3 col-sm-3"},"\u6bcf\u9875\u663e\u793a\u884c\u6570: ",r.a.createElement("select",{onChange:function(e){U(e.target.value),P(1)},value:T},[20,30,50].map((function(e){return r.a.createElement("option",{key:e,value:e},e)}))),r.a.createElement(E.a,{className:"my-3",count:F,page:N,siblingCount:1,boundaryCount:1,variant:"outlined",shape:"rounded",onChange:function(e,t){P(t)}})),r.a.createElement("div",{className:"col-sm-12 list"},r.a.createElement("table",Object.assign({className:"table table-striped table-bordered"},K()),r.a.createElement("thead",null,ee.map((function(e){return r.a.createElement("tr",e.getHeaderGroupProps(),e.headers.map((function(e){return r.a.createElement("th",e.getHeaderProps(e.getSortByToggleProps()),e.render("Header"),r.a.createElement("span",null,"startAt"===e.id||"deadline"===e.id||"responsesCount"===e.id?e.isSortedDesc?" \ud83d\udd3d":" \ud83d\udd3c":""))})))}))),r.a.createElement("tbody",Z(),te.map((function(e,t){return ae(e),r.a.createElement("tr",e.getRowProps(),e.cells.map((function(e){return r.a.createElement("td",e.getCellProps(),e.render("Cell"))})))}))))),r.a.createElement("div",{className:"col-sm-8"}))},Y=a(18),X=a.n(Y),$=a(30),Q=a(52),K=a(68),Z=function(e){var t=Object(n.useState)([]),a=Object(v.a)(t,2),s=a[0],o=a[1],c=Object(n.useState)(null),l=Object(v.a)(c,2),i=(l[0],l[1],Object(n.useState)(-1)),u=Object(v.a)(i,2),d=(u[0],u[1],Object(n.useState)("")),m=Object(v.a)(d,2),h=m[0],p=m[1],g=Object(n.useState)(e.match?e.match.params.responseId:e.responseId),f=Object(v.a)(g,2),y=f[0],C=(f[1],Object(n.useState)(!!e.readonly&&e.readonly)),O=Object(v.a)(C,2),S=O[0],w=(O[1],Object(n.useState)(!!e.embedded&&e.embedded)),k=Object(v.a)(w,2),N=k[0],I=(k[1],Object(n.useState)(e.reload)),P=Object(v.a)(I,2),x=P[0],R=P[1];Object(n.useEffect)((function(){R(e.reload)}),[e.reload]);var F=Object(n.useRef)();F.current=s;var A=Object(n.useState)(1),B=Object(v.a)(A,2),D=B[0],H=B[1],T=Object(n.useState)(0),U=Object(v.a)(T,2),V=U[0],q=U[1],G=Object(n.useState)(5),L=Object(v.a)(G,2),_=L[0],M=L[1],W=function(){var e=function(){var e={};return h&&(e.originalname=h),D&&(e.page=D-1),_&&(e.size=_),y&&(e.responseId=y),e}();K.a.getAll2(e).then((function(e){var t=e.data,a=t.attachments,n=t.totalPages;o(a),q(n),console.log(e.data)})).catch((function(e){console.log(e)}))};Object(n.useEffect)(W,[D,_,x]);var J=Object(n.useMemo)((function(){return[{Header:"\u65f6\u95f4",accessor:"createdAt",Cell:function(e){var t=e.row.id,a=new Date(F.current[t].createdAt);return r.a.createElement("div",null,a.toLocaleDateString("zh-cn",{hour12:!0,hour:"2-digit",minute:"2-digit",second:"2-digit"}))}},{Header:"\u6587\u4ef6\u540d",accessor:"originalname"},{Header:"\u8bf4\u660e",accessor:"description",disableSortBy:!0},{Header:"\u64cd\u4f5c",accessor:"actions",disableSortBy:!0,Cell:function(e){var t=e.row.id;return r.a.createElement("div",null,(F.current[t].mimetype.startsWith("image")||F.current[t].mimetype.indexOf("pdf")>0)&&r.a.createElement("a",{href:"#",onClick:function(){return ee(F.current[t].id,F.current[t].originalname,F.current[t].mimetype,!0)}},r.a.createElement("i",{className:"fas fa-eye action mr-2"})),r.a.createElement("a",{href:"#",onClick:function(){return ee(F.current[t].id,F.current[t].originalname,F.current[t].mimetype,!1)}},r.a.createElement("i",{className:"fas fa-download action mr-2"})),!S&&r.a.createElement("span",{onClick:function(){return window.confirm("\u60a8\u786e\u5b9a\u8981\u5220\u9664\u5417 ?")&&function(e){var t=F.current[e].id;K.a.delete(t).then((function(t){var a=Object(b.a)(F.current);a.splice(e,1),o(a)})).catch((function(e){console.log(e)}))}(t)}},r.a.createElement("i",{className:"fas fa-trash action"})))}}]}),[]),z=Object(j.useTable)({columns:J,data:s,disableSortRemove:!0},j.useSortBy),Y=z.getTableProps,X=z.getTableBodyProps,$=z.headerGroups,Q=z.rows,Z=z.prepareRow,ee=function(e,t,a,n){K.a.getContent(e).then((function(e){console.log(e.data);var r=window.URL.createObjectURL(new Blob([e.data],{type:a})),s=document.createElement("a");s.href=r,n||s.setAttribute("download",t),document.body.appendChild(s),s.click(),s.remove()})).catch((function(e){alert(e),console.log(e)}))};return r.a.createElement("div",{className:"list row"},!N&&r.a.createElement("div",{className:"col-sm-8"},r.a.createElement("h4",null,"\u9644\u4ef6\u5217\u8868"),r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("input",{type:"text",className:"form-control",placeholder:"Search by originalname",value:h,onChange:function(e){var t=e.target.value;p(t)}}),r.a.createElement("div",{className:"input-group-append"},r.a.createElement("button",{className:"btn btn-outline-secondary",type:"button",onClick:function(){H(1),W()}},"Search"))),"\u6bcf\u9875\u663e\u793a\u884c\u6570: ",r.a.createElement("select",{onChange:function(e){M(e.target.value),H(1)},value:_},[5,10,20].map((function(e){return r.a.createElement("option",{key:e,value:e},e)}))),r.a.createElement(E.a,{className:"my-3",count:V,page:D,siblingCount:1,boundaryCount:1,variant:"outlined",shape:"rounded",onChange:function(e,t){H(t)}})),r.a.createElement("div",{className:"col-sm-12 list"},r.a.createElement("table",Object.assign({className:"table table-striped table-bordered"},Y()),r.a.createElement("thead",null,$.map((function(e){return r.a.createElement("tr",e.getHeaderGroupProps(),e.headers.map((function(e){return r.a.createElement("th",e.getHeaderProps(e.getSortByToggleProps()),e.render("Header"),r.a.createElement("span",null,e.isSorted?e.isSortedDesc?" \ud83d\udd3d":" \ud83d\udd3c":""))})))}))),r.a.createElement("tbody",X(),Q.map((function(e,t){return Z(e),r.a.createElement("tr",e.getRowProps(),e.cells.map((function(e){return r.a.createElement("td",e.getCellProps(),e.render("Cell"))})))}))))),r.a.createElement("div",{className:"col-sm-8"}))},ee=a(46),te=a(19),ae=["id","startAt"],ne=["startAt"];window.jQuery=M.a,window.$=M.a,a(161),a(162),a(322),document.body.style.margin="30px";var re=function(e){Object(d.a)(a,e);var t=Object(m.a)(a);function a(e){var r;return Object(l.a)(this,a),(r=t.call(this,e)).optionOnSave={onSave:function(e,t){r.submitResponse()}},r.onChangeTitle=r.onChangeTitle.bind(Object(u.a)(r)),r.getResponse=r.getResponse.bind(Object(u.a)(r)),r.updateResponse=r.updateResponse.bind(Object(u.a)(r)),r.deleteResponse=r.deleteResponse.bind(Object(u.a)(r)),r.onChangeSchoolId=r.onChangeSchoolId.bind(Object(u.a)(r)),r.onChangeAttFiles=r.onChangeAttFiles.bind(Object(u.a)(r)),r.submitResponse=r.submitResponse.bind(Object(u.a)(r)),r.reload=r.reload.bind(Object(u.a)(r)),r.hasFiles=r.hasFiles.bind(Object(u.a)(r)),r.state={currentResponse:{id:null,title:"",fdata:null,formId:null,schoolId:null},currentUser:null,schools:[],message:"",readonly:!0,newresponse:!0,progress:0,reload:!1,hasFiles:null,submitted:!1,updatedRecently:!0,updatedAt:null},r.fb=Object(n.createRef)(),r.fRender=null,r}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=Object($.a)(X.a.mark((function e(){var t,a;return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.setUpdateStatus();case 2:t=window.location.pathname.includes("add"),this.setState({newresponse:t}),a=window.location.pathname.includes("View"),this.setState({readonly:a}),t?this.getForm(this.props.match.params.id):this.getResponse(this.props.match.params.id,a);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setUpdateStatus",value:function(){var e=Object($.a)(X.a.mark((function e(){var t,a,n,r,s;return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=2,!(a=H.a.getCurrentUser())||!a.schoolId){e.next=16;break}return e.prev=3,e.next=6,y.a.getUpdatedAt(a.schoolId);case 6:return n=e.sent,r=new Date(n.data.updatedAt.updatedAt),s=(new Date).getTime()-r.getTime()<864e5*t,e.next=11,this.setState({updatedRecently:s,updatedAt:r.toLocaleDateString("zh-cn",{hour12:!0,hour:"2-digit",minute:"2-digit",second:"2-digit"})});case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),console.log(e.t0.message);case 16:case"end":return e.stop()}}),e,this,[[3,13]])})));return function(){return e.apply(this,arguments)}}()},{key:"convert",value:function(e){var t=[];if(e){for(var a=0;a<e.length;a++)t.push({value:e[a].id,label:e[a].code+"-"+e[a].name+"-"+e[a].region});return t}}},{key:"display",value:function(e){if(this.state.schools){for(var t=0;t<this.state.schools.length;t++)if(this.state.schools[t].value==e)return this.state.schools[t];return[]}}},{key:"displayName",value:function(e){if(this.state.schools){for(var t=0;t<this.state.schools.length;t++)if(this.state.schools[t].value==e)return this.state.schools[t].label?this.state.schools[t].label:"\u5b66\u6821\u540d";return""}}},{key:"getForm",value:function(e){var t=this;L.get(e).then((function(a){try{var n=a.data.fdata;"string"!==typeof n&&(n=JSON.stringify(a.data.fdata)),t.fRender=M()(t.fb.current).formRender({formData:n})}catch(c){alert(c)}var r=a.data,s=(r.id,r.startAt),o=Object(G.a)(r,ae);t.setState({currentResponse:Object(S.a)(Object(S.a)({},o),{},{startAt:new Date(s).getFullYear(),formId:e}),hasFiles:t.hasFiles()}),t.getSchools()}))}},{key:"getResponse",value:function(e,t){var a=this;Q.a.get(e).then((function(e){try{var n=e.data.fdata;"string"!==typeof n&&(n=JSON.stringify(e.data.fdata)),a.fRender=M()(a.fb.current).formRender({formData:n}),t&&M()("input, textarea, select",".rendered-form").attr("readonly",!0).attr("disabled",!0)}catch(c){alert(c)}var r=e.data,s=r.startAt,o=Object(G.a)(r,ne);a.setState({currentResponse:Object(S.a)(Object(S.a)({},o),{},{startAt:s?new Date(s).getUTCFullYear():""}),hasFiles:a.hasFiles()}),a.getSchools(),console.log(e.data)})).catch((function(e){console.log(e)}))}},{key:"getSchools",value:function(){var e=this;w.a.getAllSimple().then((function(t){e.setState({schools:e.convert(t.data)});var a=H.a.getCurrentUser();a&&(e.setState({currentUser:a}),a.schoolId&&e.setState((function(e){return{currentResponse:Object(S.a)(Object(S.a)({},e.currentResponse),{},{schoolId:a.schoolId})}}))),console.log(t)})).catch((function(e){console.log(e)}))}},{key:"init",value:function(){M()(document).ready((function(){M()("#input-multi-files").on("change",(function(){!function(e,t){if(e.files)for(var a=e.files.length,n=0;n<a;n++){var r=new FileReader;r.onload=function(e){M()(M.a.parseHTML("<img>")).attr("src",e.target.result).appendTo(t)},r.readAsDataURL(e.files[n])}}(this,"div.preview-images")}))}))}},{key:"getLabel",value:function(e,t){if(!this.state.currentResponse.fdata)return"";for(var a=0;a<this.state.currentResponse.fdata.length;a++)if(this.state.currentResponse.fdata[a].type===e&&this.state.currentResponse.fdata[a].name===t)return this.state.currentResponse.fdata[a].label;return""}},{key:"collectFiles",value:function(){var e=document.getElementsByTagName("input"),t=[];if(e)for(var a=0;a<e.length;a++)if("file"===e[a].type&&e[a].files)for(var n=e[a].files.length,r=0;r<n;r++)t.push({description:this.getLabel(e[a].type,e[a].name),file:e[a].files[r]});return t}},{key:"hasFiles",value:function(){var e=document.getElementsByTagName("input");if(!e)return!1;for(var t=0;t<e.length;t++)if("file"===e[t].type)return!0;return!1}},{key:"clearFiles",value:function(){var e=document.getElementsByTagName("input");if(e)for(var t=0;t<e.length;t++)"file"===e[t].type&&e[t].files&&(e[t].value=null)}},{key:"onChangeAttFiles",value:function(e){e.preventDefault();var t=e.target.files;this.setState((function(e){return{currentResponse:Object(S.a)(Object(S.a)({},e.currentResponse),{},{attFiles:t})}}))}},{key:"onChangeSchoolId",value:function(e){var t=e.value;this.setState((function(e){return{currentResponse:Object(S.a)(Object(S.a)({},e.currentResponse),{},{schoolId:t})}}))}},{key:"onChangeTitle",value:function(e){var t=e.target.value;this.setState((function(e){return{currentResponse:Object(S.a)(Object(S.a)({},e.currentResponse),{},{title:t})}}))}},{key:"uploadAttachments",value:function(e){for(var t=this,a=new FormData,n=[],r=0;r<e.length;r++)a.append("multi-files",e[r].file,e[r].file.name),n.push(e[r].description);a.append("descriptions",JSON.stringify(n)),Q.a.uploadAttachments(this.state.currentResponse.id,a,(function(e){t.setState({progress:Math.round(100*e.loaded/e.total)})})).then((function(a){console.log(a.data),t.setState((function(a){return{message:a.message+(e[0]?" \u9879\u76ee\u7533\u8bf7\u9644\u4ef6\u6210\u529f\u4e0a\u4f20!":""),reload:!t.state.reload,submitted:!0}})),t.clearFiles()})).catch((function(e){console.log(e)}))}},{key:"validateSchool",value:function(){return!!this.state.currentResponse.schoolId||(this.setState({message:"\u8bf7\u9009\u62e9\u5b66\u6821"}),!1)}},{key:"updateResponse",value:function(){var e=this;if(this.validateSchool()){var t=this.collectFiles(),a={title:this.state.currentResponse.title,schoolId:this.state.currentResponse.schoolId,fdata:this.fRender.userData};Q.a.update(this.state.currentResponse.id,a).then((function(a){console.log(a.data),e.uploadAttachments(t),e.setState({message:"\u9879\u76ee\u7533\u8bf7\u6210\u529f\u4fee\u6539!"})})).catch((function(e){console.log(e)}))}}},{key:"submitResponse",value:function(){var e=this;if(this.validateSchool()){var t=this.collectFiles(),a={title:this.state.currentResponse.title,formId:this.state.currentResponse.formId,schoolId:this.state.currentResponse.schoolId,fdata:this.fRender.userData,userId:this.state.currentUser.id};Q.a.create(a).then(function(){var a=Object($.a)(X.a.mark((function a(n){return X.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return console.log(n.data),a.next=3,e.setState((function(e){return{currentResponse:Object(S.a)(Object(S.a)({},e.currentResponse),{},{id:n.data.id}),message:"\u9879\u76ee\u7533\u8bf7\u6210\u529f\u63d0\u4ea4!",newresponse:!1}}));case 3:e.uploadAttachments(t),e.props.history.push("/responses/"+n.data.id);case 5:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}()).catch((function(e){console.log(e)}))}}},{key:"deleteResponse",value:function(){var e=this;Q.a.delete(this.state.currentResponse.id).then((function(t){console.log(t.data),e.props.history.push("/responses"+(e.state.currentResponse.schoolId?"/school/"+e.state.currentResponse.schoolId:""))})).catch((function(e){console.log(e)}))}},{key:"reload",value:function(){this.setState({reload:!this.state.reload})}},{key:"render",value:function(){var e=this.state,t=e.currentResponse,a=e.progress;return r.a.createElement("div",null,this.state.updatedRecently?this.state.submitted?r.a.createElement("div",null,r.a.createElement("p",null,r.a.createElement("h4",null,this.state.message))):r.a.createElement("div",{class:"row"},r.a.createElement("div",{class:"col-sm-4"},this.state.readonly&&r.a.createElement("div",{class:"box"},r.a.createElement("a",{target:"_blank",href:"/responses/"+t.id,class:"btn btn-primary mb-4"},"\u7f16\u8f91"))),r.a.createElement("div",{class:"col-sm-4"},r.a.createElement("h4",null,"\u9879\u76ee\u7533\u8bf7\uff08",this.state.readonly?"\u6d4f\u89c8":"\u7f16\u8f91","\uff09"),r.a.createElement("form",null,r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"title"},"\u6807\u9898"),r.a.createElement("input",{readonly:"true",type:"text",className:"form-control",id:"title",value:t.title,onChange:this.onChangeTitle})),r.a.createElement("div",{class:"form-group"},r.a.createElement("label",{htmlFor:"schoolId"},"\u6240\u5c5e\u5b66\u6821"),this.state.readonly||!H.a.getCurrentUser()||H.a.getCurrentUser().schoolId?r.a.createElement(c.b,{to:"/schoolsView/"+t.schoolId,id:"schoolId",name:"schoolId"},this.displayName(t.schoolId)):r.a.createElement(ee.a,{onChange:this.onChangeSchoolId.bind(this),readonly:!!this.state.readonly&&"",class:"form-control",required:!0,id:"schoolId",value:this.display(t.schoolId),name:"schoolId",options:this.state.schools})),r.a.createElement("div",{class:"form-group"},r.a.createElement("label",{htmlFor:"startAt"},"\u9879\u76ee\u5e74\u4efd"),r.a.createElement("input",{type:"text",className:"form-control",id:"startAt",readonly:"true",placeholder:"\u9879\u76ee\u5e74\u4efd",value:t.startAt})))),r.a.createElement("div",{class:"col-sm-4"},!this.state.readonly&&r.a.createElement("div",null,this.state.newresponse?r.a.createElement("button",{style:{position:"absolute",right:"10px"},type:"submit",className:"btn btn-success",onClick:this.submitResponse},"\u63d0\u4ea4"):r.a.createElement("button",{style:{position:"absolute",right:"10px"},type:"submit",className:"btn btn-success",onClick:this.updateResponse},"\u4fdd\u5b58"),a<100&&a>0&&r.a.createElement("div",{className:"progress"},r.a.createElement("div",{className:"progress-bar progress-bar-info progress-bar-striped",role:"progressbar","aria-valuenow":a,"aria-valuemin":"0","aria-valuemax":"100",style:{width:a+"%"}},a,"%")))),r.a.createElement("div",{id:"fb-editor",ref:this.fb}),r.a.createElement("div",{class:"w-100"}),this.state.hasFiles&&r.a.createElement(te.d,null,r.a.createElement(te.b,null,r.a.createElement(te.a,null,"\u66f4\u591a\u4fe1\u606f ",r.a.createElement("i",{class:"fas fa-hand-point-right"})),r.a.createElement(te.a,null,"\u9879\u76ee\u7533\u8bf7\u9644\u4ef6")),r.a.createElement(te.c,null),r.a.createElement(te.c,null,this.state.currentResponse.id&&r.a.createElement(Z,{responseId:this.state.currentResponse.id,embedded:!0,readonly:this.state.readonly,reload:this.state.reload}))),r.a.createElement("div",{class:"w-100"}),!this.state.readonly&&r.a.createElement("div",null,this.state.newresponse?r.a.createElement("button",{type:"submit",className:"btn btn-success",onClick:this.submitResponse},"\u63d0\u4ea4"):r.a.createElement("button",{type:"submit",className:"btn btn-success",onClick:this.updateResponse},"\u4fdd\u5b58")),r.a.createElement("div",{class:"w-100"}),r.a.createElement("div",{className:"alert-danger"},r.a.createElement("p",null,r.a.createElement("h4",null,this.state.message)))):r.a.createElement("div",null,r.a.createElement("p",null,"\u60a8\u7684\u5b66\u6821\u4fe1\u606f\u4e0a\u6b21\u66f4\u65b0\u65f6\u95f4\u662f\uff1a"+this.state.updatedAt+", \u8bf7\u70b9\u51fb\u4e0b\u9762\u66f4\u65b0\u5b66\u6821\u4fe1\u606f"),r.a.createElement("a",{href:"/surveys/"+t.schoolId,class:"btn btn-success"},"\u66f4\u65b0")))}}]),a}(n.Component),se=a(76),oe=function(e){var t=Object(n.useState)([]),a=Object(v.a)(t,2),s=a[0],o=a[1],l=Object(n.useState)(null),i=Object(v.a)(l,2),u=(i[0],i[1],Object(n.useState)(-1)),d=Object(v.a)(u,2),m=(d[0],d[1],Object(n.useRef)());m.current=s;var h=Object(n.useState)(1),p=Object(v.a)(h,2),g=p[0],f=p[1],y=Object(n.useState)(0),C=Object(v.a)(y,2),O=C[0],S=C[1],w=Object(n.useState)(30),k=Object(v.a)(w,2),N=k[0],I=k[1],P=Object(n.useState)(e.match?e.match.params.schoolId:e.schoolId),x=Object(v.a)(P,2),R=x[0],F=(x[1],Object(n.useState)([{name:"user",label:"\u5b66\u6821\u7528\u6237"},{name:"admin",label:"\u7ba1\u7406\u5458"},{name:"moderator",label:"\u6559\u5e08"},{name:"volunteer",label:"\u6b23\u6b23\u4e49\u5de5"}])),A=Object(v.a)(F,2),B=A[0],D=A[1],T=[20,30,50],U=Object(n.useState)([]),V=Object(v.a)(U,2),q=V[0],G=V[1],L=Object(n.useState)(0),_=Object(v.a)(L,2),M=_[0],W=_[1],J=Object(n.useState)(null),z=Object(v.a)(J,2),Y=z[0],X=z[1],$=Object(n.useState)(""),Q=Object(v.a)($,2),K=Q[0],Z=Q[1],ee=Object(n.useState)(""),te=Object(v.a)(ee,2),ae=te[0],ne=te[1],re=Object(n.useState)(""),se=Object(v.a)(re,2),oe=se[0],ce=se[1],le=Object(n.useState)(""),ie=Object(v.a)(le,2),ue=ie[0],de=ie[1],me=Object(n.useState)(null),he=Object(v.a)(me,2),pe=he[0],ge=he[1],fe=Object(n.useState)(null),be=Object(v.a)(fe,2),ve=be[0],ye=be[1],Ee=function(e){for(var t=0;t<B.length;t++)if(B[t].name.trim()===e.trim())return B[t].label;return null};Object(n.useEffect)((function(){H.a.getRoles().then((function(e){D(e.data),console.log(e)})).catch((function(e){console.log(e)}))}),[]);var je=function(){var e=function(){var e={};return ae&&(e.username=ae),oe&&(e.email=oe),K&&(e.role=K),ue&&(e.schoolCode=ue),pe&&(e.contactOnly=pe),ve&&(e.emailVerified=ve),g&&(e.page=g-1),N&&(e.size=N),R&&(e.schoolId=R),q&&(e.orderby=q),e}();H.a.getAll2(e).then((function(e){var t=e.data,a=t.users,n=t.totalPages,r=t.totalItems;o(a),S(n),W(r),R&&a[0]&&X(a[0].school.name+"("+a[0].school.code+")"),console.log(e.data)})).catch((function(e){console.log(e)}))};Object(n.useEffect)(je,[g,N,q,K,ae,oe,ue,pe,ve]);var Ce=function(t){var a=m.current[t].id;e.history.push("/users/"+a)},Oe=[];R&&(Oe=["school.code","school.name"]);var Se=Object(n.useMemo)((function(){return[{Header:"\u7528\u6237\u540d",accessor:"username"},{Header:"\u4e2d\u6587\u540d",accessor:"chineseName"},{Header:"\u7535\u5b50\u90ae\u4ef6",accessor:"email",disableSortBy:!0},{Header:"\u804c\u52a1",accessor:"title",disableSortBy:!0},{Header:"\u89d2\u8272",accessor:"roles",disableSortBy:!0,Cell:function(e){var t=e.row.id;return r.a.createElement("div",null,function(e){var t="";if(m.current[e].roles)for(var a=0;a<m.current[e].roles.length;a++)t=t+", "+Ee(m.current[e].roles[a].name);return t.substring(t.indexOf(",")+2)}(t))}},{Header:"\u5b66\u6821\u7f16\u53f7",accessor:"school.code",Cell:function(e){var t=e.row.id;return r.a.createElement("div",null,m.current[t].school?r.a.createElement(c.b,{to:"/schoolsView/"+m.current[t].school.id,className:"badge badge-success"},m.current[t].school.code):"")}},{Header:"\u5b66\u6821\u540d\u79f0",accessor:"school.name",Cell:function(e){var t=e.row.id;return r.a.createElement("div",null,m.current[t].school?r.a.createElement(c.b,{to:"/schoolsView/"+m.current[t].school.id,className:"badge badge-success"},m.current[t].school.name):"")}},{Header:"\u4e0a\u6b21\u767b\u5f55\u65f6\u95f4",accessor:"lastLogin"},{Header:"\u6ce8\u518c\u7528\u6237",accessor:"contactOnly",Cell:function(e){var t=e.row.id;return r.a.createElement("div",null,m.current[t].contactOnly?"\u5426":"\u662f")}},{Header:"\u767b\u5f55\u8fc7?",accessor:"emailVerified",Cell:function(e){var t=e.row.id;return r.a.createElement("div",null,m.current[t].emailVerified?"\u662f":"\u5426")}},{Header:"\u64cd\u4f5c",accessor:"actions",disableSortBy:!0,Cell:function(e){var t=e.row.id;return r.a.createElement("div",null,r.a.createElement(c.b,{to:"/usersView/"+m.current[t].id},r.a.createElement("i",{className:"fas fa-eye action mr-2"})),r.a.createElement("span",{onClick:function(){return Ce(t)}},r.a.createElement("i",{className:"far fa-edit action mr-2"})),r.a.createElement("span",{onClick:function(){return window.confirm("\u60a8\u786e\u5b9a\u8981\u5220\u9664\u5417 ?")&&function(e){var t=m.current[e].id;H.a.delete(t).then((function(t){var a=Object(b.a)(m.current);a.splice(e,1),o(a)})).catch((function(e){console.log(e)}))}(t)}},r.a.createElement("i",{className:"fas fa-trash action"})))}}]}),[]),we=Object(j.useTable)({columns:Se,data:s,disableSortRemove:!0,manualSortBy:!0,initialState:{hiddenColumns:Oe}},j.useSortBy),ke=we.getTableProps,Ne=we.getTableBodyProps,Ie=we.headerGroups,Pe=we.rows,xe=we.prepareRow,Re=(we.state,we.state.sortBy),Fe=function(e,t){f(t)},Ae=function(e){I(e.target.value),f(1)};return Object(n.useEffect)((function(){Re&&Re[0]&&G(Re)}),[Re]),r.a.createElement("div",{className:"list row"},r.a.createElement("div",{className:"col-sm-7"},r.a.createElement("h4",null,Y?Y+" - ":"","\u7528\u6237\u5217\u8868(\u603b\u6570\uff1a",M,")"),r.a.createElement("div",{className:"row mb-3"},r.a.createElement("select",{className:"form-control col-sm-2",value:K,onChange:function(e){var t=e.target.value;Z(t)}},r.a.createElement("option",{value:""},"\u89d2\u8272"),B.map((function(e){return r.a.createElement("option",{value:e.name},e.label)}))),!R&&r.a.createElement("input",{type:"text",className:"form-control col-sm-2 ml-2",placeholder:"\u5b66\u6821\u7f16\u53f7",value:ue,onChange:function(e){var t=e.target.value;de(t)}}),r.a.createElement("input",{type:"text",className:"form-control col-sm-4 ml-2",placeholder:"\u7535\u5b50\u90ae\u4ef6",value:oe,onChange:function(e){var t=e.target.value;ce(t)}})),r.a.createElement("div",{className:"row mb-3"},r.a.createElement("input",{type:"text",className:"form-control col-sm-3",placeholder:"\u7528\u6237\u540d/\u4e2d\u6587\u540d",value:ae,onChange:function(e){var t=e.target.value;ne(t)}}),r.a.createElement("select",{className:"form-control col-sm-2 ml-2",value:pe,onChange:function(e){var t=e.target.value;ge(t)}},r.a.createElement("option",{value:""},"\u7528\u6237\u7c7b\u578b"),r.a.createElement("option",{value:!1},"\u6ce8\u518c\u7528\u6237"),r.a.createElement("option",{value:!0},"\u975e\u6ce8\u518c\u7528\u6237")),r.a.createElement("select",{className:"form-control col-sm-2 ml-2",value:ve,onChange:function(e){var t=e.target.value;ye(t)}},r.a.createElement("option",{value:""},"\u767b\u5f55\u8fc7?"),r.a.createElement("option",{value:!0},"\u662f"),r.a.createElement("option",{value:!1},"\u5426")),r.a.createElement("div",null,r.a.createElement("button",{className:"btn btn-primary ml-2",type:"button",onClick:function(e){ne(""),ce(""),de(""),Z(""),ge(""),ye(""),G([])}},"\u6e05\u7a7a"))),r.a.createElement("div",{className:"row mb-4"},r.a.createElement("button",{className:"btn btn-primary mr-2",type:"button",onClick:function(){f(1),je()}},"\u67e5\u8be2"),R&&r.a.createElement("a",{target:"_blank",href:"/addU?schoolId="+R,class:"btn btn-primary "},"\u65b0\u5efa\u8054\u7edc\u65b9\u5f0f"))),r.a.createElement("div",{className:"mt-3 col-sm-5"},"\u6bcf\u9875\u663e\u793a\u884c\u6570: ",r.a.createElement("select",{onChange:Ae,value:N},T.map((function(e){return r.a.createElement("option",{key:e,value:e},e)}))),r.a.createElement(E.a,{className:"my-3",count:O,page:g,siblingCount:1,boundaryCount:1,variant:"outlined",shape:"rounded",onChange:Fe})),r.a.createElement("div",{class:"w-100"}),r.a.createElement("div",{className:"col-sm-12 list"},r.a.createElement("table",Object.assign({className:"table table-striped table-bordered"},ke()),r.a.createElement("thead",null,Ie.map((function(e){return r.a.createElement("tr",e.getHeaderGroupProps(),e.headers.map((function(e){return r.a.createElement("th",e.getHeaderProps(e.getSortByToggleProps()),e.render("Header"),r.a.createElement("span",null,e.isSorted?e.isSortedDesc?" \ud83d\udd3d":" \ud83d\udd3c":""))})))}))),r.a.createElement("tbody",Ne(),Pe.map((function(e,t){return xe(e),r.a.createElement("tr",e.getRowProps(),e.cells.map((function(e){return r.a.createElement("td",e.getCellProps(),e.render("Cell"))})))}))))),r.a.createElement("div",{className:"mb-3 col-sm-12"},"\u6bcf\u9875\u663e\u793a\u884c\u6570: ",r.a.createElement("select",{onChange:Ae,value:N},T.map((function(e){return r.a.createElement("option",{key:e,value:e},e)}))),r.a.createElement(E.a,{className:"my-3",count:O,page:g,siblingCount:1,boundaryCount:1,variant:"outlined",shape:"rounded",onChange:Fe})))},ce=a(246),le=["ComposedClass"],ie=["/schools","/schoolsView","/projects","/projects/school","/projectsView"],ue=Object(h.f)((function(e){var t=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(H.a.logout(),t){e.history.goBack();var a=window.open("/login",t?"_blank":null);a.focus()}else e.history.push("/login"),window.location.reload()};H.a.getCurrentUser()||function(){for(var e=window.location.pathname,t=0;t<ie.length;t++)if(e.includes(ie[t]))return!0;return!1}()||t(!0);var a=e.ComposedClass,n=Object(G.a)(e,le);Object(ce.a)({timeout:12e5,onIdle:function(e){t()},debounce:500}).getLastActiveTime;return r.a.createElement(a,n)})),de=a(77),me=a.n(de),he=a(35),pe=a.n(he),ge=a(78),fe=a.n(ge),be=a(98),ve=function(e){if(!e)return r.a.createElement("div",{className:"alert alert-danger",role:"alert"},"\u5fc5\u987b\u586b\u5199!")},ye=function(e){if(e&&e.length>0&&(e.length<6||e.length>40))return r.a.createElement("div",{className:"alert alert-danger",role:"alert"},"\u5bc6\u7801\u5e94\u542b6\u81f340\u4e2a\u5b57\u8282")},Ee=function(e){Object(d.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).handleReset=n.handleReset.bind(Object(u.a)(n)),n.onChangePasswordVerified=n.onChangePasswordVerified.bind(Object(u.a)(n)),n.onChangePassword=n.onChangePassword.bind(Object(u.a)(n)),n.state={passwordVerified:"",password:"",email:null,loading:!1,message:""},n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=this.props.location.search,t=new URLSearchParams(e).get("token"),a=null;be.verify(t,"config.secret",(function(e,t){e||(a=t.email)})),a?this.setState({email:a}):this.setState({message:"\u60a8\u7684\u90ae\u7bb1\u5730\u5740\u65e0\u6548\uff0c\u5bc6\u7801\u91cd\u7f6e\u8bf7\u6c42\u5931\u6548\uff0c\u8bf7\u5230\u767b\u5f55\u9875\u9762\u91cd\u65b0\u63d0\u4f9b\u6ce8\u518c\u90ae\u7bb1\u3002\u3002\u3002",email:null})}},{key:"onChangePasswordVerified",value:function(e){this.setState({passwordVerified:e.target.value})}},{key:"onChangePassword",value:function(e){this.setState({password:e.target.value})}},{key:"handleReset",value:function(e){var t=this;e.preventDefault(),this.form.validateAll(),this.checkBtn.context._errors.length>0||this.state.email&&(this.state.passwordVerified===this.state.password?H.a.reset(this.state.email,this.state.password).then((function(e){alert("\u5bc6\u7801\u5df2\u7ecf\u6210\u529f\u91cd\u7f6e"),H.a.getCurrentUser()?t.props.history.goBack():(t.props.history.push("/login?username="+e.data.username),window.location.reload(),t.setState({message:"\u60a8\u7684\u5bc6\u7801\u5df2\u7ecf\u6210\u529f\u91cd\u7f6e\uff01"}))})).catch((function(e){t.setState({message:JSON.stringify(e)})})):this.setState({message:"\u8bf7\u518d\u6b21\u786e\u8ba4\u5bc6\u7801\u3002\u3002\u3002"}))}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement("div",{className:"col-sm-12"},r.a.createElement("div",{className:"card card-container"},r.a.createElement("img",{src:"//ssl.gstatic.com/accounts/ui/avatar_2x.png",alt:"profile-img",className:"profile-img-card"}),r.a.createElement(me.a,{onSubmit:this.handleReset,ref:function(t){e.form=t}},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"password"},"\u65b0\u5bc6\u7801"),r.a.createElement(pe.a,{type:"password",className:"form-control",name:"password",value:this.state.password,onChange:this.onChangePassword,validations:[ve,ye]})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"passwordVerified"},"\u65b0\u5bc6\u7801\u518d\u786e\u8ba4"),r.a.createElement(pe.a,{type:"password",className:"form-control",name:"passwordVerified",value:this.state.passwordVerified,onChange:this.onChangePasswordVerified,validations:[ve]})),r.a.createElement("div",{className:"form-group"},r.a.createElement("button",{className:"btn btn-primary btn-block",disabled:this.state.loading},this.state.loading&&r.a.createElement("span",{className:"spinner-border spinner-border-sm"}),r.a.createElement("span",null,"\u63d0\u4ea4"))),this.state.message&&r.a.createElement("div",{className:"form-group"},r.a.createElement("div",{className:"alert alert-danger",role:"alert"},this.state.message)),r.a.createElement(fe.a,{style:{display:"none"},ref:function(t){e.checkBtn=t}})))))}}]),a}(n.Component),je=a(81);Object(je.b)("user_xpt3ehC4nNeGJBgM579gJ");var Ce=a(98),Oe=function(e){if(!e)return r.a.createElement("div",{className:"alert alert-danger",role:"alert"},"\u5fc5\u987b\u586b\u5199!")},Se=function(e){Object(d.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).handleLogin=n.handleLogin.bind(Object(u.a)(n)),n.onChangeUsername=n.onChangeUsername.bind(Object(u.a)(n)),n.onChangePassword=n.onChangePassword.bind(Object(u.a)(n)),n.onChangeEmail=n.onChangeEmail.bind(Object(u.a)(n)),n.onReset=n.onReset.bind(Object(u.a)(n)),n.handleReset=n.handleReset.bind(Object(u.a)(n)),n.handleEmailVerification=n.handleEmailVerification.bind(Object(u.a)(n)),n.state={username:"",password:"",email:"",isReset:!1,loading:!1,message:""},n.init(),n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=this.props.location.search,t=new URLSearchParams(e).get("username"),a=new URLSearchParams(e).get("token");if(a){var n=null;Ce.verify(a,"config.secret",(function(e,t){e||(n=t.email)})),n&&this.handleEmailVerification(n)}t&&this.setState({username:t})}},{key:"init",value:function(){M()(document).ready((function(){M()("#toggle").addClass("fas fa-eye-slash"),M()("#toggle").click((function(){M()(this).hasClass("fas fa-eye-slash")?(M()(this).removeClass("fas fa-eye-slash"),M()(this).addClass("fas fa-eye"),M()("#password").attr("type","text")):(M()(this).removeClass("fas fa-eye"),M()(this).addClass("fas fa-eye-slash"),M()("#password").attr("type","password"))}))}))}},{key:"onChangeUsername",value:function(e){this.setState({username:e.target.value})}},{key:"onChangePassword",value:function(e){this.setState({password:e.target.value})}},{key:"onChangeEmail",value:function(e){this.setState({email:e.target.value})}},{key:"onReset",value:function(){this.setState({isReset:!0})}},{key:"handleEmailVerification",value:function(e){var t=this;H.a.findByEmail(e).then((function(e){t.setState({username:e.data.username})})).catch((function(e){t.setState({message:e.toString()})}))}},{key:"handleReset",value:function(e){var t=this;if(e.preventDefault(),this.state.email){var a=Ce.sign({email:this.state.email},"config.secret",{expiresIn:900});H.a.findByEmail(this.state.email).then((function(e){var n=window.location.host,r={to:t.state.email,username:e.data.chineseName?e.data.chineseName:e.data.username,link:n+"/reset?token="+a};je.a.send("icloud_2021_12_27","template_ae0k3bj",r).then((function(e){console.log(e.text),t.setState({message:"\u90ae\u4ef6\u5df2\u53d1\u81f3\u60a8\u7684\u90ae\u7bb1\uff0c\u8bf7\u572815\u5206\u949f\u5185\u5b8c\u6210\u5bc6\u7801\u91cd\u7f6e\u3002\u3002\u3002"})}),(function(e){console.log(e.text),t.setState({message:e.text})}))})).catch((function(e){t.setState({message:"\u60a8\u7684\u6ce8\u518c\u90ae\u7bb1\u5730\u5740\u6709\u8bef\uff0c\u8bf7\u63d0\u4f9b\u6b63\u786e\u7684\u6ce8\u518c\u90ae\u7bb1 \u3002\u3002\u3002"})}))}}},{key:"handleLogin",value:function(e){var t=this;e.preventDefault(),this.setState({message:"",loading:!0}),this.form.validateAll(),0===this.checkBtn.context._errors.length?H.a.login(this.state.username,this.state.password).then((function(e){e.data.accessToken?(localStorage.setItem("user",JSON.stringify(e.data)),H.a.getCurrentUser().schoolId?t.props.history.push("/schoolsView/"+H.a.getCurrentUser().schoolId):t.props.history.push("/schools"),window.location.reload()):t.setState({loading:!1,message:"\u670d\u52a1\u5668\u5f02\u5e38\uff0c\u767b\u5f55\u5931\u8d25"})}),(function(e){var a=e.response&&e.response.data&&e.response.data.message||e.message||e.toString();t.setState({loading:!1,message:a})})):this.setState({loading:!1})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,H.a.isValid()?H.a.getCurrentUser().schoolId?this.props.history.push("/schoolsView/"+H.a.getCurrentUser().schoolId):this.props.history.push("/schools"):r.a.createElement("div",{className:"col-sm-12"},r.a.createElement("div",{className:"card card-container"},r.a.createElement("img",{src:"//ssl.gstatic.com/accounts/ui/avatar_2x.png",alt:"profile-img",className:"profile-img-card"}),r.a.createElement(me.a,{onSubmit:this.state.isReset?this.handleReset:this.handleLogin,ref:function(t){e.form=t}},this.state.isReset?r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"email"},"\u60a8\u7684\u6ce8\u518c\u90ae\u7bb1"),r.a.createElement(pe.a,{type:"text",className:"form-control",name:"email",value:this.state.email,onChange:this.onChangeEmail,validations:[Oe]})):r.a.createElement("div",null,r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"username"},"\u7528\u6237\u540d"),r.a.createElement(pe.a,{type:"text",className:"form-control",name:"username",value:this.state.username,onChange:this.onChangeUsername,validations:[Oe]})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"password"},"\u5bc6\u7801"),r.a.createElement("div",{style:{position:"relative",width:"100%"}},r.a.createElement(pe.a,{style:{width:"100%"},type:"password",className:"form-control",name:"password",id:"password",value:this.state.password,onChange:this.onChangePassword,validations:[Oe]}),r.a.createElement("button",{type:"button",id:"toggle",class:"toggle",style:{position:"absolute",right:"10px",top:"10px",background:"transparent",border:"none"}})),r.a.createElement("button",{style:{float:"left",width:"45%"},className:"btn btn-primary badge mt-2",type:"button",onClick:this.onReset},"\u5fd8\u8bb0\u7528\u6237\u540d\u6216\u5bc6\u7801?"))),r.a.createElement("div",{className:"form-group"},r.a.createElement("button",{className:"btn btn-primary btn-block",disabled:this.state.loading},this.state.loading&&r.a.createElement("span",{className:"spinner-border spinner-border-sm"}),r.a.createElement("span",null,this.state.isReset?"\u91cd\u7f6e\u5bc6\u7801":"\u767b\u5f55"))),this.state.message&&r.a.createElement("div",{className:"form-group"},r.a.createElement("div",{className:"alert alert-danger",role:"alert"},this.state.message)),r.a.createElement(fe.a,{style:{display:"none"},ref:function(t){e.checkBtn=t}})))))}}]),a}(n.Component),we=a(250),ke=a(249),Ne=a.n(ke);Object(je.b)("user_xpt3ehC4nNeGJBgM579gJ");var Ie=a(98),Pe=function(e){if(!e)return r.a.createElement("div",{className:"alert alert-danger",role:"alert"},"\u8bf7\u586b\u5199!")},xe=function(e){if(!Object(we.isEmail)(e))return r.a.createElement("div",{className:"alert alert-danger",role:"alert"},"\u90ae\u4ef6\u5730\u5740\u4e0d\u6b63\u786e")},Re=function(e){if(e.length<3||e.length>20)return r.a.createElement("div",{className:"alert alert-danger",role:"alert"},"\u7528\u6237\u540d\u5e94\u542b3\u81f320\u4e2a\u5b57\u8282")},Fe=function(e){if(e&&e.length>0&&(e.length<6||e.length>40))return r.a.createElement("div",{className:"alert alert-danger",role:"alert"},"\u5bc6\u7801\u5e94\u542b6\u81f340\u4e2a\u5b57\u8282")},Ae=function(e){Object(d.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).handleRegister=n.handleRegister.bind(Object(u.a)(n)),n.createContactOnly=n.createContactOnly.bind(Object(u.a)(n)),n.updateUser=n.updateUser.bind(Object(u.a)(n)),n.updateContactOnly=n.updateContactOnly.bind(Object(u.a)(n)),n.getUser=n.getUser.bind(Object(u.a)(n)),n.onChangeTitle=n.onChangeTitle.bind(Object(u.a)(n)),n.onChangeUsername=n.onChangeUsername.bind(Object(u.a)(n)),n.onChangeEmail=n.onChangeEmail.bind(Object(u.a)(n)),n.onChangePassword=n.onChangePassword.bind(Object(u.a)(n)),n.onChangeRoles=n.onChangeRoles.bind(Object(u.a)(n)),n.onChangeSchoolId=n.onChangeSchoolId.bind(Object(u.a)(n)),n.onChangeChineseName=n.onChangeChineseName.bind(Object(u.a)(n)),n.onChangePhone=n.onChangePhone.bind(Object(u.a)(n)),n.onChangeWechat=n.onChangeWechat.bind(Object(u.a)(n)),n.onChangeStartAt=n.onChangeStartAt.bind(Object(u.a)(n)),n.onChangeContactOnly=n.onChangeContactOnly.bind(Object(u.a)(n)),n.state={id:null,username:"",email:"",password:null,roles:null,schoolId:null,chineseName:"",phone:"",wechat:"",startAt:null,createdAt:null,lastLogin:null,title:"",newuser:!0,contactOnly:!1,titles:[],schools:[],rolesFull:[],successful:!1,message:"",readonly:!0},n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){this.setState({readonly:window.location.pathname.includes("View")}),this.props.match&&this.props.match.params.id&&(this.setState({newuser:!1}),this.getUser(this.props.match.params.id));var e=Ne.a.parse(this.props.location.search);e&&e.schoolId&&this.setState({schoolId:e.schoolId,contactOnly:!0}),this.getRoles(),this.getSchools(),this.getTitles()}},{key:"updateContactOnly",value:function(){var e=this;this.setState({message:"",successful:!1});var t={email:this.state.email,roles:this.state.roles,schoolId:this.state.schoolId,chineseName:this.state.chineseName,phone:this.state.phone,wechat:this.state.wechat,title:this.state.title,contactOnly:this.state.contactOnly};H.a.updateContactOnly(this.state.id,t).then((function(t){console.log(t.data),e.setState({message:"\u7528\u6237\u4fe1\u606f\u6210\u529f\u66f4\u65b0!",successful:!0})})).catch((function(t){e.setState({message:"\u7528\u6237\u4fe1\u606f\u4fee\u6539\u5931\u8d25\uff1a"+t,successful:!1}),console.log(t)}))}},{key:"updateUser",value:function(e){var t=this;if(e.preventDefault(),this.state.contactOnly)return this.updateContactOnly();if(this.setState({message:"",successful:!1}),this.validateSchool()&&(this.form.validateAll(),0===this.checkBtn.context._errors.length)){var a={username:this.state.username,email:this.state.email,roles:this.state.roles,schoolId:this.state.schoolId,chineseName:this.state.chineseName,phone:this.state.phone,wechat:this.state.wechat,startAt:this.state.startAt,title:this.state.title};H.a.update(this.state.id,a).then((function(e){console.log(e.data),t.setState({message:"\u7528\u6237\u4fe1\u606f\u6210\u529f\u66f4\u65b0!",successful:!0})})).catch((function(e){t.setState({message:"\u7528\u6237\u4fe1\u606f\u4fee\u6539\u5931\u8d25\uff1a"+e,successful:!1}),console.log(e)}))}}},{key:"getRoleNames",value:function(e){var t=[];if(e)for(var a=0;a<e.length;a++)t.push(e[a].name);return t}},{key:"getUser",value:function(e){var t=this;H.a.get(e).then((function(e){t.setState({id:e.data.id,username:e.data.username,email:e.data.email,roles:t.getRoleNames(e.data.roles),schoolId:e.data.schoolId,chineseName:e.data.chineseName,phone:e.data.phone,wechat:e.data.wechat,startAt:e.data.startAt,createdAt:e.data.createdAt,lastLogin:e.data.lastLogin,title:e.data.title,contactOnly:e.data.contactOnly}),console.log(e.data)})).catch((function(e){console.log(e)}))}},{key:"getRoles",value:function(){var e=this;H.a.getRoles().then((function(t){e.setState({rolesFull:t.data}),console.log(t)})).catch((function(e){console.log(e)}))}},{key:"convert",value:function(e){var t=[];if(e){for(var a=0;a<e.length;a++)t.push({value:e[a].id,label:e[a].code+"-"+e[a].name+"-"+e[a].region});return t}}},{key:"display",value:function(e){if(this.state.schools){for(var t=0;t<this.state.schools.length;t++)if(this.state.schools[t].value==e)return this.state.schools[t];return[]}}},{key:"displayName",value:function(e){if(this.state.schools){for(var t=0;t<this.state.schools.length;t++)if(this.state.schools[t].value==e)return this.state.schools[t].label?this.state.schools[t].label:"\u5b66\u6821\u540d";return""}}},{key:"getSchools",value:function(){var e=this;w.a.getAllSimple().then((function(t){e.setState({schools:e.convert(t.data)}),console.log(t)})).catch((function(e){console.log(e)}))}},{key:"getTitles",value:function(){var e=this;H.a.getUserTitles().then((function(t){e.setState({titles:t.data}),console.log(t)})).catch((function(e){console.log(e)}))}},{key:"onChangeRoles",value:function(e){var t=Object(b.a)(e.target.selectedOptions).map((function(e){return e.value}));this.setState({roles:t})}},{key:"onChangeContactOnly",value:function(e){this.setState({contactOnly:e.target.checked})}},{key:"onChangeChineseName",value:function(e){this.setState({chineseName:e.target.value})}},{key:"onChangeTitle",value:function(e){this.setState({title:e.target.value})}},{key:"onChangePhone",value:function(e){this.setState({phone:e.target.value})}},{key:"onChangeWechat",value:function(e){this.setState({wechat:e.target.value})}},{key:"onChangeStartAt",value:function(e){this.setState({startAt:e.target.value})}},{key:"onChangeUsername",value:function(e){this.setState({username:e.target.value})}},{key:"onChangeSchoolId",value:function(e){this.setState({schoolId:e.value})}},{key:"onChangeEmail",value:function(e){this.setState({email:e.target.value})}},{key:"onChangePassword",value:function(e){this.setState({password:e.target.value})}},{key:"getRelevantRoles",value:function(e){var t=[],a=[];if(!this.state.rolesFull)return[];for(var n=0;n<this.state.rolesFull.length;n++)"user"===this.state.rolesFull[n].name?t.push(this.state.rolesFull[n]):a.push(this.state.rolesFull[n]);return e?t:a}},{key:"createContactOnly",value:function(){var e=this;H.a.createContactOnly({email:this.state.email,roles:this.state.roles,schoolId:this.state.schoolId,chineseName:this.state.chineseName,phone:this.state.phone,wechat:this.state.wechat,title:this.state.title,contactOnly:this.state.contactOnly}).then((function(t){e.setState({message:t.data.message,successful:!0})}),(function(t){var a=t.response&&t.response.data&&t.response.data.message||t.message||t.toString();e.setState({successful:!1,message:"\u521b\u5efa\u7528\u6237\u5f02\u5e38\uff0c"+a})}))}},{key:"validateSchool",value:function(){var e=H.a.getCurrentUser();return!(!e&&!this.state.schoolId||e&&e.schoolId&&!this.state.schoolId)||(this.setState({message:"\u8bf7\u9009\u62e9\u5b66\u6821",successful:!1}),!1)}},{key:"validatePrincipal",value:function(){var e=Object($.a)(X.a.mark((function e(){var t,a;return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!H.a.getCurrentUser()&&this.state.schoolId){e.next=2;break}return e.abrupt("return",!0);case 2:return e.prev=2,e.next=5,w.a.getPrincipal(this.state.schoolId);case 5:if(t=e.sent,a=prompt("\u8bf7\u8f93\u5165\u6821\u957f\u59d3\u540d",""),console.log(t),console.log("user input principal: "+a),console.log("db retrieved principal: "+t.data.principal),a){e.next=12;break}return e.abrupt("return",!1);case 12:if(a!==t.data.principal){e.next=16;break}return e.abrupt("return",!0);case 16:return alert("\u6821\u957f\u59d3\u540d\u8f93\u5165\u6709\u8bef\uff01"),e.abrupt("return",!1);case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(2),alert(e.t0.message);case 23:return e.abrupt("return",!1);case 24:case"end":return e.stop()}}),e,this,[[2,20]])})));return function(){return e.apply(this,arguments)}}()},{key:"handleRegister",value:function(){var e=Object($.a)(X.a.mark((function e(t){var a=this;return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),!this.state.contactOnly){e.next=3;break}return e.abrupt("return",this.createContactOnly());case 3:if(this.setState({message:"",successful:!1}),this.state.password){e.next=7;break}return this.setState({message:"\u5bc6\u7801\u662f\u5fc5\u586b\u9879\u3002\u3002\u3002"}),e.abrupt("return");case 7:if(this.validateSchool()){e.next=9;break}return e.abrupt("return");case 9:return e.next=11,this.validatePrincipal();case 11:if(e.sent){e.next=14;break}return e.abrupt("return");case 14:this.form.validateAll(),0===this.checkBtn.context._errors.length&&H.a.register(this.state.username,this.state.email,this.state.password,this.state.roles,this.state.schoolId,this.state.chineseName,this.state.phone,this.state.wechat,this.state.startAt,this.state.title).then((function(e){a.emailVerification(),a.setState({message:e.data.message,successful:!0})}),(function(e){var t=e.response&&e.response.data&&e.response.data.message||e.message||e.toString();a.setState({successful:!1,message:t})}));case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"emailVerification",value:function(){var e=this;if(this.state.email){var t=Ie.sign({email:this.state.email},"config.secret",{expiresIn:900}),a=window.location.host,n={to:this.state.email,username:this.state.chineseName?this.state.chineseName:this.state.username,link:a+"/login?token="+t};je.a.send("icloud_2021_12_27","template_vye2wfs",n).then((function(t){console.log(t.text),e.setState({message:"\u6ce8\u518c\u786e\u8ba4\u90ae\u4ef6\u5df2\u53d1\u81f3\u60a8\u7684\u90ae\u7bb1 \u3002\u3002\u3002",successful:!0})}),(function(t){console.log(t.text),e.setState({message:t.text,successful:!1})}))}}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement(me.a,{onSubmit:this.state.newuser?this.handleRegister:this.updateUser,ref:function(t){e.form=t}},!this.state.successful&&r.a.createElement("div",{class:"row"},r.a.createElement("div",{class:"form-group col-sm-4",hidden:this.state.contactOnly},r.a.createElement("label",{htmlFor:"username"},"\u7528\u6237\u540d"),r.a.createElement(pe.a,{readonly:!this.state.newuser&&"",type:"text",class:"form-control",name:"username",value:this.state.username,onChange:this.onChangeUsername,validations:[Pe,Re]})),r.a.createElement("div",{class:"form-group col-sm-4"},r.a.createElement("label",{htmlFor:"email"},"\u7535\u5b50\u90ae\u7bb1"),r.a.createElement(pe.a,{readonly:!this.state.newuser&&"",type:"text",class:"form-control",name:"email",value:this.state.email,onChange:this.onChangeEmail,validations:[Pe,xe]})),r.a.createElement("div",{class:"form-group col-sm-4",hidden:this.state.contactOnly||!this.state.newuser},r.a.createElement("label",{htmlFor:"password"},"\u5bc6\u7801"),r.a.createElement(pe.a,{readonly:!!this.state.readonly&&"",type:"password",class:"form-control",name:"password",value:this.state.password,onChange:this.onChangePassword,validations:[Fe]})),r.a.createElement("div",{class:"form-group col-sm-4"},r.a.createElement("label",{htmlFor:"chineseName"},"\u4e2d\u6587\u540d"),r.a.createElement(pe.a,{readonly:!!this.state.readonly&&"",type:"text",class:"form-control",required:!0,name:"chineseName",value:this.state.chineseName,onChange:this.onChangeChineseName})),r.a.createElement("div",{class:"form-group col-sm-4"},r.a.createElement("label",{htmlFor:"phone"},"\u7535\u8bdd"),r.a.createElement(pe.a,{readonly:!!this.state.readonly&&"",type:"text",class:"form-control",name:"phone",value:this.state.phone,onChange:this.onChangePhone})),r.a.createElement("div",{class:"form-group col-sm-4"},r.a.createElement("label",{htmlFor:"wechat"},"\u5fae\u4fe1"),r.a.createElement(pe.a,{readonly:!!this.state.readonly&&"",type:"text",class:"form-control",name:"wechat",value:this.state.wechat,onChange:this.onChangeWechat})),r.a.createElement("div",{class:"form-group col-sm-4",hidden:!this.state.schoolId},r.a.createElement("label",{htmlFor:"title"},"\u804c\u52a1"),r.a.createElement("select",{onChange:this.onChangeTitle.bind(this),readonly:!!this.state.readonly&&"",class:"form-control",id:"title",value:this.state.title,name:"title"},r.a.createElement("option",{value:""},this.state.readonly?"":"\u8bf7\u9009\u62e9"),this.state.titles.map((function(e){return r.a.createElement("option",{value:e},e)})))),H.a.getCurrentUser()&&r.a.createElement("div",{class:"form-group col-sm-4",hidden:this.state.contactOnly},r.a.createElement("label",{htmlFor:"roles"},"\u89d2\u8272"),r.a.createElement("select",{onChange:this.onChangeRoles.bind(this),disabled:!(!this.state.readonly&&H.a.getCurrentUser().roles.includes("ROLE_ADMIN"))&&"disabled",class:"form-control",id:"roles",value:this.state.roles,name:"roles"},this.getRelevantRoles(this.state.schoolId).map((function(e){return r.a.createElement("option",{value:e.name},e.label)})))),r.a.createElement("div",{class:"form-group col-sm-4",hidden:!(this.state.newuser||this.state.schoolId||H.a.getCurrentUser()&&H.a.getCurrentUser().roles.includes("ROLE_ADMIN"))},r.a.createElement("label",{htmlFor:"schoolId"},"\u6240\u5c5e\u5b66\u6821"),this.state.newuser||!this.state.readonly&&H.a.getCurrentUser()&&H.a.getCurrentUser().roles.includes("ROLE_ADMIN")?r.a.createElement(ee.a,{onChange:this.onChangeSchoolId.bind(this),class:"form-control",id:"schoolId",value:this.display(this.state.schoolId),name:"schoolId",options:this.state.schools}):r.a.createElement(c.b,{to:"/schoolsView/"+this.state.schoolId,id:"schoolId",name:"schoolId"},this.displayName(this.state.schoolId))),r.a.createElement("div",{class:"form-group col-sm-4",hidden:this.state.newuser},r.a.createElement("label",{htmlFor:"lastLogin"},"\u4e0a\u6b21\u767b\u5f55\u65f6\u95f4"),r.a.createElement(pe.a,{readonly:"",type:"date",class:"form-control",name:"lastLogin",value:this.state.lastLogin})),r.a.createElement("div",{class:"form-group col-sm-4",hidden:this.state.newuser},r.a.createElement("label",{htmlFor:"createdAt"},"\u521b\u5efa\u65f6\u95f4"),r.a.createElement(pe.a,{readonly:"",type:"date",class:"form-control",name:"createdAt",value:this.state.createdAt})),r.a.createElement("div",{class:"w-100"}),this.state.readonly?"":r.a.createElement("div",{class:"form-group"},r.a.createElement("button",{className:"btn btn-primary btn-block"},this.state.newuser?"\u521b\u5efa\u65b0\u7528\u6237":"\u4fee\u6539\u7528\u6237")),r.a.createElement("div",{class:"w-100"}),!this.state.readonly&&!this.state.newuser&&r.a.createElement(c.b,{to:"/reset?token="+Ie.sign({email:this.state.email},"config.secret",{expiresIn:900}),className:"btn btn-primary"},"\u91cd\u7f6e\u5bc6\u7801")),this.state.message&&r.a.createElement("div",{class:"form-group"},r.a.createElement("div",{className:this.state.successful?"alert alert-success":"alert alert-danger",role:"alert"},this.state.message)),r.a.createElement(fe.a,{style:{display:"none"},ref:function(t){e.checkBtn=t}})))}}]),a}(n.Component),Be=a(28),De=a.n(Be),He=new(function(){function e(){Object(l.a)(this,e)}return Object(i.a)(e,[{key:"getPublicContent",value:function(){return De.a.get("/api/test/all")}},{key:"getUserBoard",value:function(){return De.a.get("/api/test/user",{headers:Object(B.a)()})}},{key:"getModeratorBoard",value:function(){return De.a.get("/api/test/mod",{headers:Object(B.a)()})}},{key:"getAdminBoard",value:function(){return De.a.get("/api/test/admin",{headers:Object(B.a)()})}}]),e}()),Te=(n.Component,function(e){Object(d.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={currentUser:H.a.getCurrentUser()},n}return Object(i.a)(a,[{key:"render",value:function(){var e=this.state.currentUser;return r.a.createElement("div",{className:"container"},r.a.createElement("header",{className:"jumbotron"},r.a.createElement("h3",null,r.a.createElement("strong",null,e.username)," Profile")),r.a.createElement("p",null,r.a.createElement("strong",null,"Token:")," ",e.accessToken.substring(0,20)," ..."," ",e.accessToken.substr(e.accessToken.length-20)),r.a.createElement("p",null,r.a.createElement("strong",null,"Id:")," ",e.id),r.a.createElement("p",null,r.a.createElement("strong",null,"Email:")," ",e.email),r.a.createElement("strong",null,"Authorities:"),r.a.createElement("ul",null,e.roles&&e.roles.map((function(e,t){return r.a.createElement("li",{key:t},e)}))))}}]),a}(n.Component)),Ue=a(98),Ve=function(e){Object(d.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).logOut=n.logOut.bind(Object(u.a)(n)),n.state={showModeratorBoard:!1,showAdminBoard:!1,currentUser:void 0},n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=H.a.getCurrentUser();e&&this.setState({currentUser:e,showModeratorBoard:e.roles.includes("ROLE_MODERATOR"),showAdminBoard:e.roles.includes("ROLE_ADMIN")})}},{key:"logOut",value:function(){H.a.logout(),this.props.history.push("/login"),window.location.reload()}},{key:"render",value:function(){var e=this.state,t=e.currentUser,a=(e.showModeratorBoard,e.showAdminBoard);return r.a.createElement("div",null,r.a.createElement("div",{class:"mb-3"},r.a.createElement("img",{src:g.a,alt:"",height:"60",width:"370",class:"responsive"})),r.a.createElement("nav",{class:"navbar navbar-expand-sm navbar-dark navbar-custom"},r.a.createElement(c.b,{to:"/",class:"navbar-brand"},"\u5b66\u6821\u9879\u76ee\u7ba1\u7406\u7cfb\u7edf"),r.a.createElement("button",{class:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarSupportedContent","aria-controls":"navbarSupportedContent","aria-expanded":"false","aria-label":"Toggle navigation"},r.a.createElement("span",{class:"navbar-toggler-icon"})),r.a.createElement("div",{class:"collapse navbar-collapse navbar-nav mr-auto",id:"navbarSupportedContent"},t&&!t.schoolId&&a&&r.a.createElement("li",{class:"nav-item dropdown"},r.a.createElement("a",{class:"nav-link dropdown-toggle",href:"#",id:"navbarDropdown",role:"button","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},"\u7ba1\u7406"),r.a.createElement("div",{class:"dropdown-menu","aria-labelledby":"navbarDropdown"},r.a.createElement("a",{class:"dropdown-item",href:"/users"},"\u7528\u6237\u5217\u8868"),r.a.createElement("a",{class:"dropdown-item",href:"/addU"},"\u521b\u5efa\u7528\u6237"))),(!t||t&&!t.schoolId)&&r.a.createElement("li",{class:"nav-item dropdown"},r.a.createElement("a",{class:"nav-link dropdown-toggle",href:"#",id:"navbarDropdown",role:"button","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},"\u5b66\u6821"),r.a.createElement("div",{class:"dropdown-menu","aria-labelledby":"navbarDropdown"},r.a.createElement("a",{class:"dropdown-item",href:"/schools"},"\u5b66\u6821\u5217\u8868"),r.a.createElement("a",{class:"dropdown-item",href:"/regions"},"\u5730\u533a\u5217\u8868"),r.a.createElement("a",{class:"dropdown-item",href:"/addS"},"\u65b0\u589e\u5b66\u6821"),r.a.createElement("a",{class:"dropdown-item",href:"/addSurvey"},"\u65b0\u589e\u8c03\u67e5\u8868"),r.a.createElement("div",{class:"dropdown-divider"}),r.a.createElement("a",{class:"dropdown-item",href:"/documents"},"\u5b66\u6821\u6587\u6863"),r.a.createElement("a",{class:"dropdown-item",href:"/comments"},"\u7559\u8a00"),r.a.createElement("a",{class:"dropdown-item",href:"/logs"},"\u4fee\u6539\u8bb0\u5f55"),r.a.createElement("a",{class:"dropdown-item",href:"/surveys"},"\u8c03\u67e5\u8868\u5217\u8868"))),(!t||t&&!t.schoolId)&&r.a.createElement("li",{class:"nav-item dropdown"},r.a.createElement("a",{class:"nav-link dropdown-toggle",href:"#",id:"navbarDropdown",role:"button","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},"\u9879\u76ee"),r.a.createElement("div",{class:"dropdown-menu","aria-labelledby":"navbarDropdown"},r.a.createElement("a",{class:"dropdown-item",href:"/projects"},"\u9879\u76ee\u5217\u8868"),r.a.createElement("a",{class:"dropdown-item",href:"/addP"},"\u65b0\u589e\u9879\u76ee"),r.a.createElement("div",{class:"dropdown-divider"}),r.a.createElement("a",{class:"dropdown-item",href:"/projectsXR"},"\u5411\u8363\u652f\u6301\u9879\u76ee\u5217\u8868"),r.a.createElement("a",{class:"dropdown-item",href:"/addPXR"},"\u65b0\u589e\u5411\u8363\u652f\u6301\u9879\u76ee"),r.a.createElement("div",{class:"dropdown-divider"}),r.a.createElement("a",{class:"dropdown-item",href:"/dossiers"},"\u9879\u76ee\u6587\u6863"))),t&&!t.schoolId&&r.a.createElement("li",{class:"nav-item dropdown"},r.a.createElement("a",{class:"nav-link dropdown-toggle",href:"#",id:"navbarDropdown",role:"button","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},"\u9879\u76ee\u7533\u8bf7"),r.a.createElement("div",{class:"dropdown-menu","aria-labelledby":"navbarDropdown"},r.a.createElement("a",{class:"dropdown-item",href:"/responses"},"\u9879\u76ee\u7533\u8bf7\u5217\u8868"),r.a.createElement("a",{class:"dropdown-item",href:"/forms"},"\u9879\u76ee\u5f81\u96c6\u5217\u8868"),r.a.createElement("a",{class:"dropdown-item",href:"/addF"},"\u65b0\u589e\u9879\u76ee\u5f81\u96c6"),r.a.createElement("div",{class:"dropdown-divider"}),r.a.createElement("a",{class:"dropdown-item",href:"/attachments"},"\u9879\u76ee\u7533\u8bf7\u9644\u4ef6")))),t?r.a.createElement("div",{class:"navbar-nav ml-auto"},r.a.createElement("li",{class:"nav-item dropdown"},r.a.createElement("a",{class:"nav-link dropdown-toggle",href:"#",id:"navbarDropdown",role:"button","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},t.lastLogin?r.a.createElement("span",{title:"\u4e0a\u6b21\u767b\u5f55\u65f6\u95f4: "+t.lastLogin},"\u6211\u7684\u6b23\u6b23(",t.chineseName?t.chineseName:t.username,")"):r.a.createElement("span",null," \u6211\u7684\u6b23\u6b23(",t.chineseName?t.chineseName:t.username,") ")),r.a.createElement("div",{class:"dropdown-menu","aria-labelledby":"navbarDropdown"},r.a.createElement("a",{class:"dropdown-item",href:"/users/"+t.id},"\u4e2a\u4eba\u4fe1\u606f"),r.a.createElement("a",{class:"dropdown-item",href:"/reset?token="+Ue.sign({email:t.email},"config.secret",{expiresIn:900})},"\u91cd\u7f6e\u5bc6\u7801"),t.schoolId?r.a.createElement("a",{class:"dropdown-item",href:"/schoolsView/"+t.schoolId},"\u6211\u7684\u5b66\u6821"):"",r.a.createElement("a",{class:"dropdown-item",href:"/responses/user/"+t.id},"\u6211\u7684\u9879\u76ee\u7533\u8bf7"))),r.a.createElement("li",{class:"nav-item"},r.a.createElement("a",{href:"#",class:"nav-link",onClick:this.logOut},"\u9000\u51fa"))):r.a.createElement("div",{class:"navbar-nav ml-auto"},r.a.createElement("li",{class:"nav-item"},r.a.createElement(c.b,{to:"/login",class:"nav-link"},"\u767b\u5f55")),r.a.createElement("li",{class:"nav-item"},r.a.createElement(c.b,{to:"/register",class:"nav-link"},"\u6ce8\u518c")))),r.a.createElement("div",{class:"container mt-3"},r.a.createElement(h.c,null,r.a.createElement(h.a,{exact:!0,path:["/reset"],component:Ee}),r.a.createElement(h.a,{exact:!0,path:["/login","/","/home"],component:Se}),r.a.createElement(h.a,{exact:!0,path:"/register",component:Ae}),r.a.createElement(h.a,{exact:!0,path:"/profile",component:Te}),r.a.createElement(h.a,{exact:!0,path:["/regions"],component:R},r.a.createElement(ue,{ComposedClass:R})),r.a.createElement(h.a,{exact:!0,path:["/schools","/schools/region/:region"]},r.a.createElement(ue,{ComposedClass:P})),r.a.createElement(h.a,{path:["/schoolsView/:id","/schools/:id","/addS"],component:O.a},r.a.createElement(ue,{ComposedClass:O.a})),r.a.createElement(h.a,{path:["/surveys/:id","/surveysView/:id","/addSurvey","/surveys/school/:schoolId"],component:f.a},r.a.createElement(ue,{ComposedClass:f.a})),r.a.createElement(h.a,{exact:!0,path:["/surveys"],component:C},r.a.createElement(ue,{ComposedClass:C})),r.a.createElement(h.a,{exact:!0,path:["/documents","/documents/school/:schoolId","/documents/school/:schoolId/:docCategory"],component:x.a},r.a.createElement(ue,{ComposedClass:x.a})),r.a.createElement(h.a,{exact:!0,path:["/comments","/comments/school/:schoolId"],component:F.a},r.a.createElement(ue,{ComposedClass:F.a})),r.a.createElement(h.a,{exact:!0,path:["/logs","/logs/school/:schoolId"],component:T},r.a.createElement(ue,{ComposedClass:T})),r.a.createElement(h.a,{exact:!0,path:["/projects","/projects/school/:schoolId","/projectsXR","/projectsXR/school/:schoolId"],component:V.a},r.a.createElement(ue,{ComposedClass:V.a})),r.a.createElement(h.a,{path:["/projectsView/:id","/projects/:id","/addP","/projectsViewXR/:id","/projectsXR/:id","/addPXR"],component:U.a},r.a.createElement(ue,{ComposedClass:U.a})),r.a.createElement(h.a,{exact:!0,path:["/dossiers","/dossiers/project/:projectId","/dossiers/project/:projectId/:docCategory"],component:q.a},r.a.createElement(ue,{ComposedClass:q.a})),r.a.createElement(h.a,{exact:!0,path:["/forms"],component:z},r.a.createElement(ue,{ComposedClass:z})),r.a.createElement(h.a,{path:["/forms/:id","/formsView/:id","/addF"],component:J},r.a.createElement(ue,{ComposedClass:J})),r.a.createElement(h.a,{exact:!0,path:["/responses","/responses/form/:formId","/responses/school/:schoolId","/responses/user/:userId"],component:se.a},r.a.createElement(ue,{ComposedClass:se.a})),r.a.createElement(h.a,{path:["/responses/:id","/responsesView/:id","/addR/:id"],component:re},r.a.createElement(ue,{ComposedClass:re})),r.a.createElement(h.a,{exact:!0,path:["/attachments","/attachments/response/:responseId"],component:Z},r.a.createElement(ue,{ComposedClass:Z})),r.a.createElement(h.a,{exact:!0,path:["/users","/users/school/:schoolId"],component:oe},r.a.createElement(ue,{ComposedClass:oe})),r.a.createElement(h.a,{path:["/addU","/users/:id","/usersView/:id"],component:Ae},r.a.createElement(ue,{ComposedClass:Ae})))))}}]),a}(n.Component),qe=Object(h.f)(Ve);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(c.a,null,r.a.createElement(qe,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},52:function(e,t,a){"use strict";var n=a(12),r=a(13),s=a(4),o=a(5),c=function(){function e(){Object(n.a)(this,e)}return Object(r.a)(e,[{key:"getAll2",value:function(e){return s.a.post("/responses/all",e,{headers:Object(o.a)()})}},{key:"getAll",value:function(e){return s.a.get("/responses",{params:e},{headers:Object(o.a)()})}},{key:"get",value:function(e){return s.a.get("/responses/".concat(e),{headers:Object(o.a)()})}},{key:"create",value:function(e){return s.a.post("/responses",e,{headers:Object(o.a)()})}},{key:"update",value:function(e,t){return s.a.put("/responses/".concat(e),t,{headers:Object(o.a)()})}},{key:"delete",value:function(e){return s.a.delete("/responses/".concat(e),{headers:Object(o.a)()})}},{key:"deleteAll",value:function(){return s.a.delete("/responses",{headers:Object(o.a)()})}},{key:"findByTitle",value:function(e){return s.a.get("/responses?title=".concat(e),{headers:Object(o.a)()})}},{key:"uploadAttachments",value:function(e,t,a){var n=JSON.parse(localStorage.getItem("user"));return s.a.post("/attachments-upload/".concat(e),t,{headers:{"content-type":"multipart/form-data","x-access-token":n&&n.accessToken?n.accessToken:null},onUploadProgress:a})}}]),e}();t.a=new c},57:function(e,t,a){"use strict";var n=a(12),r=a(13),s=a(4),o=a(5),c=function(){function e(){Object(n.a)(this,e)}return Object(r.a)(e,[{key:"getAll2",value:function(e){return s.a.post("/documents/all",e,{headers:Object(o.a)()})}},{key:"getAll",value:function(e){return s.a.get("/documents",{params:e},{headers:Object(o.a)()})}},{key:"get",value:function(e){return s.a.get("/documents/".concat(e),{headers:Object(o.a)()})}},{key:"getContent",value:function(e){var t=JSON.parse(localStorage.getItem("user"));return s.a.get("/documentsContent/".concat(e),{headers:{"x-access-token":t&&t.accessToken?t.accessToken:null},responseType:"arraybuffer"})}},{key:"getDocCategories",value:function(){return s.a.get("/documents/categories",{headers:Object(o.a)()})}},{key:"getCount",value:function(e){return s.a.get("/documentsCount/".concat(e),{headers:Object(o.a)()})}},{key:"create",value:function(e){return s.a.post("/documents",e,{headers:Object(o.a)()})}},{key:"update",value:function(e,t){return s.a.put("/documents/".concat(e),t,{headers:Object(o.a)()})}},{key:"delete",value:function(e){return s.a.delete("/documents/".concat(e),{headers:Object(o.a)()})}},{key:"deleteAll",value:function(){return s.a.delete("/documents",{headers:Object(o.a)()})}},{key:"findByTitle",value:function(e){return s.a.get("/documents?title=".concat(e),{headers:Object(o.a)()})}}]),e}();t.a=new c},68:function(e,t,a){"use strict";var n=a(12),r=a(13),s=a(4),o=a(5),c=function(){function e(){Object(n.a)(this,e)}return Object(r.a)(e,[{key:"getAll2",value:function(e){return s.a.post("/attachments/all",e,{headers:Object(o.a)()})}},{key:"getAll",value:function(e){return s.a.get("/attachments",{params:e},{headers:Object(o.a)()})}},{key:"get",value:function(e){return s.a.get("/attachments/".concat(e),{headers:Object(o.a)()})}},{key:"getContent",value:function(e){var t=JSON.parse(localStorage.getItem("user"));return s.a.get("/attachmentsContent/".concat(e),{headers:{"x-access-token":t&&t.accessToken?t.accessToken:null},responseType:"arraybuffer"})}},{key:"getCount",value:function(e){return s.a.get("/attachmentsCount/".concat(e),{headers:Object(o.a)()})}},{key:"create",value:function(e){return s.a.post("/attachments",e,{headers:Object(o.a)()})}},{key:"update",value:function(e,t){return s.a.put("/attachments/".concat(e),t,{headers:Object(o.a)()})}},{key:"delete",value:function(e){return s.a.delete("/attachments/".concat(e),{headers:Object(o.a)()})}},{key:"deleteAll",value:function(){return s.a.delete("/attachments",{headers:Object(o.a)()})}},{key:"findByTitle",value:function(e){return s.a.get("/attachments?title=".concat(e),{headers:Object(o.a)()})}}]),e}();t.a=new c},69:function(e,t,a){"use strict";var n=a(12),r=a(13),s=a(4),o=a(5),c=function(){function e(){Object(n.a)(this,e)}return Object(r.a)(e,[{key:"getAll2",value:function(e){return s.a.post("/dossiers/all",e,{headers:Object(o.a)()})}},{key:"getAll",value:function(e){return s.a.get("/dossiers",{params:e},{headers:Object(o.a)()})}},{key:"get",value:function(e){return s.a.get("/dossiers/".concat(e),{headers:Object(o.a)()})}},{key:"getContent",value:function(e){var t=JSON.parse(localStorage.getItem("user"));return s.a.get("/dossiersContent/".concat(e),{headers:{"x-access-token":t&&t.accessToken?t.accessToken:null},responseType:"arraybuffer"})}},{key:"getDocCategories",value:function(){return s.a.get("/dossiers/categories",{headers:Object(o.a)()})}},{key:"getCount",value:function(e){return s.a.get("/dossiersCount/".concat(e),{headers:Object(o.a)()})}},{key:"create",value:function(e){return s.a.post("/dossiers",e,{headers:Object(o.a)()})}},{key:"update",value:function(e,t){return s.a.put("/dossiers/".concat(e),t,{headers:Object(o.a)()})}},{key:"delete",value:function(e){return s.a.delete("/dossiers/".concat(e),{headers:Object(o.a)()})}},{key:"deleteAll",value:function(){return s.a.delete("/dossiers",{headers:Object(o.a)()})}},{key:"findByTitle",value:function(e){return s.a.get("/dossiers?title=".concat(e),{headers:Object(o.a)()})}}]),e}();t.a=new c},76:function(e,t,a){"use strict";var n=a(21),r=a(3),s=a(39),o=(a(18),a(30),a(1)),c=a(0),l=a.n(c),i=a(52),u=(a(68),a(8),a(23)),d=a(10),m=a(95),h=a(17),p=a(34),g=a.n(p),f=["fdata"];t.a=function(e){var t=Object(c.useState)([]),a=Object(o.a)(t,2),p=a[0],b=a[1],v=Object(c.useState)(null),y=Object(o.a)(v,2),E=(y[0],y[1],Object(c.useState)(-1)),j=Object(o.a)(E,2),C=(j[0],j[1],Object(c.useState)("")),O=Object(o.a)(C,2),S=O[0],w=O[1],k=Object(c.useState)(""),N=Object(o.a)(k,2),I=N[0],P=N[1],x=Object(c.useState)(""),R=Object(o.a)(x,2),F=R[0],A=R[1],B=Object(c.useState)(e.match?e.match.params.formId:e.formId),D=Object(o.a)(B,2),H=D[0],T=(D[1],Object(c.useState)(null)),U=Object(o.a)(T,2),V=U[0],q=U[1],G=Object(c.useState)(e.match?e.match.params.schoolId:e.schoolId),L=Object(o.a)(G,2),_=L[0],M=(L[1],Object(c.useState)(e.match?e.match.params.userId:e.userId)),W=Object(o.a)(M,2),J=W[0],z=(W[1],Object(c.useState)([])),Y=Object(o.a)(z,2),X=Y[0],$=Y[1],Q=Object(c.useState)([]),K=Object(o.a)(Q,2),Z=(K[0],K[1]),ee=Object(c.useState)(!!e.readonly&&e.readonly),te=Object(o.a)(ee,2),ae=te[0],ne=(te[1],Object(c.useState)(!!e.embedded&&e.embedded)),re=Object(o.a)(ne,2),se=re[0],oe=(re[1],Object(c.useRef)());oe.current=p;var ce=Object(c.useState)(0),le=Object(o.a)(ce,2),ie=le[0],ue=le[1],de=Object(c.useState)(1),me=Object(o.a)(de,2),he=me[0],pe=me[1],ge=Object(c.useState)(0),fe=Object(o.a)(ge,2),be=fe[0],ve=fe[1],ye=Object(c.useState)(30),Ee=Object(o.a)(ye,2),je=Ee[0],Ce=Ee[1],Oe=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t={};return S&&(t.title=S),I&&(t.code=I),F&&(t.startAt=F),he&&(t.page=he-1),je&&(t.size=je),H&&(t.formId=H),_&&(t.schoolId=_),X&&(t.orderby=X),J&&(t.userId=J),e&&(t.exportFlag=e),t},Se=function(e){if(!e||0===e.length)return"";for(var t=e[0],a=1;a<e.length;a++)t=t+", "+e[a];return t},we=function(e){if(!e||0===e.length)return{};for(var t={},a=0;a<e.length;a++)"file"!==e[a].type&&(t[e[a].label]=Se(e[a].userData));return t},ke=function(){var e=Oe();i.a.getAll2(e).then((function(e){var t=e.data,a=t.responses,n=t.totalPages,r=t.totalItems;if(b(a),ve(n),ue(r),H&&a[0]&&a[0].title){var s=a[0].title.indexOf("-");q(s>0?a[0].title.substring(0,s):a[0].title)}console.log(e.data)})).catch((function(e){console.log(e)}))};Object(c.useEffect)(ke,[he,je,X,S,I,F]);var Ne=[{Header:"\u5e02",accessor:"school.surveys.city"},{Header:"\u533a/\u53bf",accessor:"school.surveys.county"},{Header:"\u4e61/\u9547",accessor:"school.surveys.community"},{Header:"\u6559\u80b2\u5c40\u6821\u540d",accessor:"school.surveys.schoolBoardRegisteredName"},{Header:"\u5b66\u6821\u7c7b\u578b",accessor:"school.category"},{Header:"\u5b66\u751f\u4eba\u6570",accessor:"school.studentsCount"},{Header:"\u6559\u5e08\u4eba\u6570",accessor:"school.teachersCount"}],Ie=Object(c.useMemo)((function(){return[{Header:"\u9879\u76ee\u5e74\u4efd",accessor:"startAt",Cell:function(e){var t=e.row.id,a=null;return oe.current[t].startAt&&(a=new Date(oe.current[t].startAt)),l.a.createElement("div",null,a?a.getUTCFullYear():"")}},{Header:"\u6807\u9898",accessor:"title"},{Header:"\u7533\u8bf7\u4eba",accessor:"user.chineseName",disableSortBy:!0,Cell:function(e){var t=e.row.id;return l.a.createElement("div",null,oe.current[t].user?l.a.createElement(d.b,{to:"/usersView/"+oe.current[t].user.id,className:"badge badge-success"},oe.current[t].user.chineseName):"")}},{Header:"\u4fee\u6539\u65f6\u95f4",accessor:"updatedAt",Cell:function(e){var t=e.row.id,a=new Date(oe.current[t].updatedAt);return l.a.createElement("div",null,a.toLocaleDateString("zh-cn",{hour12:!0,hour:"2-digit",minute:"2-digit",second:"2-digit"}))}},{Header:"\u5b66\u6821\u7f16\u53f7",accessor:"school.code",Cell:function(e){var t=e.row.id;return l.a.createElement("div",null,oe.current[t].school?l.a.createElement(d.b,{to:"/schoolsView/"+oe.current[t].school.id,className:"badge badge-success"},oe.current[t].school.code):"")}},{Header:"\u5b66\u6821\u540d\u79f0",accessor:"school.name",Cell:function(e){var t=e.row.id;return l.a.createElement("div",null,oe.current[t].school?l.a.createElement(d.b,{to:"/schoolsView/"+oe.current[t].school.id,className:"badge badge-success"},oe.current[t].school.name):"")}},{Header:"\u7701\uff08\u76f4\u8f96\u5e02\uff09",accessor:"school.region"},{Header:"\u64cd\u4f5c",accessor:"actions",disableSortBy:!0,Cell:function(e){var t=e.row.id;return l.a.createElement("div",null,l.a.createElement(d.b,{to:"/responsesView/"+oe.current[t].id},l.a.createElement("i",{className:"fas fa-eye action mr-2"})),!ae&&l.a.createElement(d.b,{to:"/responses/"+oe.current[t].id},l.a.createElement("i",{className:"far fa-edit action mr-2"})),!ae&&l.a.createElement("span",{onClick:function(){return window.confirm("\u60a8\u786e\u5b9a\u8981\u5220\u9664\u5417 ?")&&function(e){var t=oe.current[e].id;i.a.delete(t).then((function(t){var a=Object(n.a)(oe.current);a.splice(e,1),b(a)})).catch((function(e){console.log(e)}))}(t)}},l.a.createElement("i",{className:"fas fa-trash action"})))}}]}),[]),Pe=[];(se||_)&&(Pe=["school.region","school.code","school.name"]),H&&(Pe=[].concat(Object(n.a)(Pe),["title"]));var xe=Object(h.useTable)({columns:Ie,data:p,disableSortRemove:!0,manualSortBy:!0,initialState:{hiddenColumns:Pe,sortBy:[{id:"startAt",desc:!0}]}},h.useSortBy),Re=xe.getTableProps,Fe=xe.getTableBodyProps,Ae=xe.headerGroups,Be=xe.rows,De=xe.prepareRow,He=xe.state.sortBy;return Object(c.useEffect)((function(){He&&He[0]&&$(He)}),[He]),l.a.createElement("div",{className:"list row"},l.a.createElement("div",{className:"col-sm-8"},l.a.createElement("h4",null,_&&!se&&l.a.createElement("a",{href:"/schoolsView/"+_},"\u5b66\u6821",_+"-"),V?V+"-":"","\u9879\u76ee\u7533\u8bf7\u5217\u8868(\u603b\u6570\uff1a",ie,")"),l.a.createElement("div",{className:"input-group mb-3"},l.a.createElement("input",{type:"text",readonly:"",className:"form-control",placeholder:"\u9879\u76ee\u5e74\u4efd",value:F,onChange:function(e){A(e)}}),l.a.createElement(g.a,{yearArray:["2019","2020"],value:F,onSelect:function(e){A(e)},hideInput:!0,minRange:1995,maxRange:2022}),!H&&l.a.createElement("input",{type:"text",className:"form-control ml-2",placeholder:"\u6807\u9898\u67e5\u627e",value:S,onChange:function(e){var t=e.target.value;w(t)}}),!se&&l.a.createElement("input",{type:"text",className:"form-control ml-2",placeholder:"\u5b66\u6821\u7f16\u7801",value:I,onChange:function(e){var t=e.target.value;P(t)}}),l.a.createElement("div",null,l.a.createElement("button",{className:"btn btn-primary ml-2",type:"button",onClick:function(e){w(""),P(""),A(""),$([]),Z([]),pe(1)}},"\u6e05\u7a7a"))),l.a.createElement("div",{className:"input-group mb-3"},l.a.createElement("button",{className:"btn btn-primary ",type:"button",onClick:function(){pe(1),ke()}},"\u67e5\u8be2"),H&&l.a.createElement("button",{className:"btn btn-primary ml-2",type:"button",onClick:function(){var e=Oe(!0);i.a.getAll2(e).then((function(e){var t=e.data,a=t.responses,o=(t.totalPages,t.totalItems,function(e){if(!e||0==e.length)return[];var t=e[0].fdata;if(!t||0===t.length)return[];for(var a=[],n=0;n<t.length;n++)"file"!==t[n].type&&a.push({Header:t[n].label,accessor:t[n].label});return a}(a)),c=u.a.exportCSV(function(e){if(!e||0==e.length)return[];for(var t=[],a=0;a<e.length;a++){var n=e[a],o=n.fdata,c=Object(s.a)(n,f),l=we(o);t.push(Object(r.a)(Object(r.a)({},c),l))}return t}(a),[].concat(Object(n.a)(Ie),Ne,Object(n.a)(o))),l=window.URL.createObjectURL(new Blob([c])),i=document.createElement("a");i.href=l,i.setAttribute("download","response.csv"),document.body.appendChild(i),i.click(),i.remove(),console.log(e.data)})).catch((function(e){console.log(e)}))}},"\u5bfc\u51fa"))),l.a.createElement("div",{className:"col-sm-4 mt-3"},"\u6bcf\u9875\u663e\u793a\u884c\u6570: ",l.a.createElement("select",{onChange:function(e){Ce(e.target.value),pe(1)},value:je},[20,30,50].map((function(e){return l.a.createElement("option",{key:e,value:e},e)}))),l.a.createElement(m.a,{className:"my-3",count:be,page:he,siblingCount:1,boundaryCount:1,variant:"outlined",shape:"rounded",onChange:function(e,t){pe(t)}})),l.a.createElement("div",{className:"col-sm-12 list"},l.a.createElement("table",Object.assign({className:"table table-striped table-bordered"},Re()),l.a.createElement("thead",null,Ae.map((function(e){return l.a.createElement("tr",e.getHeaderGroupProps(),e.headers.map((function(e){return l.a.createElement("th",e.getHeaderProps(e.getSortByToggleProps()),e.render("Header"),l.a.createElement("span",null,"school.region"===e.id||"school.code"===e.id||"school.name"===e.id||"startAt"===e.id||"updatedAt"===e.id||"title"===e.id?e.isSortedDesc?" \ud83d\udd3d":" \ud83d\udd3c":""))})))}))),l.a.createElement("tbody",Fe(),Be.map((function(e,t){return De(e),l.a.createElement("tr",e.getRowProps(),e.cells.map((function(e){return l.a.createElement("td",e.getCellProps(),e.render("Cell"))})))}))))))}},79:function(e,t,a){"use strict";var n=a(21),r=a(1),s=a(0),o=a.n(s),c=a(23),l=a(10),i=a(95),u=a(17),d=a(34),m=a.n(d);t.a=function(e){var t=Object(s.useState)([]),a=Object(r.a)(t,2),d=a[0],h=a[1],p=Object(s.useState)([]),g=Object(r.a)(p,2),f=(g[0],g[1]),b=Object(s.useState)(null),v=Object(r.a)(b,2),y=(v[0],v[1],Object(s.useState)(localStorage.getItem("user"))),E=Object(r.a)(y,2),j=E[0],C=(E[1],Object(s.useState)(-1)),O=Object(r.a)(C,2),S=(O[0],O[1],Object(s.useState)("")),w=Object(r.a)(S,2),k=w[0],N=w[1],I=Object(s.useState)(""),P=Object(r.a)(I,2),x=P[0],R=P[1],F=Object(s.useState)(""),A=Object(r.a)(F,2),B=A[0],D=A[1],H=Object(s.useState)(""),T=Object(r.a)(H,2),U=T[0],V=T[1],q=Object(s.useState)(e.match?e.match.params.schoolId:e.schoolId),G=Object(r.a)(q,2),L=G[0],_=(G[1],Object(s.useState)(!!e.embedded&&e.embedded)),M=Object(r.a)(_,2),W=M[0],J=(M[1],Object(s.useState)(!!e.readonly&&e.readonly)),z=Object(r.a)(J,2),Y=z[0],X=(z[1],Object(s.useRef)());X.current=d;var $=Object(s.useState)(1),Q=Object(r.a)($,2),K=Q[0],Z=Q[1],ee=Object(s.useState)(0),te=Object(r.a)(ee,2),ae=te[0],ne=te[1],re=Object(s.useState)(30),se=Object(r.a)(re,2),oe=se[0],ce=se[1],le=Object(s.useState)(0),ie=Object(r.a)(le,2),ue=ie[0],de=ie[1],me=[20,30,50],he=Object(s.useState)([]),pe=Object(r.a)(he,2),ge=pe[0],fe=pe[1],be=Object(s.useState)([]),ve=Object(r.a)(be,2),ye=ve[0],Ee=ve[1],je=Object(s.useState)([]),Ce=Object(r.a)(je,2),Oe=(Ce[0],Ce[1],Object(s.useState)(window.location.pathname.includes("XR")?window.location.pathname.includes("XR"):e.xr)),Se=Object(r.a)(Oe,2),we=Se[0],ke=(Se[1],function(e){var t={};return k&&(t.name=k),K&&(t.page=K-1),oe&&(t.size=oe),ge&&(t.orderby=ge),x&&(t.code=x),B&&(t.region=B),U&&(t.startAt=U),L&&(t.schoolId=L),t.xr=we,e&&(t.exportFlag=e),t});Object(s.useEffect)((function(){0==ye.length&&c.a.getRegions().then((function(e){Ee(e.data),console.log(e)})).catch((function(e){console.log(e)}))}),[ge]);var Ne=function(){var e=ke(!1);c.a.getAll2(e).then((function(e){var t=e.data,a=t.projects,n=t.totalPages,r=t.totalItems;h(a),ne(n),de(r),console.log(e.data)})).catch((function(e){console.log(e)}))};Object(s.useEffect)(Ne,[K,oe,ge,x,k,U,B]);var Ie=Object(s.useMemo)((function(){return[{Header:"\u9879\u76ee\u5e74\u4efd",accessor:"startAt",Cell:function(e){var t=e.row.id,a=new Date(X.current[t].startAt);return o.a.createElement("div",null,a.getUTCFullYear())}},{Header:"\u9879\u76ee\u72b6\u6001",accessor:"status"},{Header:"\u9879\u76ee\u540d\u79f0",accessor:"name"},{Header:"\u9879\u76ee\u7533\u8bf7",accessor:"response.title",disableSortBy:!0,Cell:function(e){var t=e.row.id;return o.a.createElement("div",null,X.current[t].response?o.a.createElement(l.b,{to:"/responsesView/"+X.current[t].response.id},X.current[t].response.title):"")}},{Header:"\u9879\u76ee\u63cf\u8ff0",accessor:"description",disableSortBy:!0},{Header:"\u5b66\u6821\u7f16\u53f7",accessor:"school.code",Cell:function(e){var t=e.row.id;return o.a.createElement("div",null,X.current[t].school?o.a.createElement(l.b,{to:"/schoolsView/"+X.current[t].school.id},X.current[t].school.code):"")}},{Header:"\u7701\uff08\u76f4\u8f96\u5e02\uff09",accessor:"school.region"},{Header:"\u5b66\u6821\u540d\u79f0",accessor:"school.name",Cell:function(e){var t=e.row.id;return o.a.createElement("div",null,X.current[t].school?o.a.createElement(l.b,{to:"/schoolsView/"+X.current[t].school.id},X.current[t].school.name):"")}},{Header:"\u5b66\u751f\u6570",accessor:"school.studentsCount",disableSortBy:!0},{Header:"\u6559\u5e08\u6570",accessor:"school.teachersCount",disableSortBy:!0},{Header:"\u5b66\u6821\u7c7b\u578b",accessor:"school.category",disableSortBy:!0},{Header:"\u9879\u76ee\u8d39\u7528",accessor:"budget",disableSortBy:!0},{Header:"\u64cd\u4f5c",accessor:"actions",disableSortBy:!0,Cell:function(e){var t=e.row.id;return o.a.createElement("div",null,j&&o.a.createElement(l.b,{to:"/projectsView"+(we?"XR":"")+"/"+X.current[t].id},o.a.createElement("i",{className:"fas fa-eye action mr-2"})),!Y&&j&&o.a.createElement(l.b,{to:"/projects"+(we?"XR":"")+"/"+X.current[t].id},o.a.createElement("i",{className:"far fa-edit action mr-2"})),!Y&&j&&o.a.createElement("span",{onClick:function(){return window.confirm("\u60a8\u786e\u5b9a\u8981\u5220\u9664\u5417 ?")&&function(e){var t=X.current[e].id;c.a.delete(t).then((function(t){var a=Object(n.a)(X.current);a.splice(e,1),h(a)})).catch((function(e){console.log(e)}))}(t)}},o.a.createElement("i",{className:"fas fa-trash action"})))}}]}),[]),Pe=W||L?[].concat(["id","school.region","school.code","school.name"],["school.studentsCount","school.teachersCount","school.category"]):[];Pe=we?[].concat(Object(n.a)(Pe),["response.title","status"]):Pe;var xe=Object(u.useTable)({columns:Ie,data:d,disableSortRemove:!0,manualSortBy:!0,initialState:{hiddenColumns:Pe,sortBy:[{id:"startAt",desc:!0}]}},u.useSortBy),Re=xe.getTableProps,Fe=xe.getTableBodyProps,Ae=xe.headerGroups,Be=xe.rows,De=xe.prepareRow,He=(xe.state,xe.state.sortBy),Te=function(e,t){Z(t)},Ue=function(e){ce(e.target.value),Z(1)};return Object(s.useEffect)((function(){He&&He[0]&&fe(He)}),[He]),o.a.createElement("div",{className:"list row"},o.a.createElement("div",{className:"col-sm-9"},o.a.createElement("h4",null,L&&!W&&o.a.createElement("a",{href:"/schoolsView/"+L},"\u5b66\u6821",L+"-"),we&&"\u5411\u8363\u652f\u6301","\u9879\u76ee\u5217\u8868(\u603b\u6570\uff1a",ue,")"),o.a.createElement("div",{className:"input-group mb-3 "},o.a.createElement("input",{type:"text",className:"form-control mr-2",placeholder:"\u9879\u76ee\u540d\u79f0",value:k,onChange:function(e){var t=e.target.value;N(t)}}),o.a.createElement("input",{type:"text",readonly:"",className:"form-control ml-2",placeholder:"\u9879\u76ee\u5e74\u4efd",value:U}),o.a.createElement(m.a,{yearArray:["2019","2020"],value:U,onSelect:function(e){V(e)},hideInput:!0,minRange:1995,maxRange:2022}),!W&&o.a.createElement("input",{type:"text",className:"form-control ml-2",placeholder:"\u5b66\u6821\u7f16\u53f7",value:x,onChange:function(e){var t=e.target.value;R(t)}}),o.a.createElement("select",{className:"form-control ml-2",placeholder:"....",value:B,onChange:function(e){var t=e.target.value;D(t)}},o.a.createElement("option",{value:""},"\u7701/\u81ea\u6cbb\u533a"),ye.map((function(e){return o.a.createElement("option",{value:e},e)}))),o.a.createElement("div",null,o.a.createElement("button",{className:"btn btn-primary ml-2",type:"button",onClick:function(e){N(""),R(""),D(""),V(""),fe([]),f([])}},"\u6e05\u7a7a"))),o.a.createElement("div",{className:"input-group mb-4"},o.a.createElement("div",null,o.a.createElement("button",{className:"btn btn-primary ",type:"button",onClick:function(){Z(1),Ne()}},"\u67e5\u8be2")),o.a.createElement("div",{hidden:!j},o.a.createElement("button",{className:"btn btn-primary ml-2",type:"button",onClick:function(){var e=ke(!0);c.a.getAll2(e).then((function(e){var t=e.data,a=t.projects;t.totalPages,t.totalItems;f(a),console.log(e.data);var n=c.a.exportCSV(a,Ie),r=window.URL.createObjectURL(new Blob([n])),s=document.createElement("a");s.href=r,s.setAttribute("download","project.csv"),document.body.appendChild(s),s.click(),s.remove()})).catch((function(e){console.log(e)}))}},"\u5bfc\u51fa")))),o.a.createElement("div",{className:"mt-3 col-sm-3"},"\u6bcf\u9875\u663e\u793a\u884c\u6570: ",o.a.createElement("select",{onChange:Ue,value:oe},me.map((function(e){return o.a.createElement("option",{key:e,value:e},e)}))),o.a.createElement(i.a,{className:"my-3",count:ae,page:K,siblingCount:1,boundaryCount:1,variant:"outlined",shape:"rounded",onChange:Te})),o.a.createElement("div",{class:"w-100"}),o.a.createElement("div",{className:"col-sm-12 list"},o.a.createElement("table",Object.assign({className:"table table-striped table-bordered"},Re()),o.a.createElement("thead",null,Ae.map((function(e){return o.a.createElement("tr",e.getHeaderGroupProps(),e.headers.map((function(e){return o.a.createElement("th",e.getHeaderProps(e.getSortByToggleProps()),e.render("Header"),o.a.createElement("span",null,"school.region"===e.id||"school.code"===e.id||"school.name"===e.id||"startAt"===e.id||"status"===e.id||"name"===e.id?e.isSortedDesc?" \ud83d\udd3d":" \ud83d\udd3c":""))})))}))),o.a.createElement("tbody",Fe(),Be.map((function(e,t){return De(e),o.a.createElement("tr",e.getRowProps(),e.cells.map((function(e){return o.a.createElement("td",e.getCellProps(),e.render("Cell"))})))}))))),o.a.createElement("div",{className:"mt-3 col-sm-"},"\u6bcf\u9875\u663e\u793a\u884c\u6570: ",o.a.createElement("select",{onChange:Ue,value:oe},me.map((function(e){return o.a.createElement("option",{key:e,value:e},e)}))),o.a.createElement(i.a,{className:"my-3",count:ae,page:K,siblingCount:1,boundaryCount:1,variant:"outlined",shape:"rounded",onChange:Te})))}},8:function(e,t,a){"use strict";var n=a(12),r=a(13),s=a(28),o=a.n(s),c=a(5),l="/api/auth/",i=function(){function e(){Object(n.a)(this,e)}return Object(r.a)(e,[{key:"login",value:function(e,t){return o.a.post(l+"signin",{username:e,password:t})}},{key:"reset",value:function(e,t){return o.a.post(l+"reset",{email:e,password:t})}},{key:"findByEmail",value:function(e){return o.a.post(l+"findByEmail",{email:e})}},{key:"logout",value:function(){if(localStorage.getItem("user")){var e=JSON.parse(localStorage.getItem("user")).username;return localStorage.removeItem("user"),o.a.post(l+"signout",{username:e}).then((function(e){return e.data})).catch((function(e){console.log(e)}))}}},{key:"register",value:function(e,t,a,n,r,s,c,i,u,d){return o.a.post(l+"signup",{username:e,email:t,password:a,roles:n,schoolId:r,chineseName:s,phone:c,wechat:i,startAt:u,title:d})}},{key:"createContactOnly",value:function(e){return o.a.post(l+"createContactOnly",e,{headers:Object(c.a)()})}},{key:"updateContactOnly",value:function(e,t){return o.a.put(l+"users/updateContactOnly/"+"".concat(e),t,{headers:Object(c.a)()})}},{key:"getCurrentUser",value:function(){return JSON.parse(localStorage.getItem("user"))}},{key:"isValid",value:function(){if(!localStorage.getItem("user"))return!1;var e=JSON.parse(localStorage.getItem("user"));return!e.thisLogin||!e.validity||e.thisLogin+e.validity>Math.floor(Date.now()/1e3)}},{key:"getRoles",value:function(){return o.a.get(l+"roles")}},{key:"getAll2",value:function(e){return o.a.post(l+"users",e,{headers:Object(c.a)()})}},{key:"getAllSimple",value:function(e){return o.a.post(l+"usersSimple",e,{headers:Object(c.a)()})}},{key:"delete",value:function(e){return o.a.delete(l+"users/"+"".concat(e),{headers:Object(c.a)()})}},{key:"get",value:function(e){return o.a.get(l+"users/"+"".concat(e),{headers:Object(c.a)()})}},{key:"update",value:function(e,t){return o.a.put(l+"users/update/"+"".concat(e),t,{headers:Object(c.a)()})}},{key:"getUserTitles",value:function(){return o.a.get(l+"userTitles")}}]),e}();t.a=new i},80:function(e,t,a){"use strict";var n=a(21),r=a(1),s=a(0),o=a.n(s),c=a(57),l=a(10),i=a(95),u=a(17);t.a=function(e){var t=Object(s.useState)([]),a=Object(r.a)(t,2),d=a[0],m=a[1],h=Object(s.useState)(null),p=Object(r.a)(h,2),g=(p[0],p[1],Object(s.useState)(-1)),f=Object(r.a)(g,2),b=(f[0],f[1],Object(s.useState)("")),v=Object(r.a)(b,2),y=v[0],E=v[1],j=Object(s.useState)(e.match?e.match.params.schoolId:e.schoolId),C=Object(r.a)(j,2),O=C[0],S=(C[1],Object(s.useState)(e.match?e.match.params.docCategory:e.docCategory)),w=Object(r.a)(S,2),k=w[0],N=(w[1],Object(s.useState)(!!e.readonly&&e.readonly)),I=Object(r.a)(N,2),P=I[0],x=(I[1],Object(s.useState)(!!e.embedded&&e.embedded)),R=Object(r.a)(x,2),F=R[0],A=(R[1],Object(s.useRef)());A.current=d;var B=Object(s.useState)(1),D=Object(r.a)(B,2),H=D[0],T=D[1],U=Object(s.useState)(0),V=Object(r.a)(U,2),q=V[0],G=V[1],L=Object(s.useState)(5),_=Object(r.a)(L,2),M=_[0],W=_[1],J=function(){var e=function(){var e={};return y&&(e.originalname=y),H&&(e.page=H-1),M&&(e.size=M),O&&(e.schoolId=O),k&&(e.docCategory=k),e}();c.a.getAll2(e).then((function(e){var t=e.data,a=t.documents,n=t.totalPages;m(a),G(n),console.log(e.data)})).catch((function(e){console.log(e)}))};Object(s.useEffect)(J,[H,M]);var z=Object(s.useMemo)((function(){return[{Header:"\u65f6\u95f4",accessor:"createdAt",Cell:function(e){var t=e.row.id,a=new Date(A.current[t].createdAt);return o.a.createElement("div",null,a.toLocaleDateString("zh-cn",{hour12:!0,hour:"2-digit",minute:"2-digit",second:"2-digit"}))}},{Header:"\u6587\u6863\u540d",accessor:"originalname"},{Header:"\u7c7b\u522b",accessor:"docCategory"},{Header:"\u5b66\u6821",accessor:"school",disableSortBy:!0,Cell:function(e){var t=e.row.id;return o.a.createElement("div",null,o.a.createElement(l.b,{to:"/schoolsView/"+A.current[t].schoolId,className:"badge badge-success"},"\u70b9\u51fb\u67e5\u770b\u5b66\u6821"))}},{Header:"\u64cd\u4f5c",accessor:"actions",disableSortBy:!0,Cell:function(e){var t=e.row.id;return o.a.createElement("div",null,(A.current[t].mimetype.startsWith("image")||A.current[t].mimetype.indexOf("pdf")>0)&&o.a.createElement("a",{href:"#",onClick:function(){return te(A.current[t].id,A.current[t].originalname,A.current[t].mimetype,!0)}},o.a.createElement("i",{className:"fas fa-eye action mr-2"})),o.a.createElement("a",{href:"#",onClick:function(){return te(A.current[t].id,A.current[t].originalname,A.current[t].mimetype,!1)}},o.a.createElement("i",{className:"fas fa-download action mr-2"})),!P&&o.a.createElement("span",{onClick:function(){return window.confirm("\u60a8\u786e\u5b9a\u8981\u5220\u9664\u5417 ?")&&function(e){var t=A.current[e].id;c.a.delete(t).then((function(t){var a=Object(n.a)(A.current);a.splice(e,1),m(a)})).catch((function(e){console.log(e)}))}(t)}},o.a.createElement("i",{className:"fas fa-trash action"})))}}]}),[]),Y=F?["school"]:[],X=Object(u.useTable)({columns:z,data:d,disableSortRemove:!0,initialState:{hiddenColumns:Y,sortBy:[{id:"createdAt",desc:!1}]}},u.useSortBy),$=X.getTableProps,Q=X.getTableBodyProps,K=X.headerGroups,Z=X.rows,ee=X.prepareRow,te=function(e,t,a,n){c.a.getContent(e).then((function(e){console.log(e.data);var r=window.URL.createObjectURL(new Blob([e.data],{type:a})),s=document.createElement("a");s.href=r,n||s.setAttribute("download",t),document.body.appendChild(s),s.click(),s.remove()})).catch((function(e){alert(e),console.log(e)}))};return o.a.createElement("div",{className:"list row"},!F&&o.a.createElement("div",{className:"col-sm-8"},o.a.createElement("h4",null,"\u9644\u4ef6\u5217\u8868"),o.a.createElement("div",{className:"input-group mb-3"},o.a.createElement("input",{type:"text",className:"form-control",placeholder:"Search by originalname",value:y,onChange:function(e){var t=e.target.value;E(t)}}),o.a.createElement("div",{className:"input-group-append"},o.a.createElement("button",{className:"btn btn-outline-secondary",type:"button",onClick:function(){T(1),J()}},"Search"))),"\u6bcf\u9875\u663e\u793a\u884c\u6570: ",o.a.createElement("select",{onChange:function(e){W(e.target.value),T(1)},value:M},[5,10,20].map((function(e){return o.a.createElement("option",{key:e,value:e},e)}))),o.a.createElement(i.a,{className:"my-3",count:q,page:H,siblingCount:1,boundaryCount:1,variant:"outlined",shape:"rounded",onChange:function(e,t){T(t)}})),o.a.createElement("div",{className:"col-sm-12 list"},o.a.createElement("table",Object.assign({className:"table table-striped table-bordered"},$()),o.a.createElement("thead",null,K.map((function(e){return o.a.createElement("tr",e.getHeaderGroupProps(),e.headers.map((function(e){return o.a.createElement("th",e.getHeaderProps(e.getSortByToggleProps()),e.render("Header"),o.a.createElement("span",null,e.isSorted?e.isSortedDesc?" \ud83d\udd3d":" \ud83d\udd3c":""))})))}))),o.a.createElement("tbody",Q(),Z.map((function(e,t){return ee(e),o.a.createElement("tr",e.getRowProps(),e.cells.map((function(e){return o.a.createElement("td",e.getCellProps(),e.render("Cell"))})))}))))),o.a.createElement("div",{className:"col-sm-8"}))}},88:function(e,t,a){"use strict";a.d(t,"a",(function(){return v}));var n=a(50),r=a(3),s=a(12),o=a(13),c=a(6),l=a(26),i=a(25),u=a(0),d=a.n(u),m=(a(96),a(20),a(10)),h=a(46),p=a(8),g=a(37),f=a(15),b=a(57),v=(a(34),function(e){Object(l.a)(a,e);var t=Object(i.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).onChangeGenerics=n.onChangeGenerics.bind(Object(c.a)(n)),n.getSurvey=n.getSurvey.bind(Object(c.a)(n)),n.updateSurvey=n.updateSurvey.bind(Object(c.a)(n)),n.deleteSurvey=n.deleteSurvey.bind(Object(c.a)(n)),n.onChangeDocFiles=n.onChangeDocFiles.bind(Object(c.a)(n)),n.onChangeSchoolId=n.onChangeSchoolId.bind(Object(c.a)(n)),n.onChangePrincipalId=n.onChangePrincipalId.bind(Object(c.a)(n)),n.onChangeContactId=n.onChangeContactId.bind(Object(c.a)(n)),n.saveSurvey=n.saveSurvey.bind(Object(c.a)(n)),n.newSurvey=n.newSurvey.bind(Object(c.a)(n)),n.state={currentSurvey:{id:null,schoolId:null,docFiles:[],docCategory:"",status:"",request:"",category:"",principal:"",principalCell:null,principalWechat:null,contact:"",contactCell:null,contactWechat:null,schoolBoard:null,schoolBoardRegisteredName:null,region:"",city:"",county:"",community:"",address:"",phone:"",email:"",studentsCount:0,teachersCount:0,description:"",principalId:null,contactId:null,stayBehindCount:0,boarderCount:0,kClassesCount:0,g1ClassesCount:0,g2ClassesCount:0,g3ClassesCount:0,g4ClassesCount:0,g5ClassesCount:0,g6ClassesCount:0,kStudentsCount:0,g1StudentsCount:0,g2StudentsCount:0,g3StudentsCount:0,g4StudentsCount:0,g5StudentsCount:0,g6StudentsCount:0,mStudentsCount:0,computersCount:0,computerRoomExists:!1,computerRoomCount:0,internetExists:!1,multimediaSystemsCount:0,libraryExists:!1,bookCornersCount:0,booksCount:0},embedded:!1,newsurvey:!0,readonly:!0,regions:[],docCategories:[],users:[],schools:[],stages:[],statuses:[],requests:[],categories:[],message:"",submitted:!1},n}return Object(o.a)(a,[{key:"componentDidMount",value:function(){var e=window.location.pathname.includes("add");this.setState({newsurvey:e});var t=this.props.match?this.props.match.params.readonly:this.props.readonly;this.setState({readonly:t});var a=this.props.match?this.props.match.params.schoolId:this.props.schoolId,n=this.props.match?this.props.match.params.id:this.props.id;a=a||n,this.setState((function(e){return{currentSurvey:Object(r.a)(Object(r.a)({},e.currentSurvey),{},{schoolId:a})}}));var s=this.props.match?this.props.match.params.embedded:this.props.embedded;this.setState({embedded:s}),e||this.getSurvey(a),this.getSchools(),this.getRegions(),this.getDocCategories(),this.getCategories(),this.getRequests(),this.getStatuses(),this.getStages(),this.getUsers(a)}},{key:"convertUser",value:function(e){var t=[];if(e){for(var a=0;a<e.length;a++)t.push({value:e[a].id,label:e[a].chineseName});return t}}},{key:"displayUser",value:function(e){if(this.state.users){for(var t=0;t<this.state.users.length;t++)if(this.state.users[t].value==e)return this.state.users[t];return[]}}},{key:"displayNameUser",value:function(e){if(this.state.users){for(var t=0;t<this.state.users.length;t++)if(this.state.users[t].value==e)return this.state.users[t].label?this.state.users[t].label:"\u4e2d\u6587\u540d";return""}}},{key:"displayNameSchool",value:function(e){if(this.state.schools){for(var t=0;t<this.state.schools.length;t++)if(this.state.schools[t].value==e)return this.state.schools[t].label?this.state.schools[t].label:"\u5b66\u6821\u540d";return""}}},{key:"getUsers",value:function(e){var t=this;p.a.getAllSimple({schoolId:e}).then((function(e){t.setState({users:t.convertUser(e.data)}),console.log(e)})).catch((function(e){console.log(e)}))}},{key:"getSchools",value:function(){var e=this;f.a.getAllSimple().then((function(t){e.setState({schools:e.convert(t.data)}),console.log(t)})).catch((function(e){console.log(e)}))}},{key:"getCategories",value:function(){var e=this;f.a.getCategories().then((function(t){e.setState({categories:t.data}),console.log(t)})).catch((function(e){console.log(e)}))}},{key:"getRequests",value:function(){var e=this;f.a.getRequests().then((function(t){e.setState({requests:t.data}),console.log(t)})).catch((function(e){console.log(e)}))}},{key:"getStatuses",value:function(){var e=this;f.a.getStatuses().then((function(t){e.setState({statuses:t.data}),console.log(t)})).catch((function(e){console.log(e)}))}},{key:"getStages",value:function(){var e=this;f.a.getStages().then((function(t){e.setState({stages:t.data}),console.log(t)})).catch((function(e){console.log(e)}))}},{key:"getRegions",value:function(){var e=this;f.a.getRegions().then((function(t){e.setState({regions:t.data}),console.log(t)})).catch((function(e){console.log(e)}))}},{key:"getDocCategories",value:function(){var e=this;b.a.getDocCategories().then((function(t){e.setState({docCategories:t.data}),console.log(t)})).catch((function(e){console.log(e)}))}},{key:"display",value:function(e){if(this.state.schools){for(var t=0;t<this.state.schools.length;t++)if(this.state.schools[t].value==e)return this.state.schools[t];return[]}}},{key:"convert",value:function(e){var t=[];if(e){for(var a=0;a<e.length;a++)t.push({value:e[a].id,label:e[a].code+"-"+e[a].name+"-"+e[a].region});return t}}},{key:"onChangeSchoolId",value:function(e){var t=e.value;this.setState((function(e){return{currentSurvey:Object(r.a)(Object(r.a)({},e.currentSurvey),{},{schoolId:t})}}))}},{key:"onChangePrincipalId",value:function(e){this.setState((function(t){return{currentSurvey:Object(r.a)(Object(r.a)({},t.currentSurvey),{},{principalId:e.value})}}))}},{key:"onChangeContactId",value:function(e){this.setState((function(t){return{currentSurvey:Object(r.a)(Object(r.a)({},t.currentSurvey),{},{contactId:e.value})}}))}},{key:"onChangeGenerics",value:function(e){var t=e.target.name,a="checkbox"===e.target.type?e.target.checked:e.target.value;this.setState((function(e){return{currentSurvey:Object(r.a)(Object(r.a)({},e.currentSurvey),{},Object(n.a)({},t,a))}}))}},{key:"getSurvey",value:function(e){var t=this;g.a.get(e).then((function(e){t.setState({currentSurvey:e.data}),console.log(e.data)})).catch((function(e){console.log(e)}))}},{key:"newSurvey",value:function(){this.setState((function(e){return{currentSurvey:Object(r.a)(Object(r.a)({},e.currentSurvey),{},{id:null,name:"",code:"",description:"",principal:"",region:"",address:"",phone:"",studentsCount:0,teachersCount:0,docFiles:[],docCategory:"",stage:"",status:"",request:"",category:""}),submitted:!1}}))}},{key:"saveSurvey",value:function(){var e=this;g.a.create(this.state.currentSurvey).then((function(t){e.setState((function(e){return{currentSurvey:Object(r.a)(Object(r.a)({},e.currentSurvey),{},{id:t.data.id}),message:"\u5b66\u6821\u4fe1\u606f\u6210\u529f\u63d0\u4ea4!",submitted:!0}})),e.state.currentSurvey.docFiles&&e.uploadDocuments(),console.log(t.data)})).catch((function(t){var a=t.response&&t.response.data&&t.response.data.message||t.message||t.toString();e.setState({message:"\u5b66\u6821\u4fe1\u606f\u4fdd\u5b58\u5931\u8d25! "+a}),console.log(t)}))}},{key:"updateSurvey",value:function(){var e=this;g.a.update(this.state.currentSurvey.schoolId,this.state.currentSurvey).then((function(t){console.log(t.data),e.state.currentSurvey.docFiles&&e.uploadDocuments(),e.setState({message:"\u5b66\u6821\u4fe1\u606f\u6210\u529f\u4fee\u6539!",submitted:!0})})).catch((function(t){var a=t.response&&t.response.data&&t.response.data.message||t.message||t.toString();e.setState({message:"\u5b66\u6821\u4fe1\u606f\u4fee\u6539\u5931\u8d25! "+a}),console.log(t)}))}},{key:"uploadDocuments",value:function(){for(var e=this,t=new FormData,a=0;a<this.state.currentSurvey.docFiles.length;a++)t.append("multi-files",this.state.currentSurvey.docFiles[a],this.state.currentSurvey.docFiles[a].name);t.append("docCategory",this.state.currentSurvey.docCategory),f.a.uploadDocuments(this.state.currentSurvey.schoolId,t).then((function(t){e.setState((function(e){return{message:e.message+" \u5b66\u6821\u4fe1\u606f\u9644\u4ef6\u6210\u529f\u4e0a\u4f20!"}})),console.log(t.data)})).catch((function(e){console.log(e)}))}},{key:"deleteSurvey",value:function(){var e=this;g.a.delete(this.state.currentSurvey.id).then((function(t){console.log(t.data),e.props.history.push("/surveys")})).catch((function(e){console.log(e)}))}},{key:"onChangeDocFiles",value:function(e){e.preventDefault();var t=e.target.files;this.setState((function(e){return{currentSurvey:Object(r.a)(Object(r.a)({},e.currentSurvey),{},{docFiles:t})}}))}},{key:"renderUpdates",value:function(){return d.a.createElement("div",null,d.a.createElement("button",{className:"badge badge-danger mr-2",onClick:this.deleteSurvey},"Delete"),d.a.createElement("button",{type:"submit",className:"badge badge-success",onClick:this.updateSurvey},"Update"),d.a.createElement("p",null,this.state.message))}},{key:"render",value:function(){var e=this,t=this.state.currentSurvey;return d.a.createElement("div",null,this.state.submitted?d.a.createElement("div",null,d.a.createElement("h4",null,this.state.message),d.a.createElement("a",{href:"/surveysView/"+t.schoolId,class:"btn btn-success"},"\u8fd4\u56de")):d.a.createElement("div",{class:"row"},d.a.createElement("div",{class:"col-sm-3"},d.a.createElement("div",{class:"row"},!this.state.embedded&&d.a.createElement("div",null,d.a.createElement("h4",null,"\u5b66\u6821\u8be6\u60c5"),d.a.createElement("div",{class:"form-group"},d.a.createElement("label",{htmlFor:"schoolId"},"\u5b66\u6821"),d.a.createElement(m.b,{to:"/schoolsView/"+t.schoolId,id:"schoolId",name:"schoolId",target:"_blank"},this.displayNameSchool(t.schoolId))),d.a.createElement("div",{class:"form-group"},d.a.createElement("label",{htmlFor:"schoolBoardRegisteredName"},"\u6559\u80b2\u5c40\u6821\u540d"),d.a.createElement("textarea",{readonly:!!this.state.readonly&&"",cols:"31",class:"form-control",id:"schoolBoardRegisteredName",required:!0,value:t.schoolBoardRegisteredName,onChange:this.onChangeGenerics,name:"schoolBoardRegisteredName"})),d.a.createElement("div",{class:"form-group"},d.a.createElement("label",{htmlFor:"schoolBoard"},"\u6559\u80b2\u5c40"),d.a.createElement("textarea",{readonly:!!this.state.readonly&&"",cols:"31",class:"form-control",id:"schoolBoard",required:!0,value:t.schoolBoard,onChange:this.onChangeGenerics,name:"schoolBoard"})),d.a.createElement("form",{ref:"formToSubmit",action:"http://localhost:8080/api/documents-upload",method:"POST",enctype:"multipart/form-data"},d.a.createElement("div",{class:"form-group input-group"},d.a.createElement("label",{for:"input-multi-files"},"\u4e0a\u4f20\u6587\u4ef6:"),d.a.createElement("input",{type:"file",name:"multi-files",multiple:!0,id:"input-multi-files",class:"form-control-file border",onChange:function(t){return e.onChangeDocFiles(t)}}),d.a.createElement("select",{className:"form-control input-group-append",placeholder:"",name:"docCategory",id:"docCategory",value:t.docCategory,onChange:function(t){return e.onChangeGenerics(t)}},d.a.createElement("option",{value:""},"\u9644\u4ef6\u7c7b\u522b"),this.state.docCategories.map((function(e){return d.a.createElement("option",{value:e},e)}))),d.a.createElement("input",{type:"hidden",name:"surveyId",id:"surveyId"}))),d.a.createElement("div",{class:"w-100"}),d.a.createElement("button",{onClick:this.saveSurvey,class:"btn btn-success",hidden:!this.state.newsurvey},"\u63d0\u4ea4"),d.a.createElement("button",{hidden:this.state.newsurvey,type:"submit",className:"btn btn-success",onClick:this.updateSurvey},"\u66f4\u65b0"),d.a.createElement("p",null,this.state.message)),d.a.createElement("div",{class:"w-100"}))),d.a.createElement("div",{class:"col-md-9"},!this.state.embedded&&d.a.createElement("div",{class:"row"},d.a.createElement("div",{class:"w-100"}),d.a.createElement("div",{class:"col-md-4"}),d.a.createElement("div",{class:"select-container form-group col-md-4"},d.a.createElement("label",{htmlFor:"status"},"\u5b66\u6821\u72b6\u6001"),d.a.createElement("select",{readonly:!!this.state.readonly&&"",class:"form-control",id:"status",required:!0,value:t.status,onChange:this.onChangeGenerics,name:"status"},d.a.createElement("option",{value:""},this.state.readonly?"":"\u8bf7\u9009\u62e9"),this.state.statuses.map((function(e){return d.a.createElement("option",{value:e},e)})))),d.a.createElement("div",{class:"select-container form-group col-md-4"},d.a.createElement("label",{htmlFor:"request"},"\u5b66\u6821\u9700\u6c42\u72b6\u6001"),d.a.createElement("select",{readonly:!!this.state.readonly&&"",class:"form-control",id:"request",required:!0,value:t.request,onChange:this.onChangeGenerics,name:"request"},d.a.createElement("option",{value:""},this.state.readonly?"":"\u8bf7\u9009\u62e9"),this.state.requests.map((function(e){return d.a.createElement("option",{value:e},e)})))),d.a.createElement("div",{class:"w-100"}),d.a.createElement("div",{class:"select-container form-group col-md-3"},d.a.createElement("label",{htmlFor:"region"},"\u7701/\u81ea\u6cbb\u533a/\u76f4\u8f96\u5e02"),d.a.createElement("select",{readonly:!!this.state.readonly&&"",class:"form-control",id:"region",required:!0,value:t.region,onChange:this.onChangeGenerics,name:"region"},d.a.createElement("option",{value:""},this.state.readonly?"":"\u8bf7\u9009\u62e9"),this.state.regions.map((function(e){return d.a.createElement("option",{value:e},e)})))),d.a.createElement("div",{class:"form-group col-md-3"},d.a.createElement("label",{htmlFor:"city"},"\u5e02"),d.a.createElement("input",{readonly:!!this.state.readonly&&"",type:"text",class:"form-control",id:"city",required:!0,value:t.city,onChange:this.onChangeGenerics,name:"city"})),d.a.createElement("div",{class:"form-group col-md-3"},d.a.createElement("label",{htmlFor:"county"},"\u533a/\u53bf"),d.a.createElement("input",{readonly:!!this.state.readonly&&"",type:"text",class:"form-control",id:"county",required:!0,value:t.county,onChange:this.onChangeGenerics,name:"county"})),d.a.createElement("div",{class:"form-group col-md-3"},d.a.createElement("label",{htmlFor:"community"},"\u4e61/\u9547"),d.a.createElement("input",{readonly:!!this.state.readonly&&"",type:"text",class:"form-control",id:"community",required:!0,value:t.community,onChange:this.onChangeGenerics,name:"community"})),d.a.createElement("div",{class:"form-group col-md-12"},d.a.createElement("label",{htmlFor:"address"},"\u5730\u5740"),d.a.createElement("input",{readonly:!!this.state.readonly&&"",type:"text",class:"form-control",id:"address",required:!0,value:t.address,onChange:this.onChangeGenerics,name:"address"})),d.a.createElement("div",{class:"w-100"}),d.a.createElement("div",{class:"form-group col-md-5"},d.a.createElement("label",{htmlFor:"phone"},"\u5b66\u6821\u7535\u8bdd"),d.a.createElement("input",{readonly:!!this.state.readonly&&"",type:"text",class:"form-control",id:"phone",required:!0,value:t.phone,onChange:this.onChangeGenerics,name:"phone"})),d.a.createElement("div",{class:"form-group col-md-5"},d.a.createElement("label",{htmlFor:"email"},"\u5b66\u6821\u7535\u5b50\u90ae\u7bb1"),d.a.createElement("input",{readonly:!!this.state.readonly&&"",type:"text",class:"form-control",id:"email",required:!0,value:t.email,onChange:this.onChangeGenerics,name:"email"})),d.a.createElement("div",{class:"w-100"}),d.a.createElement("div",{class:"form-group col-md-4"},d.a.createElement("label",{htmlFor:"studentsCount"},"\u5b66\u751f\u4eba\u6570"),d.a.createElement("input",{readonly:!!this.state.readonly&&"",type:"number",class:"form-control",id:"studentsCount",required:!0,value:t.studentsCount,onChange:this.onChangeGenerics,name:"studentsCount"})),d.a.createElement("div",{class:"form-group col-md-4"},d.a.createElement("label",{htmlFor:"teachersCount"},"\u6559\u5e08\u4eba\u6570"),d.a.createElement("input",{readonly:!!this.state.readonly&&"",type:"number",class:"form-control",id:"teachersCount",required:!0,value:t.teachersCount,onChange:this.onChangeGenerics,name:"teachersCount"})),d.a.createElement("div",{class:"select-container form-group col-md-4"},d.a.createElement("label",{htmlFor:"category"},"\u5b66\u6821\u7c7b\u578b"),d.a.createElement("select",{readonly:!!this.state.readonly&&"",class:"form-control",id:"category",required:!0,value:t.category,onChange:this.onChangeGenerics,name:"category"},d.a.createElement("option",{value:""},this.state.readonly?"":"\u8bf7\u9009\u62e9"),this.state.categories.map((function(e){return d.a.createElement("option",{value:e},e)})))),d.a.createElement("div",{class:"w-100"}),d.a.createElement("div",{class:"form-group col-md-4"},d.a.createElement("label",{htmlFor:"principalId"},"\u6821\u957f"),this.state.readonly?d.a.createElement(m.b,{to:"/usersView/"+t.principalId,id:"principalId",name:"principalId"},this.displayNameUser(t.principalId)):d.a.createElement(h.a,{onChange:this.onChangePrincipalId.bind(this),readonly:!!this.state.readonly&&"",class:"form-control",id:"principalId",value:this.displayUser(t.principalId),name:"principalId",options:this.state.users})),d.a.createElement("div",{class:"form-group col-md-4"},d.a.createElement("label",{htmlFor:"contactId"},"\u8054\u7edc\u4eba"),this.state.readonly?d.a.createElement(m.b,{to:"/usersView/"+t.contactId,id:"contactId",name:"contactId"},this.displayNameUser(t.contactId)):d.a.createElement(h.a,{onChange:this.onChangeContactId.bind(this),readonly:!!this.state.readonly&&"",class:"form-control",id:"contactId",value:this.displayUser(t.contactId),name:"contactId",options:this.state.users})),d.a.createElement("div",{class:"w-100"}),d.a.createElement("div",{class:"form-group col-md-12"},d.a.createElement("label",{htmlFor:"description"},"\u7b80\u4ecb"),d.a.createElement("textarea",{readonly:!!this.state.readonly&&"",class:"form-control",id:"description",required:!0,value:t.description,onChange:this.onChangeGenerics,name:"description"}))),d.a.createElement("div",{class:"row"},d.a.createElement("div",{class:"w-100"}),d.a.createElement("div",{class:"form-group col-md-2"},d.a.createElement("label",{htmlFor:"stayBehindCount"},"\u7559\u5b88\u513f\u7ae5\u4eba\u6570"),d.a.createElement("input",{readonly:!!this.state.readonly&&"",type:"number",class:"form-control",id:"stayBehindCount",required:!0,value:t.stayBehindCount,onChange:this.onChangeGenerics,name:"stayBehindCount"})),d.a.createElement("div",{class:"form-group col-md-2"},d.a.createElement("label",{htmlFor:"boarderCount"},"\u5b66\u751f\u4f4f\u5bbf\u4eba\u6570"),d.a.createElement("input",{readonly:!!this.state.readonly&&"",type:"number",class:"form-control",id:"boarderCount",required:!0,value:t.boarderCount,onChange:this.onChangeGenerics,name:"boarderCount"})),d.a.createElement("div",{class:"form-group col-md-2"},d.a.createElement("label",{htmlFor:"kClassesCount"},"\u5b66\u524d\u73ed\u7ea7\u6570"),d.a.createElement("input",{readonly:!!this.state.readonly&&"",type:"number",class:"form-control",id:"kClassesCount",required:!0,value:t.kClassesCount,onChange:this.onChangeGenerics,name:"kClassesCount"})),d.a.createElement("div",{class:"form-group col-md-2"},d.a.createElement("label",{htmlFor:"kStudentsCount"},"\u5b66\u524d\u5b66\u751f\u6570"),d.a.createElement("input",{readonly:!!this.state.readonly&&"",type:"number",class:"form-control",id:"kStudentsCount",required:!0,value:t.kStudentsCount,onChange:this.onChangeGenerics,name:"kStudentsCount"})),d.a.createElement("div",{class:"form-group col-md-2"},d.a.createElement("label",{htmlFor:"mStudentsCount"},"\u521d\u4e2d\u5b66\u751f\u6570"),d.a.createElement("input",{readonly:!!this.state.readonly&&"",type:"number",class:"form-control",id:"mStudentsCount",required:!0,value:t.mStudentsCount,onChange:this.onChangeGenerics,name:"mStudentsCount"})),d.a.createElement("div",{class:"w-100"}),d.a.createElement("div",{class:"form-group col-md-2"},d.a.createElement("label",{htmlFor:"g1ClassesCount"},"\u4e00\u5e74\u7ea7\u73ed\u7ea7\u6570"),d.a.createElement("input",{readonly:!!this.state.readonly&&"",type:"number",class:"form-control",id:"g1ClassesCount",required:!0,value:t.g1ClassesCount,onChange:this.onChangeGenerics,name:"g1ClassesCount"})),d.a.createElement("div",{class:"form-group col-md-2"},d.a.createElement("label",{htmlFor:"g2ClassesCount"},"\u4e8c\u5e74\u7ea7\u73ed\u7ea7\u6570"),d.a.createElement("input",{readonly:!!this.state.readonly&&"",type:"number",class:"form-control",id:"g2ClassesCount",required:!0,value:t.g2ClassesCount,onChange:this.onChangeGenerics,name:"g2ClassesCount"})),d.a.createElement("div",{class:"form-group col-md-2"},d.a.createElement("label",{htmlFor:"g3ClassesCount"},"\u4e09\u5e74\u7ea7\u73ed\u7ea7\u6570"),d.a.createElement("input",{readonly:!!this.state.readonly&&"",type:"number",class:"form-control",id:"g3ClassesCount",required:!0,value:t.g3ClassesCount,onChange:this.onChangeGenerics,name:"g3ClassesCount"})),d.a.createElement("div",{class:"form-group col-md-2"},d.a.createElement("label",{htmlFor:"g4ClassesCount"},"\u56db\u5e74\u7ea7\u73ed\u7ea7\u6570"),d.a.createElement("input",{readonly:!!this.state.readonly&&"",type:"number",class:"form-control",id:"g4ClassesCount",required:!0,value:t.g4ClassesCount,onChange:this.onChangeGenerics,name:"g4ClassesCount"})),d.a.createElement("div",{class:"form-group col-md-2"},d.a.createElement("label",{htmlFor:"g5ClassesCount"},"\u4e94\u5e74\u7ea7\u73ed\u7ea7\u6570"),d.a.createElement("input",{readonly:!!this.state.readonly&&"",type:"number",class:"form-control",id:"g5ClassesCount",required:!0,value:t.g5ClassesCount,onChange:this.onChangeGenerics,name:"g5ClassesCount"})),d.a.createElement("div",{class:"form-group col-md-2"},d.a.createElement("label",{htmlFor:"g6ClassesCount"},"\u516d\u5e74\u7ea7\u73ed\u7ea7\u6570"),d.a.createElement("input",{readonly:!!this.state.readonly&&"",type:"number",class:"form-control",id:"g6ClassesCount",required:!0,value:t.g6ClassesCount,onChange:this.onChangeGenerics,name:"g6ClassesCount"})),d.a.createElement("div",{class:"w-100"}),d.a.createElement("div",{class:"form-group col-md-2"},d.a.createElement("label",{htmlFor:"g1StudentsCount"},"\u4e00\u5e74\u7ea7\u5b66\u751f\u6570"),d.a.createElement("input",{readonly:!!this.state.readonly&&"",type:"number",class:"form-control",id:"g1StudentsCount",required:!0,value:t.g1StudentsCount,onChange:this.onChangeGenerics,name:"g1StudentsCount"})),d.a.createElement("div",{class:"form-group col-md-2"},d.a.createElement("label",{htmlFor:"g2StudentsCount"},"\u4e8c\u5e74\u7ea7\u5b66\u751f\u6570"),d.a.createElement("input",{readonly:!!this.state.readonly&&"",type:"number",class:"form-control",id:"g2StudentsCount",required:!0,value:t.g2StudentsCount,onChange:this.onChangeGenerics,name:"g2StudentsCount"})),d.a.createElement("div",{class:"form-group col-md-2"},d.a.createElement("label",{htmlFor:"g3StudentsCount"},"\u4e09\u5e74\u7ea7\u5b66\u751f\u6570"),d.a.createElement("input",{readonly:!!this.state.readonly&&"",type:"number",class:"form-control",id:"g3StudentsCount",required:!0,value:t.g3StudentsCount,onChange:this.onChangeGenerics,name:"g3StudentsCount"})),d.a.createElement("div",{class:"form-group col-md-2"},d.a.createElement("label",{htmlFor:"g4StudentsCount"},"\u56db\u5e74\u7ea7\u5b66\u751f\u6570"),d.a.createElement("input",{readonly:!!this.state.readonly&&"",type:"number",class:"form-control",id:"g4StudentsCount",required:!0,value:t.g4StudentsCount,onChange:this.onChangeGenerics,name:"g4StudentsCount"})),d.a.createElement("div",{class:"form-group col-md-2"},d.a.createElement("label",{htmlFor:"g5StudentsCount"},"\u4e94\u5e74\u7ea7\u5b66\u751f\u6570"),d.a.createElement("input",{readonly:!!this.state.readonly&&"",type:"number",class:"form-control",id:"g5StudentsCount",required:!0,value:t.g5StudentsCount,onChange:this.onChangeGenerics,name:"g5StudentsCount"})),d.a.createElement("div",{class:"form-group col-md-2"},d.a.createElement("label",{htmlFor:"g6StudentsCount"},"\u516d\u5e74\u7ea7\u5b66\u751f\u6570"),d.a.createElement("input",{readonly:!!this.state.readonly&&"",type:"number",class:"form-control",id:"g6StudentsCount",required:!0,value:t.g6StudentsCount,onChange:this.onChangeGenerics,name:"g6StudentsCount"})),d.a.createElement("div",{class:"form-group col-md-2"},d.a.createElement("label",{htmlFor:"internetExists"},"\u53ef\u5426\u4e0a\u7f51"),d.a.createElement("input",{disabled:!!this.state.readonly&&"disabled",type:"checkbox",class:"form-control",id:"internetExists",required:!0,checked:t.internetExists,onChange:this.onChangeGenerics,name:"internetExists"})),d.a.createElement("div",{class:"form-group col-md-2"},d.a.createElement("label",{htmlFor:"computerRoomExists"},"\u662f\u5426\u6709\u7535\u8111\u5ba4"),d.a.createElement("input",{disabled:!!this.state.readonly&&"disabled",type:"checkbox",class:"form-control",id:"computerRoomExists",required:!0,checked:t.computerRoomExists,onChange:this.onChangeGenerics,name:"computerRoomExists"})),d.a.createElement("div",{class:"form-group col-md-2"},d.a.createElement("label",{htmlFor:"computerRoomCount"},"\u7535\u8111\u5ba4\u7535\u8111\u6570"),d.a.createElement("input",{readonly:!!this.state.readonly&&"",type:"number",class:"form-control",id:"computerRoomCount",required:!0,value:t.computerRoomCount,onChange:this.onChangeGenerics,name:"computerRoomCount"})),d.a.createElement("div",{class:"form-group col-md-2"},d.a.createElement("label",{htmlFor:"computersCount"},"\u529e\u516c\u7535\u8111\u6570"),d.a.createElement("input",{readonly:!!this.state.readonly&&"",type:"number",class:"form-control",id:"computersCount",required:!0,value:t.computersCount,onChange:this.onChangeGenerics,name:"computersCount"})),d.a.createElement("div",{class:"form-group col-md-2"},d.a.createElement("label",{htmlFor:"multimediaSystemsCount"},"\u591a\u5a92\u4f53\u4e00\u4f53\u673a\u6570"),d.a.createElement("input",{readonly:!!this.state.readonly&&"",type:"number",class:"form-control",id:"multimediaSystemsCount",required:!0,value:t.multimediaSystemsCount,onChange:this.onChangeGenerics,name:"multimediaSystemsCount"})),d.a.createElement("div",{class:"w-100"}),d.a.createElement("div",{class:"form-group col-md-2"},d.a.createElement("label",{htmlFor:"libraryExists"},"\u662f\u5426\u6709\u56fe\u4e66\u5ba4"),d.a.createElement("input",{disabled:!!this.state.readonly&&"disabled",type:"checkbox",class:"form-control",id:"libraryExists",required:!0,checked:t.libraryExists,onChange:this.onChangeGenerics,name:"libraryExists"})),d.a.createElement("div",{class:"form-group col-md-2"},d.a.createElement("label",{htmlFor:"bookCornersCount"},"\u56fe\u4e66\u89d2\u6570\u91cf"),d.a.createElement("input",{readonly:!!this.state.readonly&&"",type:"number",class:"form-control",id:"bookCornersCount",required:!0,value:t.bookCornersCount,onChange:this.onChangeGenerics,name:"bookCornersCount"})),d.a.createElement("div",{class:"form-group col-md-2"},d.a.createElement("label",{htmlFor:"booksCount"},"\u56fe\u4e66\u518c\u6570"),d.a.createElement("input",{readonly:!!this.state.readonly&&"",type:"number",class:"form-control",id:"booksCount",required:!0,value:t.booksCount,onChange:this.onChangeGenerics,name:"booksCount"})))),d.a.createElement("div",{class:"w-100"})))}}]),a}(u.Component))},91:function(e,t,a){"use strict";var n=a(21),r=a(1),s=a(0),o=a.n(s),c=a(69),l=a(95),i=a(17);t.a=function(e){var t=Object(s.useState)([]),a=Object(r.a)(t,2),u=a[0],d=a[1],m=Object(s.useState)(null),h=Object(r.a)(m,2),p=(h[0],h[1],Object(s.useState)(-1)),g=Object(r.a)(p,2),f=(g[0],g[1],Object(s.useState)("")),b=Object(r.a)(f,2),v=b[0],y=b[1],E=Object(s.useState)(e.match?e.match.params.projectId:e.projectId),j=Object(r.a)(E,2),C=j[0],O=(j[1],Object(s.useState)(e.match?e.match.params.docCategory:e.docCategory)),S=Object(r.a)(O,2),w=S[0],k=(S[1],Object(s.useState)(!!e.readonly&&e.readonly)),N=Object(r.a)(k,2),I=N[0],P=(N[1],Object(s.useState)(!!e.embedded&&e.embedded)),x=Object(r.a)(P,2),R=x[0],F=(x[1],Object(s.useRef)());F.current=u;var A=Object(s.useState)(1),B=Object(r.a)(A,2),D=B[0],H=B[1],T=Object(s.useState)(0),U=Object(r.a)(T,2),V=U[0],q=U[1],G=Object(s.useState)(5),L=Object(r.a)(G,2),_=L[0],M=L[1],W=function(){var e=function(){var e={};return v&&(e.originalname=v),D&&(e.page=D-1),_&&(e.size=_),C&&(e.projectId=C),w&&(e.docCategory=w),e}();c.a.getAll2(e).then((function(e){var t=e.data,a=t.dossiers,n=t.totalPages;d(a),q(n),console.log(e.data)})).catch((function(e){console.log(e)}))};Object(s.useEffect)(W,[D,_]);var J=Object(s.useMemo)((function(){return[{Header:"\u65f6\u95f4",accessor:"createdAt",Cell:function(e){var t=e.row.id,a=new Date(F.current[t].createdAt);return o.a.createElement("div",null,a.toLocaleDateString("zh-cn",{hour12:!0,hour:"2-digit",minute:"2-digit",second:"2-digit"}))}},{Header:"\u6587\u6863\u540d",accessor:"originalname"},{Header:"\u7c7b\u522b",accessor:"docCategory"},{Header:"\u64cd\u4f5c",accessor:"actions",disableSortBy:!0,Cell:function(e){var t=e.row.id;return o.a.createElement("div",null,(F.current[t].mimetype.startsWith("image")||F.current[t].mimetype.indexOf("pdf")>0)&&o.a.createElement("a",{href:"#",onClick:function(){return Z(F.current[t].id,F.current[t].originalname,F.current[t].mimetype,!0)}},o.a.createElement("i",{className:"fas fa-eye action mr-2"})),o.a.createElement("a",{href:"#",onClick:function(){return Z(F.current[t].id,F.current[t].originalname,F.current[t].mimetype,!1)}},o.a.createElement("i",{className:"fas fa-download action mr-2"})),!I&&o.a.createElement("span",{onClick:function(){return window.confirm("\u60a8\u786e\u5b9a\u8981\u5220\u9664\u5417 ?")&&function(e){var t=F.current[e].id;c.a.delete(t).then((function(t){var a=Object(n.a)(F.current);a.splice(e,1),d(a)})).catch((function(e){console.log(e)}))}(t)}},o.a.createElement("i",{className:"fas fa-trash action"})))}}]}),[]),z=Object(i.useTable)({columns:J,data:u,disableSortRemove:!0},i.useSortBy),Y=z.getTableProps,X=z.getTableBodyProps,$=z.headerGroups,Q=z.rows,K=z.prepareRow,Z=function(e,t,a,n){c.a.getContent(e).then((function(e){console.log(e.data);var r=window.URL.createObjectURL(new Blob([e.data],{type:a})),s=document.createElement("a");s.href=r,n||s.setAttribute("download",t),document.body.appendChild(s),s.click(),s.remove()})).catch((function(e){alert(e),console.log(e)}))};return o.a.createElement("div",{className:"list row"},!R&&o.a.createElement("div",{className:"col-sm-8"},o.a.createElement("h4",null,"\u9644\u4ef6\u5217\u8868"),o.a.createElement("div",{className:"input-group mb-3"},o.a.createElement("input",{type:"text",className:"form-control",placeholder:"Search by originalname",value:v,onChange:function(e){var t=e.target.value;y(t)}}),o.a.createElement("div",{className:"input-group-append"},o.a.createElement("button",{className:"btn btn-outline-secondary",type:"button",onClick:function(){H(1),W()}},"Search"))),"\u6bcf\u9875\u663e\u793a\u884c\u6570: ",o.a.createElement("select",{onChange:function(e){M(e.target.value),H(1)},value:_},[5,10,20].map((function(e){return o.a.createElement("option",{key:e,value:e},e)}))),o.a.createElement(l.a,{className:"my-3",count:V,page:D,siblingCount:1,boundaryCount:1,variant:"outlined",shape:"rounded",onChange:function(e,t){H(t)}})),o.a.createElement("div",{className:"col-sm-12 list"},o.a.createElement("table",Object.assign({className:"table table-striped table-bordered"},Y()),o.a.createElement("thead",null,$.map((function(e){return o.a.createElement("tr",e.getHeaderGroupProps(),e.headers.map((function(e){return o.a.createElement("th",e.getHeaderProps(e.getSortByToggleProps()),e.render("Header"),o.a.createElement("span",null,e.isSorted?e.isSortedDesc?" \ud83d\udd3d":" \ud83d\udd3c":""))})))}))),o.a.createElement("tbody",X(),Q.map((function(e,t){return K(e),o.a.createElement("tr",e.getRowProps(),e.cells.map((function(e){return o.a.createElement("td",e.getCellProps(),e.render("Cell"))})))}))))),o.a.createElement("div",{className:"col-sm-8"}))}},92:function(e,t,a){"use strict";var n=a(21),r=a(1),s=a(0),o=a.n(s),c=a(12),l=a(13),i=a(4),u=a(5),d=new(function(){function e(){Object(c.a)(this,e)}return Object(l.a)(e,[{key:"getAll2",value:function(e){return i.a.post("/comments/all",e,{headers:Object(u.a)()})}},{key:"getAll",value:function(e){return i.a.get("/comments",{params:e},{headers:Object(u.a)()})}},{key:"get",value:function(e){return i.a.get("/comments/".concat(e),{headers:Object(u.a)()})}},{key:"getContent",value:function(e){var t=JSON.parse(localStorage.getItem("user"));return i.a.get("/commentsContent/".concat(e),{headers:{"x-access-token":t&&t.accessToken?t.accessToken:null},responseType:"arraybuffer"})}},{key:"getDocCategories",value:function(){return i.a.get("/comments/categories",{headers:Object(u.a)()})}},{key:"getCount",value:function(e){return i.a.get("/commentsCount/".concat(e),{headers:Object(u.a)()})}},{key:"create",value:function(e){return i.a.post("/comments",e,{headers:Object(u.a)()})}},{key:"update",value:function(e,t){return i.a.put("/comments/".concat(e),t,{headers:Object(u.a)()})}},{key:"delete",value:function(e){return i.a.delete("/comments/".concat(e),{headers:Object(u.a)()})}},{key:"deleteAll",value:function(){return i.a.delete("/comments",{headers:Object(u.a)()})}},{key:"findByTitle",value:function(e){return i.a.get("/comments?title=".concat(e),{headers:Object(u.a)()})}}]),e}()),m=a(8),h=a(10),p=a(95),g=a(17);t.a=function(e){var t=Object(s.useState)([]),a=Object(r.a)(t,2),c=a[0],l=a[1],i=Object(s.useState)(null),u=Object(r.a)(i,2),f=(u[0],u[1],Object(s.useState)(-1)),b=Object(r.a)(f,2),v=(b[0],b[1],Object(s.useState)("")),y=Object(r.a)(v,2),E=y[0],j=y[1],C=Object(s.useState)(""),O=Object(r.a)(C,2),S=O[0],w=O[1],k=Object(s.useState)(e.match?e.match.params.schoolId:e.schoolId),N=Object(r.a)(k,2),I=N[0],P=(N[1],Object(s.useState)(m.a.getCurrentUser()?m.a.getCurrentUser().id:null)),x=Object(r.a)(P,2),R=x[0],F=(x[1],Object(s.useState)([])),A=Object(r.a)(F,2),B=A[0],D=A[1],H=Object(s.useState)(!!e.readonly&&e.readonly),T=Object(r.a)(H,2),U=T[0],V=(T[1],Object(s.useRef)());V.current=c;var q=Object(s.useState)(1),G=Object(r.a)(q,2),L=G[0],_=G[1],M=Object(s.useState)(0),W=Object(r.a)(M,2),J=W[0],z=W[1],Y=Object(s.useState)(5),X=Object(r.a)(Y,2),$=X[0],Q=X[1],K=function(){var e=function(){var e={};return S&&(e.text=S),L&&(e.page=L-1),$&&(e.size=$),I&&(e.schoolId=I),B&&(e.orderby=B),e}();d.getAll2(e).then((function(e){var t=e.data,a=t.comments,n=t.totalPages;l(a),z(n),console.log(e.data)})).catch((function(e){console.log(e)}))};Object(s.useEffect)(K,[L,$,B]);var Z=function(){K(),j("")},ee=Object(s.useMemo)((function(){return[{Header:"\u8bc4\u8bba",accessor:"text",maxWidth:400,minWidth:140,width:300,disableSortBy:!0},{Header:"\u65f6\u95f4",accessor:"createdAt",maxWidth:50,minWidth:10,width:50,Cell:function(e){var t=e.row.id,a=new Date(V.current[t].createdAt);return o.a.createElement("div",null,a.toLocaleDateString("zh-cn",{hour12:!0,hour:"2-digit",minute:"2-digit",second:"2-digit"}))}},{Header:"\u8bc4\u8bba\u4eba",accessor:"user.username",maxWidth:40,minWidth:10,width:40,Cell:function(e){var t=e.row.id;return o.a.createElement("div",null,V.current[t].user?o.a.createElement(h.b,{to:"/usersView/"+V.current[t].user.id,className:"badge badge-success"},V.current[t].user.chineseName?V.current[t].user.chineseName:V.current[t].user.username):"")}},{Header:"\u5220\u9664",accessor:"actions",maxWidth:30,minWidth:10,width:20,disableSortBy:!0,Cell:function(e){var t=e.row.id;return o.a.createElement("div",null,!U&&o.a.createElement("span",{onClick:function(){return window.confirm("\u60a8\u786e\u5b9a\u8981\u5220\u9664\u5417 ?")&&function(e){var t=V.current[e].id;d.delete(t).then((function(t){var a=Object(n.a)(V.current);a.splice(e,1),l(a)})).catch((function(e){console.log(e)}))}(t)}},o.a.createElement("i",{className:"fas fa-trash action"})))}}]}),[]),te=(o.a.useMemo((function(){return{minWidth:30,width:150,maxWidth:400}}),[]),Object(g.useTable)({columns:ee,data:c,disableSortRemove:!0,manualSortBy:!0,initialState:{sortBy:[{id:"createdAt",desc:!0}]}},g.useFlexLayout,g.useSortBy)),ae=te.getTableProps,ne=te.getTableBodyProps,re=te.headerGroups,se=te.rows,oe=te.prepareRow,ce=te.state.sortBy;return Object(s.useEffect)((function(){ce&&ce[0]&&D(ce)}),[ce]),o.a.createElement("div",{className:"list row"},o.a.createElement("div",{class:"form-group col-sm-12"},o.a.createElement("label",{htmlFor:"text"},o.a.createElement("h4",null,"\u8bc4\u8bba")),o.a.createElement("textarea",{rows:"4",class:"form-control",id:"text",name:"text",value:E,onChange:function(e){var t=e.target.value;j(t)}}),o.a.createElement("button",{className:"btn btn-primary badge-success mb-5",onClick:function(e){var t={text:E,userId:R,schoolId:I};d.create(t).then((function(e){Z(),console.log(e.data)})).catch((function(e){console.log(e)}))}},"\u63d0\u4ea4")),o.a.createElement("div",{class:"w-100"}),o.a.createElement("div",{className:"col-sm-6"},o.a.createElement("h6",null,"\u8bc4\u8bba\u5217\u8868"),o.a.createElement("div",{className:"input-group mb-3"},o.a.createElement("input",{type:"text",className:"form-control",placeholder:"\u641c\u7d22 \u3002\u3002\u3002",value:S,onChange:function(e){var t=e.target.value;w(t)}}),o.a.createElement("div",{className:"input-group-append"},o.a.createElement("button",{className:"btn btn-outline-secondary",type:"button",onClick:function(){_(1),K()}},"\u67e5\u627e"))),o.a.createElement("div",{className:"col-sm-6 mt-3"},"\u6bcf\u9875\u663e\u793a\u884c\u6570: ",o.a.createElement("select",{onChange:function(e){Q(e.target.value),_(1)},value:$},[5,10,20].map((function(e){return o.a.createElement("option",{key:e,value:e},e)}))),o.a.createElement(p.a,{className:"my-3",count:J,page:L,siblingCount:1,boundaryCount:1,variant:"outlined",shape:"rounded",onChange:function(e,t){_(t)}}))),o.a.createElement("div",{class:"w-100"}),o.a.createElement("div",{className:"col-sm-12 list"},o.a.createElement("table",Object.assign({className:"table table-striped table-bordered"},ae()),o.a.createElement("thead",null,re.map((function(e){return o.a.createElement("tr",e.getHeaderGroupProps(),e.headers.map((function(e){return o.a.createElement("th",e.getHeaderProps(e.getSortByToggleProps(),{}),e.render("Header"),o.a.createElement("span",null,"createdAt"===e.id||"user.username"===e.id?e.isSortedDesc?" \ud83d\udd3d":" \ud83d\udd3c":""))})))}))),o.a.createElement("tbody",ne(),se.map((function(e,t){return oe(e),o.a.createElement("tr",e.getRowProps(),e.cells.map((function(e){return o.a.createElement("td",e.getCellProps({style:{minWidth:e.column.minWidth,width:e.column.width,whiteSpace:"pre-wrap"}}),e.render("Cell"))})))}))))),o.a.createElement("div",{className:"col-sm-8"}))}}},[[255,1,2]]]);
//# sourceMappingURL=main.2a7361aa.chunk.js.map