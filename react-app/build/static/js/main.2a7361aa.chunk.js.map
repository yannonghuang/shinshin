{"version":3,"sources":["components/school.component.js","components/project.component.js","services/school.service.js","services/project.service.js","shinshin-logo.png","defaultPhoto.jpg","services/survey.service.js","http-common.js","services/auth-header.js","components/surveys-list.component.js","components/schools-list.component.js","components/regions-list.component.js","services/log.service.js","components/logs-list.component.js","services/form.service.js","components/form.component.js","components/forms-list.component.js","components/attachments-list.component.js","components/response.component.js","components/users-list.component.js","services/timer.service.js","components/reset.component.js","components/login.component.js","components/register.component.js","services/user.service.js","components/profile.component.js","components/home.component.js","App.js","serviceWorker.js","index.js","services/response.service.js","services/document.service.js","services/attachment.service.js","services/dossier.service.js","components/responses-list.component.js","components/projects-list.component.js","services/auth.service.js","components/documents-list.component.js","components/survey.component.js","components/dossiers-list.component.js","services/comment.service.js","components/comments-list.component.js"],"names":["School","props","onDrag","event","preventDefault","onDrop","file","dataTransfer","files","item","items","kind","type","indexOf","setState","prevState","currentSchool","reader","FileReader","readAsDataURL","onload","photo","result","onChangeGenerics","bind","onChangeStartAt","onChangeYPStartAt","onChangeLastVisit","onChangeYPLastVisit","onChangePrincipalId","onChangeContactId","getSchool","getSchoolPhoto","updateSchool","updatePhoto","deleteSchool","onChangeDocFiles","saveSchool","newSchool","state","id","name","code","docFiles","docCategory","startAt","lastVisit","donor","stage","status","request","category","principal","principalCell","principalWechat","contact","contactCell","contactWechat","schoolBoard","schoolBoardRegisteredName","region","city","county","community","address","phone","email","studentsCount","teachersCount","description","principalId","contactId","xr","newschool","readonly","regions","docCategories","users","stages","statuses","requests","categories","message","submitted","pastedPhotoType","surveyRef","createRef","a","window","location","pathname","includes","this","schoolId","match","params","getRegions","getDocCategories","getCategories","getRequests","getStatuses","getStages","getUsers","init","document","onpaste","pasteEvent","clipboardData","i","length","blob","getAsFile","getElementById","src","push","value","label","chineseName","userId","UserDataService","getAllSimple","then","response","convert","data","console","log","catch","e","SchoolDataService","getRequests_ss","getStatuses_ss","DocumentDataService","displayName","target","checked","base","get","rSchool","SurveyDataService","rSurvey","rSurveyButId","x","y","reduce","alert","getPhoto","imageURL","Buffer","toString","others","dataSchool","create","dataSurvey","r","err","resMessage","uploadDocuments","current","updateSurvey","update","FormData","append","fetch","base64Response","Blob","delete","history","className","onClick","href","class","contenteditable","onDragOver","defaultPhoto","width","height","htmlFor","required","onChange","cols","AuthService","getCurrentUser","yearArray","onSelect","hideInput","minRange","maxRange","disabled","map","option","hidden","to","display","options","rows","ref","action","method","enctype","for","multiple","placeholder","embedded","Component","Project","currentProject","onChangeName","onChangeSchoolId","onChangeResponseId","onChangeBudget","onChangePhoto","onChangeStatus","onChangeDescription","getProject","getProjectPhoto","updatePublished","updateProject","deleteProject","onChangeDocCategory","saveProject","newProject","responseId","budget","currentUser","schools","newproject","getSchools","user","ProjectDataService","DossierDataService","school","title","published","uploadDossiers","validateSchool","localStorage","getItem","min","max","step","projectId","bigObj","smallObj","Object","keys","forEach","key","assign","http","post","headers","authHeader","put","JSON","parse","accessToken","toCSV","obj","mapper","path","newline","translate","column","accessor","Header","p","substring","lastIndexOf","header","body","Array","endsWith","exportCSV","render","replace","csv","flatten","hh","trim","split","index","j","order","line","newBody","module","exports","responseType","axios","baseURL","SurveysList","useState","surveys","setSurveys","searchOriginalname","setSearchOriginalname","orderby","setOrderby","surveysRef","useRef","page","setPage","count","setCount","pageSize","setPageSize","retrieveSurveys","getRequestParams","getAll2","totalPages","useEffect","columns","useMemo","Cell","rowIdx","row","d","Date","createdAt","toLocaleDateString","hour12","hour","minute","second","disableSortBy","confirm","rowIndex","newSurveys","splice","deleteSurvey","useTable","disableSortRemove","manualSortBy","initialState","sortBy","desc","useSortBy","getTableProps","getTableBodyProps","headerGroups","prepareRow","size","Pagination","siblingCount","boundaryCount","variant","shape","headerGroup","getHeaderGroupProps","getHeaderProps","getSortByToggleProps","isSorted","isSortedDesc","getRowProps","cells","cell","getCellProps","withRouter","setSchools","setExportSchools","searchName","setSearchName","searchCode","setSearchCode","searchRegion","setSearchRegion","searchStartAt","setSearchStartAt","searchLastVisit","setSearchLastVisit","searchDonor","setSearchDonor","searchStage","setSearchStage","searchStatus","setSearchStatus","searchRequest","setSearchRequest","searchXR","setSearchXR","schoolsRef","totalItems","setTotalItems","pageSizes","setRegions","setStages","setStatuses","setRequests","exportFlag","retrieveSchools","doRetrieveExportSchools","filters","getExport","exportColumns","url","URL","createObjectURL","link","createElement","setAttribute","detail","appendChild","click","remove","error","getAttributes","exportColumnsMain","exportColumnsDetail","projectsCount","responsesCount","newSchools","handlePageChange","handlePageSizeChange","main","RegionsList","regionsRef","retrieveRegions","getCountsByRegion","schoolsCount","LogsList","logs","setLogs","searchText","setSearchText","logsRef","retrieveLogs","LogDataService","username","newLogs","deleteLog","useFlexLayout","style","minWidth","whiteSpace","jQuery","$","require","margin","Form","newFormOptions","formData","subtype","onSave","saveForm","oldFormOptions","updateForm","showActionButtons","onChangeTitle","onChangeDeadline","getForm","deleteForm","newForm","currentForm","fdata","deadline","newsform","fb","fBuilder","fRender","newform","formBuilder","FormDataService","getUTCFullYear","stringify","formRender","promise","actions","setData","getData","FormsList","forms","setForms","searchTitle","setSearchTitle","formsRef","retrieveForms","openForm","expired","newForms","AttachmentsList","attachments","setAttachments","reload","setReload","attachmentsRef","retrieveAttachments","AttachmentDataService","mimetype","startsWith","download","originalname","newAttachments","deleteAttachment","previewOnly","getContent","Response","optionOnSave","responseData","submitResponse","getResponse","updateResponse","deleteResponse","onChangeAttFiles","hasFiles","currentResponse","formId","newresponse","progress","updatedRecently","updatedAt","setUpdateStatus","UPDATE_THRESHOLD","getUpdatedAt","updatedAtObj","getTime","otherParameters","getFullYear","ResponseDataService","attr","ready","on","input","placeToInsertImagePreview","filesAmount","parseHTML","appendTo","imagesPreview","inputs","getElementsByTagName","attFiles","filesN","getLabel","descriptions","uploadAttachments","Math","round","loaded","total","clearFiles","collectFiles","userData","position","right","role","aria-valuenow","aria-valuemin","aria-valuemax","UsersList","setUsers","usersRef","rolesFull","setRolesFull","schoolTitle","setSchoolTitle","searchRole","setSearchRole","searchUsername","setSearchUsername","searchEmail","setSearchEmail","searchSchoolCode","setSearchSchoolCode","searchContactOnly","setSearchContactOnly","searchEmailVerified","setSearchEmailVerified","getRoleLabel","getRoles","retrieveUsers","openUser","hiddenColumns","roles","renderRoles","contactOnly","emailVerified","newUsers","deleteUser","EXEMPTED_URLS","login","newTarget","logout","goBack","win","open","focus","isExempted","ComposedClass","passThroughProps","useIdleTimer","timeout","onIdle","debounce","getLastActiveTime","jwt","vpassword","Reset","handleReset","onChangePasswordVerified","onChangePassword","passwordVerified","password","loading","search","token","URLSearchParams","verify","decoded","form","validateAll","checkBtn","context","_errors","reset","alt","onSubmit","c","validations","Login","handleLogin","onChangeUsername","onChangeEmail","onReset","handleEmailVerification","isReset","addClass","hasClass","removeClass","findByEmail","sign","expiresIn","host","templateParams","emailjs","send","text","setItem","isValid","top","background","border","float","isEmail","vusername","Register","handleRegister","createContactOnly","updateUser","updateContactOnly","getUser","onChangeRoles","onChangeChineseName","onChangePhone","onChangeWechat","onChangeContactOnly","wechat","lastLogin","newuser","titles","successful","qString","queryString","getTitles","names","getRoleNames","getUserTitles","selected","selectedOptions","opt","isSchoolUser","schoolRoles","ssRoles","getPrincipal","prompt","validatePrincipal","register","emailVerification","getRelevantRoles","API_URL","Profile","substr","App","logOut","showModeratorBoard","showAdminBoard","undefined","logo","data-toggle","data-target","aria-controls","aria-expanded","aria-label","aria-haspopup","aria-labelledby","exact","component","SchoolsList","Survey","DocumentsList","CommentsList","ProjectsList","DossiersList","ResponsesList","Boolean","hostname","ReactDOM","navigator","serviceWorker","registration","unregister","onUploadProgress","responses","setResponses","setTitle","setExportResponses","responsesRef","flattenUserData","flattenFData","retrieveResponses","newResponses","fColumns","getFDataColumns","f","projects","setProjects","setExportProjects","projectsRef","retrieveProjects","newProjects","removeItem","thisLogin","validity","floor","now","documents","setDocuments","documentsRef","retrieveDocuments","newDocuments","deleteDocument","getSurvey","saveSurvey","newSurvey","currentSurvey","stayBehindCount","boarderCount","kClassesCount","g1ClassesCount","g2ClassesCount","g3ClassesCount","g4ClassesCount","g5ClassesCount","g6ClassesCount","kStudentsCount","g1StudentsCount","g2StudentsCount","g3StudentsCount","g4StudentsCount","g5StudentsCount","g6StudentsCount","mStudentsCount","computersCount","computerRoomExists","computerRoomCount","internetExists","multimediaSystemsCount","libraryExists","bookCornersCount","booksCount","newsurvey","convertUser","displayNameSchool","displayNameUser","displayUser","dossiers","setDossiers","dossiersRef","retrieveDossiers","newDossiers","deleteDossier","comments","setComments","setText","commentsRef","retrieveComments","CommentDataService","refreshList","maxWidth","newComments","deleteComment","React"],"mappings":"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","file":"static/js/main.2a7361aa.chunk.js","sourcesContent":["//import React, { Component } from \"react\";\nimport React, { Component, createRef } from \"react\"; //For react component\n//import 'bootstrap/dist/css/bootstrap.min.css';\n//import {Tabs, Tab} from \"react-bootstrap\";\nimport \"bootstrap/dist/css/bootstrap.min.css\";\nimport { Tab, Tabs, TabList, TabPanel } from 'react-tabs';\nimport 'react-tabs/style/react-tabs.css';\nimport $ from \"jquery\"; //Load jquery\nimport { Link } from \"react-router-dom\";\nimport Divider from '@material-ui/core/Divider';\nimport Select from 'react-select';\n\nimport AuthService from \"./../services/auth.service\";\nimport UserDataService from \"../services/auth.service\";\nimport Survey from './survey.component.js';\nimport CommentsList from './comments-list.component.js';\nimport ProjectsList from './projects-list.component.js';\nimport ResponsesList from './responses-list.component.js';\nimport DocumentsList from './documents-list.component.js';\nimport SchoolDataService from \"../services/school.service\";\nimport SurveyDataService from \"../services/survey.service\";\nimport DocumentDataService from \"../services/document.service\";\n//import SchoolDetails from './collapsible-school.component';\nimport defaultPhoto from '../defaultPhoto.jpg';\n\nimport YearPicker from 'react-single-year-picker';\n\nexport default class School extends Component {\n  constructor(props) {\n    super(props);\n\n    this.onChangeGenerics = this.onChangeGenerics.bind(this);\n\n    this.onChangeStartAt = this.onChangeStartAt.bind(this);\n    this.onChangeYPStartAt = this.onChangeYPStartAt.bind(this);\n    this.onChangeLastVisit = this.onChangeLastVisit.bind(this);\n    this.onChangeYPLastVisit = this.onChangeYPLastVisit.bind(this);\n\n    this.onChangePrincipalId = this.onChangePrincipalId.bind(this);\n    this.onChangeContactId = this.onChangeContactId.bind(this);\n\n    this.getSchool = this.getSchool.bind(this);\n    this.getSchoolPhoto = this.getSchoolPhoto.bind(this);\n\n    this.updateSchool = this.updateSchool.bind(this);\n    this.updatePhoto = this.updatePhoto.bind(this);\n    this.deleteSchool = this.deleteSchool.bind(this);\n    this.onDrag = this.onDrag.bind(this);\n    this.onDrop = this.onDrop.bind(this);\n    this.onChangeDocFiles = this.onChangeDocFiles.bind(this);\n\n    this.saveSchool = this.saveSchool.bind(this);\n    this.newSchool = this.newSchool.bind(this);\n\n    this.state = {\n      currentSchool: {\n        id: null,\n        name: \"\",\n        code: \"\",\n\n        photo: null,\n        file: null, // for photo\n        docFiles: [],\n        docCategory: \"\",\n\n        startAt: null,\n        lastVisit: null,\n        donor: null,\n        stage: \"\",\n\n        status: \"\",\n        request: \"\",\n        category: \"\",\n        principal: \"\",\n        principalCell: null,\n        principalWechat: null,\n        contact: \"\",\n        contactCell: null,\n        contactWechat: null,\n        schoolBoard: null,\n        schoolBoardRegisteredName: null,\n        region: \"\",\n        city: \"\",\n        county: \"\",\n        community: \"\",\n        address: \"\",\n        phone: \"\",\n        email: \"\",\n        studentsCount: 0,\n        teachersCount: 0,\n        description: \"\",\n        principalId: null,\n        contactId: null,\n        xr: false,\n      },\n\n      newschool: true,\n      readonly: true,\n      regions: [],\n      docCategories: [],\n\n      users: [],\n\n      stages: [],\n      statuses: [],\n      requests: [],\n      categories: [],\n\n      message: \"\",\n      submitted: false,\n      pastedPhotoType: null,\n    };\n\n    this.surveyRef = createRef();\n  }\n\n  async componentDidMount() {\n    const newschool = window.location.pathname.includes('add');\n    this.setState({newschool: newschool});\n    this.setState({readonly: window.location.pathname.includes('View')});\n\n    const schoolId = this.props.match? this.props.match.params.id : this.props.id;\n    if (!newschool) {\n      await this.getSchool(schoolId);\n      await this.getSchoolPhoto(schoolId);\n    }\n\n    this.getRegions();\n    this.getDocCategories();\n\n    this.getCategories();\n    this.getRequests();\n    this.getStatuses();\n    this.getStages();\n    this.getUsers(schoolId);\n\n    this.init();\n  }\n\n  init() {\n    document.onpaste = async (pasteEvent) => {\n      pasteEvent.preventDefault();\n\n      var items = pasteEvent.clipboardData.items;\n\n      for (var i = 0; i < items.length; i++) {\n        if (items[i].type.indexOf(\"image\") === 0) {\n          var blob = items[i].getAsFile();\n          const type = items[i].type;\n          var reader = new FileReader();\n          reader.readAsDataURL(blob);\n          reader.onload = async () => {\n            await this.setState(prevState => ({\n              currentSchool: {\n                ...prevState.currentSchool,\n                photo: reader.result\n              },\n              pastedPhotoType: type\n            }));\n\n            document.getElementById('schoolPhoto').src = reader.result;\n            return;\n          }\n\n        }\n      }\n    };\n\n  }\n\n  convert(users) {\n    const result = [];\n    if (users) {\n    for (var i = 0; i < users.length; i++) {\n      result.push({value: users[i].id,\n        label: users[i].chineseName });\n    }\n    return result;\n    }\n  }\n\n  display(userId) {\n    if (this.state.users) {\n      for (var i = 0; i < this.state.users.length; i++) {\n        if (this.state.users[i].value == userId)\n          return this.state.users[i];\n      }\n      return [];\n    }\n  }\n\n  displayName(userId) {\n    if (this.state.users) {\n      for (var i = 0; i < this.state.users.length; i++) {\n        if (this.state.users[i].value == userId)\n          return this.state.users[i].label ? this.state.users[i].label : '中文名';\n      }\n      return '';\n    }\n  }\n\n  getUsers(schoolId) {\n    //UserDataService.getAll2({schoolId: this.state.currentSchool.id})\n    UserDataService.getAllSimple({schoolId: schoolId})\n      .then(response => {\n        this.setState({\n          users: this.convert(response.data)\n        });\n\n        console.log(response);\n      })\n      .catch(e => {\n        //alert(JSON.stringify(e))\n        console.log(e);\n      });\n  }\n\n  getCategories() {\n    SchoolDataService.getCategories()\n      .then(response => {\n        this.setState({\n          categories: response.data\n        });\n        console.log(response);\n      })\n      .catch(e => {\n        console.log(e);\n      });\n  }\n\n  getRequests() {\n    SchoolDataService.getRequests_ss()\n      .then(response => {\n        this.setState({\n          requests: response.data\n        });\n        console.log(response);\n      })\n      .catch(e => {\n        console.log(e);\n      });\n  }\n\n  getStatuses() {\n    SchoolDataService.getStatuses_ss()\n      .then(response => {\n        this.setState({\n          statuses: response.data\n        });\n        console.log(response);\n      })\n      .catch(e => {\n        console.log(e);\n      });\n  }\n\n  getStages() {\n    SchoolDataService.getStages()\n      .then(response => {\n        this.setState({\n          stages: response.data\n        });\n        console.log(response);\n      })\n      .catch(e => {\n        console.log(e);\n      });\n  }\n\n  getRegions() {\n    SchoolDataService.getRegions()\n      .then(response => {\n        this.setState({\n          regions: response.data\n        });\n        console.log(response);\n      })\n      .catch(e => {\n        console.log(e);\n      });\n  }\n\n  getDocCategories() {\n    DocumentDataService.getDocCategories()\n      .then(response => {\n        this.setState({\n          docCategories: response.data\n        });\n        console.log(response);\n      })\n      .catch(e => {\n        console.log(e);\n      });\n  }\n\n  onChangePrincipalId(e) {\n    this.setState(prevState => ({\n      currentSchool: {\n        ...prevState.currentSchool,\n        principalId: e.value, //.target.value\n        principal: this.displayName(e.value)\n      }\n    }));\n  }\n\n  onChangeContactId(e) {\n    this.setState(prevState => ({\n      currentSchool: {\n        ...prevState.currentSchool,\n        contactId: e.value //.target.value\n      }\n    }));\n  }\n\n  onChangeGenerics(e) {\n    const name = e.target.name;\n    const type = e.target.type;\n    const value = (type === \"checkbox\") ? e.target.checked : e.target.value;\n\n    this.setState(prevState => ({\n      currentSchool: {\n        ...prevState.currentSchool,\n        [name]: value\n      }\n    }));\n  }\n\n  onChangeStartAt(e) {\n    const startAt = e.target.value;\n\n    this.setState(function(prevState) {\n      return {\n        currentSchool: {\n          ...prevState.currentSchool,\n          startAt: startAt\n        }\n      };\n    });\n  }\n\n\n  onChangeYPStartAt(e) {\n    const startAt = e; //.target.value;\n\n    this.setState(function(prevState) {\n      return {\n        currentSchool: {\n          ...prevState.currentSchool,\n          startAt: startAt\n        }\n      };\n    });\n  }\n\n  onChangeLastVisit(e) {\n    const lastVisit = e.target.value;\n\n    this.setState(function(prevState) {\n      return {\n        currentSchool: {\n          ...prevState.currentSchool,\n          lastVisit: lastVisit\n        }\n      };\n    });\n  }\n\n  onChangeYPLastVisit(e) {\n    const lastVisit = e; //.target.value;\n\n    this.setState(function(prevState) {\n      return {\n        currentSchool: {\n          ...prevState.currentSchool,\n          lastVisit: lastVisit\n        }\n      };\n    });\n  }\n\n  async getSchool(schoolId) {\n    const {\n      id,\n      photo,\n      file,\n      docFiles,\n      docCategory,\n      ...base} = this.state.currentSchool;\n\n    try {\n      let rSchool = await SchoolDataService.get(schoolId);\n      let rSurvey = await SurveyDataService.get(schoolId);\n\n      const {id, ...rSurveyButId} = rSurvey.data;\n      let x = {...base, ...rSchool.data, ...rSurveyButId};\n      let y = SchoolDataService.reduce(x, base);\n\n      await this.setState({\n        currentSchool: {\n          ...y,\n          id: schoolId\n        }\n      });\n\n    } catch (err) {\n      alert(err.message);\n    };\n\n  }\n\n  getSchoolPhoto(id) {\n    SchoolDataService.getPhoto(id)\n      .then(response => {\n        var imageURL = 'data:image/png;base64,' +\n            new Buffer(response.data.data.photo, 'binary').toString('base64');\n\n        this.setState(prevState => ({\n              currentSchool: {\n                ...prevState.currentSchool,\n                photo: imageURL\n              }\n            }));\n\n        console.log(response.data);\n      })\n      .catch(e => {\n        console.log(e);\n      });\n  }\n\n  newSchool() {\n  this.setState(prevState => ({\n    currentSchool: {\n      ...prevState.currentSchool,\n      id: null,\n      name: \"\",\n      code: \"\",\n      description: \"\",\n      principal: \"\",\n      photo: null,\n      file: null,\n      region: \"\",\n      address: \"\",\n      phone: \"\",\n      email: \"\",\n      studentsCount: 0,\n      teachersCount: 0,\n      docFiles: [],\n      docCategory: \"\",\n\n      stage: \"\",\n      status: \"\",\n      request: \"\",\n      category: \"\",\n      },\n\n      submitted: false\n    }));\n\n  }\n\n  saveSchool() {\n  const {\n    id,\n    photo,\n    file,\n    docFiles,\n    docCategory,\n    startAt,\n    lastVisit,\n    ...others} = this.state.currentSchool;\n\n  const dataSchool = {\n      ...others,\n      startAt: startAt ? (startAt + '-01-01') : null,\n      lastVisit: lastVisit ? (lastVisit + '-01-01') : null,\n    };\n\n    SchoolDataService.create(dataSchool)\n      .then(response => {\n\n        const dataSurvey = {\n          ...others,\n          startAt: startAt ? (startAt + '-01-01') : null,\n          lastVisit: lastVisit ? (lastVisit + '-01-01') : null,\n          schoolId: response.data.id\n        };\n\n        SurveyDataService.create(dataSurvey)\n        .then(r => {\n           this.setState(prevState => ({\n             currentSchool: {\n               ...prevState.currentSchool,\n               id: response.data.id,\n             },\n             message: \"学校信息成功提交!\",\n             submitted: true\n           }));\n        })\n        .catch(err => {\n          const resMessage =\n            (err.response &&\n            err.response.data &&\n            err.response.data.message) ||\n            err.message ||\n            err.toString();\n\n          this.setState({\n            message: \"学校信息保存失败! \" + resMessage\n          });\n        })\n\n        if (this.state.currentSchool.file || this.state.pastedPhotoType) { // photo, followed by docs\n          this.updatePhoto();\n        } else {\n          if (this.state.currentSchool.docFiles) // docs\n            this.uploadDocuments();\n        }\n\n        console.log(response.data);\n      })\n      .catch(e => {\n        const resMessage =\n          (e.response &&\n            e.response.data &&\n            e.response.data.message) ||\n          e.message ||\n          e.toString();\n\n        this.setState({\n          message: \"学校信息保存失败! \" + resMessage\n        });\n        console.log(e);\n      });\n  }\n\n  updateSchool() {\n    if (this.surveyRef.current) this.surveyRef.current.updateSurvey();\n\n    const {\n      id,\n      photo,\n      file,\n      docFiles,\n      docCategory,\n      startAt,\n      lastVisit,\n      ...others} = this.state.currentSchool;\n\n    const dataSchool = {\n        ...others,\n        startAt: startAt ? (startAt + '-01-01') : null,\n        lastVisit: lastVisit ? (lastVisit + '-01-01') : null,\n      };\n\n    const dataSurvey = {\n        ...others,\n        startAt: startAt ? (startAt + '-01-01') : null,\n        lastVisit: lastVisit ? (lastVisit + '-01-01') : null,\n        schoolId: this.state.currentSchool.id\n      };\n\n    SchoolDataService.update(\n      this.state.currentSchool.id,\n      dataSchool)\n      .then(response => {\n        console.log(response.data);\n\n        SurveyDataService.update(\n          this.state.currentSchool.id,\n          dataSurvey)\n        .then (r => {\n          this.setState({\n            message: \"学校信息成功修改!\",\n            submitted: true\n          });\n        })\n        .catch(err => {\n          const resMessage =\n            (err.response &&\n            err.response.data &&\n            err.response.data.message) ||\n            err.message ||\n            err.toString();\n\n          this.setState({\n            message: \"学校信息修改失败! \" + resMessage\n          });\n        });\n\n        if (this.state.currentSchool.file || this.state.pastedPhotoType) { // photo, followed by docs\n          this.updatePhoto();\n        } else {\n          if (this.state.currentSchool.docFiles) // docs\n            this.uploadDocuments();\n        }\n      })\n      .catch(e => {\n        const resMessage =\n          (e.response &&\n            e.response.data &&\n            e.response.data.message) ||\n          e.message ||\n          e.toString();\n\n        this.setState({\n          message: \"学校信息修改失败! \" + resMessage\n        });\n        console.log(e);\n      });\n  }\n\n\n  async updatePhoto() {\n    var data = new FormData();\n    if (this.state.currentSchool.file)\n      data.append('multi-files', this.state.currentSchool.file, this.state.currentSchool.file.name);\n    else if (this.state.pastedPhotoType) {\n      const base64Response = await fetch(this.state.currentSchool.photo);\n      const blob = await base64Response.blob();\n      data.append('multi-files', new Blob([blob], {type: this.state.pastedPhotoType}));\n    }\n    SchoolDataService.updatePhoto(this.state.currentSchool.id, data)\n    .then(response => {\n      if (this.state.currentSchool.docFiles) { // docs\n        this.uploadDocuments();\n      }\n      console.log(response.data);\n    })\n    .catch(e => {\n      console.log(e);\n    });\n  }\n\n  uploadDocuments() {\n    var data = new FormData();\n    for (var i = 0; i < this.state.currentSchool.docFiles.length; i++) {\n      data.append('multi-files', this.state.currentSchool.docFiles[i],\n        this.state.currentSchool.docFiles[i].name);\n    }\n    data.append('docCategory', this.state.currentSchool.docCategory);\n    SchoolDataService.uploadDocuments(this.state.currentSchool.id, data)\n    .then(response => {\n      this.setState(prevState => ({\n        message: prevState.message + \" 学校信息附件成功上传!\"\n      }));\n\n      console.log(response.data);\n    })\n    .catch(e => {\n      console.log(e);\n    });\n  }\n\n  deleteSchool() {\n    SchoolDataService.delete(this.state.currentSchool.id)\n      .then(response => {\n        console.log(response.data);\n        this.props.history.push('/schools')\n      })\n      .catch(e => {\n        console.log(e);\n      });\n  }\n\n  onDrag = event => {\n    event.preventDefault()\n  }\n\n  onDrop = event => {\n    event.preventDefault();\n    var file = event.dataTransfer.files[0];\n    var item = event.dataTransfer.items[0];\n    if (!item || item.kind !== 'file' || item.type.indexOf('image/') !== 0) return;\n    \n    this.setState(prevState => ({\n          currentSchool: {\n            ...prevState.currentSchool,\n            file: file\n          }\n        }));\n\n    var reader = new FileReader();\n    reader.readAsDataURL(file);\n    reader.onload = () => this.setState(prevState => ({\n      currentSchool: {\n        ...prevState.currentSchool,\n        photo: reader.result\n      }\n    }));\n  }\n\n\n  onChangeDocFiles(e) {\n    e.preventDefault();\n    var docFiles = e.target.files;\n    this.setState(prevState => ({\n          currentSchool: {\n            ...prevState.currentSchool,\n            docFiles: docFiles\n          }\n        }));\n  }\n\n  renderUpdates() {\n    return (\n            <div>\n            <button\n              className=\"badge badge-danger mr-2\"\n              onClick={this.deleteSchool}\n            >\n              Delete\n            </button>\n\n            <button\n              type=\"submit\"\n              className=\"badge badge-success\"\n              onClick={this.updateSchool}\n            >\n              Update\n            </button>\n\n            <p>{this.state.message}</p>\n            </div>\n    );\n  }\n\n  render() {\n    const { currentSchool } = this.state;\n\n    return (\n      <div>\n        {(this.state.submitted /*&& this.state.newschool*/) ? (\n          <div>\n            <div>{this.state.message}</div>\n\n            <a href={\"/schoolsView/\" + currentSchool.id} class=\"btn btn-success\">返回</a>\n{/*}\n            <h4>学校信息成功提交!</h4>\n            <button class=\"btn btn-success\" onClick={this.newSchool}>\n              Add\n            </button>\n*/}\n          </div>\n        ) : (\n          <div class=\"row\">\n            <div class=\"col-sm-4\">\n              <div class=\"row\">\n                <h4>学校基本信息</h4>\n\n                <div contenteditable=\"true\" onDragOver={this.onDrag} onDrop={this.onDrop}>\n                  {this.state.readonly ? \"\" :\n                    <p contenteditable=\"false\">编辑学校照片（拖拽照片文件或复制粘贴图标）</p>\n                  }\n                  <img id=\"schoolPhoto\" src={currentSchool.photo ? currentSchool.photo : defaultPhoto}\n                    width=\"320\" height=\"320\" class=\"responsive\" readonly={this.state.readonly?\"\":false}\n                  />\n                </div>\n\n                <div class=\"form-group\">\n                <label htmlFor=\"code\">学校编号</label>\n                <input\n                readonly={this.state.readonly?\"\":false}\n                type=\"text\"\n                class=\"form-control\"\n                id=\"code\"\n                required\n                value={currentSchool.code}\n                onChange={this.onChangeGenerics}\n                name=\"code\"\n                />\n                </div>\n\n{/*\n                <div class=\"form-group\" hidden={this.state.readonly && !currentSchool.xr} >\n                  <label htmlFor=\"xr\">向荣支持</label>\n                  <input\n                    type=\"checkbox\"\n                    hidden={this.state.readonly}\n                    class=\"form-control\"\n                    name=\"xr\"\n                    checked={currentSchool.xr}\n                    onChange={this.onChangeGenerics}\n                  />\n                </div>\n*/}\n                <div class=\"form-group\">\n                <label htmlFor=\"name\">欣欣学校名称</label>\n                <textarea\n                readonly={this.state.readonly?\"\":false}\n                class=\"form-control\"\n                id=\"name\"\n                cols=\"31\"\n                required\n                value={currentSchool.name}\n                onChange={this.onChangeGenerics}\n                name=\"name\"\n                />\n                </div>\n\n\n                <div class=\"form-group\">\n                <label htmlFor=\"schoolBoardRegisteredName\">教育局注册校名</label>\n                <textarea\n                readonly={this.state.readonly?\"\":false}\n                cols=\"31\"\n                class=\"form-control\"\n                id=\"schoolBoardRegisteredName\"\n                required\n                value={currentSchool.schoolBoardRegisteredName}\n                onChange={this.onChangeGenerics}\n                name=\"schoolBoardRegisteredName\"\n                />\n                </div>\n\n                <div class=\"form-group\">\n                <label htmlFor=\"schoolBoard\">教育局名称</label>\n                <textarea\n                readonly={this.state.readonly?\"\":false}\n                cols=\"31\"\n                class=\"form-control\"\n                id=\"schoolBoard\"\n                required\n                value={currentSchool.schoolBoard}\n                onChange={this.onChangeGenerics}\n                name=\"schoolBoard\"\n                />\n                </div>\n\n                <div class=\"w-100\"></div>\n\n                {(this.state.readonly && AuthService.getCurrentUser()) && (\n                <div class=\"box\">\n\n                  {AuthService.getCurrentUser().schoolId &&\n                    <a target=\"_blank\" href={\"/forms\"} class=\"btn btn-primary\">项目申请</a>}\n                  <a target=\"_blank\" href={\"/users/school/\" + currentSchool.id} class=\"btn btn-primary\">用户</a>\n                  {!AuthService.getCurrentUser().schoolId &&\n                    <a target=\"_blank\" href={\"/logs/school/\" + currentSchool.id} class=\"btn btn-primary\">更新历史</a>}\n                  {AuthService.getCurrentUser().schoolId &&\n                    <a target=\"_blank\" href={\"/surveys/\" + currentSchool.id} class=\"btn btn-primary mb-4\">更新信息</a>}\n                  {!AuthService.getCurrentUser().schoolId &&\n                    <a target=\"_blank\" href={\"/schools/\" + currentSchool.id} class=\"btn btn-primary mb-4\">编辑</a>}\n                </div>\n                )}\n\n              </div>\n            </div>\n\n            <div class=\"col-sm-8\">\n              <div class=\"row\">\n\n                <div class=\"form-group col-sm-4\">\n                <div>\n                <div class=\"side\"><label htmlFor=\"startAt\">建校年份</label></div>\n                <div class=\"side\">\n                {!this.state.readonly &&\n                (<YearPicker\n                yearArray={['2019', '2020']}\n                value={currentSchool.startAt}\n                onSelect={this.onChangeYPStartAt}\n                hideInput={true}\n                minRange={1995}\n                maxRange={2022}\n                />)}\n                </div>\n                </div>\n                <input\n                readonly=\"\"\n                type=\"text\"\n                class=\"form-control\"\n                id=\"startAt\"\n                required\n                value={currentSchool.startAt}\n                onChange={this.onChangeStartAt}\n                name=\"startAt\"\n                />\n                </div>\n\n                <div class=\"form-group col-sm-4\">\n                <label htmlFor=\"donor\">捐款人</label>\n                <input\n                readonly={this.state.readonly?\"\":false}\n                type=\"text\"\n                class=\"form-control\"\n                id=\"donor\"\n                required\n                value={currentSchool.donor}\n                onChange={this.onChangeGenerics}\n                name=\"donor\"\n                />\n                </div>\n\n                <div class=\"form-group col-sm-4\">\n                <div>\n                <div class=\"side\"><label htmlFor=\"lastVisit\">最近访校年份</label></div>\n                <div class=\"side\">\n                {!this.state.readonly &&\n                (<YearPicker\n                yearArray={['2019', '2020']}\n                value={currentSchool.lastVisit}\n                onSelect={this.onChangeYPLastVisit}\n                hideInput={true}\n                minRange={1995}\n                maxRange={2022}\n                />)}\n                </div>\n                </div>\n                <input\n                readonly=\"\"\n                type=\"text\"\n                class=\"form-control\"\n                id=\"lastVisit\"\n                required\n                value={currentSchool.lastVisit}\n                onChange={this.onChangeLastVisit}\n                name=\"lastVisit\"\n                />\n                </div>\n\n                <div class=\"w-100\"></div>\n\n\n                <div class=\"select-container form-group col-sm-4\">\n                <label htmlFor=\"stage\">学校阶段</label>\n                <select\n                disabled={this.state.readonly?\"disabled\":false}\n                class=\"form-control\"\n                id=\"stage\"\n                required\n                value={currentSchool.stage}\n                onChange={this.onChangeGenerics}\n                name=\"stage\"\n                >\n                <option value=\"\">{this.state.readonly ? '' : '请选择' }</option>\n                {this.state.stages.map((option) => (\n                  <option value={option}>{option}</option>\n                ))}\n                </select>\n                </div>\n\n                <div class=\"select-container form-group col-sm-4\">\n                <label htmlFor=\"status\">学校状态</label>\n                <select\n                disabled={this.state.readonly?\"disabled\":false}\n                class=\"form-control\"\n                id=\"status\"\n                required\n                value={currentSchool.status}\n                onChange={this.onChangeGenerics}\n                name=\"status\"\n                >\n                <option value=\"\">{this.state.readonly ? '' : '请选择' }</option>\n                {this.state.statuses.map((option) => (\n                  <option value={option}>{option}</option>\n                ))}\n                </select>\n                </div>\n\n                <div class=\"select-container form-group col-sm-4\">\n                <label htmlFor=\"request\">学校需求</label>\n                <select\n                disabled={this.state.readonly?\"disabled\":false}\n                class=\"form-control\"\n                id=\"request\"\n                required\n                value={currentSchool.request}\n                onChange={this.onChangeGenerics}\n                name=\"request\"\n                >\n                <option value=\"\">{this.state.readonly ? '' : '请选择' }</option>\n                {this.state.requests.map((option) => (\n                  <option value={option}>{option}</option>\n                ))}\n                </select>\n                </div>\n\n                <div class=\"w-100\"></div>\n\n                <div class=\"select-container form-group col-sm-3\">\n                <label htmlFor=\"region\">省/自治区/直辖市</label>\n                <select\n                disabled={this.state.readonly?\"disabled\":false}\n                class=\"form-control\"\n                id=\"region\"\n                required\n                value={currentSchool.region}\n                onChange={this.onChangeGenerics}\n                name=\"region\"\n                >\n                <option value=\"\">{this.state.readonly ? '' : '请选择' }</option>\n                {this.state.regions.map((option) => (\n                  <option value={option}>{option}</option>\n                ))}\n                </select>\n                </div>\n\n                <div class=\"form-group col-sm-3\">\n                <label htmlFor=\"city\">市</label>\n                <input\n                readonly={this.state.readonly?\"\":false}\n                type=\"text\"\n                class=\"form-control\"\n                id=\"city\"\n                required\n                value={currentSchool.city}\n                onChange={this.onChangeGenerics}\n                name=\"city\"\n                />\n                </div>\n\n                <div class=\"form-group col-sm-3\">\n                <label htmlFor=\"county\">区/县</label>\n                <input\n                readonly={this.state.readonly?\"\":false}\n                type=\"text\"\n                class=\"form-control\"\n                id=\"county\"\n                required\n                value={currentSchool.county}\n                onChange={this.onChangeGenerics}\n                name=\"county\"\n                />\n                </div>\n\n                <div class=\"form-group col-sm-3\">\n                <label htmlFor=\"community\">乡/镇</label>\n                <input\n                readonly={this.state.readonly?\"\":false}\n                type=\"text\"\n                class=\"form-control\"\n                id=\"community\"\n                required\n                value={currentSchool.community}\n                onChange={this.onChangeGenerics}\n                name=\"community\"\n                />\n                </div>\n\n                <div class=\"form-group col-sm-12\">\n                <label htmlFor=\"address\">地址</label>\n                <input\n                readonly={this.state.readonly?\"\":false}\n                type=\"text\"\n                class=\"form-control\"\n                id=\"address\"\n                required\n                value={currentSchool.address}\n                onChange={this.onChangeGenerics}\n                name=\"address\"\n                />\n                </div>\n\n                <div class=\"w-100\"></div>\n\n\n                <div class=\"form-group col-sm-4\">\n                <label htmlFor=\"phone\">学校电话</label>\n                <input\n                readonly={this.state.readonly?\"\":false}\n                type=\"text\"\n                class=\"form-control\"\n                id=\"phone\"\n                required\n                value={currentSchool.phone}\n                onChange={this.onChangeGenerics}\n                name=\"phone\"\n                />\n                </div>\n\n                <div class=\"form-group col-sm-4\">\n                <label htmlFor=\"email\">学校电子邮箱</label>\n                <input\n                readonly={this.state.readonly?\"\":false}\n                type=\"text\"\n                class=\"form-control\"\n                id=\"email\"\n                required\n                value={currentSchool.email}\n                onChange={this.onChangeGenerics}\n                name=\"email\"\n                />\n                </div>\n\n\n                <div class=\"w-100\"></div>\n\n                <div class=\"form-group col-sm-4\">\n                <label htmlFor=\"studentsCount\">学生人数</label>\n                <input\n                readonly={this.state.readonly?\"\":false}\n                type=\"number\"\n                class=\"form-control\"\n                id=\"studentsCount\"\n                required\n                value={currentSchool.studentsCount}\n                onChange={this.onChangeGenerics}\n                name=\"studentsCount\"\n                />\n                </div>\n\n                <div class=\"form-group col-sm-4\">\n                <label htmlFor=\"teachersCount\">教师人数</label>\n                <input\n                readonly={this.state.readonly?\"\":false}\n                type=\"number\"\n                class=\"form-control\"\n                id=\"teachersCount\"\n                required\n                value={currentSchool.teachersCount}\n                onChange={this.onChangeGenerics}\n                name=\"teachersCount\"\n                />\n                </div>\n\n                <div class=\"select-container form-group col-sm-4\">\n                <label htmlFor=\"category\">学校类型</label>\n                <select\n                disabled={this.state.readonly?\"disabled\":false}\n                class=\"form-control\"\n                id=\"category\"\n                required\n                value={currentSchool.category}\n                onChange={this.onChangeGenerics}\n                name=\"category\"\n                >\n                <option value=\"\">{this.state.readonly ? '' : '请选择' }</option>\n                {this.state.categories.map((option) => (\n                  <option value={option}>{option}</option>\n                ))}\n                </select>\n                </div>\n\n                <div class=\"w-100\"></div>\n\n                <div class=\"form-group col-sm-4\" hidden={!AuthService.getCurrentUser()}>\n                  <label htmlFor=\"principalId\">校长</label>\n                  {!this.state.readonly\n                  ? (<Select onChange={this.onChangePrincipalId.bind(this)}\n                    class=\"form-control\"\n                    id=\"principalId\"\n                    value={this.display(currentSchool.principalId)}\n                    name=\"principalId\"\n                    options={this.state.users}\n                  />)\n                  : (<Link\n                    to={ \"/usersView/\" + currentSchool.principalId}\n                    id=\"principalId\"\n                    name=\"principalId\"\n                  >\n                    {this.displayName(currentSchool.principalId)}\n                  </Link>)}\n                </div>\n\n                <div class=\"form-group col-sm-4\" hidden={!AuthService.getCurrentUser()}>\n                  <label htmlFor=\"contactId\">联络人</label>\n                  {!this.state.readonly\n                  ? (<Select onChange={this.onChangeContactId.bind(this)}\n                    class=\"form-control\"\n                    id=\"contactId\"\n                    value={this.display(currentSchool.contactId)}\n                    name=\"contactId\"\n                    options={this.state.users}\n                  />)\n                  : (<Link\n                    to={ \"/usersView/\" + currentSchool.contactId}\n                    id=\"contactId\"\n                    name=\"contactId\"\n                  >\n                    {this.displayName(currentSchool.contactId)}\n                  </Link>)}\n                </div>\n\n                <div class=\"w-100\"></div>\n\n\n                <div class=\"form-group col-sm-12\">\n                <label htmlFor=\"description\">简介</label>\n                <textarea\n                rows=\"4\"\n                readonly={this.state.readonly?\"\":false}\n                class=\"form-control\"\n                id=\"description\"\n                required\n                value={currentSchool.description}\n                onChange={this.onChangeGenerics}\n                name=\"description\"\n                />\n                </div>\n              </div>\n            </div>\n\n            <div class=\"w-100\"></div>\n\n            {!this.state.readonly && (\n\n            <div>\n\n            <button onClick={this.saveSchool} class=\"btn btn-primary\" hidden={!this.state.newschool}>\n              提交\n            </button>\n\n            <button hidden={this.state.newschool}\n              type=\"submit\"\n              className=\"btn btn-primary\"\n              onClick={this.updateSchool}\n            >\n              更新\n            </button>\n\n            <div class=\"w-100\"></div>\n\n            <form ref=\"formToSubmit\" action=\"http://localhost:8080/api/documents-upload\" method=\"POST\" enctype=\"multipart/form-data\">\n                <div class=\"form-group input-group\">\n                <label for=\"input-multi-files\">上传文件:</label>\n                <input type=\"file\" name=\"multi-files\"\n                multiple\n                id=\"input-multi-files\"\n                class=\"form-control-file border\"\n                onChange={e => this.onChangeDocFiles(e)}\n                />\n\n                <select\n                  className=\"form-control input-group-append\"\n                  name=\"docCategory\" id=\"docCategory\"\n                  placeholder=\"\"\n                  value={currentSchool.docCategory}\n                  onChange={e => this.onChangeGenerics(e)}\n                >\n                  <option value=\"\">附件类别</option>\n                  {this.state.docCategories.map((option) => (\n                    <option value={option}>\n                      {option}\n                    </option>\n                  ))}\n                </select>\n\n                <input type=\"hidden\" name=\"schoolId\" id=\"schoolId\"/>\n                </div>\n            </form>\n\n            <p>{this.state.message}</p>\n            </div>\n\n            )}\n\n            <div class=\"w-100\"></div>\n\n\n            {!this.state.newschool && (<Tabs>\n              <TabList>\n                <Tab>更多信息 <i class=\"fas fa-hand-point-right\"></i></Tab>\n                <Tab>学校详情</Tab>\n                <Tab>项目列表</Tab>\n                <Tab>项目申请列表</Tab>\n                <Tab>学校文档</Tab>\n                <Tab>学校照片</Tab>\n                <Tab>评论区</Tab>\n                {currentSchool.xr ? <Tab>向荣支持项目</Tab> : null}\n              </TabList>\n\n              <TabPanel>\n              </TabPanel>\n              <TabPanel>\n                <Survey\n                  schoolId = {currentSchool.id}\n                  embedded = {true}\n                  readonly = {this.state.readonly}\n                  ref = {this.surveyRef}\n                />\n              </TabPanel>\n              <TabPanel>\n                <ProjectsList\n                  schoolId = {currentSchool.id}\n                  embedded = {true}\n                  readonly = {this.state.readonly}\n                />\n              </TabPanel>\n              <TabPanel>\n                <ResponsesList\n                  schoolId = {currentSchool.id}\n                  embedded = {true}\n                  readonly = {this.state.readonly}\n                />\n              </TabPanel>\n              <TabPanel>\n                <DocumentsList\n                  schoolId = {currentSchool.id}\n                  docCategory = {'!照片'}\n                  embedded = {true}\n                  readonly = {this.state.readonly}\n                />\n              </TabPanel>\n              <TabPanel>\n                <DocumentsList\n                  schoolId = {currentSchool.id}\n                  docCategory = {'照片'}\n                  embedded = {true}\n                  readonly = {this.state.readonly}\n                />\n              </TabPanel>\n              <TabPanel>\n                <CommentsList\n                  schoolId = {currentSchool.id}\n                  readonly = {this.state.readonly}\n                />\n              </TabPanel>\n              {currentSchool.xr ? (<TabPanel>\n                <ProjectsList\n                  schoolId = {currentSchool.id}\n                  embedded = {true}\n                  readonly = {this.state.readonly}\n                  xr = {true}\n                />\n              </TabPanel>) : null}\n            </Tabs>)}\n\n          </div>\n        ) }\n      </div>\n    );\n  }\n}\n","import React, { Component } from \"react\";\n//import 'bootstrap/dist/css/bootstrap.min.css';\n//import {Tabs, Tab} from \"react-bootstrap\";\nimport \"bootstrap/dist/css/bootstrap.min.css\";\nimport { Tab, Tabs, TabList, TabPanel } from 'react-tabs';\nimport 'react-tabs/style/react-tabs.css';\nimport $ from \"jquery\"; //Load jquery\nimport { Link } from \"react-router-dom\";\nimport Select from 'react-select';\n\nimport YearPicker from 'react-single-year-picker';\n\nimport ResponsesList from './responses-list.component.js';\nimport DossiersList from './dossiers-list.component.js';\nimport ProjectDataService from \"../services/project.service\";\nimport DossierDataService from \"../services/dossier.service\";\nimport SchoolDataService from \"../services/school.service\";\nimport AuthService from \"./../services/auth.service\";\n//import ProjectDetails from './collapsible-project.component';\n\nexport default class Project extends Component {\n  constructor(props) {\n    super(props);\n    this.onChangeName = this.onChangeName.bind(this);\n    this.onChangeSchoolId = this.onChangeSchoolId.bind(this);\n    this.onChangeResponseId = this.onChangeResponseId.bind(this);\n\n    this.onChangeBudget = this.onChangeBudget.bind(this);\n\n    this.onChangePhoto = this.onChangePhoto.bind(this);\n    this.onChangeStatus = this.onChangeStatus.bind(this);\n    this.onChangeDescription = this.onChangeDescription.bind(this);\n    this.onChangeStartAt = this.onChangeStartAt.bind(this);\n\n    this.getProject = this.getProject.bind(this);\n    this.getProjectPhoto = this.getProjectPhoto.bind(this);\n    this.updatePublished = this.updatePublished.bind(this);\n    this.updateProject = this.updateProject.bind(this);\n    this.updatePhoto = this.updatePhoto.bind(this);\n    this.deleteProject = this.deleteProject.bind(this);\n    this.onDrag = this.onDrag.bind(this);\n    this.onDrop = this.onDrop.bind(this);\n    this.onChangeDocFiles = this.onChangeDocFiles.bind(this);\n    this.onChangeDocCategory = this.onChangeDocCategory.bind(this);\n\n    this.saveProject = this.saveProject.bind(this);\n    this.newProject = this.newProject.bind(this);\n\n    this.state = {\n      currentProject: {\n        id: null,\n        name: \"\",\n        schoolId: null,\n        responseId: null,\n        status: \"\",\n        budget: 0,\n        photo: null,\n        file: null, // for photo\n        description: \"\",\n        startAt: null,\n        xr: window.location.pathname.includes('XR'),\n\n        docFiles: [],\n        docCategory: \"\"\n      },\n      currentUser: null,\n      schools: [],\n      statuses: [],\n\n      newproject: true,\n      readonly: true,\n      docCategories: [],\n      message: \"\",\n      submitted: false\n    };\n  }\n\n  componentDidMount() {\n    const newproject = window.location.pathname.includes('add');\n    this.setState({newproject: newproject});\n    this.setState({readonly: window.location.pathname.includes('View')});\n\n    if (!newproject) {\n      this.getProject(this.props.match.params.id);\n      //this.getProjectPhoto(this.props.match.params.id);\n    }\n\n    this.getDocCategories();\n    this.getSchools();\n    this.getStatuses();\n  }\n\n  convert(schools) {\n    const result = [];\n    if (schools) {\n    for (var i = 0; i < schools.length; i++) {\n      result.push({value: schools[i].id,\n        label: schools[i].code + \"-\" + schools[i].name + \"-\" + schools[i].region});\n    }\n    return result;\n    }\n  }\n\n  display(schoolId) {\n    if (this.state.schools) {\n      for (var i = 0; i < this.state.schools.length; i++) {\n        if (this.state.schools[i].value == schoolId)\n          return this.state.schools[i];\n      }\n      return [];\n    }\n  }\n\n  displayName(schoolId) {\n    if (this.state.schools) {\n      for (var i = 0; i < this.state.schools.length; i++) {\n        if (this.state.schools[i].value == schoolId)\n          return this.state.schools[i].label ? this.state.schools[i].label : '学校名';\n      }\n      return '';\n    }\n  }\n\n  getSchools() {\n    SchoolDataService.getAllSimple()\n      .then(response => {\n        this.setState({\n          schools: this.convert(response.data)\n        });\n\n        const user = AuthService.getCurrentUser();\n        if (user) {\n          this.setState({\n          currentUser: user,\n          });\n          if (user.schoolId) {\n            this.setState(function(prevState) {\n              return {\n                currentProject: {\n                  ...prevState.currentProject,\n                  schoolId: user.schoolId\n                }\n              };\n            });\n          }\n        }\n        console.log(response);\n      })\n      .catch(e => {\n        console.log(e);\n      });\n  }\n\n  OLDgetSchools() {\n    SchoolDataService.getAllSimple()\n      .then(response => {\n        this.setState({\n          schools: this.convert(response.data)\n        });\n        console.log(response);\n      })\n      .catch(e => {\n        console.log(e);\n      });\n  }\n\n  getStatuses() {\n    ProjectDataService.getStatuses()\n      .then(response => {\n        this.setState({\n          statuses: response.data\n        });\n        console.log(response);\n      })\n      .catch(e => {\n        console.log(e);\n      });\n  }\n\n\n  getDocCategories() {\n    DossierDataService.getDocCategories()\n      .then(response => {\n        this.setState({\n          docCategories: response.data\n        });\n        console.log(response);\n      })\n      .catch(e => {\n        console.log(e);\n      });\n  }\n\n  onChangeName(e) {\n    const name = e.target.value;\n\n    this.setState(function(prevState) {\n      return {\n        currentProject: {\n          ...prevState.currentProject,\n          name: name\n        }\n      };\n    });\n  }\n\n  onChangeSchoolId(e) {\n    const schoolId = e.value; //.target.value;\n\n    this.setState(function(prevState) {\n      return {\n        currentProject: {\n          ...prevState.currentProject,\n          schoolId: schoolId\n        }\n      };\n    });\n  }\n\n  onChangeResponseId(e) {\n    const responseId = e.target.value;\n\n    this.setState(function(prevState) {\n      return {\n        currentProject: {\n          ...prevState.currentProject,\n          responseId: responseId\n        }\n      };\n    });\n  }\n\n  onChangeDocCategory(e) {\n    const docCategory = e.target.value;\n\n    this.setState(function(prevState) {\n      return {\n        currentProject: {\n          ...prevState.currentProject,\n          docCategory: docCategory\n        }\n      };\n    });\n  }\n\n  onChangeBudget(e) {\n    const budget = e.target.value;\n\n    this.setState(prevState => ({\n      currentProject: {\n        ...prevState.currentProject,\n        budget: budget\n      }\n    }));\n  }\n\n\n  onChangePhoto(e) {\n    const photo = e.target.value;\n\n    this.setState(prevState => ({\n      currentProject: {\n        ...prevState.currentProject,\n        photo: photo\n      }\n    }));\n  }\n\n  onChangeStatus(e) {\n    const status = e.target.value;\n\n    this.setState(prevState => ({\n      currentProject: {\n        ...prevState.currentProject,\n        status: status\n      }\n    }));\n  }\n\n  onChangeDescription(e) {\n    const description = e.target.value;\n\n    this.setState(prevState => ({\n      currentProject: {\n        ...prevState.currentProject,\n        description: description\n      }\n    }));\n  }\n\n  onChangeStartAt(e) {\n    const startAt = e; //e.target.value;\n    this.setState(function(prevState) {\n      return {\n        currentProject: {\n          ...prevState.currentProject,\n          startAt: startAt\n        }\n      };\n    });\n  };\n\n  getProject(id) {\n    ProjectDataService.get(id)\n      .then(response => {\n        this.setState({\n          currentProject: response.data,\n        });\n\n        this.setState(prevState => ({\n              currentProject: {\n                ...prevState.currentProject,\n                schoolId: response.data.school ? response.data.school.id : null\n              }\n            }));\n\n        this.setState(prevState => ({\n              currentProject: {\n                ...prevState.currentProject,\n                responseId: response.data.response ? response.data.response.id : null\n              }\n            }));\n\n        this.getProjectPhoto(id);\n        console.log(response.data);\n      })\n      .catch(e => {\n        console.log(e);\n      });\n  }\n\n  getProjectPhoto(id) {\n    ProjectDataService.getPhoto(id)\n      .then(response => {\n        var imageURL = 'data:image/png;base64,' +\n            new Buffer(response.data.data.photo, 'binary').toString('base64');\n\n        this.setState(prevState => ({\n              currentProject: {\n                ...prevState.currentProject,\n                photo: imageURL\n              }\n            }));\n\n        console.log(response.data);\n      })\n      .catch(e => {\n        console.log(e);\n      });\n  }\n\n  updatePublished(status) {\n    var data = {\n      id: this.state.currentProject.id,\n      title: this.state.currentProject.title,\n      budget: this.state.currentProject.budget,\n      published: status\n    };\n\n    ProjectDataService.update(this.state.currentProject.id, data)\n      .then(response => {\n        this.setState(prevState => ({\n          currentProject: {\n            ...prevState.currentProject,\n            published: status\n          }\n        }));\n        console.log(response.data);\n      })\n      .catch(e => {\n        console.log(e);\n      });\n  }\n\n  newProject() {\n  this.setState(prevState => ({\n    currentProject: {\n      ...prevState.currentProject,\n      id: null,\n      name: \"\",\n      budget: 0,\n      photo: null,\n      file: null,\n      status: \"\",\n      docFiles: [],\n      docCategory: \"\",\n      description: \"\",\n      startAt: null\n      },\n\n      submitted: false\n    }));\n\n  }\n\n  SAVE_saveProject() {\n    var data = {\n      name: this.state.currentProject.name,\n      budget: this.state.currentProject.budget,\n      schoolId: this.state.currentProject.schoolId,\n      responseId: this.state.currentProject.responseId,\n      status: this.state.currentProject.status,\n      description: this.state.currentProject.description,\n    };\n\n    ProjectDataService.create(data)\n      .then(response => {\n        this.setState(prevState => ({\n          currentProject: {\n            ...prevState.currentProject,\n            id: response.data.id,\n          },\n          submitted: true\n        }));\n\n        if (this.state.currentProject.file) { // photo, followed by docs\n          this.updatePhoto();\n        } else {\n          if (this.state.currentProject.docFiles) // docs\n            this.uploadDossiers();\n        }\n\n        this.setState({\n          message: \"项目信息成功提交!\"\n        });\n\n        console.log(response.data);\n      })\n      .catch(e => {\n        console.log(e);\n      });\n\n      //$('input[name=\"projectId\"]').attr('value', this.state.currentProject.id );\n      //this.refs.formToSubmit.submit();\n  }\n\n  validateSchool() {\n\n    if (!this.state.currentProject.schoolId) {\n      this.setState({\n        message: \"请选择学校\"\n      });\n      return false;\n    }\n    return true;\n  }\n\n  async saveProject() {\n    if (!this.validateSchool()) return;\n\n    var data = {\n      name: this.state.currentProject.name,\n      budget: this.state.currentProject.budget,\n      schoolId: this.state.currentProject.schoolId,\n      responseId: this.state.currentProject.responseId,\n      status: this.state.currentProject.status,\n      description: this.state.currentProject.description,\n      startAt: this.state.currentProject.startAt ? (this.state.currentProject.startAt + '-02-01') : null,\n      xr: this.state.currentProject.xr,\n    };\n\n    try {\n      let response = await ProjectDataService.create(data);\n\n      await this.setState(prevState => ({\n        currentProject: {\n          ...prevState.currentProject,\n          id: response.data.id,\n        },\n      }));\n\n      if (this.state.currentProject.file)\n        await this.updatePhoto();\n\n      if (this.state.currentProject.docFiles) // docs\n        await this.uploadDossiers();\n\n      this.setState({\n        message: \"项目信息成功提交!\",\n        submitted: true\n      });\n\n    } catch (e) {\n      console.log(e);\n      this.setState({\n        message: \"项目信息提交失败!\" || e.message,\n      });\n    };\n\n  }\n\n  async updateProject() {\n    if (!this.validateSchool()) return;\n\n    var data = {\n      name: this.state.currentProject.name,\n      budget: this.state.currentProject.budget,\n      //photo: this.state.currentProject.photo,\n      status: this.state.currentProject.status,\n      schoolId: this.state.currentProject.schoolId,\n      responseId: this.state.currentProject.responseId,\n      description: this.state.currentProject.description,\n      startAt: this.state.currentProject.startAt ? (this.state.currentProject.startAt + '-02-01') : null,\n    };\n\n    try {\n      await ProjectDataService.update(this.state.currentProject.id, data);\n\n      if (this.state.currentProject.file)\n        await this.updatePhoto();\n\n      if (this.state.currentProject.docFiles) // docs\n        await this.uploadDossiers();\n\n      this.setState({\n        message: \"项目信息成功修改!\",\n        submitted: true\n      });\n\n    } catch (e) {\n        this.setState({\n          message: \"项目信息修改失败!\" || e.message\n        });\n        console.log(e);\n    }\n  }\n\n  SAVE_updateProject() {\n    var data = {\n      name: this.state.currentProject.name,\n      budget: this.state.currentProject.budget,\n      //photo: this.state.currentProject.photo,\n      status: this.state.currentProject.status,\n      schoolId: this.state.currentProject.schoolId,\n      responseId: this.state.currentProject.responseId,\n      description: this.state.currentProject.description,\n    };\n\n    ProjectDataService.update(\n      this.state.currentProject.id,\n      data\n      //this.state.currentProject\n    )\n      .then(response => {\n\n        if (this.state.currentProject.file) { // photo, followed by docs\n          this.updatePhoto();\n        } else {\n          if (this.state.currentProject.docFiles) // docs\n            this.uploadDossiers();\n        }\n\n        this.setState({\n          message: \"项目信息成功修改!\",\n          submitted: true\n        });\n\n        console.log(response.data);\n      })\n      .catch(e => {\n        console.log(e);\n      });\n\n/**\n      if (this.state.currentProject.file) {\n        this.updatePhoto();\n      } else {\n        this.uploadDossiers();\n      }\n*/\n  }\n\n\n  async updatePhoto() {\n    var data = new FormData();\n    data.append('multi-files', this.state.currentProject.file, this.state.currentProject.file.name);\n    await ProjectDataService.updatePhoto(this.state.currentProject.id, data);\n  }\n\n  async uploadDossiers() {\n    var data = new FormData();\n    for (var i = 0; i < this.state.currentProject.docFiles.length; i++) {\n      data.append('multi-files', this.state.currentProject.docFiles[i],\n        this.state.currentProject.docFiles[i].name);\n    }\n    data.append('docCategory', this.state.currentProject.docCategory);\n    await ProjectDataService.uploadDossiers(this.state.currentProject.id, data);\n  }\n\n  deleteProject() {\n    ProjectDataService.delete(this.state.currentProject.id)\n      .then(response => {\n        console.log(response.data);\n        this.props.history.push('/projects')\n      })\n      .catch(e => {\n        console.log(e);\n      });\n  }\n\n  onDrag = event => {\n    event.preventDefault()\n  }\n\n  onDrop = event => {\n    event.preventDefault();\n    var file = event.dataTransfer.files[0];\n    this.setState(prevState => ({\n          currentProject: {\n            ...prevState.currentProject,\n            file: file\n          }\n        }));\n\n    var reader = new FileReader();\n    reader.readAsDataURL(file);\n    reader.onload = () => this.setState(prevState => ({\n      currentProject: {\n        ...prevState.currentProject,\n        photo: reader.result\n      }\n    }));\n  }\n\n\n  onChangeDocFiles(e) {\n    e.preventDefault();\n    var docFiles = e.target.files;\n    this.setState(prevState => ({\n          currentProject: {\n            ...prevState.currentProject,\n            docFiles: docFiles\n          }\n        }));\n  }\n\n  renderUpdates() {\n    return (\n            <div>\n            <button\n              className=\"badge badge-danger mr-2\"\n              onClick={this.deleteProject}\n            >\n              Delete\n            </button>\n\n            <button\n              type=\"submit\"\n              className=\"badge badge-success\"\n              onClick={this.updateProject}\n            >\n              Update\n            </button>\n\n            <p>{this.state.message}</p>\n            </div>\n    );\n  }\n\n  render() {\n    const { currentProject } = this.state;\n\n    return (\n      <div>\n        {(this.state.submitted /*&& this.state.newproject*/) ? (\n          <div>\n            <div>{this.state.message}</div>\n            <a href={\"/projectsView/\" + currentProject.id} class=\"btn btn-success\">返回</a>\n{/*}\n            <h4>项目信息成功提交!</h4>\n            <button class=\"btn btn-success\" onClick={this.newProject}>\n              Add\n            </button>\n*/}\n          </div>\n        ) : (\n          <div class=\"row\">\n            <div class=\"col-sm-4\">\n\n              <div class=\"row\">\n                <div onDragOver={this.onDrag} onDrop={this.onDrop}>\n                <p>上传照片（拖拽照片文件到下框中）</p>\n                <img src={currentProject.photo} height=\"200\" width=\"300\" readonly={this.state.readonly?\"\":false} />\n                </div>\n\n                <div class=\"form-group\">\n                <label htmlFor=\"name\">{currentProject.xr && '向荣支持'}项目名称</label>\n                <textarea\n                readonly={this.state.readonly?\"\":false}\n                cols=\"26\"\n                class=\"form-control\"\n                id=\"name\"\n                required\n                value={currentProject.name}\n                onChange={this.onChangeName}\n                name=\"name\"\n                />\n                </div>\n              </div>\n\n                {this.state.readonly && localStorage.getItem('user') && (\n                <div class=\"box\">\n                  <a target=\"_blank\" href={\"/projects/\" + currentProject.id} class=\"btn btn-primary mb-4\">编辑</a>\n                </div>\n                )}\n\n            </div>\n\n            <div class=\"col-sm-8\">\n              <div class=\"row\">\n                <div class=\"form-group col-sm-12\">\n                <label htmlFor=\"description\">项目描述</label>\n                <textarea\n                readonly={this.state.readonly?\"\":false}\n                class=\"form-control\"\n                id=\"description\"\n                required\n                value={currentProject.description}\n                onChange={this.onChangeDescription}\n                name=\"description\"\n                />\n                </div>\n\n                <div class=\"w-100\"></div>\n\n\n                <div class=\"col-sm-8\">\n                  <label htmlFor=\"schoolId\">学校</label>\n                  {!this.state.readonly\n                  ? (<Select onChange={this.onChangeSchoolId.bind(this)}\n                    readonly={this.state.readonly?\"\":false}\n                    class=\"form-control\"\n                    required\n                    id=\"schoolId\"\n                    value={this.display(currentProject.schoolId)}\n                    name=\"schoolId\"\n                    options={this.state.schools}\n                  />)\n                  : (<Link\n                    to={ \"/schoolsView/\" + currentProject.schoolId}\n                    id=\"schoolId\"\n                    name=\"schoolId\"\n                    >\n                      {this.displayName(currentProject.schoolId)}\n                  </Link>)}\n                </div>\n{/*}\n                    <option value=\"\">学校编号（省-学校名）</option>\n                    {this.state.schools.map((option) => (\n                      <option value={option.id}>{option.code + \"(\" + option.region + \" - \" + option.name + \")\"}</option>\n                    ))}\n                  </Select>\n*/}\n\n                <div class=\"w-100\"></div>\n\n                <div class=\"col-sm-4\">\n                <label htmlFor=\"budget\">费用</label>\n                <input\n                readonly={this.state.readonly?\"\":false}\n                type=\"number\" min=\"0.00\" max=\"10000.00\" step=\"0.01\"\n                class=\"form-control\"\n                id=\"budget\"\n                required\n                value={currentProject.budget}\n                onChange={this.onChangeBudget}\n                name=\"budget\"\n                />\n                </div>\n\n                {(currentProject.responseId) ? (\n                <div class=\"col-sm-4\">\n                <label htmlFor=\"response\">项目申请</label>\n                <Link\n                  to={(this.state.readonly ? \"/responsesView/\" : \"/responses/\") + currentProject.responseId}\n                  id=\"response\"\n                  name=\"response\"\n                >\n                  {\"点击查看项目申请\"}\n                </Link>\n                </div>\n                ) : '' }\n\n\n                {(!currentProject.xr) ? (\n                <div class=\"select-container form-group col-sm-4\">\n                <label htmlFor=\"status\">项目状态</label>\n                <select onChange={this.onChangeStatus}\n                readonly={this.state.readonly?\"\":false}\n                class=\"form-control\"\n                id=\"status\"\n                required\n                value={currentProject.status}\n                onChange={this.onChangeStatus}\n                name=\"status\"\n                >\n                <option value=\"\">请选择</option>\n                {this.state.statuses.map((option) => (\n                  <option value={option}>{option}</option>\n                ))}\n                </select>\n                </div>\n                ) : '' }\n\n                <div className=\"col-sm-4\">\n                  <label htmlFor=\"startAt\">项目年份</label>\n                  {(this.state.readonly)\n                  ?<input\n                     type=\"text\"\n                     id='startAt'\n                     readonly=\"\"\n                     className=\"form-control\"\n                     placeholder=\"项目年份\"\n                     value={currentProject.startAt}\n                  />\n                  :<YearPicker\n                     yearArray={['2019', '2020']}\n                     value={currentProject.startAt}\n                     onSelect={this.onChangeStartAt}\n                     minRange={1995}\n                     maxRange={2022}\n                  />\n                  }\n                </div>\n\n              </div>\n            </div>\n\n            <div class=\"w-100\"></div>\n\n            {!this.state.readonly && (\n\n            <div>\n              <button onClick={this.saveProject} class=\"btn btn-success\" hidden={!this.state.newproject}>\n                提交\n              </button>\n\n              <button hidden={this.state.newproject}\n                type=\"submit\"\n                className=\"btn btn-success\"\n                onClick={this.updateProject}\n              >\n                更新\n              </button>\n\n              {(!currentProject.xr) &&\n              <form ref=\"formToSubmit\" action=\"http://localhost:8080/api/dossiers-upload\" method=\"POST\" enctype=\"multipart/form-data\">\n                <div class=\"form-group input-group\">\n                <label for=\"input-multi-files\">上传文件:</label>\n                <input type=\"file\" name=\"multi-files\"\n                multiple\n                id=\"input-multi-files\"\n                class=\"form-control-file border\"\n                onChange={e => this.onChangeDocFiles(e)}\n                />\n\n                <select\n                  className=\"form-control input-group-append\"\n                  placeholder=\"\"\n                  value={currentProject.docCategory}\n                  onChange={e => this.onChangeDocCategory(e)}\n                >\n                  <option value=\"\">附件类别</option>\n                  {this.state.docCategories.map((option) => (\n                    <option value={option}>\n                      {option}\n                    </option>\n                  ))}\n                </select>\n\n                <input type=\"hidden\" name=\"projectId\" id=\"projectId\"/>\n                </div>\n              </form>}\n\n              <p>{this.state.message}</p>\n            </div>)}\n\n            <div class=\"w-100\"></div>\n\n            {(!currentProject.xr && !this.state.newproject) &&\n            <Tabs>\n              <TabList>\n                <Tab>更多信息 <i class=\"fas fa-hand-point-right\"></i></Tab>\n                <Tab>项目文档</Tab>\n              </TabList>\n              <TabPanel>\n              </TabPanel>\n              <TabPanel>\n                <DossiersList\n                  projectId = {currentProject.id}\n                  embedded = {true}\n                  readonly = {this.state.readonly}\n                />\n              </TabPanel>\n            </Tabs>}\n\n            <div class=\"w-100\"></div>\n            <div className=\"alert-danger\">\n            <p><h4>{this.state.message}</h4></p>\n            </div>\n\n          </div>\n        ) }\n      </div>\n    );\n  }\n}\n","import http from \"../http-common\";\nimport authHeader from './auth-header';\n\nclass SchoolDataService {\n\n  getAll2(data) {\n    return http.post(\"/schools/all\", data /*, { headers: authHeader() }*/);\n  }\n\n  getExport(data) {\n    return http.post(\"/schools/export\", data, { headers: authHeader() });\n  }\n\n  getAll(params) {\n    return http.get(\"/schools\", { params }, { headers: authHeader() });\n  }\n\n      /**\n    return http.get(\"/schools\", {\n        params: { params } ,\n        headers: authHeader()\n      }\n    );\n\n  }\n\n    */\n  getAll() {\n    return http.get(\"/schools\", { headers: authHeader() });\n  }\n\n  getRegions() {\n    return http.get(\"/schools/regions\"/*, { headers: authHeader() }*/);\n  }\n\n  getCountsByRegion() {\n    return http.get(\"/schools/countsByRegion\", { headers: authHeader() });\n  }\n\n\n  getStages() {\n    return http.get(\"/schools/stages\"/*, { headers: authHeader() }*/);\n  }\n\n  getStatuses() {\n    return http.get(\"/schools/statuses\"/*, { headers: authHeader() }*/);\n  }\n\n  getStatuses_ss() {\n    return http.get(\"/schools/statuses_ss\"/*, { headers: authHeader() }*/);\n  }\n\n  getRequests() {\n    return http.get(\"/schools/requests\"/*, { headers: authHeader() }*/);\n  }\n\n  getRequests_ss() {\n    return http.get(\"/schools/requests_ss\"/*, { headers: authHeader() }*/);\n  }\n\n  getCategories() {\n    return http.get(\"/schools/categories\"/*, { headers: authHeader() }*/);\n  }\n\n  get(id) {\n    return http.get(`/schools/${id}`/*, { headers: authHeader() }*/);\n  }\n\n  getPrincipal(id) {\n    return http.get(`/schoolsPrincipal/${id}`/*, { headers: authHeader() }*/);\n  }\n\n  getPhoto(id) {\n    return http.get(`/schoolPhoto/${id}`/*, { headers: authHeader() }*/);\n  }\n\n  create(data) {\n    return http.post(\"/schools\", data, { headers: authHeader() });\n  }\n\n  update(id, data) {\n    return http.put(`/schools/${id}`, data, { headers: authHeader() });\n  }\n\n  updatePhoto(id, data) {\n    const user = JSON.parse(localStorage.getItem('user'));\n    return http.post(`/single-upload/${id}`, data, {\n        headers: {\n            'content-type': 'multipart/form-data',\n            'x-access-token':  (user && user.accessToken) ? user.accessToken : null\n            //authHeader()\n        }\n    });\n  }\n\n  uploadDocuments(id, data) {\n    const user = JSON.parse(localStorage.getItem('user'));\n    return http.post(`/documents-upload/${id}`, data, {\n        headers: {\n            'content-type': 'multipart/form-data',\n            'x-access-token':  (user && user.accessToken) ? user.accessToken : null\n            //authHeader()\n        }\n    });\n  }\n\n  delete(id) {\n    return http.delete(`/schools/${id}`, { headers: authHeader() });\n  }\n\n  deleteAll() {\n    return http.delete(`/schools`, { headers: authHeader() });\n  }\n\n  findByTitle(title) {\n    return http.get(`/schools?title=${title}`, { headers: authHeader() });\n  }\n\n  getAllSimple() {\n    return http.get(\"/schoolsSimple\", { headers: authHeader() });\n  }\n\n//\n\n  reduce = (bigObj, smallObj) => {\n    var result = {};\n    Object.keys(smallObj).forEach(key => {\n      Object.assign(result, {[key]: bigObj[key]});\n    });\n    return result;\n  }\n\n}\n\nexport default new SchoolDataService();\n","import http from \"../http-common\";\nimport authHeader from './auth-header';\n\nclass ProjectDataService {\n\n  getAll2(data) {\n    return http.post(\"/projects/all\", data/*, { headers: authHeader() }*/);\n  }\n\n\n  getAll(params) {\n    return http.get(\"/projects\", { params }, { headers: authHeader() });\n  }\n\n      /**\n    return http.get(\"/projects\", {\n        params: { params } ,\n        headers: authHeader()\n      }\n    );\n\n  }\n\n    */\n  getAll() {\n    return http.get(\"/projects\", { headers: authHeader() });\n  }\n\n  getRegions() {\n    return http.get(\"/projects/regions\", { headers: authHeader() });\n  }\n\n  getStatuses() {\n    return http.get(\"/projectsStatuses\", { headers: authHeader() });\n  }\n\n  get(id) {\n    return http.get(`/projects/${id}`/*, { headers: authHeader() }*/);\n  }\n\n  getPhoto(id) {\n    return http.get(`/projectPhoto/${id}`, { headers: authHeader() });\n  }\n\n  create(data) {\n    return http.post(\"/projects\", data, { headers: authHeader() });\n  }\n\n  update(id, data) {\n    return http.put(`/projects/${id}`, data, { headers: authHeader() });\n  }\n\n  updatePhoto(id, data) {\n    const user = JSON.parse(localStorage.getItem('user'));\n    return http.post(`/single-project-upload/${id}`, data, {\n        headers: {\n            'content-type': 'multipart/form-data',\n            'x-access-token':  (user && user.accessToken) ? user.accessToken : null\n            //authHeader()\n        }\n    });\n  }\n\n  uploadDossiers(id, data) {\n    const user = JSON.parse(localStorage.getItem('user'));\n    return http.post(`/dossiers-upload/${id}`, data, {\n        headers: {\n            'content-type': 'multipart/form-data',\n            'x-access-token':  (user && user.accessToken) ? user.accessToken : null\n            //authHeader()\n        }\n    });\n  }\n\n  delete(id) {\n    return http.delete(`/projects/${id}`, { headers: authHeader() });\n  }\n\n  deleteAll() {\n    return http.delete(`/projects`, { headers: authHeader() });\n  }\n\n  findByTitle(title) {\n    return http.get(`/projects?title=${title}`, { headers: authHeader() });\n  }\n\n  getAllSimple() {\n    return http.get(\"/projectsSimple\", { headers: authHeader() });\n  }\n\n  toCSV = (obj, mapper, path = '', newline = true) => {\n    const translate = (column) => {\n      if (mapper) {\n        for (var i = 0; i < mapper.length; i++) {\n          if (column === mapper[i].accessor)\n            return mapper[i].Header;\n        }\n      }\n      return null;\n    }\n\n    if (!(obj instanceof Object)) {\n      const p = path.substring(0, path.lastIndexOf('.')); // drop the last \".\"\n      //return {header: translate(p), body: (obj ? obj.trim() : '')};\n      return {header: translate(p), body: (obj ? obj : '')};\n    }\n\n    if (obj instanceof Array) {\n      var body = '';\n      var header = '';\n      for (var i = 0; i < obj.length; i++) {\n        const result = this.toCSV(obj[i], mapper, path, false);\n        body = body + result.body + (newline ? '\\n' : '');\n        if (!header.endsWith('\\n'))\n          header = header + result.header + (newline ? '\\n' : '');\n      }\n      return {header: header, body: body};\n    }\n\n    if (obj instanceof Object) {\n      var body = '';\n      var header = '';\n      Object.keys(obj).forEach(key => {\n        const result = this.toCSV(obj[key], mapper, path + key + '.', false);\n        if (result.header) {\n          body = body + result.body + ',';\n          if (!header.endsWith('\\n'))\n            header = header + result.header + ',';\n        }\n      });\n      body = body.substring(0, body.lastIndexOf(',')); // drop last ', '\n      header = header.substring(0, header.lastIndexOf(',')); // drop last ', '\n      return {header: header, body: body};\n    }\n  }\n\n  exportCSV = (obj, mapper) => {\n    const render = (item) => {\n      if (item === true) return '是';\n      if (item === false) return '否';\n\n      return (item\n        ? typeof item === 'string'\n          ? item.replace(/(\\r\\n|\\n|\\r)/gm, \"\")\n          : item\n        : ''\n      );\n    }\n\n    const flatten = (obj, path = '', newline = true) => {\n      if (!(obj instanceof Object)) {\n        const p = path.substring(0, path.lastIndexOf('.')); // drop the last \".\"\n        return {hh: '', header: p, body: render(obj)};\n        //return {hh: '', header: p, body: (obj ? obj : '')};\n      }\n\n      if (obj instanceof Array) {\n        var body = '';\n        var header = '';\n        var hh = '';\n        for (var i = 0; i < obj.length; i++) {\n          const result = flatten(obj[i], path, false);\n          body = body + result.body + (newline ? '\\n' : '');\n          header = header + result.header + (newline ? '\\n' : '');\n          if (header.endsWith('\\n')) {\n            hh = (header.length > hh.length) ? header : hh;\n            header = '';\n          }\n        }\n        return {hh: hh, header: header, body: body};\n      }\n\n      if (obj instanceof Object) {\n        var body = '';\n        var header = '';\n        Object.keys(obj).forEach(key => {\n          const result = flatten(obj[key], path + key + '.', false);\n          body = body + result.body + ',';\n          header = header + result.header + ',';\n        });\n        body = body.substring(0, body.lastIndexOf(',')); // drop last ','\n        header = header.substring(0, header.lastIndexOf(',')); // drop last ','\n        return {hh: '', header: header, body: body};\n      }\n    }\n\n    const csv = flatten(obj);\n\n    const header = csv.hh.trim().split(',');\n\n    // build index\n    const index = [];\n    for (var i = 0; i < mapper.length; i++) {\n      for (var j = 0; j < header.length; j++)\n          //if (mapper[i].accessor === header[j])\n          if (header[j].endsWith(mapper[i].accessor))\n            index.push({mapper: i, data: j}); //index.push(j);\n    }\n\n    const order = (line, header = false) => {\n      if (!line || line.trim().length == 0) return \"\";\n\n      const column = line.split(',');\n      //if (column.length == 0)\n        //return \"\";\n\n      var result = \"\";\n      for (var i = 0; i < index.length; i++)\n        result = result + (header\n                            ? mapper[index[i].mapper].Header\n                            //: column[index[i].data]\n                            : render(column[index[i].data])\n                          ) + ',';\n\n      result = result.substring(0, result.lastIndexOf(',')) + '\\n';\n\n      return result;\n    }\n\n    const body = csv.body.split('\\n');\n    var newBody = \"\";\n    for (var i = 0; i < body.length; i++) {\n      newBody = newBody + order(body[i]);\n\n    }\n\n    const newHeader = order(csv.hh, true);\n    return (newHeader + newBody);\n  }\n\n}\n\nexport default new ProjectDataService();\n","module.exports = __webpack_public_path__ + \"static/media/shinshin-logo.e8d0faed.png\";","module.exports = __webpack_public_path__ + \"static/media/defaultPhoto.f4adc5ef.jpg\";","import http from \"../http-common\";\nimport authHeader from './auth-header';\n\nclass SurveyDataService {\n\n  getAll2(data) {\n    return http.post(\"/surveys/all\", data, { headers: authHeader() });\n  }\n\n  getAll(params) {\n    return http.get(\"/surveys\", { params }, { headers: authHeader() });\n      /**\n    return http.get(\"/surveys\", {\n        params: { params } ,\n        headers: authHeader()\n      }\n    );\n    */\n  }\n\n/**\n  getAll() {\n    return http.get(\"/surveys\", { headers: authHeader() });\n  }\n*/\n\n  get(id) {\n    return http.get(`/surveys/${id}`/*, { headers: authHeader() }*/);\n  }\n\n  getUpdatedAt(id) {\n    return http.get(`/surveysUpdatedAt/${id}`, { headers: authHeader() });\n  }\n\n  getContent(id) {\n    const user = JSON.parse(localStorage.getItem('user'));\n    return http.get(`/surveysContent/${id}`, {\n        headers: {\n          'x-access-token':  (user && user.accessToken) ? user.accessToken : null\n        },\n        responseType: 'arraybuffer'\n      });\n  }\n\n  getDocCategories() {\n    return http.get(`/surveys/categories`, { headers: authHeader() });\n  }\n\n  getCount(id) {\n    return http.get(`/surveysCount/${id}`, { headers: authHeader() });\n  }\n\n  create(data) {\n    return http.post(\"/surveys\", data, { headers: authHeader() });\n  }\n\n  update(id, data) {\n    return http.put(`/surveys/${id}`, data, { headers: authHeader() });\n  }\n\n  delete(id) {\n    return http.delete(`/surveys/${id}`, { headers: authHeader() });\n  }\n\n  deleteAll() {\n    return http.delete(`/surveys`, { headers: authHeader() });\n  }\n\n  findByTitle(title) {\n    return http.get(`/surveys?title=${title}`, { headers: authHeader() });\n  }\n}\n\nexport default new SurveyDataService();\n","import axios from \"axios\";\n\nexport default axios.create({\n  baseURL: \"/api\",\n  //baseURL: \"http://localhost:8080/api\",\n  headers: {\n    \"Content-type\": \"application/json\",\n  }\n});\n","export default function authHeader() {\n  const user = JSON.parse(localStorage.getItem('user'));\n\n  if (user && user.accessToken) {\n    // for Node.js Express back-end\n    return { 'x-access-token': user.accessToken };\n  } else {\n    return {};\n  }\n}\n","import React, { Component } from \"react\";\nimport SurveyDataService from \"../services/survey.service\";\nimport { Link } from \"react-router-dom\";\nimport Pagination from \"@material-ui/lab/Pagination\";\n\nimport { useState, useEffect, useMemo, useRef } from \"react\";\nimport { useTable, useSortBy } from \"react-table\";\n\nconst SurveysList = (props) => {\n  const [surveys, setSurveys] = useState([]);\n  const [currentSurvey, setCurrentSurvey] = useState(null);\n  const [currentIndex, setCurrentIndex] = useState(-1);\n  const [searchOriginalname, setSearchOriginalname] = useState(\"\");\n  const [schoolId, setSchoolId] = useState(props.match? props.match.params.schoolId : props.schoolId);\n  const [docCategory, setDocCategory] = useState(props.match? props.match.params.docCategory : props.docCategory);\n\n  const [orderby, setOrderby] = useState([]);\n\n  const [readonly, setReadonly] = useState(props.readonly ? props.readonly : false);\n\n  const [embedded, setEmbedded] = useState(props.embedded ? props.embedded : false);\n\n  const surveysRef = useRef();\n  surveysRef.current = surveys;\n\n  const [page, setPage] = useState(1);\n  const [count, setCount] = useState(0);\n  const [pageSize, setPageSize] = useState(5);\n\n  const pageSizes = [5, 10, 20];\n\n  const onChangeSearchOriginalname = (e) => {\n    const searchOriginalname = e.target.value;\n    setSearchOriginalname(searchOriginalname);\n  };\n\n  const getRequestParams = (/*searchOriginalname, page, pageSize, schoolId, docCategory*/) => {\n    let params = {};\n\n    if (searchOriginalname) {\n      params[\"originalname\"] = searchOriginalname;\n    }\n\n    if (page) {\n      params[\"page\"] = page - 1;\n    }\n\n    if (pageSize) {\n      params[\"size\"] = pageSize;\n    }\n\n    if (schoolId) {\n      params[\"schoolId\"] = schoolId;\n    }\n\n    if (docCategory) {\n      params[\"docCategory\"] = docCategory;\n    }\n\n    if (orderby) {\n      params[\"orderby\"] = orderby;\n    }\n\n    return params;\n  };\n\n  const retrieveSurveys = () => {\n    const params = getRequestParams(/*searchOriginalname, page, pageSize, schoolId, docCategory*/);\n\n    SurveyDataService.getAll2(params)\n      .then((response) => {\n        const { surveys, totalPages } = response.data;\n\n        setSurveys(surveys);\n        setCount(totalPages);\n\n        console.log(response.data);\n      })\n      .catch((e) => {\n        console.log(e);\n      });\n  };\n\n  useEffect(retrieveSurveys, [page, pageSize, orderby]);\n\n  const refreshList = () => {\n    retrieveSurveys();\n  };\n\n  const removeAllSurveys = () => {\n    SurveyDataService.deleteAll()\n      .then((response) => {\n        console.log(response.data);\n        refreshList();\n      })\n      .catch((e) => {\n        console.log(e);\n      });\n  };\n\n\n  const openSurvey = (rowIndex) => {\n    const id = surveysRef.current[rowIndex].id;\n\n    props.history.push(\"/surveys/\" + id);\n  };\n\n  const deleteSurvey = (rowIndex) => {\n    const id = surveysRef.current[rowIndex].id;\n\n    SurveyDataService.delete(id)\n      .then((response) => {\n        //props.history.push(\"/surveys\");\n\n        let newSurveys = [...surveysRef.current];\n        newSurveys.splice(rowIndex, 1);\n\n        setSurveys(newSurveys);\n      })\n      .catch((e) => {\n        console.log(e);\n      });\n  };\n\n  const columns = useMemo(\n    () => [\n      {\n        Header: \"最后修改时间\",\n        accessor: \"updatedAt\",\n        Cell: (props) => {\n          const rowIdx = props.row.id;\n          const d = new Date(surveysRef.current[rowIdx].createdAt);\n          return (\n            <div>\n              {d.toLocaleDateString('zh-cn', { hour12: true, hour: \"2-digit\", minute: \"2-digit\", second: \"2-digit\" })}\n            </div>\n          );\n        },\n      },\n      {\n        Header: \"学校\",\n        accessor: 'school',\n        disableSortBy: true,\n        Cell: (props) => {\n          const rowIdx = props.row.id;\n          return (\n            <div>\n              <Link\n                to={\"/schoolsView/\" + surveysRef.current[rowIdx].schoolId}\n                className=\"badge badge-success\"\n              >\n                {surveysRef.current[rowIdx].schoolId}\n              </Link>\n            </div>\n          );\n        }\n      },\n      {\n        Header: \"操作\",\n        accessor: \"actions\",\n        disableSortBy: true,\n        Cell: (props) => {\n          const rowIdx = props.row.id;\n          return (\n            <div>\n              <Link\n                to={\"/surveysView/\" + surveysRef.current[rowIdx].schoolId}\n              >\n                <i className=\"fas fa-eye action mr-2\"></i>\n              </Link>\n\n              {!readonly && (<Link\n                to={\"/surveys/\" + surveysRef.current[rowIdx].schoolId}\n              >\n                <i className=\"far fa-edit action mr-2\"></i>\n              </Link>)}\n\n              {!readonly && (<span onClick={() => window.confirm(\"您确定要删除吗 ?\") && deleteSurvey(rowIdx)}>\n                <i className=\"fas fa-trash action\"></i>\n              </span>)}\n            </div>\n          );\n        },\n      },\n    ],\n    []\n  );\n\n  const hiddenColumns = embedded\n    ? ['school']\n    : [];\n\n  const {\n    getTableProps,\n    getTableBodyProps,\n    headerGroups,\n    rows,\n    prepareRow,\n    state: {sortBy},\n  } = useTable({\n    columns,\n    data: surveys,\n    disableSortRemove: true,\n    manualSortBy: true,\n    initialState: {\n      sortBy: [\n        {\n          id: 'updatedAt',\n          desc: false\n        }\n      ]\n    },\n  },\n  useSortBy);\n\n  const findByOriginalname = () => {\n    setPage(1);\n    retrieveSurveys();\n  };\n\n  const handlePageChange = (event, value) => {\n    setPage(value);\n  };\n\n  const handlePageSizeChange = (event) => {\n    setPageSize(event.target.value);\n    setPage(1);\n  };\n\n  useEffect(() => {\n    if (sortBy && sortBy[0])\n      setOrderby(sortBy);\n  }, [sortBy]);\n\n  return (\n    <div className=\"list row\">\n      {!embedded && (<div className=\"col-sm-8\">\n        <h4>调查表列表</h4>\n        <div className=\"input-group mb-3\">\n          <input\n            type=\"text\"\n            className=\"form-control\"\n            placeholder=\"Search by originalname\"\n            value={searchOriginalname}\n            onChange={onChangeSearchOriginalname}\n          />\n          <div className=\"input-group-append\">\n            <button\n              className=\"btn btn-outline-secondary\"\n              type=\"button\"\n              onClick={findByOriginalname}\n            >\n              Search\n            </button>\n          </div>\n        </div>\n\n        {\"每页显示行数: \"}\n        <select onChange={handlePageSizeChange} value={pageSize}>\n          {pageSizes.map((size) => (\n            <option key={size} value={size}>\n              {size}\n            </option>\n          ))}\n        </select>\n\n        <Pagination\n          className=\"my-3\"\n          count={count}\n          page={page}\n          siblingCount={1}\n          boundaryCount={1}\n          variant=\"outlined\"\n          shape=\"rounded\"\n          onChange={handlePageChange}\n        />\n      </div>)}\n\n      <div className=\"col-sm-12 list\">\n        <table\n          className=\"table table-striped table-bordered\"\n          {...getTableProps()}\n        >\n          <thead>\n            {headerGroups.map((headerGroup) => (\n              <tr {...headerGroup.getHeaderGroupProps()}>\n                {headerGroup.headers.map((column) => (\n                // Add the sorting props to control sorting. For this example\n                // we can add them into the header props\n                  <th {...column.getHeaderProps(column.getSortByToggleProps())}>\n                    {column.render('Header')}\n                    {/* Add a sort direction indicator */}\n                      <span>\n                        {column.isSorted\n                        ? column.isSortedDesc\n                          ? ' 🔽'\n                          : ' 🔼'\n                        : ''}\n                      </span>\n                    </th>\n                ))}\n              </tr>\n            ))}\n          </thead>\n          <tbody {...getTableBodyProps()}>\n            {rows.map((row, i) => {\n              prepareRow(row);\n              return (\n                <tr {...row.getRowProps()}>\n                  {row.cells.map((cell) => {\n                    return (\n                      <td {...cell.getCellProps()}>{cell.render(\"Cell\")}</td>\n                    );\n                  })}\n                </tr>\n              );\n            })}\n          </tbody>\n        </table>\n      </div>\n\n      <div className=\"col-sm-8\">\n      </div>\n    </div>\n  );\n};\n\nexport default SurveysList;","import React, { Component } from \"react\";\nimport SchoolDataService from \"../services/school.service\";\nimport ProjectDataService from \"../services/project.service\";\nimport { Link } from \"react-router-dom\";\nimport Pagination from \"@material-ui/lab/Pagination\";\nimport { withRouter } from \"react-router-dom\";\n\nimport { useState, useEffect, useMemo, useRef, useCallback } from \"react\";\nimport { useTable, useSortBy } from \"react-table\";\n\nimport YearPicker from 'react-single-year-picker';\n\nconst SchoolsList = (props) => {\n  const [schools, setSchools] = useState([]);\n  const [exportSchools, setExportSchools] = useState([]);\n\n  const [currentSchool, setCurrentSchool] = useState(null);\n  const [currentUser, setCurrentUser] = useState(localStorage.getItem('user'));\n\n  const [currentIndex, setCurrentIndex] = useState(-1);\n  const [searchName, setSearchName] = useState(\"\");\n  const [searchCode, setSearchCode] = useState(\"\");\n  const [searchRegion, setSearchRegion] = useState(props.match? props.match.params.region : props.region);\n  const [searchStartAt, setSearchStartAt] = useState(\"\");\n  const [searchLastVisit, setSearchLastVisit] = useState(\"\");\n  const [searchDonor, setSearchDonor] = useState(\"\");\n  const [searchStage, setSearchStage] = useState(\"\");\n  const [searchStatus, setSearchStatus] = useState(\"\");\n  const [searchRequest, setSearchRequest] = useState(\"\");\n  const [searchXR, setSearchXR] = useState(null);\n\n  const schoolsRef = useRef();\n  schoolsRef.current = schools;\n\n  const [page, setPage] = useState(1);\n  const [count, setCount] = useState(0);\n  const [pageSize, setPageSize] = useState(30);\n\n  const [totalItems, setTotalItems] = useState(0);\n\n  const pageSizes = [20, 30, 50];\n\n  const [orderby, setOrderby] = useState([]);\n\n  const [regions, setRegions] = useState([]);\n  const [stages, setStages] = useState([]);\n  const [statuses, setStatuses] = useState([]);\n  const [requests, setRequests] = useState([]);\n\n\n  const onChangeSearchName = (e) => {\n    const searchName = e.target.value;\n    setSearchName(searchName);\n  };\n\n  const onChangeSearchCode = (e) => {\n    const searchCode = e.target.value;\n    setSearchCode(searchCode);\n  };\n\n  const onChangeSearchRegion = (e) => {\n    const searchRegion = e.target.value;\n    setSearchRegion(searchRegion);\n  };\n\n  const onChangeSearchDonor = (e) => {\n    const searchDonor = e.target.value;\n    setSearchDonor(searchDonor);\n  };\n\n  const onChangeSearchStage = (e) => {\n    const searchStage = e.target.value;\n    setSearchStage(searchStage);\n  };\n\n  const onChangeSearchStatus = (e) => {\n    const searchStatus = e.target.value;\n    setSearchStatus(searchStatus);\n  };\n\n  const onChangeSearchRequest = (e) => {\n    const searchRequest = e.target.value;\n    setSearchRequest(searchRequest);\n  };\n\n  const onChangeSearchStartAt = (e) => {\n    const searchStartAt = e; //e.target.value;\n    setSearchStartAt(searchStartAt);\n  };\n\n  const onChangeSearchLastVisit = (e) => {\n    const searchLastVisit = e; //e.target.value;\n    setSearchLastVisit(searchLastVisit);\n  };\n\n  const onChangeSearchXR = (e) => {\n    const searchXR = e.target.value;\n    setSearchXR(searchXR);\n  };\n  \n  const onClearSearch = (e) => {\n    setSearchName(\"\");\n    setSearchCode(\"\");\n    setSearchRegion(\"\");\n    setSearchStartAt(\"\");\n    setSearchLastVisit(\"\");\n    setSearchDonor(\"\");\n    setSearchStage(\"\");\n    setSearchStatus(\"\");\n    setSearchRequest(\"\");\n    setSearchXR(\"\");\n    \n    setOrderby([]);\n    setExportSchools([]);\n  };\n\n  const getRequestParams = (/*searchName, page, pageSize, orderby,\n    searchCode, searchRegion, searchStartAt, */exportFlag) => {\n    let params = {};\n\n    if (searchName) {\n      params[\"name\"] = searchName;\n    }\n\n    if (page) {\n      params[\"page\"] = page - 1;\n    }\n\n    if (pageSize) {\n      params[\"size\"] = pageSize;\n    }\n\n    if (orderby) {\n      params[\"orderby\"] = orderby;\n    }\n\n    if (searchCode) {\n      params[\"code\"] = searchCode;\n    }\n\n    if (searchRegion) {\n      params[\"region\"] = searchRegion;\n    }\n\n    if (searchStartAt) {\n      params[\"startAt\"] = searchStartAt;\n    }\n\n    if (searchLastVisit) {\n      params[\"lastVisit\"] = searchLastVisit;\n    }\n\n    if (searchDonor) {\n      params[\"donor\"] = searchDonor;\n    }\n\n    if (searchStage) {\n      params[\"stage\"] = searchStage;\n    }\n\n    if (searchStatus) {\n      params[\"status\"] = searchStatus;\n    }\n\n    if (searchRequest) {\n      params[\"request\"] = searchRequest;\n    }\n\n    if (searchXR) {\n      params[\"xr\"] = searchXR;\n    }\n    \n    if (exportFlag) {\n      params[\"exportFlag\"] = exportFlag;\n    }\n\n    return params;\n  };\n\n  const getRegions = () => {\n    if (regions.length == 0) {\n      SchoolDataService.getRegions()\n        .then(response => {\n          setRegions(response.data);\n          console.log(response);\n        })\n        .catch(e => {\n          console.log(e);\n        });\n    }\n  }\n\n\n  const getRequests = () => {\n    SchoolDataService.getRequests_ss()\n      .then(response => {\n        setRequests(response.data);\n        console.log(response);\n      })\n      .catch(e => {\n        console.log(e);\n      });\n  }\n\n  const getStatuses = () => {\n    SchoolDataService.getStatuses_ss()\n      .then(response => {\n        setStatuses(response.data);\n        console.log(response);\n      })\n      .catch(e => {\n        console.log(e);\n      });\n  }\n\n  const getStages = () => {\n    SchoolDataService.getStages()\n      .then(response => {\n        setStages(response.data);\n        console.log(response);\n      })\n      .catch(e => {\n        console.log(e);\n      });\n  }\n\n  useEffect(getRegions, [orderby]);\n  useEffect(getStages, [orderby]);\n  useEffect(getStatuses, [orderby]);\n  useEffect(getRequests, [orderby]);\n\n  const retrieveSchools = () => {\n    const params = getRequestParams(/*searchName, page, pageSize, orderby,\n        searchCode, searchRegion, searchStartAt, */false);\n\n    SchoolDataService.getAll2(params)\n      .then((response) => {\n        const { schools, totalPages, totalItems } = response.data;\n\n        setSchools(schools);\n        setCount(totalPages);\n        setTotalItems(totalItems);\n\n        console.log(response.data);\n      })\n      .catch((e) => {\n        console.log(e);\n      });\n  };\n\n  const retrieveExportSchoolsDetail = () => {\n    doRetrieveExportSchools({main: getAttributes(exportColumnsMain),\n                detail: getAttributes(exportColumnsDetail)});\n  }\n\n  const retrieveExportSchools = () => {\n    doRetrieveExportSchools({main: getAttributes(exportColumnsMain), detail: []});\n  }\n\n  const doRetrieveExportSchools = (columns) => {\n\n    const filters = getRequestParams(true);\n\n    //SchoolDataService.getExport(columns)\n    SchoolDataService.getExport({...columns, ...filters})\n      .then(response => {\n        setExportSchools(response.data);\n        console.log(response.data);\n\n        const csv = ProjectDataService.exportCSV(response.data, exportColumns);\n        const url = window.URL.createObjectURL(new Blob([csv]));\n\n        const link = document.createElement('a');\n        link.href = url;\n        link.setAttribute('download',\n                'schools_export' + (columns.detail[0] ? '_detail' : '') + '.csv'\n            );\n        document.body.appendChild(link);\n        link.click();\n        link.remove();\n      })\n      .catch(error => {\n        const resMessage =\n          (error.response &&\n            error.response.data &&\n            error.response.data.message) ||\n          error.message ||\n          error.toString();\n        console.log(error);\n        console.log(resMessage);\n      });\n  };\n\n  const SAVE_retrieveExportSchools = () => {\n    const params = getRequestParams(/*searchName, page, pageSize, orderby,\n        searchCode, searchRegion, searchStartAt, */true);\n\n    SchoolDataService.getAll2(params)\n      .then((response) => {\n        const { schools, totalPages, totalItems } = response.data;\n        setExportSchools(schools);\n        console.log(response.data);\n\n        //const csv = ProjectDataService.toCSV(schools, columns);\n        //const url = window.URL.createObjectURL(new Blob([csv.header + csv.body]));\n        const csv = ProjectDataService.exportCSV(schools, columns);\n        const url = window.URL.createObjectURL(new Blob([csv]));\n\n        const link = document.createElement('a');\n        link.href = url;\n        link.setAttribute('download',\n                'school.csv'\n            );\n        document.body.appendChild(link);\n        link.click();\n        link.remove();\n      })\n      .catch((e) => {\n        console.log(e);\n      });\n  };\n\n  useEffect(retrieveSchools, [page, pageSize, orderby, searchName, searchCode, searchRegion, searchStartAt,\n                            searchLastVisit, searchDonor, searchStage, searchStatus, searchRequest, searchXR]);\n\n  const refreshList = () => {\n    retrieveSchools();\n  };\n\n  const removeAllSchools = () => {\n    SchoolDataService.deleteAll()\n      .then((response) => {\n        console.log(response.data);\n        refreshList();\n      })\n      .catch((e) => {\n        console.log(e);\n      });\n  };\n\n\n  const openSchool = (rowIndex) => {\n    const id = schoolsRef.current[rowIndex].id;\n\n    props.history.push(\"/schools/\" + id);\n  };\n\n  const deleteSchool = (rowIndex) => {\n    const id = schoolsRef.current[rowIndex].id;\n\n    SchoolDataService.delete(id)\n      .then((response) => {\n        //props.history.push(\"/schools\");\n\n        let newSchools = [...schoolsRef.current];\n        newSchools.splice(rowIndex, 1);\n\n        setSchools(newSchools);\n      })\n      .catch((e) => {\n        console.log(e);\n      });\n  };\n\n  const getAttributes = (mapper) => {\n    var result = [];\n    for (var i = 0; i < mapper.length; i++)\n      result.push(mapper[i].accessor);\n    return result;\n  }\n\n\n  const exportColumnsMain = [\n      {\n        Header: \"学校编号\",\n        accessor: \"code\",\n      },\n      {\n        Header: \"学校名称\",\n        accessor: \"name\",\n      },\n      {\n        Header: \"教育局注册校名\",\n        accessor: \"schoolBoardRegisteredName\",\n      },\n      {\n        Header: \"主管教育局名称\",\n        accessor: \"schoolBoard\",\n      },\n      {\n        Header: \"建校年份\",\n        accessor: \"startAt\",\n      },\n      {\n        Header: \"捐款人\",\n        accessor: \"donor\",\n      },\n      {\n        Header: \"最近访校年份\",\n        accessor: \"lastVisit\",\n      },\n\n      {\n        Header: \"学校阶段\",\n        accessor: \"stage\",\n      },\n      {\n        Header: \"学校状态\",\n        accessor: \"status\",\n      },\n      {\n        Header: \"需求状态\",\n        accessor: \"request\",\n      },\n      {\n        Header: \"省/自治区/直辖市\",\n        accessor: \"region\",\n      },\n      {\n        Header: \"市\",\n        accessor: \"city\",\n      },\n      {\n        Header: \"区/县\",\n        accessor: \"county\",\n      },\n      {\n        Header: \"乡/镇\",\n        accessor: \"community\",\n      },\n      {\n        Header: \"地址\",\n        accessor: \"address\",\n      },\n\n      {\n        Header: \"教师人数\",\n        accessor: \"teachersCount\",\n      },\n      {\n        Header: \"学生人数\",\n        accessor: \"studentsCount\",\n      },\n      {\n        Header: \"学校类型\",\n        accessor: \"category\",\n      },\n      {\n        Header: \"校长\",\n        accessor: \"principalId\",\n      },\n      {\n        Header: \"校长电话\",\n        accessor: \"principalPhone\",\n      },\n      {\n        Header: \"校长微信\",\n        accessor: \"principalWechat\",\n      },\n      {\n        Header: \"联络人\",\n        accessor: \"contactId\",\n      },\n      {\n        Header: \"联络人电话\",\n        accessor: \"contactPhone\",\n      },\n      {\n        Header: \"联络人微信\",\n        accessor: \"contactWechat\",\n      },\n  ];\n\n  const exportColumnsDetail = [\n      {\n        Header: \"学校电话\",\n        accessor: \"phone\",\n      },\n      {\n        Header: \"学校电邮地址\",\n        accessor: \"email\",\n      },\n      {\n        Header: \"留守儿童人数\",\n        accessor: \"stayBehindCount\",\n      },\n      {\n        Header: \"学生住宿人数\",\n        accessor: \"boarderCount\",\n      },\n      {\n        Header: \"学前班级数\",\n        accessor: \"kClassesCount\",\n      },\n      {\n        Header: \"一年级班级数\",\n        accessor: \"g1ClassesCount\",\n      },\n      {\n        Header: \"二年级班级数\",\n        accessor: \"g2ClassesCount\",\n      },\n      {\n        Header: \"三年级班级数\",\n        accessor: \"g3ClassesCount\",\n      },\n      {\n        Header: \"四年级班级数\",\n        accessor: \"g4ClassesCount\",\n      },\n      {\n        Header: \"五年级班级数\",\n        accessor: \"g5ClassesCount\",\n      },\n      {\n        Header: \"六年级班级数\",\n        accessor: \"g6ClassesCount\",\n      },\n      {\n        Header: \"学前学生数\",\n        accessor: \"kStudentsCount\",\n      },\n      {\n        Header: \"一年级学生数\",\n        accessor: \"g1StudentsCount\",\n      },\n      {\n        Header: \"二年级学生数\",\n        accessor: \"g2StudentsCount\",\n      },\n      {\n        Header: \"三年级学生数\",\n        accessor: \"g3StudentsCount\",\n      },\n      {\n        Header: \"四年级学生数\",\n        accessor: \"g4StudentsCount\",\n      },\n      {\n        Header: \"五年级学生数\",\n        accessor: \"g5StudentsCount\",\n      },\n      {\n        Header: \"六年级学生数\",\n        accessor: \"g6StudentsCount\",\n      },\n      {\n        Header: \"如有初中学生数\",\n        accessor: \"mStudentsCount\",\n      },\n      {\n        Header: \"办公用电脑台数\",\n        accessor: \"computersCount\",\n      },\n      {\n        Header: \"是否有电脑室\",\n        accessor: \"computerRoomExists\",\n      },\n      {\n        Header: \"共有几台电脑\",\n        accessor: \"computerRoomCount\",\n      },\n      {\n        Header: \"可否上网\",\n        accessor: \"internetExists\",\n      },\n      {\n        Header: \"多媒体一体机套数\",\n        accessor: \"multimediaSystemsCount\",\n      },\n      {\n        Header: \"是否有图书阅览室\",\n        accessor: \"libraryExists\",\n      },\n      {\n        Header: \"图书角数量\",\n        accessor: \"bookCornersCount\",\n      },\n      {\n        Header: \"图书册数\",\n        accessor: \"booksCount\",\n      },\n    ];\n\n  const exportColumns = [...exportColumnsMain, ...exportColumnsDetail];\n\n  const columns = useMemo(\n    () => [\n      {\n        Header: \"ID\",\n        accessor: \"id\",\n        disableSortBy: true,\n      },\n      {\n        Header: \"学校编号\",\n        accessor: \"code\",\n        Cell: (props) => {\n          const rowIdx = props.row.id;\n          return (\n            <div>\n              <Link\n                to={\"/schoolsView/\" + schoolsRef.current[rowIdx].id}\n              >\n                {schoolsRef.current[rowIdx].code}\n              </Link>\n            </div>\n          );\n        },\n      },\n      {\n        Header: \"省/自治区/直辖市\",\n        accessor: \"region\",\n      },\n      {\n        Header: \"学校名称\",\n        accessor: \"name\",\n      },\n      {\n        Header: \"建校年份\",\n        accessor: \"startAt\",\n        //Filter: SelectStartAtFilter,\n      },\n      {\n        Header: \"最近访校年份\",\n        accessor: \"lastVisit\",\n        //Filter: SelectStartAtFilter,\n      },\n/**\n      {\n        Header: \"校长\",\n        accessor: \"principal\",\n        disableSortBy: true,\n      },\n*/\n      {\n        Header: \"学校阶段\",\n        accessor: \"stage\",\n      },\n      {\n        Header: \"学校状态\",\n        accessor: \"status\",\n      },\n      {\n        Header: \"需求状态\",\n        accessor: \"request\",\n      },\n      {\n        Header: \"捐款人\",\n        accessor: \"donor\",\n        disableSortBy: true,\n      },\n/**\n      {\n        Header: \"教师人数\",\n        accessor: \"teachersCount\",\n      },\n      {\n        Header: \"学生人数\",\n        accessor: \"studentsCount\",\n      },\n*/\n      {\n        Header: \"项目\",\n        accessor: \"projectsCount\",\n\n        Cell: (props) => {\n          const rowIdx = props.row.id;\n          return (\n            <div>\n              <Link\n                to={\"/projects/school/\" + schoolsRef.current[rowIdx].id}\n                className=\"badge badge-success\"\n              >\n                {schoolsRef.current[rowIdx].projectsCount}\n              </Link>\n            </div>\n          );\n        },\n      },\n      {\n        Header: \"项目申请\",\n        accessor: \"responsesCount\",\n\n        Cell: (props) => {\n          const rowIdx = props.row.id;\n          return (\n            <div>\n              <Link\n                to={\"/responses/school/\" + schoolsRef.current[rowIdx].id}\n                className=\"badge badge-success\"\n              >\n                {schoolsRef.current[rowIdx].responsesCount}\n              </Link>\n            </div>\n          );\n        },\n      },\n      {\n        Header: \"向荣支持\",\n        accessor: 'xr',\n        Cell: (props) => {\n          const rowIdx = props.row.id;\n          return (\n            <div>\n                {schoolsRef.current[rowIdx].xr ? '是' : '否'}\n            </div>\n          );\n        },\n      },      \n      {\n        Header: \"操作\",\n        accessor: \"actions\",\n        disableSortBy: true,\n        Cell: (props) => {\n          const rowIdx = props.row.id;\n          return (\n            <div>\n              <Link\n                to={\"/schoolsView/\" + schoolsRef.current[rowIdx].id}\n              >\n                <i className=\"fas fa-eye action mr-2\"></i>\n              </Link>\n\n              {currentUser && (<Link\n                to={\"/schools/\" + schoolsRef.current[rowIdx].id}\n              >\n                <i className=\"far fa-edit action mr-2\"></i>\n              </Link>)}\n\n              {currentUser && (<span onClick={() => window.confirm(\"您确定要删除吗 ?\") && deleteSchool(rowIdx)}>\n                <i className=\"fas fa-trash action\"></i>\n              </span>)}\n            </div>\n          );\n        },\n      },\n    ],\n    []\n  );\n\n  const {\n    getTableProps,\n    getTableBodyProps,\n    headerGroups,\n    rows,\n    prepareRow,\n    state,\n    state: {sortBy},\n  } = useTable({\n    columns,\n    data: schools,\n    disableSortRemove: true,\n    manualSortBy: true,\n    initialState: {\n      sortBy: [\n        {\n          id: 'code',\n          desc: false\n        }\n      ]\n    },\n  },\n  useSortBy,\n  );\n\n  const findByName = () => {\n    setPage(1);\n    retrieveSchools();\n  };\n\n  const handlePageChange = (event, value) => {\n    setPage(value);\n  };\n\n  const handlePageSizeChange = (event) => {\n    setPageSize(event.target.value);\n    setPage(1);\n  };\n\n  useEffect(() => {\n    if (sortBy && sortBy[0])\n      setOrderby(sortBy);\n  }, [sortBy]);\n\n  //useEffect(() => {\n  //}, [filters]);\n\n\n  return (\n    <div className=\"list row\">\n      <div className=\"col-sm-9\">\n        <h4>学校列表(总数：{totalItems})</h4>\n        <div className=\"row mb-3\">\n\n          <input\n            type=\"text\"\n            className=\"form-control col-sm-2 ml-2\"\n            placeholder=\"学校编号\"\n            value={searchCode}\n            onChange={onChangeSearchCode}\n          />\n\n          <select\n            className=\"form-control col-sm-2 ml-2\"\n            placeholder=\"....\"\n            value={searchRegion}\n            onChange={onChangeSearchRegion}\n          >\n            <option value=\"\">省/自治区</option>\n            {regions.map((option) => (\n            <option value={option}>\n            {option}\n            </option>\n            ))}\n          </select>\n\n          <input\n            type=\"text\"\n            className=\"form-control col-sm-4 ml-2\"\n            placeholder=\"学校名称\"\n            value={searchName}\n            onChange={onChangeSearchName}\n          />\n\n\n          <input\n            type=\"text\"\n            readonly=\"\"\n            className=\"form-control col-sm-1 ml-2\"\n            placeholder=\"建校\"\n            value={searchStartAt}\n          />\n          <YearPicker\n            yearArray={['2019', '2020']}\n            value={searchStartAt}\n            onSelect={onChangeSearchStartAt}\n            hideInput={true}\n            minRange={1995}\n            maxRange={2022}\n          />\n\n\n          <input\n            type=\"text\"\n            readonly=\"\"\n            className=\"form-control col-sm-1 ml-2\"\n            placeholder=\"访校\"\n            value={searchLastVisit}\n          />\n          <YearPicker\n            yearArray={['2019', '2020']}\n            value={searchLastVisit}\n            onSelect={onChangeSearchLastVisit}\n            hideInput={true}\n            minRange={1995}\n            maxRange={2022}\n          />\n\n        </div>\n\n        <div className=\"row mb-3 \">\n\n          <select\n            className=\"form-control col-sm-2 ml-2\"\n            placeholder=\"....\"\n            value={searchStage}\n            onChange={onChangeSearchStage}\n          >\n            <option value=\"\">学校阶段</option>\n            {stages.map((option) => (\n            <option value={option}>\n            {option}\n            </option>\n            ))}\n          </select>\n\n          <select\n            className=\"form-control col-sm-2 ml-2\"\n            placeholder=\"....\"\n            value={searchStatus}\n            onChange={onChangeSearchStatus}\n          >\n            <option value=\"\">学校状态</option>\n            {statuses.map((option) => (\n            <option value={option}>\n            {option}\n            </option>\n            ))}\n          </select>\n\n          <select\n            className=\"form-control col-sm-2 ml-2\"\n            placeholder=\"....\"\n            value={searchRequest}\n            onChange={onChangeSearchRequest}\n          >\n            <option value=\"\">需求状态</option>\n            {requests.map((option) => (\n            <option value={option}>\n            {option}\n            </option>\n            ))}\n          </select>\n\n          <input\n            type=\"text\"\n            className=\"form-control col-sm-2 ml-2\"\n            placeholder=\"捐款人\"\n            value={searchDonor}\n            onChange={onChangeSearchDonor}\n          />\n\n          <select\n            className=\"form-control col-sm-2 ml-2\"\n            value={searchXR}\n            onChange={onChangeSearchXR}\n          >\n            <option value=\"\">向荣支持?</option>\n              <option value={false}>\n                {'否'}\n              </option>\n              <option value={true}>\n                {'是'}\n              </option>\n          </select>\n          \n          <div>\n            <button\n              className=\"btn btn-primary  ml-2\"\n              type=\"button\"\n              onClick={onClearSearch}\n            >\n              清空\n            </button>\n          </div>\n\n        </div>\n\n        <div className=\"input-group mb-4\">\n          <div>\n            <button\n              className=\"btn btn-primary \"\n              type=\"button\"\n              onClick={findByName}\n            >\n              查询\n            </button>\n          </div>\n          <div hidden={!currentUser}>\n            <button\n              className=\"btn btn-primary ml-2\"\n              type=\"button\"\n              onClick={retrieveExportSchools}\n            >\n              导出\n            </button>\n          </div>\n          <div hidden={!currentUser}>\n            <button\n              className=\"btn btn-primary ml-2\"\n              type=\"button\"\n              onClick={retrieveExportSchoolsDetail}\n            >\n              详细导出\n            </button>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"mt-3 col-sm-3\">\n        {\"每页显示行数: \"}\n        <select onChange={handlePageSizeChange} value={pageSize}>\n          {pageSizes.map((size) => (\n            <option key={size} value={size}>\n              {size}\n            </option>\n          ))}\n        </select>\n\n        <Pagination\n          className=\"my-3\"\n          count={count}\n          page={page}\n          siblingCount={1}\n          boundaryCount={1}\n          variant=\"outlined\"\n          shape=\"rounded\"\n          onChange={handlePageChange}\n        />\n      </div>\n\n        <div class=\"w-100\"></div>\n\n      <div className=\"col-sm-12 list\">\n        <table\n          className=\"table table-striped table-bordered\"\n          {...getTableProps()}\n        >\n          <thead>\n            {headerGroups.map((headerGroup) => (\n              <tr {...headerGroup.getHeaderGroupProps()}>\n                {headerGroup.headers.map((column) => (\n                  // Add the sorting props to control sorting. For this example\n                  // we can add them into the header props\n                  <th {...column.getHeaderProps(column.getSortByToggleProps())}>\n                    {column.render('Header')}\n                    {/* Add a sort direction indicator */}\n                    <span>\n                      {/*column.isSorted*/ (column.id === 'code' || column.id === 'region' ||\n                      column.id === 'startAt' || column.id === 'teachersCount' ||\n                      column.id === 'studentsCount' || column.id === 'name' ||\n                      column.id === 'projectsCount' || column.id === 'responsesCount' ||\n                      column.id === 'stage' || column.id === 'lastVisit' ||\n                      column.id === 'status' || column.id === 'request' || column.id === 'xr'\n                      )\n                      ? column.isSortedDesc\n                        ? ' 🔽'\n                        : ' 🔼'\n                      : ''}\n                    </span>\n                  </th>\n                ))}\n              </tr>\n            ))}\n          </thead>\n          <tbody {...getTableBodyProps()}>\n            {rows.map((row, i) => {\n              prepareRow(row);\n              return (\n                <tr {...row.getRowProps()}>\n                  {row.cells.map((cell) => {\n                    return (\n                      <td {...cell.getCellProps()}>{cell.render(\"Cell\")}</td>\n                    );\n                  })}\n                </tr>\n              );\n            })}\n          </tbody>\n        </table>\n      </div>\n\n      <div className=\"mt-3 col-sm-12\">\n        {\"每页显示行数: \"}\n        <select onChange={handlePageSizeChange} value={pageSize}>\n          {pageSizes.map((size) => (\n            <option key={size} value={size}>\n              {size}\n            </option>\n          ))}\n        </select>\n\n        <Pagination\n          className=\"my-3\"\n          count={count}\n          page={page}\n          siblingCount={1}\n          boundaryCount={1}\n          variant=\"outlined\"\n          shape=\"rounded\"\n          onChange={handlePageChange}\n        />\n      </div>\n\n    </div>\n  );\n};\n\nexport default withRouter(SchoolsList);","import React, { Component } from \"react\";\nimport SchoolDataService from \"../services/school.service\";\nimport { Link } from \"react-router-dom\";\nimport Pagination from \"@material-ui/lab/Pagination\";\n\nimport { useState, useEffect, useMemo, useRef } from \"react\";\nimport { useTable, useSortBy } from \"react-table\";\n\nconst RegionsList = (props) => {\n  const [regions, setRegions] = useState([]);\n\n  const [currentRegion, setCurrentRegion] = useState(null);\n  const [currentIndex, setCurrentIndex] = useState(-1);\n  const [searchOriginalname, setSearchOriginalname] = useState(\"\");\n  const [responseId, setResponseId] = useState(props.match? props.match.params.responseId : props.responseId);\n  //const [responseId, setResponseId] = useState(props.match.params.responseId);\n\n  const regionsRef = useRef();\n  regionsRef.current = regions;\n\n  const [page, setPage] = useState(1);\n  const [count, setCount] = useState(0);\n  const [pageSize, setPageSize] = useState(5);\n\n  const pageSizes = [5, 10, 20];\n\n  const onChangeSearchOriginalname = (e) => {\n    const searchOriginalname = e.target.value;\n    setSearchOriginalname(searchOriginalname);\n  };\n\n  const getRequestParams = (page, pageSize) => {\n    let params = {};\n\n    if (page) {\n      params[\"page\"] = page - 1;\n    }\n\n    if (pageSize) {\n      params[\"size\"] = pageSize;\n    }\n\n    return params;\n  };\n\n  const retrieveRegions = () => {\n    const params = getRequestParams(page, pageSize);\n\n    SchoolDataService.getCountsByRegion(params)\n      .then((response) => {\n\n        const { schools, totalPages } = response.data;\n\n        setRegions(schools);\n        setCount(totalPages);\n\n        console.log(response.data);\n      })\n      .catch((e) => {\n\n        console.log(e);\n      });\n  };\n\n  useEffect(retrieveRegions, [page, pageSize]);\n\n  const refreshList = () => {\n    retrieveRegions();\n  };\n\n  const openRegion = (rowIndex) => {\n    const region = regionsRef.current[rowIndex].region;\n\n    props.history.push(\"/schools/\" + region);\n  };\n\n\n  const columns = useMemo(\n    () => [\n      {\n        Header: \"省（自治区）\",\n        accessor: \"region\",\n      },\n\n      {\n        Header: \"学校数\",\n        accessor: \"schoolsCount\",\n        Cell: (props) => {\n          const rowIdx = props.row.id;\n          return (\n            <div>\n              <Link\n                to={regionsRef.current[rowIdx].region\n                    ? \"/schools/region/\" + regionsRef.current[rowIdx].region\n                    : \"/schools\"\n                    }\n                className=\"badge badge-success\"\n              >\n                {regionsRef.current[rowIdx].schoolsCount}\n              </Link>\n\n            </div>\n          );\n        },\n      },\n    ],\n    []\n  );\n\n  const {\n    getTableProps,\n    getTableBodyProps,\n    headerGroups,\n    rows,\n    prepareRow,\n  } = useTable({\n    columns,\n    data: regions,\n    disableSortRemove: true,\n  },\n  useSortBy);\n\n  const findByOriginalname = () => {\n    setPage(1);\n    retrieveRegions();\n  };\n\n  const handlePageChange = (event, value) => {\n    setPage(value);\n  };\n\n  const handlePageSizeChange = (event) => {\n    setPageSize(event.target.value);\n    setPage(1);\n  };\n\n\n\n  return (\n    <div className=\"list row\">\n      <div className=\"col-sm-8\">\n        <h4>地区列表</h4>\n{/*}\n        <div className=\"input-group mb-3\">\n          <input\n            type=\"text\"\n            className=\"form-control\"\n            placeholder=\"Search by originalname\"\n            value={searchOriginalname}\n            onChange={onChangeSearchOriginalname}\n          />\n          <div className=\"input-group-append\">\n            <button\n              className=\"btn btn-outline-secondary\"\n              type=\"button\"\n              onClick={findByOriginalname}\n            >\n              Search\n            </button>\n          </div>\n        </div>\n*/}\n      </div>\n\n      <div className=\"col-sm-12 list\">\n        <div className=\"mt-3\">\n          {\"每页显示行数: \"}\n          <select onChange={handlePageSizeChange} value={pageSize}>\n            {pageSizes.map((size) => (\n              <option key={size} value={size}>\n                {size}\n              </option>\n            ))}\n          </select>\n\n          <Pagination\n            className=\"my-3\"\n            count={count}\n            page={page}\n            siblingCount={1}\n            boundaryCount={1}\n            variant=\"outlined\"\n            shape=\"rounded\"\n            onChange={handlePageChange}\n          />\n        </div>\n\n        <table\n          className=\"table table-striped table-bordered\"\n          {...getTableProps()}\n        >\n          <thead>\n            {headerGroups.map((headerGroup) => (\n              <tr {...headerGroup.getHeaderGroupProps()}>\n                {headerGroup.headers.map((column) => (\n                  // Add the sorting props to control sorting. For this example\n                  // we can add them into the header props\n                  <th {...column.getHeaderProps(column.getSortByToggleProps())}>\n                    {column.render('Header')}\n                    {/* Add a sort direction indicator */}\n                      <span>\n                        {column.isSorted\n                        ? column.isSortedDesc\n                          ? ' 🔽'\n                          : ' 🔼'\n                        : ''}\n                      </span>\n                  </th>\n                ))}\n              </tr>\n            ))}\n          </thead>\n          <tbody {...getTableBodyProps()}>\n            {rows.map((row, i) => {\n              prepareRow(row);\n              return (\n                <tr {...row.getRowProps()}>\n                  {row.cells.map((cell) => {\n                    return (\n                      <td {...cell.getCellProps()}>{cell.render(\"Cell\")}</td>\n                    );\n                  })}\n                </tr>\n              );\n            })}\n          </tbody>\n        </table>\n      </div>\n\n\n    </div>\n  );\n};\n\nexport default RegionsList;","import http from \"../http-common\";\nimport authHeader from './auth-header';\n\nclass LogDataService {\n\n  getAll2(data) {\n    return http.post(\"/logs/all\", data, { headers: authHeader() });\n  }\n\n  getAll(params) {\n    return http.get(\"/logs\", { params }, { headers: authHeader() });\n      /**\n    return http.get(\"/logs\", {\n        params: { params } ,\n        headers: authHeader()\n      }\n    );\n    */\n  }\n\n/**\n  getAll() {\n    return http.get(\"/logs\", { headers: authHeader() });\n  }\n*/\n\n  get(id) {\n    return http.get(`/logs/${id}`, { headers: authHeader() });\n  }\n\n  getContent(id) {\n    const user = JSON.parse(localStorage.getItem('user'));\n    return http.get(`/logsContent/${id}`, {\n        headers: {\n          'x-access-token':  (user && user.accessToken) ? user.accessToken : null\n        },\n        responseType: 'arraybuffer'\n      });\n  }\n\n  getDocCategories() {\n    return http.get(`/logs/categories`, { headers: authHeader() });\n  }\n\n  getCount(id) {\n    return http.get(`/logsCount/${id}`, { headers: authHeader() });\n  }\n\n  create(data) {\n    return http.post(\"/logs\", data, { headers: authHeader() });\n  }\n\n  update(id, data) {\n    return http.put(`/logs/${id}`, data, { headers: authHeader() });\n  }\n\n  delete(id) {\n    return http.delete(`/logs/${id}`, { headers: authHeader() });\n  }\n\n  deleteAll() {\n    return http.delete(`/logs`, { headers: authHeader() });\n  }\n\n  findByTitle(title) {\n    return http.get(`/logs?title=${title}`, { headers: authHeader() });\n  }\n}\n\nexport default new LogDataService();\n","import React, { Component } from \"react\";\nimport LogDataService from \"../services/log.service\";\nimport AuthService from \"../services/auth.service\";\n\nimport { Link } from \"react-router-dom\";\nimport Pagination from \"@material-ui/lab/Pagination\";\n\nimport { useState, useEffect, useMemo, useRef } from \"react\";\nimport { useTable, useFlexLayout, useBlockLayout, useResizeColumns, useSortBy } from \"react-table\";\n\nconst LogsList = (props) => {\n  const [logs, setLogs] = useState([]);\n  const [currentLog, setCurrentLog] = useState(null);\n  const [currentIndex, setCurrentIndex] = useState(-1);\n  const [text, setText] = useState(\"\");\n  const [searchText, setSearchText] = useState(\"\");\n  const [schoolId, setSchoolId] = useState(props.match? props.match.params.schoolId : props.schoolId);\n  const [userId, setUserId] = useState(AuthService.getCurrentUser() ? AuthService.getCurrentUser().id : null);\n\n  const [orderby, setOrderby] = useState([]);\n\n  const logsRef = useRef();\n  logsRef.current = logs;\n\n  const [page, setPage] = useState(1);\n  const [count, setCount] = useState(0);\n  const [pageSize, setPageSize] = useState(5);\n\n  const pageSizes = [5, 10, 20];\n\n  const onChangeText = (e) => {\n    const text = e.target.value;\n    setText(text);\n  };\n\n  const onChangeSearchText = (e) => {\n    const searchText = e.target.value;\n    setSearchText(searchText);\n  };\n\n  const getRequestParams = (/*searchText, page, pageSize, schoolId, orderby*/) => {\n    let params = {};\n\n    if (searchText) {\n      params[\"text\"] = searchText;\n    }\n\n    if (page) {\n      params[\"page\"] = page - 1;\n    }\n\n    if (pageSize) {\n      params[\"size\"] = pageSize;\n    }\n\n    if (schoolId) {\n      params[\"schoolId\"] = schoolId;\n    }\n\n    if (orderby) {\n      params[\"orderby\"] = orderby;\n    }\n\n    return params;\n  };\n\n  const retrieveLogs = () => {\n    const params = getRequestParams(/*searchText, page, pageSize, schoolId, orderby*/);\n\n    LogDataService.getAll2(params)\n      .then((response) => {\n        const { logs, totalPages } = response.data;\n\n        setLogs(logs);\n        setCount(totalPages);\n\n        console.log(response.data);\n      })\n      .catch((e) => {\n        console.log(e);\n      });\n  };\n\n  useEffect(retrieveLogs, [page, pageSize, orderby]);\n\n  const refreshList = () => {\n    retrieveLogs();\n    setText(\"\");\n  };\n\n\n  const save = (e) => {\n\n    var data = {\n      text: text,\n      userId: userId,\n      schoolId: schoolId\n    };\n\n    LogDataService.create(data)\n      .then(response => {\n        refreshList();\n        console.log(response.data);\n      })\n      .catch(e => {\n        console.log(e);\n      });\n  }\n\n  const removeAllLogs = () => {\n    LogDataService.deleteAll()\n      .then((response) => {\n        console.log(response.data);\n        refreshList();\n      })\n      .catch((e) => {\n        console.log(e);\n      });\n  };\n\n  const deleteLog = (rowIndex) => {\n    const id = logsRef.current[rowIndex].id;\n\n    LogDataService.delete(id)\n      .then((response) => {\n        //props.history.push(\"/logs\");\n\n        let newLogs = [...logsRef.current];\n        newLogs.splice(rowIndex, 1);\n\n        setLogs(newLogs);\n      })\n      .catch((e) => {\n        console.log(e);\n      });\n  };\n\n  const columns = useMemo(\n    () => [\n      {\n        Header: \"时间\",\n        accessor: \"createdAt\",\n        Cell: (props) => {\n          const rowIdx = props.row.id;\n          const d = new Date(logsRef.current[rowIdx].createdAt);\n          return (\n            <div>\n              {d.toLocaleDateString('zh-cn', { hour12: true, hour: \"2-digit\", minute: \"2-digit\", second: \"2-digit\" })}\n            </div>\n          );\n        },\n      },\n      {\n        Header: \"修改人\",\n        accessor: 'userId',\n        Cell: (props) => {\n          const rowIdx = props.row.id;\n          return (\n            <div>\n            { (logsRef.current[rowIdx].user) ? (\n              <Link\n                to={\"/usersView/\" + logsRef.current[rowIdx].user.id}\n                className=\"badge badge-success\"\n              >\n                {logsRef.current[rowIdx].user.chineseName\n                  ? logsRef.current[rowIdx].user.chineseName\n                  : logsRef.current[rowIdx].user.username\n                }\n              </Link>\n            ) : ''}\n            </div>\n          );\n        },\n      },\n      {\n        Header: \"修改字段\",\n        accessor: \"field\",\n        disableSortBy: true,\n      },\n      {\n        Header: \"老值\",\n        accessor: \"oldv\",\n      },\n      {\n        Header: \"新值\",\n        accessor: \"newv\",\n      },\n      {\n        Header: \"删除\",\n        accessor: \"actions\",\n        disableSortBy: true,\n        Cell: (props) => {\n          const rowIdx = props.row.id;\n          return (\n            <div>\n              <span onClick={() => window.confirm(\"您确定要删除吗 ?\") && deleteLog(rowIdx)}>\n                <i className=\"fas fa-trash action\"></i>\n              </span>\n            </div>\n          );\n        },\n      },\n    ],\n    []\n  );\n\n\n  const {\n    getTableProps,\n    getTableBodyProps,\n    headerGroups,\n    rows,\n    prepareRow,\n    state: {sortBy},\n  } = useTable({\n    columns,\n    data: logs,\n    disableSortRemove: true,\n    manualSortBy: true,\n    initialState: {\n      sortBy: [\n        {\n          id: 'createdAt',\n          desc: true\n        }\n      ]\n    },\n  },\n  useFlexLayout,\n  useSortBy);\n\n  const search = () => {\n    setPage(1);\n    retrieveLogs();\n  };\n\n  const handlePageChange = (event, value) => {\n    setPage(value);\n  };\n\n  const handlePageSizeChange = (event) => {\n    setPageSize(event.target.value);\n    setPage(1);\n  };\n\n  useEffect(() => {\n    if (sortBy && sortBy[0])\n      setOrderby(sortBy);\n  }, [sortBy]);\n\n  return (\n    <div className=\"list row\">\n      <div className=\"col-sm-6\">\n        <h6>修改记录</h6>\n        <div className=\"input-group mb-3\">\n          <input\n            type=\"text\"\n            className=\"form-control\"\n            placeholder=\"新值或老值\"\n            value={searchText}\n            onChange={onChangeSearchText}\n          />\n          <div className=\"input-group-append\">\n            <button\n              className=\"btn btn-outline-secondary\"\n              type=\"button\"\n              onClick={search}\n            >\n              查找\n            </button>\n          </div>\n        </div>\n\n        <div className=\"col-sm-6 mt-3\">\n          {\"每页显示行数: \"}\n          <select onChange={handlePageSizeChange} value={pageSize}>\n            {pageSizes.map((size) => (\n              <option key={size} value={size}>\n                {size}\n              </option>\n            ))}\n          </select>\n\n          <Pagination\n            className=\"my-3\"\n            count={count}\n            page={page}\n            siblingCount={1}\n            boundaryCount={1}\n            variant=\"outlined\"\n            shape=\"rounded\"\n            onChange={handlePageChange}\n          />\n        </div>\n      </div>\n\n      <div class=\"w-100\"></div>\n\n      <div className=\"col-sm-12 list\">\n        <table\n          className=\"table table-striped table-bordered\"\n          {...getTableProps()}\n        >\n          <thead>\n            {headerGroups.map((headerGroup) => (\n              <tr {...headerGroup.getHeaderGroupProps()}>\n                {headerGroup.headers.map((column) => (\n                // Add the sorting props to control sorting. For this example\n                // we can add them into the header props\n                <th {...column.getHeaderProps(column.getSortByToggleProps(), {\n                /*\n                  style: {\n                      minWidth: column.minWidth,\n                      width: column.width,\n                    },\n                */\n                  })}\n                >\n                  {column.render('Header')}\n                  {/* Add a sort direction indicator */}\n                  <span>\n                    {/*column.isSorted*/ (column.id === 'createdAt' || column.id === 'user.username')\n                     ? column.isSortedDesc\n                       ? ' 🔽'\n                       : ' 🔼'\n                     : ''}\n                  </span>\n                </th>\n                ))}\n              </tr>\n            ))}\n          </thead>\n          <tbody {...getTableBodyProps()}>\n            {rows.map((row, i) => {\n              prepareRow(row);\n              return (\n                <tr {...row.getRowProps()}>\n                  {row.cells.map((cell) => {\n                    return (\n                      <td {...cell.getCellProps({\n\n                          style: {\n                            minWidth: cell.column.minWidth,\n                            width: cell.column.width,\n                            whiteSpace: 'pre-wrap'\n                          },\n\n                        })}>\n                        {cell.render(\"Cell\")}\n                      </td>\n                    );\n                  })}\n                </tr>\n              );\n            })}\n          </tbody>\n        </table>\n      </div>\n\n      <div className=\"col-sm-8\">\n      </div>\n    </div>\n  );\n};\n\nexport default LogsList;","import http from \"../http-common\";\nimport authHeader from './auth-header';\n\nclass FormDataService {\n\n  getAll2(data) {\n    return http.post(\"/forms/all\", data, { headers: authHeader() });\n  }\n\n  getAll(params) {\n    return http.get(\"/forms\", { params }, { headers: authHeader() });\n      /**\n    return http.get(\"/forms\", {\n        params: { params } ,\n        headers: authHeader()\n      }\n    );\n    */\n  }\n\n/**\n  getAll() {\n    return http.get(\"/forms\", { headers: authHeader() });\n  }\n*/\n\n  get(id) {\n    return http.get(`/forms/${id}`, { headers: authHeader() });\n  }\n\n  create(data) {\n    return http.post(\"/forms\", data, { headers: authHeader() });\n  }\n\n  update(id, data) {\n    return http.put(`/forms/${id}`, data, { headers: authHeader() });\n  }\n\n  delete(id) {\n    return http.delete(`/forms/${id}`, { headers: authHeader() });\n  }\n\n  deleteAll() {\n    return http.delete(`/forms`, { headers: authHeader() });\n  }\n\n  findByTitle(title) {\n    return http.get(`/forms?title=${title}`, { headers: authHeader() });\n  }\n}\n\nexport default new FormDataService();\n","//import React, { Component } from \"react\";\nimport FormDataService from \"../services/form.service\";\n\nimport $ from \"jquery\"; //Load jquery\nimport React, { Component, createRef } from \"react\"; //For react component\nimport ReactDOM from \"react-dom\";\n\nimport YearPicker from 'react-single-year-picker';\n\nwindow.jQuery = $; //JQuery alias\nwindow.$ = $; //JQuery alias\nrequire(\"jquery-ui-sortable\"); //For FormBuilder Element Drag and Drop\nrequire(\"formBuilder\");// For FormBuilder\ndocument.body.style.margin = \"30px\"; //For add margin in HTML body\n\nexport default class Form extends Component {\n  constructor(props) {\n    super(props);\n    this.onChangeTitle = this.onChangeTitle.bind(this);\n    this.onChangeDescription = this.onChangeDescription.bind(this);\n    this.onChangeDeadline = this.onChangeDeadline.bind(this);\n    this.onChangeStartAt = this.onChangeStartAt.bind(this);\n    this.getForm = this.getForm.bind(this);\n    //this.updatePublished = this.updatePublished.bind(this);\n    this.updateForm = this.updateForm.bind(this);\n    this.deleteForm = this.deleteForm.bind(this);\n    this.saveForm = this.saveForm.bind(this);\n    this.newForm = this.newForm.bind(this);\n\n    this.state = {\n      currentForm: {\n        id: null,\n        title: \"\",\n        description: \"\",\n        published: false,\n        fdata: null,\n        deadline: null,\n        startAt: null,\n      },\n      message: \"\",\n      newsform: true,\n      readonly: true,      \n      submitted: false\n    };\n\n    this.fb = createRef();\n    this.fBuilder = null;\n    this.fRender = null;\n  }\n\n  newFormOptions = {\n    id: \"shinshin-form-id\",\n    action: \"http://localhost:8080/multiple-upload\",\n    method: \"POST\",\n    enctype: \"multipart/form-data\",\n\n    formData: [\n    {\n      type: \"header\",\n      subtype: \"h4\",\n      label: \"项目申请表\"\n    },\n    ],\n    onSave: (e, formData) => {   //Auto binds `this`\n      this.saveForm(formData);\n    }\n  };\n\n  oldFormOptions = {\n    onSave: (e, formData) => {   //Auto binds `this`\n     this.updateForm();\n    },\n    showActionButtons: !window.location.pathname.includes('View')\n  };\n\n\n  componentDidMount() {\n    const readonly = window.location.pathname.includes('View')\n    const newform = window.location.pathname.includes('add');\n    this.setState({newform: newform});\n    this.setState({readonly: readonly});\n\n    if (newform)\n      this.fBuilder = $(this.fb.current).formBuilder(this.newFormOptions);\n    else {\n      //if (!readonly)\n        //this.fBuilder = $(this.fb.current).formBuilder(this.oldFormOptions);\n      this.getForm(this.props.match.params.id, readonly);\n    }\n  }\n\n  onChangeStartAt(e) {\n    const startAt = e; //e.target.value;\n    this.setState(function(prevState) {\n      return {\n        currentForm: {\n          ...prevState.currentForm,\n          startAt: startAt\n        }\n      };\n    });\n  };\n\n  onChangeTitle(e) {\n    const title = e.target.value;\n\n    this.setState(function(prevState) {\n      return {\n        currentForm: {\n          ...prevState.currentForm,\n          title: title\n        }\n      };\n    });\n  }\n\n  onChangeDescription(e) {\n    const description = e.target.value;\n\n    this.setState(prevState => ({\n      currentForm: {\n        ...prevState.currentForm,\n        description: description\n      }\n    }));\n  }\n\n  onChangeDeadline(e) {\n    const deadline = e.target.value;\n\n    this.setState(prevState => ({\n      currentForm: {\n        ...prevState.currentForm,\n        deadline: deadline\n      }\n    }));\n  }\n\n  getForm(id, readonly) {\n    FormDataService.get(id)\n      .then(response => {\n\n      const {startAt, ...others} = response.data;\n        this.setState({\n          //currentForm: response.data\n\n          currentForm: {\n            ...others,\n            startAt: (startAt ? (new Date(startAt)).getUTCFullYear() : '')\n          }\n\n        });\n\n        console.log(response.data);\n\n        if (readonly) {\n          var formData = response.data.fdata;\n          if (!((typeof formData) === \"string\")) formData = JSON.stringify(response.data.fdata);\n          //this.fRender = $(this.fb.current).formRender({formData: response.data.fdata });\n          this.fRender = $(this.fb.current).formRender({ formData });\n        } else {\n          $(this.fb.current).formBuilder(this.oldFormOptions).promise\n            .then(formBuilder => {\n              formBuilder.actions.setData(response.data.fdata);\n              this.fBuilder = formBuilder;\n            });\n        }\n\n      })\n      .catch(e => {\n        console.log(e);\n      });\n  }\n\n  updateForm() {\n    this.setState(prevState => ({\n      currentForm: {\n        ...prevState.currentForm,\n        startAt: prevState.currentForm.startAt ? (prevState.currentForm.startAt + '-02-01') : null,\n        fdata: this.fBuilder.actions.getData()\n      }\n    }));\n\n    FormDataService.update(\n      this.state.currentForm.id,\n      this.state.currentForm\n    )\n      .then(response => {\n        console.log(response.data);\n        this.setState({\n          message: \"项目申请表成功更新!\",\n          submitted: true,\n        });\n      })\n      .catch(e => {\n        console.log(e);\n      });\n  }\n\n  saveForm(formData) {\n    var data = {\n      title: this.state.currentForm.title,\n      description: this.state.currentForm.description,\n      deadline: this.state.currentForm.deadline,\n      startAt: this.state.currentForm.startAt ? (this.state.currentForm.startAt + '-02-01') : null,\n      fdata: this.fBuilder.actions.getData() /* formData */\n    };\n\n    FormDataService.create(data)\n      .then(response => {\n        this.setState(prevState => ({\n          currentForm: {\n            ...prevState.currentForm,\n            id: response.data.id,\n          },\n          submitted: true,\n          message: '项目申请表成功提交!'\n        }));\n        console.log(response.data);\n      })\n      .catch(e => {\n        console.log(e);\n      });\n  }\n\n  newForm() {\n    this.setState(prevState => ({\n      currentForm: {\n        id: null,\n        title: \"\",\n        description: \"\",\n        deadline: null,\n        startAt: null,\n      },\n      submitted: false\n    }));\n  }\n\n  deleteForm() {\n    FormDataService.delete(this.state.currentForm.id)\n      .then(response => {\n        console.log(response.data);\n        this.props.history.push('/forms')\n      })\n      .catch(e => {\n        console.log(e);\n      });\n  }\n\n  render() {\n    const { currentForm } = this.state;\n\n    return (\n      <div>\n        {/*this.state.newform && */this.state.submitted\n        ? (\n          <div>\n            <p><h4>{this.state.message}</h4></p>\n{/*}\n            <h4>成功提交!</h4>\n\n              <button className=\"btn btn-success\" onClick={this.newForm}>\n                Add\n              </button>\n*/}\n          </div>\n          ) : (<div>\n          <div className=\"edit-form\">\n            <h4>申请表格设计</h4>\n            <form>\n              <div className=\"form-group\">\n                <label htmlFor=\"title\">标题</label>\n                <input\n                  readonly={(!this.state.newform && this.state.readonly) ? \"\" : false}\n                  type=\"text\"\n                  className=\"form-control\"\n                  id=\"title\"\n                  value={currentForm.title}\n                  onChange={this.onChangeTitle}\n                />\n              </div>\n              <div className=\"form-group\">\n                <label htmlFor=\"description\">说明</label>\n                <textarea\n                  readonly={(!this.state.newform && this.state.readonly) ? \"\" : false}\n                  className=\"form-control\"\n                  id=\"description\"\n                  value={currentForm.description}\n                  onChange={this.onChangeDescription}\n                />\n              </div>\n              <div className=\"form-group\">\n                <label htmlFor=\"deadline\">截止日期</label>\n                <input\n                  readonly={(!this.state.newform && this.state.readonly) ? \"\" : false}\n                  type=\"date\"\n                  className=\"form-control\"\n                  id=\"deadline\"\n                  value={currentForm.deadline}\n                  onChange={this.onChangeDeadline}\n                />\n              </div>\n\n              <div className=\"form-group\">\n                <label htmlFor=\"startAt\">项目年份</label>\n                {(!this.state.newform && this.state.readonly)\n                ?<input\n                   type=\"text\"\n                   id='startAt'\n                   readonly=\"\"\n                   className=\"form-control\"\n                   placeholder=\"项目年份\"\n                   value={currentForm.startAt}\n                />\n                :<YearPicker\n                   yearArray={['2019', '2020']}\n                   value={currentForm.startAt}\n                   onSelect={this.onChangeStartAt}\n\n                   minRange={1995}\n                   maxRange={2022}\n                />\n                }\n              </div>\n\n            </form>\n          </div>\n\n          <div id=\"fb-editor\" ref={this.fb} />\n\n          </div>)}\n{/*}\n          <p>{this.state.message}</p>\n*/}\n      </div>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport FormDataService from \"../services/form.service\";\nimport { Link } from \"react-router-dom\";\nimport Pagination from \"@material-ui/lab/Pagination\";\n\nimport { useState, useEffect, useMemo, useRef } from \"react\";\nimport { useTable, useSortBy } from \"react-table\";\n\nimport YearPicker from 'react-single-year-picker';\n\nimport AuthService from \"./../services/auth.service\";\n\nconst FormsList = (props) => {\n  const [forms, setForms] = useState([]);\n  const [currentForm, setCurrentForm] = useState(null);\n  const [currentIndex, setCurrentIndex] = useState(-1);\n  const [searchTitle, setSearchTitle] = useState(\"\");\n  const [searchStartAt, setSearchStartAt] = useState(\"\");\n\n  const formsRef = useRef();\n  formsRef.current = forms;\n\n  const [page, setPage] = useState(1);\n  const [count, setCount] = useState(0);\n  const [pageSize, setPageSize] = useState(30);\n\n  const [orderby, setOrderby] = useState([]);\n\n  const pageSizes = [20, 30, 50];\n\n  const [totalItems, setTotalItems] = useState(0);\n\n  const onChangeSearchTitle = (e) => {\n    const searchTitle = e.target.value;\n    setSearchTitle(searchTitle);\n  };\n\n  const onChangeSearchStartAt = (e) => {\n    const searchStartAt = e; // e.target.value;\n    setSearchStartAt(searchStartAt);\n  };\n\n  const onChangeSearchInputStartAt = (e) => {\n    const searchStartAt = e; //e.target.value;\n    setSearchStartAt(searchStartAt);\n  };\n\n  const getRequestParams = (/*searchTitle, page, pageSize, orderby*/) => {\n    let params = {};\n\n    if (searchTitle) {\n      params[\"title\"] = searchTitle;\n    }\n\n    if (searchStartAt) {\n      params[\"startAt\"] = searchStartAt;\n    }\n\n    if (page) {\n      params[\"page\"] = page - 1;\n    }\n\n    if (pageSize) {\n      params[\"size\"] = pageSize;\n    }\n\n    if (orderby) {\n      params[\"orderby\"] = orderby;\n    }\n\n    return params;\n  };\n\n  const onClearSearch = (e) => {\n    setSearchTitle(\"\");\n    setSearchStartAt(\"\");\n    setOrderby([]);\n  };\n\n  const retrieveForms = () => {\n    const params = getRequestParams(/*searchTitle, page, pageSize, orderby*/);\n\n    FormDataService.getAll2(params)\n      .then((response) => {\n        const { forms, totalPages, totalItems  } = response.data;\n\n        setForms(forms);\n        setCount(totalPages);\n        setTotalItems(totalItems);\n\n        console.log(response.data);\n      })\n      .catch((e) => {\n        console.log(e);\n      });\n  };\n\n  useEffect(retrieveForms, [page, pageSize, orderby, searchTitle, searchStartAt]);\n\n  const refreshList = () => {\n    retrieveForms();\n  };\n\n  const removeAllForms = () => {\n    FormDataService.deleteAll()\n      .then((response) => {\n        console.log(response.data);\n        refreshList();\n      })\n      .catch((e) => {\n        console.log(e);\n      });\n  };\n\n\n  const openForm = (rowIndex) => {\n    const id = formsRef.current[rowIndex].id;\n    props.history.push(\"/forms/\" + id);\n  };\n\n  const deleteForm = (rowIndex) => {\n    const id = formsRef.current[rowIndex].id;\n\n    FormDataService.delete(id)\n      .then((response) => {\n        //props.history.push(\"/forms\");\n\n        let newForms = [...formsRef.current];\n        newForms.splice(rowIndex, 1);\n\n        setForms(newForms);\n      })\n      .catch((e) => {\n        console.log(e);\n      });\n  };\n\n  const columns = useMemo(\n    () => [\n      {\n        Header: \"截止日期\",\n        accessor: \"deadline\",\n      },\n      {\n        Header: \"项目年份\",\n        accessor: \"startAt\",\n        Cell: (props) => {\n          const rowIdx = props.row.id;\n            var d = null;\n            if ((formsRef.current[rowIdx].startAt)) d = new Date(formsRef.current[rowIdx].startAt);\n            return (\n              <div>\n                {d ? d.getUTCFullYear() : ''\n                /*d.toLocaleDateString('zh-cn', { hour12: true, hour: \"2-digit\", minute: \"2-digit\", second: \"2-digit\" })*/\n                }\n              </div>\n            );\n        }\n      },\n      {\n        Header: \"标题\",\n        accessor: \"title\",\n        disableSortBy: true,\n      },\n      {\n        Header: \"项目申请数目\",\n        accessor: \"responsesCount\",\n        Cell: (props) => {\n          const rowIdx = props.row.id;\n          return (\n            <div>\n              <Link\n                to={\"/responses/form/\" + formsRef.current[rowIdx].id}\n                className=\"badge badge-success\"\n              >\n                {formsRef.current[rowIdx].responsesCount}\n              </Link>\n            </div>\n          );\n        },\n      },\n      {\n        Header: \"操作\",\n        accessor: \"actions\",\n        disableSortBy: true,\n        Cell: (props) => {\n          const rowIdx = props.row.id;\n          const expired = formsRef.current[rowIdx].deadline\n            ? new Date(formsRef.current[rowIdx].deadline) < new Date()\n            : false;\n          return (\n            <div>\n              <Link\n                to={\"/addR/\" + formsRef.current[rowIdx].id}\n                className= {expired ? \"disabled-link\" : \"badge badge-success mr-2\"}\n              >\n                {expired ? \"逾期 \" : \"申请\"}\n              </Link>\n\n              <Link\n                to={\"/formsView/\" + formsRef.current[rowIdx].id}\n              >\n                <i className=\"fas fa-eye action mr-2\"></i>\n              </Link>\n\n              {AuthService.getCurrentUser() && !AuthService.getCurrentUser().schoolId &&\n                <span onClick={() => openForm(rowIdx)}>\n                  <i className=\"far fa-edit action mr-2\"></i>\n              </span>}\n\n              {AuthService.getCurrentUser() && !AuthService.getCurrentUser().schoolId &&\n                <span onClick={() => window.confirm(\"您确定要删除吗 ?\") && deleteForm(rowIdx)}>\n                  <i className=\"fas fa-trash action\"></i>\n              </span>}\n            </div>\n          );\n        },\n      },\n    ],\n    []\n  );\n\n  const {\n    getTableProps,\n    getTableBodyProps,\n    headerGroups,\n    rows,\n    prepareRow,\n    state: {sortBy},\n  } = useTable({\n    columns,\n    data: forms,\n    disableSortRemove: true,\n    manualSortBy: true,\n    initialState: {\n      sortBy: [\n        {\n          id: 'deadline',\n          desc: true\n        }\n      ]\n    },\n  },\n  useSortBy);\n\n  const findByTitle = () => {\n    setPage(1);\n    retrieveForms();\n  };\n\n  const handlePageChange = (event, value) => {\n    setPage(value);\n  };\n\n  const handlePageSizeChange = (event) => {\n    setPageSize(event.target.value);\n    setPage(1);\n  };\n\n  useEffect(() => {\n    if (sortBy && sortBy[0])\n      setOrderby(sortBy);\n  }, [sortBy]);\n\n  return (\n    <div className=\"list row\">\n      <div className=\"col-sm-8\">\n        <h4>项目征集列表(总数：{totalItems})</h4>\n        <div className=\"input-group mb-3\">\n          <input\n            type=\"text\"\n            readonly=\"\"\n            className=\"form-control\"\n            placeholder=\"项目年份\"\n            value={searchStartAt}\n            onChange={onChangeSearchInputStartAt}\n          />\n          <YearPicker\n            yearArray={['2019', '2020']}\n            value={searchStartAt}\n            onSelect={onChangeSearchStartAt}\n            hideInput={true}\n            minRange={1995}\n            maxRange={2022}\n          />\n\n          <input\n            type=\"text\"\n            className=\"form-control ml-2\"\n            placeholder=\"标题查找\"\n            value={searchTitle}\n            onChange={onChangeSearchTitle}\n          />\n\n          <div>\n            <button\n              className=\"btn btn-primary ml-2\"\n              type=\"button\"\n              onClick={onClearSearch}\n            >\n              清空\n            </button>\n          </div>\n        </div>\n\n        <div className=\"input-group mb-3\">\n          <button\n            className=\"btn btn-primary \"\n            type=\"button\"\n            onClick={findByTitle}\n          >\n            查找\n          </button>\n        </div>\n      </div>\n\n      <div className=\"mt-3 col-sm-3\">\n        {\"每页显示行数: \"}\n        <select onChange={handlePageSizeChange} value={pageSize}>\n          {pageSizes.map((size) => (\n            <option key={size} value={size}>\n              {size}\n            </option>\n          ))}\n        </select>\n        <Pagination\n          className=\"my-3\"\n          count={count}\n          page={page}\n          siblingCount={1}\n          boundaryCount={1}\n          variant=\"outlined\"\n          shape=\"rounded\"\n          onChange={handlePageChange}\n        />\n      </div>\n\n      <div className=\"col-sm-12 list\">\n        <table\n          className=\"table table-striped table-bordered\"\n          {...getTableProps()}\n        >\n          <thead>\n            {headerGroups.map((headerGroup) => (\n              <tr {...headerGroup.getHeaderGroupProps()}>\n                {headerGroup.headers.map((column) => (\n                   // Add the sorting props to control sorting. For this example\n                   // we can add them into the header props\n                   <th {...column.getHeaderProps(column.getSortByToggleProps())}>\n                     {column.render('Header')}\n                     {/* Add a sort direction indicator */}\n                       <span>\n                         {/*column.isSorted*/ (column.id === 'startAt' || column.id === 'deadline' || column.id === 'responsesCount')\n                           ? column.isSortedDesc\n                             ? ' 🔽'\n                             : ' 🔼'\n                         : ''}\n                       </span>\n                   </th>\n                ))}\n              </tr>\n            ))}\n          </thead>\n          <tbody {...getTableBodyProps()}>\n            {rows.map((row, i) => {\n              prepareRow(row);\n              return (\n                <tr {...row.getRowProps()}>\n                  {row.cells.map((cell) => {\n                    return (\n                      <td {...cell.getCellProps()}>{cell.render(\"Cell\")}</td>\n                    );\n                  })}\n                </tr>\n              );\n            })}\n          </tbody>\n        </table>\n      </div>\n\n      <div className=\"col-sm-8\">\n      </div>\n    </div>\n  );\n};\n\nexport default FormsList;","import React, { Component } from \"react\";\nimport AttachmentDataService from \"../services/attachment.service\";\nimport { Link } from \"react-router-dom\";\nimport Pagination from \"@material-ui/lab/Pagination\";\n\nimport { useState, useEffect, useMemo, useRef } from \"react\";\nimport { useTable, useSortBy } from \"react-table\";\n\nconst AttachmentsList = (props) => {\n  const [attachments, setAttachments] = useState([]);\n\n  const [currentAttachment, setCurrentAttachment] = useState(null);\n  const [currentIndex, setCurrentIndex] = useState(-1);\n  const [searchOriginalname, setSearchOriginalname] = useState(\"\");\n  const [responseId, setResponseId] = useState(props.match? props.match.params.responseId : props.responseId);\n  //const [responseId, setResponseId] = useState(props.match.params.responseId);\n\n  const [readonly, setReadonly] = useState(props.readonly ? props.readonly : false);\n\n  const [embedded, setEmbedded] = useState(props.embedded ? props.embedded : false);\n\n  const [reload, setReload] = useState(props.reload);\n\n  //useEffect(setReload, [props.reload]);\n  useEffect(() => { setReload(props.reload) }, [props.reload]);\n\n  const attachmentsRef = useRef();\n  attachmentsRef.current = attachments;\n\n  const [page, setPage] = useState(1);\n  const [count, setCount] = useState(0);\n  const [pageSize, setPageSize] = useState(5);\n\n  const pageSizes = [5, 10, 20];\n\n  const onChangeSearchOriginalname = (e) => {\n    const searchOriginalname = e.target.value;\n    setSearchOriginalname(searchOriginalname);\n  };\n\n  const getRequestParams = (/*searchOriginalname, page, pageSize, responseId*/) => {\n    let params = {};\n\n    if (searchOriginalname) {\n      params[\"originalname\"] = searchOriginalname;\n    }\n\n    if (page) {\n      params[\"page\"] = page - 1;\n    }\n\n    if (pageSize) {\n      params[\"size\"] = pageSize;\n    }\n\n    if (responseId) {\n      params[\"responseId\"] = responseId;\n    }\n\n    return params;\n  };\n\n  const retrieveAttachments = () => {\n    const params = getRequestParams(/*searchOriginalname, page, pageSize, responseId*/);\n\n    AttachmentDataService.getAll2(params)\n      .then((response) => {\n        const { attachments, totalPages } = response.data;\n\n        setAttachments(attachments);\n        setCount(totalPages);\n\n        console.log(response.data);\n      })\n      .catch((e) => {\n        console.log(e);\n      });\n  };\n\n  useEffect(retrieveAttachments, [page, pageSize, reload]);\n\n  const refreshList = () => {\n    retrieveAttachments();\n  };\n\n  const removeAllAttachments = () => {\n    AttachmentDataService.deleteAll()\n      .then((response) => {\n        console.log(response.data);\n        refreshList();\n      })\n      .catch((e) => {\n        console.log(e);\n      });\n  };\n\n\n  const openAttachment = (rowIndex) => {\n    const id = attachmentsRef.current[rowIndex].id;\n\n    props.history.push(\"/attachments/\" + id);\n  };\n\n  const deleteAttachment = (rowIndex) => {\n    const id = attachmentsRef.current[rowIndex].id;\n\n    AttachmentDataService.delete(id)\n      .then((response) => {\n        //props.history.push(\"/attachments\");\n\n        let newAttachments = [...attachmentsRef.current];\n        newAttachments.splice(rowIndex, 1);\n\n        setAttachments(newAttachments);\n      })\n      .catch((e) => {\n        console.log(e);\n      });\n  };\n\n  const columns = useMemo(\n    () => [\n      {\n        Header: \"时间\",\n        accessor: \"createdAt\",\n        Cell: (props) => {\n          const rowIdx = props.row.id;\n          const d = new Date(attachmentsRef.current[rowIdx].createdAt);\n          return (\n            <div>\n              {d.toLocaleDateString('zh-cn', { hour12: true, hour: \"2-digit\", minute: \"2-digit\", second: \"2-digit\" })}\n            </div>\n          );\n        },\n      },\n      {\n        Header: \"文件名\",\n        accessor: \"originalname\",\n      },\n      {\n        Header: \"说明\",\n        accessor: \"description\",\n        disableSortBy: true,\n      },\n      {\n        Header: \"操作\",\n        accessor: \"actions\",\n        disableSortBy: true,\n        Cell: (props) => {\n          const rowIdx = props.row.id;\n          return (\n            <div>\n              {(attachmentsRef.current[rowIdx].mimetype.startsWith('image') ||\n                attachmentsRef.current[rowIdx].mimetype.indexOf('pdf') > 0) && (\n              <a href=\"#\" onClick={() => download(attachmentsRef.current[rowIdx].id,\n                                                attachmentsRef.current[rowIdx].originalname,\n                                                attachmentsRef.current[rowIdx].mimetype, true)} >\n                <i className=\"fas fa-eye action mr-2\"></i>\n              </a>\n              )}\n\n              <a href=\"#\" onClick={() => download(attachmentsRef.current[rowIdx].id,\n                                                attachmentsRef.current[rowIdx].originalname,\n                                                attachmentsRef.current[rowIdx].mimetype, false)} >\n                <i className=\"fas fa-download action mr-2\"></i>\n              </a>\n\n              {!readonly && (<span onClick={() => window.confirm(\"您确定要删除吗 ?\") && deleteAttachment(rowIdx)}>\n                <i className=\"fas fa-trash action\"></i>\n              </span>)}\n            </div>\n          );\n        },\n      },\n    ],\n    []\n  );\n\n  const {\n    getTableProps,\n    getTableBodyProps,\n    headerGroups,\n    rows,\n    prepareRow,\n  } = useTable({\n    columns,\n    data: attachments,\n    disableSortRemove: true,\n  },\n  useSortBy);\n\n  const findByOriginalname = () => {\n    setPage(1);\n    retrieveAttachments();\n  };\n\n  const handlePageChange = (event, value) => {\n    setPage(value);\n  };\n\n  const handlePageSizeChange = (event) => {\n    setPageSize(event.target.value);\n    setPage(1);\n  };\n\n  const download = (id, originalname, mimetype, previewOnly) => {\n    AttachmentDataService.getContent(id)\n\t  .then(response => {\n        console.log(response.data);\n\n        const url = window.URL.createObjectURL(new Blob([response.data], { type: mimetype }));\n        const link = document.createElement('a');\n        link.href = url;\n        if (!previewOnly)\n          link.setAttribute('download',\n            originalname //'file.file' response.headers[\"Content-Disposition\"].split(\"filename=\")[1]\n          ); //or any other extension\n        document.body.appendChild(link);\n        link.click();\n        link.remove();\n\t  })\n\t  .catch((e) => {\n\t  alert(e);\n        console.log(e);\n      });\n  }\n\n  return (\n    <div className=\"list row\">\n      {!embedded && (<div className=\"col-sm-8\">\n        <h4>附件列表</h4>\n        <div className=\"input-group mb-3\">\n          <input\n            type=\"text\"\n            className=\"form-control\"\n            placeholder=\"Search by originalname\"\n            value={searchOriginalname}\n            onChange={onChangeSearchOriginalname}\n          />\n          <div className=\"input-group-append\">\n            <button\n              className=\"btn btn-outline-secondary\"\n              type=\"button\"\n              onClick={findByOriginalname}\n            >\n              Search\n            </button>\n          </div>\n        </div>\n\n        {\"每页显示行数: \"}\n        <select onChange={handlePageSizeChange} value={pageSize}>\n          {pageSizes.map((size) => (\n            <option key={size} value={size}>\n              {size}\n            </option>\n          ))}\n        </select>\n        <Pagination\n          className=\"my-3\"\n          count={count}\n          page={page}\n          siblingCount={1}\n          boundaryCount={1}\n          variant=\"outlined\"\n          shape=\"rounded\"\n          onChange={handlePageChange}\n        />\n      </div>)}\n\n      <div className=\"col-sm-12 list\">\n\n        <table\n          className=\"table table-striped table-bordered\"\n          {...getTableProps()}\n        >\n          <thead>\n            {headerGroups.map((headerGroup) => (\n              <tr {...headerGroup.getHeaderGroupProps()}>\n                {headerGroup.headers.map((column) => (\n                // Add the sorting props to control sorting. For this example\n                // we can add them into the header props\n                  <th {...column.getHeaderProps(column.getSortByToggleProps())}>\n                    {column.render('Header')}\n                    {/* Add a sort direction indicator */}\n                    <span>\n                      {column.isSorted\n                      ? column.isSortedDesc\n                        ? ' 🔽'\n                        : ' 🔼'\n                      : ''}\n                    </span>\n                  </th>\n                ))}\n              </tr>\n            ))}\n          </thead>\n          <tbody {...getTableBodyProps()}>\n            {rows.map((row, i) => {\n              prepareRow(row);\n              return (\n                <tr {...row.getRowProps()}>\n                  {row.cells.map((cell) => {\n                    return (\n                      <td {...cell.getCellProps()}>{cell.render(\"Cell\")}</td>\n                    );\n                  })}\n                </tr>\n              );\n            })}\n          </tbody>\n        </table>\n      </div>\n\n      <div className=\"col-sm-8\">\n      </div>\n    </div>\n  );\n};\n\nexport default AttachmentsList;","//import React, { Component } from \"react\";\nimport ResponseDataService from \"../services/response.service\";\nimport FormDataService from \"../services/form.service\";\n//import AttachmentsList from './collapsible-attachments-list.component.js';\nimport AttachmentsList from './attachments-list.component.js';\nimport SchoolDataService from \"../services/school.service\";\nimport SurveyDataService from \"../services/survey.service\";\nimport AuthService from \"./../services/auth.service\";\n//import TheCollapsible from './collapsible-attachments-list.component';\n\nimport $ from \"jquery\"; //Load jquery\nimport React, { Component, createRef } from \"react\"; //For react component\nimport ReactDOM from \"react-dom\";\nimport Select from 'react-select';\nimport { Tab, Tabs, TabList, TabPanel } from 'react-tabs';\nimport { Link } from \"react-router-dom\";\n\nwindow.jQuery = $; //JQuery alias\nwindow.$ = $; //JQuery alias\nrequire(\"jquery-ui-sortable\"); //For FormBuilder Element Drag and Drop\nrequire(\"formBuilder\");// For FormBuilder\n\nrequire('formBuilder/dist/form-render.min.js');\n\ndocument.body.style.margin = \"30px\"; //For add margin in HTML body\n\nexport default class Response extends Component {\n  constructor(props) {\n    super(props);\n    this.onChangeTitle = this.onChangeTitle.bind(this);\n    this.getResponse = this.getResponse.bind(this);\n    this.updateResponse = this.updateResponse.bind(this);\n    this.deleteResponse = this.deleteResponse.bind(this);\n    this.onChangeSchoolId = this.onChangeSchoolId.bind(this);\n    this.onChangeAttFiles = this.onChangeAttFiles.bind(this);\n    this.submitResponse = this.submitResponse.bind(this);\n    this.reload = this.reload.bind(this);\n    this.hasFiles = this.hasFiles.bind(this);\n\n    this.state = {\n      currentResponse: {\n        id: null,\n        title: \"\",\n        fdata: null,\n        formId: null,\n        schoolId: null,\n        //attFiles: [],\n      },\n\n      currentUser: null,\n      schools: [],\n      message: \"\",\n      readonly: true,\n      newresponse: true,\n      progress: 0,\n      reload: false,\n      hasFiles: null,\n\n      submitted: false,\n      updatedRecently: true,\n      updatedAt: null,\n    };\n\n    this.fb = createRef();\n    this.fRender = null;\n    //this.init();\n  }\n\n  optionOnSave = {\n    onSave: (e, responseData) => {   //Auto binds `this`\n     this.submitResponse();\n    }\n  };\n\n  async componentDidMount() {\n    await this.setUpdateStatus();\n\n    const newresponse = window.location.pathname.includes('add');\n    this.setState({newresponse: newresponse});\n    const readonly = window.location.pathname.includes('View');\n    this.setState({readonly: readonly});\n\n    if (newresponse)\n      this.getForm(this.props.match.params.id);\n    else\n      this.getResponse(this.props.match.params.id, readonly);\n  }\n\n  async setUpdateStatus() {\n    const UPDATE_THRESHOLD = 2; // number of days\n    const user = AuthService.getCurrentUser();\n    if (user && user.schoolId) {\n      try {\n        let r = await SurveyDataService.getUpdatedAt(user.schoolId);\n        let updatedAtObj =  (new Date(r.data.updatedAt.updatedAt));\n        let updatedRecently = ((new Date()).getTime() - updatedAtObj.getTime()) < UPDATE_THRESHOLD * (60 * 60 * 24 * 1000);\n        await this.setState({\n          updatedRecently: updatedRecently,\n          updatedAt: updatedAtObj.toLocaleDateString('zh-cn', { hour12: true, hour: \"2-digit\", minute: \"2-digit\", second: \"2-digit\" })\n        });\n      } catch (e) {\n        console.log(e.message);\n      }\n    }\n  }\n\n  convert(schools) {\n    const result = [];\n    if (schools) {\n    for (var i = 0; i < schools.length; i++) {\n      result.push({value: schools[i].id,\n        label: schools[i].code + \"-\" + schools[i].name + \"-\" + schools[i].region});\n    }\n    return result;\n    }\n  }\n\n  display(schoolId) {\n    if (this.state.schools) {\n      for (var i = 0; i < this.state.schools.length; i++) {\n        if (this.state.schools[i].value == schoolId)\n          return this.state.schools[i];\n      }\n      return [];\n    }\n  }\n\n  displayName(schoolId) {\n    if (this.state.schools) {\n      for (var i = 0; i < this.state.schools.length; i++) {\n        if (this.state.schools[i].value == schoolId)\n          return this.state.schools[i].label ? this.state.schools[i].label : '学校名';\n      }\n      return '';\n    }\n  }\n\n  getForm(formId) {\n    FormDataService.get(formId)\n      .then(response => {\n\n      try {\n        //const formData = JSON.stringify(response.data.fdata);\n        var formData = response.data.fdata;\n        if (!((typeof formData) === \"string\")) formData = JSON.stringify(response.data.fdata);\n        this.fRender = $(this.fb.current).formRender({ formData });\n      } catch (e) {\n        alert(e);\n      }\n\n      const {id, startAt, ...otherParameters} = response.data;\n\n      this.setState({\n        currentResponse: {\n          ...otherParameters,\n          startAt: (new Date(startAt)).getFullYear(),\n          formId: formId\n        },\n        hasFiles: this.hasFiles()\n      });\n\n/*\n      this.setState(function(prevState) {\n        return {\n          currentResponse: {\n            ...prevState.currentResponse,\n            formId: formId\n          },\n          hasFiles: this.hasFiles()\n         };\n      });\n*/\n      this.getSchools();\n    })\n  }\n\n  getResponse(id, readonly) {\n    ResponseDataService.get(id)\n      .then(response => {\n        try {\n          //const formData = JSON.stringify(response.data.fdata);\n          var formData = response.data.fdata;\n          if (!((typeof formData) === \"string\")) formData = JSON.stringify(response.data.fdata);\n          this.fRender = $(this.fb.current).formRender({ formData });\n          //this.fRender = $(this.fb.current).formRender(this.state.currentResponse.fdata);\n          if (readonly)\n            $('input, textarea, select', '.rendered-form').attr('readonly', true).attr('disabled', true);\n        } catch (e) {\n          alert(e);\n        }\n\n        const {startAt, ...otherParameters} = response.data;\n\n        this.setState({\n          //currentResponse: response.data,\n          currentResponse: {\n            ...otherParameters,\n            startAt: (startAt ? (new Date(startAt)).getUTCFullYear() : '')\n          },\n\n          hasFiles: this.hasFiles()\n        });\n\n        this.getSchools();\n\n        console.log(response.data);\n      })\n      .catch(e => {\n        console.log(e);\n      });\n  }\n\n\n  getSchools() {\n    SchoolDataService.getAllSimple()\n      .then(response => {\n        this.setState({\n          schools: this.convert(response.data)\n        });\n\n        const user = AuthService.getCurrentUser();\n        if (user) {\n          this.setState({\n          currentUser: user,\n          });\n          if (user.schoolId) {\n            this.setState(function(prevState) {\n              return {\n                currentResponse: {\n                  ...prevState.currentResponse,\n                  schoolId: user.schoolId\n                }\n              };\n            });\n          }\n        }\n        console.log(response);\n      })\n      .catch(e => {\n        console.log(e);\n      });\n  }\n\n  init() {\n    $(document).ready(function() {\n      let imagesPreview = function(input, placeToInsertImagePreview) {\n        if (input.files) {\n          let filesAmount = input.files.length;\n          for (var i = 0; i < filesAmount; i++) {\n            let reader = new FileReader();\n            reader.onload = function(event) {\n              $($.parseHTML(\"<img>\"))\n                .attr(\"src\", event.target.result)\n                .appendTo(placeToInsertImagePreview);\n            };\n            reader.readAsDataURL(input.files[i]);\n          }\n        }\n      };\n      $(\"#input-multi-files\").on(\"change\", function() {\n        imagesPreview(this, \"div.preview-images\");\n      });\n    });\n  }\n\n  getLabel(type, name) {\n    if (!this.state.currentResponse.fdata)\n      return '';\n\n    for (var i = 0; i < this.state.currentResponse.fdata.length; i++) {\n      if (this.state.currentResponse.fdata[i].type === type &&\n          this.state.currentResponse.fdata[i].name === name)\n        return this.state.currentResponse.fdata[i].label;\n    }\n\n    return '';\n  }\n\n  collectFiles() {\n    var inputs = document.getElementsByTagName(\"input\");\n    const attFiles = [];\n    if (inputs) {\n    for (var i = 0; i < inputs.length; i++) {\n      if (inputs[i].type === \"file\" && inputs[i].files) {\n        let filesN = inputs[i].files.length;\n        for (var j = 0; j < filesN; j++) {\n          attFiles.push({description: this.getLabel(inputs[i].type, inputs[i].name),\n            file: inputs[i].files[j]});\n          }\n        }\n      }\n    }\n\n    return attFiles;\n  }\n\n  hasFiles() {\n    var inputs = document.getElementsByTagName(\"input\");\n    const attFiles = [];\n    if (!inputs) return false;\n\n    for (var i = 0; i < inputs.length; i++)\n      if (inputs[i].type === \"file\")\n        return true;\n\n    return false;\n  }\n\n  clearFiles() {\n    var inputs = document.getElementsByTagName(\"input\");\n\n    if (inputs) {\n    for (var i = 0; i < inputs.length; i++) {\n      if (inputs[i].type === \"file\" && inputs[i].files) {\n        inputs[i].value = null;\n        }\n      }\n    }\n  }\n\n  onChangeAttFiles(e) {\n    e.preventDefault();\n    var attFiles = e.target.files;\n    this.setState(prevState => ({\n          currentResponse: {\n            ...prevState.currentResponse,\n            attFiles: attFiles\n          }\n        }));\n  }\n\n  onChangeSchoolId(e) {\n    const schoolId = e.value; //.target.value\n\n    this.setState(function(prevState) {\n      return {\n        currentResponse: {\n          ...prevState.currentResponse,\n          schoolId: schoolId\n        }\n      };\n    });\n  }\n\n  onChangeTitle(e) {\n    const title = e.target.value;\n\n    this.setState(function(prevState) {\n      return {\n        currentResponse: {\n          ...prevState.currentResponse,\n          title: title\n        }\n      };\n    });\n  }\n\n  uploadAttachments(attFiles) {\n    var data = new FormData();\n    var descriptions = [];\n    for (var i = 0; i < attFiles.length; i++) {\n      data.append('multi-files', attFiles[i].file,\n      attFiles[i].file.name);\n\n      descriptions.push(attFiles[i].description);\n    }\n    data.append('descriptions', JSON.stringify(descriptions));\n\n    ResponseDataService.uploadAttachments(this.state.currentResponse.id, data, (event) => {\n      this.setState({\n        progress: Math.round((100 * event.loaded) / event.total),\n      });\n    })\n    .then(response => {\n      console.log(response.data);\n\n//      if (attFiles[0]) {\n      //this.reload();\n        this.setState(prevState => ({\n          message: prevState.message + (attFiles[0] ? \" 项目申请附件成功上传!\" : \"\"),\n          reload: !this.state.reload,\n          submitted: true,\n        }))\n//      }\n      //alert(this.state.message);\n      this.clearFiles();\n    })\n    .catch(e => {\n      console.log(e);\n    });\n  }\n\n  validateSchool() {\n\n    if (!this.state.currentResponse.schoolId) {\n      this.setState({\n        message: \"请选择学校\"\n      });\n      return false;\n    }\n    return true;\n  }\n\n  updateResponse() {\n    if (!this.validateSchool()) return;\n\n    const attFiles = this.collectFiles();\n\n    var data = {\n      title: this.state.currentResponse.title,\n      schoolId: this.state.currentResponse.schoolId,\n      fdata: this.fRender.userData\n    };\n\n    ResponseDataService.update(\n      this.state.currentResponse.id,\n      data\n    )\n    .then(response => {\n      console.log(response.data);\n      this.uploadAttachments(attFiles);\n      this.setState({\n        //currentResponse: response.data,\n        message: \"项目申请成功修改!\"\n      });\n    })\n    .catch(e => {\n      console.log(e);\n    });\n      //$('input[name=\"responseId\"]').attr('value', this.state.currentResponse.id);\n      //this.refs.formToSubmit.submit();\n  }\n\n\n  submitResponse() {\n    if (!this.validateSchool()) return;\n\n    const attFiles = this.collectFiles();\n\n    var data = {\n      title: this.state.currentResponse.title,\n      formId: this.state.currentResponse.formId,\n      schoolId: this.state.currentResponse.schoolId,\n      fdata: this.fRender.userData,\n      userId: this.state.currentUser.id,\n    };\n\n    ResponseDataService.create(\n      data\n    )\n    .then(async (response) => {\n      console.log(response.data);\n\n      await this.setState(prevState => ({\n        //currentResponse: response.data,\n        currentResponse: {\n          ...prevState.currentResponse,\n          id: response.data.id\n        },\n        message: \"项目申请成功提交!\",\n        newresponse: false\n      }));\n\n      this.uploadAttachments(attFiles);\n      this.props.history.push(\"/responses/\" + response.data.id);\n    })\n    .catch(e => {\n      console.log(e);\n    });\n\n      //$('input[name=\"responseId\"]').attr('value', this.state.currentResponse.id);\n      //this.refs.formToSubmit.submit();\n   }\n\n\n  deleteResponse() {\n    ResponseDataService.delete(this.state.currentResponse.id)\n      .then(response => {\n        console.log(response.data);\n        this.props.history.push(\"/responses\" + (this.state.currentResponse.schoolId\n                                               ? ('/school/' + this.state.currentResponse.schoolId)\n                                               : ''))\n      })\n      .catch(e => {\n        console.log(e);\n      });\n  }\n\n  reload() {\n    //const c = Date.now();\n    this.setState({reload: !this.state.reload});\n  }\n\n\n  render() {\n    const { currentResponse, progress } = this.state;\n\n    return (\n\n      <div>\n      {!this.state.updatedRecently\n      ? (\n        <div>\n            <p>{'您的学校信息上次更新时间是：' + this.state.updatedAt + ', 请点击下面更新学校信息'}</p>\n            <a href={\"/surveys/\" + currentResponse.schoolId} class=\"btn btn-success\">更新</a>\n        </div>\n      )\n      : (this.state.submitted\n        ? (\n          <div>\n            <p><h4>{this.state.message}</h4></p>\n          </div>\n        )\n        : (\n          <div class=\"row\">\n            <div class=\"col-sm-4\">\n            {this.state.readonly && (\n              <div class=\"box\">\n                <a target=\"_blank\" href={\"/responses/\" + currentResponse.id} class=\"btn btn-primary mb-4\">编辑</a>\n              </div>\n            )}\n            </div>\n\n            <div class=\"col-sm-4\">\n            <h4>项目申请（{this.state.readonly?\"浏览\":\"编辑\"}）</h4>\n            <form>\n              <div className=\"form-group\">\n                <label htmlFor=\"title\">标题</label>\n                <input\n                  readonly={\"true\" /*this.state.readonly?\"\":false*/}\n                  type=\"text\"\n                  className=\"form-control\"\n                  id=\"title\"\n                  value={currentResponse.title}\n                  onChange={this.onChangeTitle}\n                />\n            </div>\n\n            <div class=\"form-group\">\n              <label htmlFor=\"schoolId\">所属学校</label>\n              {!this.state.readonly && AuthService.getCurrentUser() && !AuthService.getCurrentUser().schoolId\n              ? (<Select onChange={this.onChangeSchoolId.bind(this)}\n                readonly={this.state.readonly?\"\":false}\n                class=\"form-control\"\n                required\n                id=\"schoolId\"\n                value={this.display(currentResponse.schoolId)}\n                name=\"schoolId\"\n                options={this.state.schools}\n              />)\n              : (<Link\n                to={ \"/schoolsView/\" + currentResponse.schoolId}\n                id=\"schoolId\"\n                name=\"schoolId\"\n              >\n                {this.displayName(currentResponse.schoolId)}\n              </Link>)}\n            </div>\n\n            <div class=\"form-group\">\n              <label htmlFor=\"startAt\">项目年份</label>\n              <input\n                type=\"text\"\n                className=\"form-control\"\n                id='startAt'\n                readonly={\"true\" /*this.state.readonly?\"\":false*/}\n                placeholder=\"项目年份\"\n                value={currentResponse.startAt}\n              />\n            </div>\n\n            </form>\n          </div>\n\n          <div class=\"col-sm-4\">\n           {!this.state.readonly && (<div>\n              { this.state.newresponse? (\n                <button\n                  style={{ position: \"absolute\", right: \"10px\" }}\n                  type=\"submit\"\n                  className=\"btn btn-success\"\n                  onClick={this.submitResponse}\n                >\n                  提交\n                </button>\n              ) : (\n                <button\n                  style={{ position: \"absolute\", right: \"10px\" }}\n                  type=\"submit\"\n                  className=\"btn btn-success\"\n                  onClick={this.updateResponse}\n                >\n                  保存\n                </button>\n              )}\n\n              {(progress < 100 && progress > 0) && (\n                <div className=\"progress\">\n                <div\n                  className=\"progress-bar progress-bar-info progress-bar-striped\"\n                  role=\"progressbar\"\n                  aria-valuenow={progress}\n                  aria-valuemin=\"0\"\n                  aria-valuemax=\"100\"\n                  style={{ width: progress + \"%\" }}\n                >\n                  {progress}%\n                </div>\n                </div>\n              )}\n            </div>)}\n          </div>\n\n\n          <div id=\"fb-editor\" ref={this.fb} />\n\n          <div class=\"w-100\"></div>\n\n          {this.state.hasFiles &&\n          (<Tabs>\n            <TabList>\n            <Tab>更多信息 <i class=\"fas fa-hand-point-right\"></i></Tab>\n            <Tab>项目申请附件</Tab>\n            </TabList>\n            <TabPanel>\n            </TabPanel>\n            <TabPanel>\n            {this.state.currentResponse.id && (<AttachmentsList\n              responseId = {this.state.currentResponse.id}\n              embedded = {true}\n              readonly = {this.state.readonly}\n              reload = {this.state.reload}\n            />)}\n          </TabPanel>\n          </Tabs>)}\n\n          <div class=\"w-100\"></div>\n\n          {!this.state.readonly && (<div>\n          { this.state.newresponse? (\n            <button\n              type=\"submit\"\n              className=\"btn btn-success\"\n              onClick={this.submitResponse}\n            >\n              提交\n            </button>\n          ) : (\n            <button\n              type=\"submit\"\n              className=\"btn btn-success\"\n              onClick={this.updateResponse}\n            >\n              保存\n            </button>\n          )}\n          </div>)}\n\n          <div class=\"w-100\"></div>\n          <div className=\"alert-danger\">\n            <p><h4>{this.state.message}</h4></p>\n          </div>\n        </div>)\n      )}\n      </div>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport UserDataService from \"../services/auth.service\";\nimport { Link } from \"react-router-dom\";\nimport Pagination from \"@material-ui/lab/Pagination\";\n\nimport { useState, useEffect, useMemo, useRef } from \"react\";\nimport { useTable, useSortBy } from \"react-table\";\n\nimport AuthService from \"../services/auth.service\";\n\nconst UsersList = (props) => {\n  const [users, setUsers] = useState([]);\n  const [currentUser, setCurrentUser] = useState(null);\n  const [currentIndex, setCurrentIndex] = useState(-1);\n\n  const usersRef = useRef();\n  usersRef.current = users;\n\n  const [page, setPage] = useState(1);\n  const [count, setCount] = useState(0);\n  const [pageSize, setPageSize] = useState(30);\n\n  const [schoolId, setSchoolId] = useState(props.match? props.match.params.schoolId : props.schoolId);\n\n  const [rolesFull, setRolesFull] = useState([\n                                               {name: \"user\", label: \"学校用户\"},\n                                               {name: \"admin\", label: \"管理员\"},\n                                               {name: \"moderator\", label: \"教师\"},\n                                               {name: \"volunteer\", label: \"欣欣义工\"},\n                                             ]);\n\n  const pageSizes = [20, 30, 50];\n\n  const [orderby, setOrderby] = useState([]);\n\n  const [totalItems, setTotalItems] = useState(0);\n\n  const [schoolTitle, setSchoolTitle] = useState(null);\n\n  const [searchRole, setSearchRole] = useState(\"\");\n  const onChangeSearchRole = (e) => {\n    const searchRole = e.target.value;\n    setSearchRole(searchRole);\n  };\n\n  const [searchUsername, setSearchUsername] = useState(\"\");\n  const onChangeSearchUsername = (e) => {\n    const searchUsername = e.target.value;\n    setSearchUsername(searchUsername);\n  };\n\n  const [searchEmail, setSearchEmail] = useState(\"\");\n  const onChangeSearchEmail = (e) => {\n    const searchEmail = e.target.value;\n    setSearchEmail(searchEmail);\n  };\n\n  const [searchSchoolCode, setSearchSchoolCode] = useState(\"\");\n  const onChangeSearchSchoolCode = (e) => {\n    const searchSchoolCode = e.target.value;\n    setSearchSchoolCode(searchSchoolCode);\n  };\n\n  const [searchContactOnly, setSearchContactOnly] = useState(null);\n  const onChangeSearchContactOnly = (e) => {\n    const searchContactOnly = e.target.value;\n    setSearchContactOnly(searchContactOnly);\n  };\n\n  const [searchEmailVerified, setSearchEmailVerified] = useState(null);\n  const onChangeSearchEmailVerified = (e) => {\n    const searchEmailVerified = e.target.value;\n    setSearchEmailVerified(searchEmailVerified);\n  };\n\n  const getRequestParams = (/*searchUsername, searchRole, searchSchoolCode, page, pageSize, schoolId, orderby*/) => {\n    let params = {};\n\n    if (searchUsername) {\n      params[\"username\"] = searchUsername;\n    }\n\n    if (searchEmail) {\n      params[\"email\"] = searchEmail;\n    }\n\n    if (searchRole) {\n      params[\"role\"] = searchRole;\n    }\n\n    if (searchSchoolCode) {\n      params[\"schoolCode\"] = searchSchoolCode;\n    }\n\n    if (searchContactOnly) {\n      params[\"contactOnly\"] = searchContactOnly;\n    }\n\n    if (searchEmailVerified) {\n      params[\"emailVerified\"] = searchEmailVerified;\n    }\n\n    if (page) {\n      params[\"page\"] = page - 1;\n    }\n\n    if (pageSize) {\n      params[\"size\"] = pageSize;\n    }\n\n    if (schoolId) {\n      params[\"schoolId\"] = schoolId;\n    }\n\n    if (orderby) {\n      params[\"orderby\"] = orderby;\n    }\n\n    return params;\n  };\n\n  const onClearSearch = (e) => {\n    setSearchUsername(\"\");\n    setSearchEmail(\"\");\n    setSearchSchoolCode(\"\");\n    setSearchRole(\"\");\n    setSearchContactOnly(\"\");\n    setSearchEmailVerified(\"\");\n    setOrderby([]);\n  };\n\n  const getRoleLabel = (name) => {\n    for (var i = 0; i < rolesFull.length; i++) {\n      if (rolesFull[i].name.trim() === name.trim()) {\n        return rolesFull[i].label;\n      }\n    }\n    return null;\n  }\n\n\n  const renderRoles = (rowIdx) => {\n    let r = \"\";\n    if (usersRef.current[rowIdx].roles) {\n      for (var i = 0; i < usersRef.current[rowIdx].roles.length; i++) {\n        r = r + \", \" + getRoleLabel(usersRef.current[rowIdx].roles[i].name);\n      }\n    }\n    return r.substring(r.indexOf(',') + 2);\n  }\n\n  const renderSchool = (rowIdx) => {\n    let r = \"\";\n    if (usersRef.current[rowIdx].school) {\n      r = usersRef.current[rowIdx].school.region + \"/\" + usersRef.current[rowIdx].school.name;\n    }\n    return r;\n  }\n\n  const getRoles = () => {\n    AuthService.getRoles()\n      .then(response => {\n        setRolesFull(response.data);\n        console.log(response);\n      })\n      .catch(e => {\n        console.log(e);\n      });\n  }\n\n  useEffect(getRoles, []);\n\n  const retrieveUsers = () => {\n    const params = getRequestParams(/*searchUsername, searchRole, searchSchoolCode, page, pageSize, schoolId, orderby*/);\n\n    UserDataService.getAll2(params)\n      .then((response) => {\n        const { users, totalPages, totalItems } = response.data;\n\n        setUsers(users);\n        setCount(totalPages);\n        setTotalItems(totalItems);\n\n\n        if (schoolId && users[0]) setSchoolTitle(users[0].school.name + \"(\" + users[0].school.code + \")\");\n\n        console.log(response.data);\n      })\n      .catch((e) => {\n        console.log(e);\n      });\n  };\n\n  useEffect(retrieveUsers, [page, pageSize, orderby, searchRole, searchUsername, searchEmail, searchSchoolCode,\n    searchContactOnly, searchEmailVerified]);\n\n  const refreshList = () => {\n    retrieveUsers();\n  };\n\n  const removeAllUsers = () => {\n    UserDataService.deleteAll()\n      .then((response) => {\n        console.log(response.data);\n        refreshList();\n      })\n      .catch((e) => {\n        console.log(e);\n      });\n  };\n\n\n  const openUser = (rowIndex) => {\n    const id = usersRef.current[rowIndex].id;\n    props.history.push(\"/users/\" + id);\n  };\n\n  const deleteUser = (rowIndex) => {\n    const id = usersRef.current[rowIndex].id;\n\n    UserDataService.delete(id)\n      .then((response) => {\n        //props.history.push(\"/users\");\n        let newUsers = [...usersRef.current];\n        newUsers.splice(rowIndex, 1);\n        setUsers(newUsers);\n      })\n      .catch((e) => {\n        console.log(e);\n      });\n  };\n\n  const schoolKnownColumns =\n    [ 'school.code', 'school.name'];\n\n  var hiddenColumns = [];\n  if (schoolId) hiddenColumns = schoolKnownColumns;\n\n  const columns = useMemo(\n    () => [\n/*\n      {\n        Header: \"id\",\n        accessor: \"id\",\n        disableSortBy: true,\n      },\n*/\n      {\n        Header: \"用户名\",\n        accessor: \"username\",\n      },\n      {\n        Header: \"中文名\",\n        accessor: \"chineseName\",\n      },\n      {\n        Header: \"电子邮件\",\n        accessor: \"email\",\n        disableSortBy: true,\n      },\n      {\n        Header: \"职务\",\n        accessor: \"title\",\n        disableSortBy: true,\n      },\n      {\n        Header: \"角色\",\n        accessor: 'roles',\n        disableSortBy: true,\n        Cell: (props) => {\n          const rowIdx = props.row.id;\n          return (\n            <div>\n                {renderRoles(rowIdx)}\n            </div>\n          );\n        },\n      },\n      {\n        Header: \"学校编号\",\n        accessor: 'school.code',\n        Cell: (props) => {\n          const rowIdx = props.row.id;\n          return (\n            <div>\n            {usersRef.current[rowIdx].school ? (\n              <Link\n                to={\"/schoolsView/\" + usersRef.current[rowIdx].school.id}\n                className=\"badge badge-success\"\n              >\n                {usersRef.current[rowIdx].school.code}\n              </Link>\n            ) : ''}\n            </div>\n          );\n        },\n      },\n      {\n        Header: \"学校名称\",\n        accessor: 'school.name',\n        Cell: (props) => {\n          const rowIdx = props.row.id;\n          return (\n            <div>\n            {usersRef.current[rowIdx].school ? (\n              <Link\n                to={\"/schoolsView/\" + usersRef.current[rowIdx].school.id}\n                className=\"badge badge-success\"\n              >\n                {usersRef.current[rowIdx].school.name}\n              </Link>\n            ) : ''}\n            </div>\n          );\n        },\n      },\n      {\n        Header: \"上次登录时间\",\n        accessor: \"lastLogin\",\n      },\n/*\n      {\n        Header: \"创建时间\",\n        accessor: \"createdAt\",\n      },\n*/\n      {\n        Header: \"注册用户\",\n        accessor: 'contactOnly',\n        Cell: (props) => {\n          const rowIdx = props.row.id;\n          return (\n            <div>\n                {usersRef.current[rowIdx].contactOnly ? '否' : '是'}\n            </div>\n          );\n        },\n      },\n      {\n        Header: \"登录过?\",\n        accessor: 'emailVerified',\n        Cell: (props) => {\n          const rowIdx = props.row.id;\n          return (\n            <div>\n                {usersRef.current[rowIdx].emailVerified ? '是' : '否'}\n            </div>\n          );\n        },\n      },\n      {\n        Header: \"操作\",\n        accessor: \"actions\",\n        disableSortBy: true,\n        Cell: (props) => {\n          const rowIdx = props.row.id;\n          return (\n            <div>\n              <Link\n                to={\"/usersView/\" + usersRef.current[rowIdx].id}\n              >\n                <i className=\"fas fa-eye action mr-2\"></i>\n              </Link>\n\n              <span onClick={() => openUser(rowIdx)}>\n                <i className=\"far fa-edit action mr-2\"></i>\n              </span>\n\n              <span onClick={() => window.confirm(\"您确定要删除吗 ?\") && deleteUser(rowIdx)}>\n                <i className=\"fas fa-trash action\"></i>\n              </span>\n            </div>\n          );\n        },\n      },\n    ],\n    []\n  );\n\n  const {\n    getTableProps,\n    getTableBodyProps,\n    headerGroups,\n    rows,\n    prepareRow,\n    state,\n    state: {sortBy},\n  } = useTable({\n    columns,\n    data: users,\n    disableSortRemove: true,\n    manualSortBy: true,\n    initialState: {\n      hiddenColumns: hiddenColumns,\n    },\n  },\n  useSortBy);\n\n  const search = () => {\n    setPage(1);\n    retrieveUsers();\n  };\n\n  const handlePageChange = (event, value) => {\n    setPage(value);\n  };\n\n  const handlePageSizeChange = (event) => {\n    setPageSize(event.target.value);\n    setPage(1);\n  };\n\n  useEffect(() => {\n    if (sortBy && sortBy[0])\n      setOrderby(sortBy);\n  }, [sortBy]);\n\n\n  return (\n    <div className=\"list row\">\n      <div className=\"col-sm-7\">\n        <h4>{schoolTitle ? schoolTitle + \" - \" : \"\"}用户列表(总数：{totalItems})</h4>\n        <div className=\"row mb-3\">\n          <select\n            className=\"form-control col-sm-2\"\n            value={searchRole}\n            onChange={onChangeSearchRole}\n          >\n            <option value=\"\">角色</option>\n            {rolesFull.map((option) => (\n              <option value={option.name}>\n                {option.label}\n              </option>\n            ))}\n          </select>\n\n          {!schoolId && (<input\n            type=\"text\"\n            className=\"form-control col-sm-2 ml-2\"\n            placeholder=\"学校编号\"\n            value={searchSchoolCode}\n            onChange={onChangeSearchSchoolCode}\n          />)}\n\n          <input\n            type=\"text\"\n            className=\"form-control col-sm-4 ml-2\"\n            placeholder=\"电子邮件\"\n            value={searchEmail}\n            onChange={onChangeSearchEmail}\n          />\n        </div>\n\n        <div className=\"row mb-3\">\n          <input\n            type=\"text\"\n            className=\"form-control col-sm-3\"\n            placeholder=\"用户名/中文名\"\n            value={searchUsername}\n            onChange={onChangeSearchUsername}\n          />\n\n          <select\n            className=\"form-control col-sm-2 ml-2\"\n            value={searchContactOnly}\n            onChange={onChangeSearchContactOnly}\n          >\n            <option value=\"\">用户类型</option>\n              <option value={false}>\n                {'注册用户'}\n              </option>\n              <option value={true}>\n                {'非注册用户'}\n              </option>\n          </select>\n\n          <select\n            className=\"form-control col-sm-2 ml-2\"\n            value={searchEmailVerified}\n            onChange={onChangeSearchEmailVerified}\n          >\n            <option value=\"\">登录过?</option>\n              <option value={true}>\n                {'是'}\n              </option>\n              <option value={false}>\n                {'否'}\n              </option>\n          </select>\n\n          <div>\n            <button\n              className=\"btn btn-primary ml-2\"\n              type=\"button\"\n              onClick={onClearSearch}\n            >\n              清空\n            </button>\n          </div>\n\n        </div>\n\n        <div className=\"row mb-4\">\n          <button\n            className=\"btn btn-primary mr-2\"\n            type=\"button\"\n            onClick={search}\n          >\n            查询\n          </button>\n\n          {schoolId && (<a target=\"_blank\"\n            href={\"/addU?schoolId=\" + schoolId} class=\"btn btn-primary \">\n              新建联络方式\n          </a>)}\n        </div>\n      </div>\n\n      <div className=\"mt-3 col-sm-5\">\n        {\"每页显示行数: \"}\n        <select onChange={handlePageSizeChange} value={pageSize}>\n          {pageSizes.map((size) => (\n            <option key={size} value={size}>\n              {size}\n            </option>\n          ))}\n        </select>\n\n        <Pagination\n          className=\"my-3\"\n          count={count}\n          page={page}\n          siblingCount={1}\n          boundaryCount={1}\n          variant=\"outlined\"\n          shape=\"rounded\"\n          onChange={handlePageChange}\n        />\n      </div>\n\n      <div class=\"w-100\"></div>\n\n      <div className=\"col-sm-12 list\">\n        <table\n          className=\"table table-striped table-bordered\"\n          {...getTableProps()}\n        >\n          <thead>\n            {headerGroups.map((headerGroup) => (\n              <tr {...headerGroup.getHeaderGroupProps()}>\n                {headerGroup.headers.map((column) => (\n                  // Add the sorting props to control sorting. For this example\n                  // we can add them into the header props\n                  <th {...column.getHeaderProps(column.getSortByToggleProps())}>\n                    {column.render('Header')}\n                    {/* Add a sort direction indicator */}\n                      <span>\n                        {column.isSorted\n                        ? column.isSortedDesc\n                          ? ' 🔽'\n                          : ' 🔼'\n                        : ''}\n                      </span>\n                  </th>\n                ))}\n              </tr>\n            ))}\n          </thead>\n          <tbody {...getTableBodyProps()}>\n            {rows.map((row, i) => {\n              prepareRow(row);\n              return (\n                <tr {...row.getRowProps()}>\n                  {row.cells.map((cell) => {\n                    return (\n                      <td {...cell.getCellProps()}>{cell.render(\"Cell\")}</td>\n                    );\n                  })}\n                </tr>\n              );\n            })}\n          </tbody>\n        </table>\n      </div>\n\n      <div className=\"mb-3 col-sm-12\">\n        {\"每页显示行数: \"}\n        <select onChange={handlePageSizeChange} value={pageSize}>\n          {pageSizes.map((size) => (\n            <option key={size} value={size}>\n              {size}\n            </option>\n          ))}\n        </select>\n\n        <Pagination\n          className=\"my-3\"\n          count={count}\n          page={page}\n          siblingCount={1}\n          boundaryCount={1}\n          variant=\"outlined\"\n          shape=\"rounded\"\n          onChange={handlePageChange}\n        />\n      </div>\n\n    </div>\n  );\n};\n\nexport default UsersList;","import React from 'react';\nimport { withRouter } from \"react-router-dom\";\nimport { useIdleTimer } from 'react-idle-timer';\n//import { useHistory } from 'react-router'\n\nimport AuthService from \"./auth.service\";\n\nconst SESSION_IDLE_MINUTES = 20;\n\nconst EXEMPTED_URLS = [\n    \"/schools\",\n    \"/schoolsView\",\n    \"/projects\",\n    \"/projects/school\",\n    \"/projectsView\"\n  ];\n\nconst AutoLogoutTimer = (props: any) => {\n\n  const login = (newTarget = false) => {\n    AuthService.logout();\n    if (newTarget) {\n      props.history.goBack();\n      const win = window.open(\"/login\", newTarget ? \"_blank\" : null);\n      win.focus();\n    } else {\n      props.history.push('/login');\n      window.location.reload();\n    }\n  }\n\n//window.location.pathname.includes('add')\n\n  const isExempted = () => {\n    const pathname = window.location.pathname;\n    for (var i = 0; i < EXEMPTED_URLS.length; i++)\n      if (pathname.includes(EXEMPTED_URLS[i]))\n        return true;\n    return false;\n  }\n\n  if (!AuthService.getCurrentUser() && !isExempted()) {\n    login(true);\n    //if (window.confirm(\"需要登录 ?\")) login();\n    //else props.history.goBack();\n  }\n\n\n  const { ComposedClass, ...passThroughProps } = props;\n    //const history = useHistory();\n\n  const handleOnIdle = (event: any) => {\n    //console.log('user is idle', event)\n    //console.log('last active', getLastActiveTime());\n    login();\n    //AuthService.logout();\n    //props.history.push('/login');\n  }\n\n  const {getLastActiveTime } = useIdleTimer({\n    timeout: 1000 * 60 * SESSION_IDLE_MINUTES,\n    onIdle: handleOnIdle,\n    debounce: 500,\n  })\n\n  return <ComposedClass  {...passThroughProps} />\n}\n\nexport default withRouter(AutoLogoutTimer);","import React, { Component } from \"react\";\nimport Form from \"react-validation/build/form\";\nimport Input from \"react-validation/build/input\";\nimport CheckButton from \"react-validation/build/button\";\n\nimport AuthService from \"../services/auth.service\";\n\nconst jwt = require(\"jsonwebtoken\");\n\nconst required = value => {\n  if (!value) {\n    return (\n      <div className=\"alert alert-danger\" role=\"alert\">\n        必须填写!\n      </div>\n    );\n  }\n};\n\nconst vpassword = value => {\n  if (value && value.length > 0 && (value.length < 6 || value.length > 40)) {\n    return (\n      <div className=\"alert alert-danger\" role=\"alert\">\n        密码应含6至40个字节\n      </div>\n    );\n  }\n};\n\nexport default class Reset extends Component {\n  constructor(props) {\n    super(props);\n    this.handleReset = this.handleReset.bind(this);\n    this.onChangePasswordVerified = this.onChangePasswordVerified.bind(this);\n    this.onChangePassword = this.onChangePassword.bind(this);\n\n    this.state = {\n      passwordVerified: \"\",\n      password: \"\",\n      email: null,\n      loading: false,\n      message: \"\"\n    };\n  }\n\n  componentDidMount() {\n    const search = this.props.location.search;\n    const token = new URLSearchParams(search).get('token');\n\n    var email = null;\n    jwt.verify(token, \"config.secret\", (err, decoded) => {\n      if (!err)\n        email = decoded.email;\n    });\n\n    if (!email) {\n      this.setState({\n        message: '您的邮箱地址无效，密码重置请求失效，请到登录页面重新提供注册邮箱。。。',\n        email: null\n      });\n    } else {\n      this.setState({\n        email: email\n      });\n    }\n  }\n\n  onChangePasswordVerified(e) {\n    this.setState({\n      passwordVerified: e.target.value\n    });\n  }\n\n  onChangePassword(e) {\n    this.setState({\n      password: e.target.value\n    });\n  }\n\n  handleReset(e) {\n    e.preventDefault();\n\n    this.form.validateAll();\n    if (this.checkBtn.context._errors.length > 0) return;\n\n    if (!this.state.email)\n      return;\n\n    if (this.state.passwordVerified === this.state.password) {\n      AuthService.reset(this.state.email, this.state.password)\n      .then(response => {\n        alert('密码已经成功重置');\n        //this.props.history.push(\"/profile\");\n        if (!AuthService.getCurrentUser()) {\n          this.props.history.push(\"/login?username=\" + response.data.username);\n          window.location.reload();\n          this.setState({\n            message: '您的密码已经成功重置！'\n          });\n        } else\n          this.props.history.goBack();\n      })\n      .catch(error => {\n        this.setState({\n          message: JSON.stringify(error)\n        });\n      });\n    } else {\n      this.setState({\n        message: '请再次确认密码。。。'\n      });\n    }\n  }\n\n\n  render() {\n    return (\n    <div>\n\n      <div className=\"col-sm-12\">\n        <div className=\"card card-container\">\n          <img\n            src=\"//ssl.gstatic.com/accounts/ui/avatar_2x.png\"\n            alt=\"profile-img\"\n            className=\"profile-img-card\"\n          />\n\n          <Form\n            onSubmit={this.handleReset}\n            ref={c => {\n              this.form = c;\n            }}\n          >\n\n            <div className=\"form-group\">\n              <label htmlFor=\"password\">新密码</label>\n              <Input\n                type=\"password\"\n                className=\"form-control\"\n                name=\"password\"\n                value={this.state.password}\n                onChange={this.onChangePassword}\n                validations={[required, vpassword]}\n              />\n            </div>\n\n            <div className=\"form-group\">\n              <label htmlFor=\"passwordVerified\">新密码再确认</label>\n              <Input\n                type=\"password\"\n                className=\"form-control\"\n                name=\"passwordVerified\"\n                value={this.state.passwordVerified}\n                onChange={this.onChangePasswordVerified}\n                validations={[required]}\n              />\n            </div>\n\n            <div className=\"form-group\">\n              <button\n                className=\"btn btn-primary btn-block\"\n                disabled={this.state.loading}\n              >\n                {this.state.loading && (\n                  <span className=\"spinner-border spinner-border-sm\"></span>\n                )}\n                <span>提交</span>\n              </button>\n            </div>\n\n            {this.state.message && (\n              <div className=\"form-group\">\n                <div className=\"alert alert-danger\" role=\"alert\">\n                  {this.state.message}\n                </div>\n              </div>\n            )}\n            <CheckButton\n              style={{ display: \"none\" }}\n              ref={c => {\n                this.checkBtn = c;\n              }}\n            />\n          </Form>\n        </div>\n      </div>\n\n    </div>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport Form from \"react-validation/build/form\";\nimport Input from \"react-validation/build/input\";\nimport CheckButton from \"react-validation/build/button\";\n\n\nimport $ from \"jquery\"; //Load jquery\n\nimport emailjs, { init } from \"emailjs-com\";\n\nimport AuthService from \"../services/auth.service\";\n\ninit(\"user_xpt3ehC4nNeGJBgM579gJ\");\n\nconst jwt = require(\"jsonwebtoken\");\n\nconst required = value => {\n  if (!value) {\n    return (\n      <div className=\"alert alert-danger\" role=\"alert\">\n        必须填写!\n      </div>\n    );\n  }\n};\n\nexport default class Login extends Component {\n  constructor(props) {\n    super(props);\n    this.handleLogin = this.handleLogin.bind(this);\n    this.onChangeUsername = this.onChangeUsername.bind(this);\n    this.onChangePassword = this.onChangePassword.bind(this);\n    this.onChangeEmail = this.onChangeEmail.bind(this);\n    this.onReset = this.onReset.bind(this);\n    this.handleReset = this.handleReset.bind(this);\n    this.handleEmailVerification = this.handleEmailVerification.bind(this);\n\n\n    this.state = {\n      username: \"\",\n      password: \"\",\n      email: \"\",\n      isReset: false,\n      loading: false,\n      message: \"\",\n\n    };\n\n    this.init();\n  }\n\n  componentDidMount() {\n    const search = this.props.location.search;\n    const username = new URLSearchParams(search).get('username');\n    const token = new URLSearchParams(search).get('token');\n\n    if (token) { // email verification\n      var email = null;\n      jwt.verify(token, \"config.secret\", (err, decoded) => {\n        if (!err)\n          email = decoded.email;\n      });\n      if (email)\n        this.handleEmailVerification(email);\n    }\n\n    if (username)\n      this.setState({\n        username: username\n      });\n  }\n\n  init() {\n    $(document).ready(function() {\n      $('#toggle').addClass('fas fa-eye-slash');\n\n      $('#toggle').click(function() {\n        if($(this).hasClass('fas fa-eye-slash')){\n          $(this).removeClass('fas fa-eye-slash');\n          $(this).addClass('fas fa-eye');\n          $('#password').attr('type','text');\n        } else {\n          $(this).removeClass('fas fa-eye');\n          $(this).addClass('fas fa-eye-slash');\n          $('#password').attr('type','password');\n        }\n      });\n    });\n  }\n\n  onChangeUsername(e) {\n    this.setState({\n      username: e.target.value\n    });\n  }\n\n  onChangePassword(e) {\n    this.setState({\n      password: e.target.value\n    });\n  }\n\n  onChangeEmail(e) {\n    this.setState({\n      email: e.target.value\n    });\n  }\n\n  onReset() {\n    this.setState({\n      isReset: true\n    });\n  }\n\n\n  handleEmailVerification(email) {\n      AuthService.findByEmail(email)\n      .then(r => {\n        this.setState({\n          username: r.data.username\n        });\n      })\n      .catch(e => {\n        this.setState({\n          message: e.toString()\n        });\n      });\n  }\n\n  handleReset(e) {\n    e.preventDefault();\n\n    if (this.state.email) {\n      var token = jwt.sign({ email: this.state.email }, \"config.secret\", {\n        expiresIn: 900 // 15 minutes\n      });\n\n      AuthService.findByEmail(this.state.email)\n      .then(r => {\n        const url = window.location.host;\n        var templateParams = {\n              to: this.state.email,\n              username: r.data.chineseName ? r.data.chineseName : r.data.username,\n              link: url + \"/reset?token=\" + token\n              //link: \"http://localhost:8081/reset?token=\" + token\n        };\n\n        emailjs.send(\"icloud_2021_12_27\",\"template_ae0k3bj\", templateParams)\n        .then((result) => {\n          console.log(result.text);\n          this.setState({\n            message: \"邮件已发至您的邮箱，请在15分钟内完成密码重置。。。\"\n          });\n        }, (error) => {\n          console.log(error.text);\n          this.setState({\n            message: error.text\n          });\n        });\n      })\n      .catch(e => {\n        this.setState({\n          message: '您的注册邮箱地址有误，请提供正确的注册邮箱 。。。' //+ e.toString()\n        });\n      });\n    }\n  }\n\n  handleLogin(e) {\n    e.preventDefault();\n\n    this.setState({\n      message: \"\",\n      loading: true\n    });\n\n    this.form.validateAll();\n\n    if (this.checkBtn.context._errors.length === 0) {\n      AuthService.login(this.state.username, this.state.password).then(\n        (response) => {\n          if (response.data.accessToken) {\n            localStorage.setItem(\"user\", JSON.stringify(response.data));\n            //this.props.history.push(\"/profile\");\n            //this.props.history.push(\"/schools\");\n            AuthService.getCurrentUser().schoolId\n              ? this.props.history.push('/schoolsView/' + AuthService.getCurrentUser().schoolId)\n              : this.props.history.push('/schools');\n\n            window.location.reload();\n          } else {\n            this.setState({\n              loading: false,\n              message: '服务器异常，登录失败'\n            });\n          }\n        },\n        error => {\n          const resMessage =\n            (error.response &&\n              error.response.data &&\n              error.response.data.message) ||\n            error.message ||\n            error.toString();\n\n          this.setState({\n            loading: false,\n            message: resMessage\n          });\n        }\n      );\n    } else {\n      this.setState({\n        loading: false\n      });\n    }\n  }\n\n\n  render() {\n    return (\n    <div>\n    { /* AuthService.getCurrentUser() */ AuthService.isValid()\n    ? AuthService.getCurrentUser().schoolId\n       ? this.props.history.push('/schoolsView/' + AuthService.getCurrentUser().schoolId)\n       : this.props.history.push('/schools')\n    : (\n      <div className=\"col-sm-12\">\n        <div className=\"card card-container\">\n          <img\n            src=\"//ssl.gstatic.com/accounts/ui/avatar_2x.png\"\n            alt=\"profile-img\"\n            className=\"profile-img-card\"\n          />\n\n          <Form\n            onSubmit={this.state.isReset? this.handleReset : this.handleLogin}\n            ref={c => {\n              this.form = c;\n            }}\n          >\n            {this.state.isReset\n            ? (\n              <div className=\"form-group\">\n                <label htmlFor=\"email\">您的注册邮箱</label>\n                <Input\n                  type=\"text\"\n                  className=\"form-control\"\n                  name=\"email\"\n                  value={this.state.email}\n                  onChange={this.onChangeEmail}\n                  validations={[required]}\n                />\n              </div>\n            )\n            : (<div>\n              <div className=\"form-group\">\n                <label htmlFor=\"username\">用户名</label>\n                <Input\n                  type=\"text\"\n                  className=\"form-control\"\n                  name=\"username\"\n                  value={this.state.username}\n                  onChange={this.onChangeUsername}\n                  validations={[required]}\n                />\n              </div>\n\n              <div className=\"form-group\">\n                <label htmlFor=\"password\">密码</label>\n                <div style={{position: \"relative\", width: \"100%\"}} >\n                  <Input\n                    style={{ width: \"100%\" }}\n                    type=\"password\"\n                    className=\"form-control\"\n                    name=\"password\"\n                    id=\"password\"\n                    value={this.state.password}\n                    onChange={this.onChangePassword}\n                    validations={[required]}\n                  />\n\n                  <button type=\"button\" id=\"toggle\" class=\"toggle\"\n                    style={{ position: \"absolute\", right: \"10px\", top: \"10px\",\n                    background: 'transparent', border: 'none'}}\n                  />\n\n                </div>\n\n                <button\n                  style={{ float: \"left\", width: \"45%\" }}\n                  className=\"btn btn-primary badge mt-2\"\n                  type=\"button\"\n                  onClick={this.onReset}\n                >\n                  忘记用户名或密码?\n                </button>\n\n              </div>\n\n            </div>)}\n\n            <div className=\"form-group\">\n              <button\n                className=\"btn btn-primary btn-block\"\n                disabled={this.state.loading}\n              >\n                {this.state.loading && (\n                  <span className=\"spinner-border spinner-border-sm\"></span>\n                )}\n                <span>{this.state.isReset? '重置密码' : '登录'}</span>\n              </button>\n            </div>\n\n            {this.state.message && (\n              <div className=\"form-group\">\n                <div className=\"alert alert-danger\" role=\"alert\">\n                  {this.state.message}\n                </div>\n              </div>\n            )}\n            <CheckButton\n              style={{ display: \"none\" }}\n              ref={c => {\n                this.checkBtn = c;\n              }}\n            />\n          </Form>\n        </div>\n      </div>\n     )}\n    </div>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport Form from \"react-validation/build/form\";\nimport Input from \"react-validation/build/input\";\nimport CheckButton from \"react-validation/build/button\";\nimport { isEmail } from \"validator\";\nimport Select from 'react-select';\nimport { Link } from \"react-router-dom\";\n\nimport queryString from 'query-string'\n\nimport emailjs, { init } from \"emailjs-com\";\n\nimport AuthService from \"../services/auth.service\";\nimport SchoolDataService from \"../services/school.service\";\n\ninit(\"user_xpt3ehC4nNeGJBgM579gJ\");\n\nconst jwt = require(\"jsonwebtoken\");\n\nconst required = value => {\n  if (!value) {\n    return (\n      <div className=\"alert alert-danger\" role=\"alert\">\n        请填写!\n      </div>\n    );\n  }\n};\n\nconst email = value => {\n  if (!isEmail(value)) {\n    return (\n      <div className=\"alert alert-danger\" role=\"alert\">\n        邮件地址不正确\n      </div>\n    );\n  }\n};\n\nconst vusername = value => {\n  if (value.length < 3 || value.length > 20) {\n    return (\n      <div className=\"alert alert-danger\" role=\"alert\">\n        用户名应含3至20个字节\n      </div>\n    );\n  }\n};\n\nconst vpassword = value => {\n  if (value && value.length > 0 && (value.length < 6 || value.length > 40)) {\n    return (\n      <div className=\"alert alert-danger\" role=\"alert\">\n        密码应含6至40个字节\n      </div>\n    );\n  }\n};\n\n\nexport default class Register extends Component {\n  constructor(props) {\n    super(props);\n    this.handleRegister = this.handleRegister.bind(this);\n    this.createContactOnly = this.createContactOnly.bind(this);\n    this.updateUser = this.updateUser.bind(this);\n    this.updateContactOnly = this.updateContactOnly.bind(this);\n    this.getUser = this.getUser.bind(this);\n\n    this.onChangeTitle = this.onChangeTitle.bind(this);\n    this.onChangeUsername = this.onChangeUsername.bind(this);\n    this.onChangeEmail = this.onChangeEmail.bind(this);\n    this.onChangePassword = this.onChangePassword.bind(this);\n    this.onChangeRoles = this.onChangeRoles.bind(this);\n    this.onChangeSchoolId = this.onChangeSchoolId.bind(this);\n    this.onChangeChineseName = this.onChangeChineseName.bind(this);\n    this.onChangePhone = this.onChangePhone.bind(this);\n    this.onChangeWechat = this.onChangeWechat.bind(this);\n    this.onChangeStartAt = this.onChangeStartAt.bind(this);\n    this.onChangeContactOnly = this.onChangeContactOnly.bind(this);\n\n    this.state = {\n      id: null,\n      username: \"\",\n      email: \"\",\n      password: null,\n      roles: null,\n      schoolId: null,\n      chineseName: \"\",\n      phone: \"\",\n      wechat: \"\",\n      startAt: null,\n      createdAt: null,\n      lastLogin: null,\n      title: \"\",\n      newuser: true,\n\n      contactOnly: false,\n\n      titles: [],\n      schools: [],\n      rolesFull: [],\n      successful: false,\n      message: \"\",\n      readonly: true\n    };\n  }\n\n  componentDidMount() {\n    this.setState({readonly: window.location.pathname.includes('View')});\n\n    if (this.props.match && this.props.match.params.id) {\n      this.setState({newuser: false});\n      this.getUser(this.props.match.params.id);\n    }\n\n    const qString = queryString.parse(this.props.location.search);\n    if (qString && qString.schoolId)\n      this.setState({schoolId: qString.schoolId, contactOnly: true});\n\n    this.getRoles();\n    this.getSchools();\n    this.getTitles();\n\n  }\n\n\n  updateContactOnly() {\n    this.setState({\n      message: \"\",\n      successful: false\n    });\n\n    var data = {\n        email: this.state.email,\n        roles: this.state.roles,\n        schoolId: this.state.schoolId,\n        chineseName: this.state.chineseName,\n        phone: this.state.phone,\n        wechat: this.state.wechat,\n        title: this.state.title,\n        contactOnly: this.state.contactOnly\n    };\n\n    AuthService.updateContactOnly(\n      this.state.id,\n      data\n    )\n      .then(response => {\n        console.log(response.data);\n        this.setState({\n          message: \"用户信息成功更新!\",\n          successful: true\n        });\n      })\n      .catch(e => {\n        this.setState({\n          message: \"用户信息修改失败：\" + e,\n          successful: false\n        });\n        console.log(e);\n      });\n  }\n\n  updateUser(e) {\n    e.preventDefault();\n\n    if(this.state.contactOnly) return this.updateContactOnly();\n\n    this.setState({\n      message: \"\",\n      successful: false\n    });\n\n    if (!this.validateSchool()) return;\n\n    this.form.validateAll();\n    if (this.checkBtn.context._errors.length !== 0)\n        return;\n\n    var data = {\n      username: this.state.username,\n      email: this.state.email,\n      //password: this.state.password,\n      roles: this.state.roles,\n      schoolId: this.state.schoolId,\n      chineseName: this.state.chineseName,\n      phone: this.state.phone,\n      wechat: this.state.wechat,\n      startAt: this.state.startAt,\n      title: this.state.title\n    };\n\n    AuthService.update(\n      this.state.id,\n      data\n    )\n      .then(response => {\n        console.log(response.data);\n        this.setState({\n          message: \"用户信息成功更新!\",\n          successful: true\n        });\n      })\n      .catch(e => {\n        this.setState({\n          message: \"用户信息修改失败：\" + e,\n          successful: false\n        });\n        console.log(e);\n      });\n  }\n\n  getRoleNames(roles) {\n      const names = [];\n      if (roles) {\n        for (let i = 0; i < roles.length; i++){\n          names.push(roles[i].name);\n        }\n      }\n      return names;\n  }\n\n  getUser(id) {\n    AuthService.get(id)\n      .then(response => {\n        this.setState({\n          id: response.data.id,\n          username: response.data.username,\n          email: response.data.email,\n          //password: response.data.password,\n          roles: this.getRoleNames(response.data.roles),\n          schoolId: response.data.schoolId,\n          chineseName: response.data.chineseName,\n          phone: response.data.phone,\n          wechat: response.data.wechat,\n          startAt: response.data.startAt,\n          createdAt: response.data.createdAt,\n          lastLogin: response.data.lastLogin,\n          title: response.data.title,\n\n          contactOnly: response.data.contactOnly,\n\n          //newuser: false\n        });\n        console.log(response.data);\n      })\n      .catch(e => {\n        console.log(e);\n      });\n  }\n\n  getRoles() {\n    AuthService.getRoles()\n      .then(response => {\n        this.setState({\n          rolesFull: response.data\n        });\n        console.log(response);\n      })\n      .catch(e => {\n        console.log(e);\n      });\n  }\n\n  convert(schools) {\n    const result = [];\n    if (schools) {\n    for (var i = 0; i < schools.length; i++) {\n      result.push({value: schools[i].id,\n        label: schools[i].code + \"-\" + schools[i].name + \"-\" + schools[i].region});\n    }\n    return result;\n    }\n  }\n\n  display(schoolId) {\n    if (this.state.schools) {\n      for (var i = 0; i < this.state.schools.length; i++) {\n        if (this.state.schools[i].value == schoolId)\n          return this.state.schools[i];\n      }\n      return [];\n    }\n  }\n\n  displayName(schoolId) {\n    if (this.state.schools) {\n      for (var i = 0; i < this.state.schools.length; i++) {\n        if (this.state.schools[i].value == schoolId)\n          return this.state.schools[i].label ? this.state.schools[i].label : '学校名';\n      }\n      return '';\n    }\n  }\n\n  getSchools() {\n    SchoolDataService.getAllSimple()\n      .then(response => {\n        this.setState({\n          schools: this.convert(response.data)\n        });\n        console.log(response);\n      })\n      .catch(e => {\n        console.log(e);\n      });\n  }\n\n  getTitles() {\n    AuthService.getUserTitles()\n      .then(response => {\n        this.setState({\n          titles: response.data\n        });\n        console.log(response);\n      })\n      .catch(e => {\n        console.log(e);\n      });\n  }\n\n  onChangeRoles(event) {\n    const selected = [...event.target.selectedOptions].map(opt => opt.value);\n    this.setState({\n      roles: selected\n    });\n  }\n\n  onChangeContactOnly(e) {\n    this.setState({\n      contactOnly: e.target.checked\n    });\n  }\n\n  onChangeChineseName(e) {\n    this.setState({\n      chineseName: e.target.value\n    });\n  }\n\n  onChangeTitle(e) {\n    this.setState({\n      title: e.target.value\n    });\n  }\n\n  onChangePhone(e) {\n    this.setState({\n      phone: e.target.value\n    });\n  }\n\n  onChangeWechat(e) {\n    this.setState({\n      wechat: e.target.value\n    });\n  }\n\n  onChangeStartAt(e) {\n    this.setState({\n      startAt: e.target.value\n    });\n  }\n\n  onChangeUsername(e) {\n    this.setState({\n      username: e.target.value\n    });\n  }\n\n  onChangeSchoolId(e) {\n    this.setState({\n      schoolId: e.value //.target.value\n    });\n  }\n\n  onChangeEmail(e) {\n    this.setState({\n      email: e.target.value\n    });\n  }\n\n  onChangePassword(e) {\n    this.setState({\n      password: e.target.value\n    });\n  }\n\n  getRelevantRoles(isSchoolUser) {\n    let schoolRoles = [];\n    let ssRoles = [];\n\n    if (!this.state.rolesFull) return [];\n\n    for (var i = 0; i < this.state.rolesFull.length; i++)\n      if (this.state.rolesFull[i].name === 'user')\n        schoolRoles.push(this.state.rolesFull[i]);\n      else\n        ssRoles.push(this.state.rolesFull[i]);\n\n    if (isSchoolUser)\n      return schoolRoles;\n    else\n      return ssRoles;\n  }\n\n  createContactOnly() {\n\n      AuthService.createContactOnly({\n        email: this.state.email,\n        roles: this.state.roles,\n        schoolId: this.state.schoolId,\n        chineseName: this.state.chineseName,\n        phone: this.state.phone,\n        wechat: this.state.wechat,\n        title: this.state.title,\n        contactOnly: this.state.contactOnly\n      }).then(\n        response => {\n          this.setState({\n            message: response.data.message,\n            successful: true\n          });\n        },\n        error => {\n          const resMessage =\n            (error.response &&\n              error.response.data &&\n              error.response.data.message) ||\n            error.message ||\n            error.toString();\n\n          this.setState({\n            successful: false,\n            message: '创建用户异常，' + resMessage\n          });\n        }\n      );\n  }\n\n  validateSchool() {\n    const user = AuthService.getCurrentUser(); //localStorage.getItem('user');\n\n    if ((!user && !this.state.schoolId) ||\n        (user && user.schoolId && !this.state.schoolId)) {\n      this.setState({\n        message: \"请选择学校\",\n        successful: false\n      });\n      return false;\n    }\n\n    return true;\n  }\n\n  async validatePrincipal() {\n    if (AuthService.getCurrentUser() || !this.state.schoolId) return true;\n\n    try {\n      let response = await SchoolDataService.getPrincipal(this.state.schoolId);\n\n      let principal = prompt(\"请输入校长姓名\", \"\");\n\n      console.log(response);\n      console.log('user input principal: ' + principal);\n      console.log('db retrieved principal: ' + response.data.principal);\n\n      if (!principal) return false;\n\n      if (principal === response.data.principal)\n        return true;\n      else {\n        alert('校长姓名输入有误！');\n        return false;\n      }\n    } catch(e) {\n      alert(e.message);\n    }\n    return false;\n  }\n\n  async handleRegister(e) {\n    e.preventDefault();\n\n    if (this.state.contactOnly) return this.createContactOnly();\n\n    this.setState({\n      message: \"\",\n      successful: false\n    });\n\n    if (!this.state.password) {\n      this.setState({\n        message: '密码是必填项。。。'\n      });\n      return;\n    }\n\n    if (!this.validateSchool()) return;\n    let vp = await this.validatePrincipal();\n    if (!vp) return;\n\n    this.form.validateAll();\n\n    if (this.checkBtn.context._errors.length === 0) {\n\n      AuthService.register(\n        this.state.username,\n        this.state.email,\n        this.state.password,\n        this.state.roles,\n        this.state.schoolId,\n        this.state.chineseName,\n        this.state.phone,\n        this.state.wechat,\n        this.state.startAt,\n        this.state.title\n      ).then(\n        response => {\n          this.emailVerification();\n\n          this.setState({\n            message: response.data.message,\n            successful: true\n          });\n        },\n        error => {\n          const resMessage =\n            (error.response &&\n              error.response.data &&\n              error.response.data.message) ||\n            error.message ||\n            error.toString();\n\n          this.setState({\n            successful: false,\n            message: resMessage\n          });\n        }\n      );\n    }\n  }\n\n  emailVerification() {\n    if (this.state.email) {\n      var token = jwt.sign({ email: this.state.email }, \"config.secret\", {\n        expiresIn: 900 // 15 minutes\n      });\n\n      const url = window.location.host;\n      var templateParams = {\n            to: this.state.email,\n            username: this.state.chineseName ?this.state.chineseName : this.state.username,\n            link: url + \"/login?token=\" + token\n            //link: \"http://localhost:8081/login?token=\" + token\n      };\n\n      emailjs.send(\"icloud_2021_12_27\",\"template_vye2wfs\", templateParams)\n      .then((result) => {\n        console.log(result.text);\n        this.setState({\n          message: \"注册确认邮件已发至您的邮箱 。。。\",\n          successful: true\n        });\n      }, (error) => {\n        console.log(error.text);\n        this.setState({\n          message: error.text,\n          successful: false\n        });\n      });\n    }\n  }\n\n  render() {\n\n    return (\n      <div>\n{/*}\n        <div className=\"card card-container\">\n*/}\n          <Form\n            onSubmit={this.state.newuser ? this.handleRegister : this.updateUser}\n            ref={c => {\n              this.form = c;\n            }}\n          >\n          {!this.state.successful && (\n            <div class=\"row\">\n{/*}\n                <div class=\"form-group col-sm-4\">\n                  <label htmlFor=\"contactOnly\"><h5>仅联络方式(信息不作校验)</h5></label>\n                  <Input\n                    readonly={!this.state.newuser?\"\":false}\n                    type=\"checkbox\"\n                    class=\"form-control\"\n                    name=\"contactOnly\"\n                    checked={this.state.contactOnly}\n                    onChange={this.onChangeContactOnly}\n                  />\n                </div>\n\n                <div class=\"w-100\"></div>\n*/}\n                <div class=\"form-group col-sm-4\" hidden={this.state.contactOnly}>\n                  <label htmlFor=\"username\">用户名</label>\n                  <Input\n                    readonly={!this.state.newuser?\"\":false}\n                    type=\"text\"\n                    class=\"form-control\"\n                    name=\"username\"\n                    value={this.state.username}\n                    onChange={this.onChangeUsername}\n                    validations={[required, vusername]}\n                  />\n                </div>\n\n                <div class=\"form-group col-sm-4\">\n                  <label htmlFor=\"email\">电子邮箱</label>\n                  <Input\n                    readonly={!this.state.newuser?\"\":false}\n                    type=\"text\"\n                    class=\"form-control\"\n                    name=\"email\"\n                    value={this.state.email}\n                    onChange={this.onChangeEmail}\n                    validations={[required, email]}\n                  />\n                </div>\n\n\n                <div class=\"form-group col-sm-4\" hidden={this.state.contactOnly || !this.state.newuser}>\n                  <label htmlFor=\"password\">密码</label>\n                  <Input\n                    readonly={this.state.readonly?\"\":false}\n                    type=\"password\"\n                    class=\"form-control\"\n                    name=\"password\"\n                    value={this.state.password}\n                    onChange={this.onChangePassword}\n                    validations={[vpassword]}\n                  />\n                </div>\n\n                <div class=\"form-group col-sm-4\">\n                  <label htmlFor=\"chineseName\">中文名</label>\n                  <Input\n                    readonly={this.state.readonly?\"\":false}\n                    type=\"text\"\n                    class=\"form-control\"\n                    required\n                    name=\"chineseName\"\n                    value={this.state.chineseName}\n                    onChange={this.onChangeChineseName}\n                  />\n                </div>\n\n                <div class=\"form-group col-sm-4\">\n                  <label htmlFor=\"phone\">电话</label>\n                  <Input\n                    readonly={this.state.readonly?\"\":false}\n                    type=\"text\"\n                    class=\"form-control\"\n                    name=\"phone\"\n                    value={this.state.phone}\n                    onChange={this.onChangePhone}\n                  />\n                </div>\n\n                <div class=\"form-group col-sm-4\">\n                  <label htmlFor=\"wechat\">微信</label>\n                  <Input\n                    readonly={this.state.readonly?\"\":false}\n                    type=\"text\"\n                    class=\"form-control\"\n                    name=\"wechat\"\n                    value={this.state.wechat}\n                    onChange={this.onChangeWechat}\n                  />\n                </div>\n{/*\n                <div class=\"form-group col-sm-4\">\n                  <label htmlFor=\"startAt\">加入时间</label>\n                  <Input\n                    readonly={this.state.readonly?\"\":false}\n                    type=\"date\"\n                    class=\"form-control\"\n                    name=\"startAt\"\n                    value={this.state.startAt}\n                    onChange={this.onChangeStartAt}\n                  />\n                </div>\n*/}\n                <div class=\"form-group col-sm-4\" hidden={!this.state.schoolId}>\n                  <label htmlFor=\"title\">职务</label>\n                  <select onChange={this.onChangeTitle.bind(this)}\n                    readonly={this.state.readonly?\"\":false}\n                    class=\"form-control\"\n                    id=\"title\"\n                    value={this.state.title}\n                    name=\"title\"\n                >\n                    <option value=\"\">{this.state.readonly ? '' : '请选择' }</option>\n                    {this.state.titles.map((option) => (\n                      <option value={option}>{option}</option>\n                    ))}\n                  </select>\n                </div>\n\n                {AuthService.getCurrentUser() &&\n                (<div class=\"form-group col-sm-4\" hidden={this.state.contactOnly}>\n                  <label htmlFor=\"roles\">角色</label>\n                  <select onChange={this.onChangeRoles.bind(this)}\n                    disabled={this.state.readonly || !AuthService.getCurrentUser().roles.includes(\"ROLE_ADMIN\")\n                               ? \"disabled\"\n                               : false\n                             }\n                    class=\"form-control\"\n                    id=\"roles\"\n                    value={this.state.roles}\n                    name=\"roles\"\n                >\n                    {//this.state.rolesFull.map((option) => (\n                      this.getRelevantRoles(this.state.schoolId).map((option) => (\n                      <option value={option.name}>{option.label}</option>\n                    ))}\n                  </select>\n                </div>)}\n\n                <div class=\"form-group col-sm-4\"\n                  hidden={!(\n                    this.state.newuser || this.state.schoolId ||\n                    (AuthService.getCurrentUser() && AuthService.getCurrentUser().roles.includes(\"ROLE_ADMIN\"))\n                  )}\n                >\n                  <label htmlFor=\"schoolId\">所属学校</label>\n                  {this.state.newuser ||\n                  (!this.state.readonly && AuthService.getCurrentUser() &&\n                  AuthService.getCurrentUser().roles.includes(\"ROLE_ADMIN\"))\n                  ? (<Select onChange={this.onChangeSchoolId.bind(this)}\n                    class=\"form-control\"\n                    id=\"schoolId\"\n                    value={this.display(this.state.schoolId)}\n                    name=\"schoolId\"\n                    options={this.state.schools}\n                  />)\n                  : (<Link\n                    to={ \"/schoolsView/\" + this.state.schoolId}\n                    id=\"schoolId\"\n                    name=\"schoolId\"\n                  >\n                    {this.displayName(this.state.schoolId)}\n                  </Link>)}\n                </div>\n\n\n                <div class=\"form-group col-sm-4\" hidden={this.state.newuser}>\n                  <label htmlFor=\"lastLogin\">上次登录时间</label>\n                  <Input\n                    readonly={\"\"}\n                    type=\"date\"\n                    class=\"form-control\"\n                    name=\"lastLogin\"\n                    value={this.state.lastLogin}\n                  />\n                </div>\n\n                <div class=\"form-group col-sm-4\" hidden={this.state.newuser}>\n                  <label htmlFor=\"createdAt\">创建时间</label>\n                  <Input\n                    readonly={\"\"}\n                    type=\"date\"\n                    class=\"form-control\"\n                    name=\"createdAt\"\n                    value={this.state.createdAt}\n                  />\n                </div>\n\n                <div class=\"w-100\"></div>\n\n                {this.state.readonly ? '' : (\n                <div class=\"form-group\">\n                  <button className=\"btn btn-primary btn-block\">{this.state.newuser?'创建新用户':'修改用户'}</button>\n                </div>\n                )}\n\n                <div class=\"w-100\"></div>\n\n                {!this.state.readonly && !this.state.newuser &&\n                  <Link\n                    to={'/reset?token=' +\n                      jwt.sign({ email: this.state.email }, \"config.secret\", {\n                        expiresIn: 900 // 15 minutes\n                      })\n                    }\n                    className=\"btn btn-primary\">\n                      重置密码\n                  </Link>\n                }\n\n            </div>\n          )}\n\n            {this.state.message && (\n              <div class=\"form-group\">\n                <div\n                  className={\n                    this.state.successful\n                      ? \"alert alert-success\"\n                      : \"alert alert-danger\"\n                  }\n                  role=\"alert\"\n                >\n                  {this.state.message}\n                </div>\n              </div>\n            )}\n            <CheckButton\n              style={{ display: \"none\" }}\n              ref={c => {\n                this.checkBtn = c;\n              }}\n            />\n\n          </Form>\n{/*}\n        </div>\n*/}\n      </div>\n    );\n  }\n}\n","import axios from 'axios';\nimport authHeader from './auth-header';\n\nconst API_URL = '/api/test/';\n//const API_URL = 'http://localhost:8080/api/test/';\n\nclass UserService {\n  getPublicContent() {\n    return axios.get(API_URL + 'all');\n  }\n\n  getUserBoard() {\n    return axios.get(API_URL + 'user', { headers: authHeader() });\n  }\n\n  getModeratorBoard() {\n    return axios.get(API_URL + 'mod', { headers: authHeader() });\n  }\n\n  getAdminBoard() {\n    return axios.get(API_URL + 'admin', { headers: authHeader() });\n  }\n}\n\nexport default new UserService();\n","import React, { Component } from \"react\";\nimport AuthService from \"../services/auth.service\";\n\nexport default class Profile extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      currentUser: AuthService.getCurrentUser()\n    };\n  }\n\n  render() {\n    const { currentUser } = this.state;\n\n    return (\n      <div className=\"container\">\n        <header className=\"jumbotron\">\n          <h3>\n            <strong>{currentUser.username}</strong> Profile\n          </h3>\n        </header>\n        <p>\n          <strong>Token:</strong>{\" \"}\n          {currentUser.accessToken.substring(0, 20)} ...{\" \"}\n          {currentUser.accessToken.substr(currentUser.accessToken.length - 20)}\n        </p>\n        <p>\n          <strong>Id:</strong>{\" \"}\n          {currentUser.id}\n        </p>\n        <p>\n          <strong>Email:</strong>{\" \"}\n          {currentUser.email}\n        </p>\n        <strong>Authorities:</strong>\n        <ul>\n          {currentUser.roles &&\n            currentUser.roles.map((role, index) => <li key={index}>{role}</li>)}\n        </ul>\n      </div>\n    );\n  }\n}\n","import React, { Component } from \"react\";\n\nimport UserService from \"../services/user.service\";\n\nexport default class Home extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      content: \"\"\n    };\n  }\n\n  componentDidMount() {\n    UserService.getPublicContent().then(\n      response => {\n        this.setState({\n          content: response.data\n        });\n      },\n      error => {\n        this.setState({\n          content:\n            (error.response && error.response.data) ||\n            error.message ||\n            error.toString()\n        });\n      }\n    );\n  }\n\n  render() {\n    return (\n      <div className=\"container\">\n        <header className=\"jumbotron\">\n          <h3>{this.state.content}</h3>\n        </header>\n      </div>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport { Switch, Route, Link, Redirect, withRouter } from \"react-router-dom\";\nimport \"bootstrap/dist/css/bootstrap.min.css\";\nimport 'bootstrap/dist/js/bootstrap.min.js'\nimport \"@fortawesome/fontawesome-free/css/all.css\";\nimport \"@fortawesome/fontawesome-free/js/all.js\";\n\nimport \"./App.css\";\n\nimport logo from './shinshin-logo.png';\n\n//import AddTutorial from \"./components/add-tutorial.component\";\n//import Tutorial from \"./components/tutorial.component\";\n//import TutorialsList from \"./components/tutorials-list.component\";\n\n//import AddSchool from \"./components/add-school.component\";\nimport Survey from \"./components/survey.component\";\nimport SurveysList from \"./components/surveys-list.component\";\n\nimport School from \"./components/school.component\";\nimport SchoolsList from \"./components/schools-list.component\";\nimport DocumentsList from \"./components/documents-list.component\";\nimport RegionsList from \"./components/regions-list.component\";\nimport CommentsList from \"./components/comments-list.component\";\nimport LogsList from \"./components/logs-list.component\";\n\nimport Project from \"./components/project.component\";\nimport ProjectsList from \"./components/projects-list.component\";\nimport DossiersList from \"./components/dossiers-list.component\";\n\n//import AddForm from \"./components/add-form.component\";\nimport Form from \"./components/form.component\";\nimport FormsList from \"./components/forms-list.component\";\n\n//import AddResponse from \"./components/add-response.component\";\nimport Response from \"./components/response.component\";\nimport ResponsesList from \"./components/responses-list.component\";\n\n//import AddAttachment from \"./components/add-attachment.component\";\n//import Attachment from \"./components/attachment.component\";\nimport AttachmentsList from \"./components/attachments-list.component\";\n\nimport UsersList from \"./components/users-list.component\";\n\nimport AuthService from \"./services/auth.service\";\nimport AccessControlService from \"./services/timer.service\";\n\nimport Reset from \"./components/reset.component\";\nimport Login from \"./components/login.component\";\nimport Register from \"./components/register.component\";\nimport Home from \"./components/home.component\";\nimport Profile from \"./components/profile.component\";\n//import BoardUser from \"./components/board-user.component\";\n//import BoardModerator from \"./components/board-moderator.component\";\n//import BoardAdmin from \"./components/board-admin.component\";\n\nconst jwt = require(\"jsonwebtoken\");\n\nclass App extends Component {\n  constructor(props) {\n    super(props);\n    this.logOut = this.logOut.bind(this);\n\n    this.state = {\n      showModeratorBoard: false,\n      showAdminBoard: false,\n      currentUser: undefined,\n    };\n  }\n\n  componentDidMount() {\n    const user = AuthService.getCurrentUser();\n\n    if (user) {\n      this.setState({\n        currentUser: user,\n        showModeratorBoard: user.roles.includes(\"ROLE_MODERATOR\"),\n        showAdminBoard: user.roles.includes(\"ROLE_ADMIN\"),\n      });\n    }\n  }\n\n  logOut() {\n    AuthService.logout();\n    this.props.history.push('/login');\n    window.location.reload();\n  }\n\n  render() {\n    const { currentUser, showModeratorBoard, showAdminBoard } = this.state;\n\n    return (\n      <div>\n        <div class=\"mb-3\">\n          <img src={logo} alt=\"\" height=\"60\" width=\"370\" class=\"responsive\" />\n        </div>\n\n\n{/*\n        <nav class=\"navbar navbar-expand-sm navbar-dark bg-dark\">\n*/}\n        <nav class=\"navbar navbar-expand-sm navbar-dark navbar-custom\">\n          <Link to={\"/\"} class=\"navbar-brand\">\n            学校项目管理系统\n          </Link>\n\n          <button class=\"navbar-toggler\" type=\"button\" data-toggle=\"collapse\" data-target=\"#navbarSupportedContent\"\n            aria-controls=\"navbarSupportedContent\" aria-expanded=\"false\" aria-label=\"Toggle navigation\">\n            <span class=\"navbar-toggler-icon\">\n            </span>\n          </button>\n\n          <div class=\"collapse navbar-collapse navbar-nav mr-auto\" id=\"navbarSupportedContent\">\n\n            {(currentUser && !currentUser.schoolId && showAdminBoard) && (\n            <li class=\"nav-item dropdown\">\n              <a class=\"nav-link dropdown-toggle\" href=\"#\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n                管理\n              </a>\n              <div class=\"dropdown-menu\" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href={\"/users\"}>用户列表</a>\n                <a class=\"dropdown-item\" href={\"/addU\"}>创建用户</a>\n              </div>\n            </li>)}\n\n            {(!currentUser || (currentUser && !currentUser.schoolId)) && (\n            <li class=\"nav-item dropdown\">\n              <a class=\"nav-link dropdown-toggle\" href=\"#\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n                学校\n              </a>\n              <div class=\"dropdown-menu\" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href={\"/schools\"}>学校列表</a>\n                <a class=\"dropdown-item\" href={\"/regions\"}>地区列表</a>\n                <a class=\"dropdown-item\" href={\"/addS\"}>新增学校</a>\n                <a class=\"dropdown-item\" href={\"/addSurvey\"}>新增调查表</a>\n                <div class=\"dropdown-divider\"></div>\n                <a class=\"dropdown-item\" href={\"/documents\"}>学校文档</a>\n                <a class=\"dropdown-item\" href={\"/comments\"}>留言</a>\n                <a class=\"dropdown-item\" href={\"/logs\"}>修改记录</a>\n                <a class=\"dropdown-item\" href={\"/surveys\"}>调查表列表</a>\n              </div>\n            </li>)}\n\n            {(!currentUser || (currentUser && !currentUser.schoolId)) && (\n            <li class=\"nav-item dropdown\">\n              <a class=\"nav-link dropdown-toggle\" href=\"#\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n                项目\n              </a>\n              <div class=\"dropdown-menu\" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href={\"/projects\"}>项目列表</a>\n                <a class=\"dropdown-item\" href={\"/addP\"}>新增项目</a>\n                <div class=\"dropdown-divider\"></div>\n                <a class=\"dropdown-item\" href={\"/projectsXR\"}>向荣支持项目列表</a>\n                <a class=\"dropdown-item\" href={\"/addPXR\"}>新增向荣支持项目</a>\n                <div class=\"dropdown-divider\"></div>\n                <a class=\"dropdown-item\" href={\"/dossiers\"}>项目文档</a>\n              </div>\n            </li>)}\n\n            {(currentUser && !currentUser.schoolId) && (\n            <li class=\"nav-item dropdown\">\n              <a class=\"nav-link dropdown-toggle\" href=\"#\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n                项目申请\n              </a>\n              <div class=\"dropdown-menu\" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href={\"/responses\"}>项目申请列表</a>\n                <a class=\"dropdown-item\" href={\"/forms\"}>项目征集列表</a>\n                <a class=\"dropdown-item\" href={\"/addF\"}>新增项目征集</a>\n                <div class=\"dropdown-divider\"></div>\n                <a class=\"dropdown-item\" href={\"/attachments\"}>项目申请附件</a>\n              </div>\n            </li>)}\n\n          </div>\n\n          {currentUser ? (\n            <div class=\"navbar-nav ml-auto\">\n\n            <li class=\"nav-item dropdown\">\n              <a class=\"nav-link dropdown-toggle\" href=\"#\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n\n                {currentUser.lastLogin\n                  ? <span title={\"上次登录时间: \" + currentUser.lastLogin}>\n                    我的欣欣({currentUser.chineseName ? currentUser.chineseName : currentUser.username})\n                    </span>\n                  : <span> 我的欣欣({currentUser.chineseName ? currentUser.chineseName : currentUser.username}) </span>\n                }\n              </a>\n              <div class=\"dropdown-menu\" aria-labelledby=\"navbarDropdown\">\n                <a class=\"dropdown-item\" href={\"/users/\" + currentUser.id}>\n                  个人信息\n                </a>\n\n                <a class=\"dropdown-item\"\n                  href={'/reset?token=' +\n                    jwt.sign({ email: currentUser.email }, \"config.secret\", {\n                      expiresIn: 900 // 15 minutes\n                    })\n                  }\n                >\n                  重置密码\n                </a>\n\n                {currentUser.schoolId\n                  ? <a class=\"dropdown-item\" href={\"/schoolsView/\" + currentUser.schoolId}>我的学校</a>\n                  : ''\n                }\n                <a class=\"dropdown-item\" href={\"/responses/user/\" + currentUser.id}>我的项目申请</a>\n{/*}\n                <a class=\"dropdown-item\" href={\"/login\"} onClick={this.logOut}>退出</a>\n*/}\n              </div>\n            </li>\n\n            <li class=\"nav-item\">\n              <a href=\"#\" class=\"nav-link\" onClick={this.logOut}>\n                退出\n              </a>\n            </li>\n{/*}\n              <li class=\"nav-item\">\n                <Link to={\"/profile\"} class=\"nav-link\">\n                  {currentUser.username}\n                </Link>\n              </li>\n*/}\n            </div>\n          ) : (\n            <div class=\"navbar-nav ml-auto\">\n              <li class=\"nav-item\">\n                <Link to={\"/login\"} class=\"nav-link\">\n                  登录\n                </Link>\n              </li>\n\n              <li class=\"nav-item\">\n                <Link to={\"/register\"} class=\"nav-link\">\n                  注册\n                </Link>\n              </li>\n            </div>\n          )}\n        </nav>\n\n        <div class=\"container mt-3\">\n          <Switch>\n          {/*}\n            <Route exact path={[\"/\", \"/home\"]} component={Home} />\n          */}\n            <Route exact path={[\"/reset\"]} component={Reset} />\n            <Route exact path={[\"/login\", \"/\", \"/home\"]} component={Login} />\n            <Route exact path=\"/register\" component={Register} />\n            <Route exact path=\"/profile\" component={Profile} />\n\n{/*\n            <Route exact path={[\"/schools\"]} component={SchoolsList} />\n            <Route path={[\"/schoolsView/:id\"]} component={School} />\n\n            <Route exact path={[\"/projects\", \"/projects/school/:schoolId\"]} component={ProjectsList} />\n            <Route path={[\"/projectsView/:id\"]} component={Project} />\n\n            <Route path=\"/user\" component={BoardUser} />\n            <Route path=\"/mod\" component={BoardModerator} />\n            <Route path=\"/admin\" component={BoardAdmin} />\n            <Route exact path={[\"/\", \"/tutorials\"]} component={TutorialsList} />\n            <Route exact path=\"/add\" component={AddTutorial} />\n            <Route path=\"/tutorials/:id\" component={Tutorial} />\n*/}\n\n\n            <Route exact path={[\"/regions\"]} component={RegionsList} >\n                <AccessControlService ComposedClass={RegionsList} />\n            </Route>\n            <Route exact path={[\"/schools\", \"/schools/region/:region\"]} >\n                <AccessControlService ComposedClass={SchoolsList} />\n            </Route>\n            <Route path={[\"/schoolsView/:id\", \"/schools/:id\", \"/addS\"]} component={School} >\n                <AccessControlService ComposedClass={School} />\n            </Route>\n\n            <Route path={[\"/surveys/:id\", \"/surveysView/:id\", \"/addSurvey\", \"/surveys/school/:schoolId\"]} component={Survey} >\n                <AccessControlService ComposedClass={Survey} />\n            </Route>\n            <Route exact path={[\"/surveys\"]} component={SurveysList} >\n                <AccessControlService ComposedClass={SurveysList} />\n            </Route>\n\n            <Route exact path={[\"/documents\", \"/documents/school/:schoolId\",\n                            \"/documents/school/:schoolId/:docCategory\"]} component={DocumentsList} >\n                <AccessControlService ComposedClass={DocumentsList} />\n            </Route>\n\n            <Route exact path={[\"/comments\", \"/comments/school/:schoolId\"]} component={CommentsList} >\n                <AccessControlService ComposedClass={CommentsList} />\n            </Route>\n\n            <Route exact path={[\"/logs\", \"/logs/school/:schoolId\"]} component={LogsList} >\n                <AccessControlService ComposedClass={LogsList} />\n            </Route>\n\n            <Route exact path={[\"/projects\", \"/projects/school/:schoolId\", \"/projectsXR\", \"/projectsXR/school/:schoolId\"]}\n                component={ProjectsList} >\n                <AccessControlService ComposedClass={ProjectsList} />\n            </Route>\n            <Route path={[\"/projectsView/:id\", \"/projects/:id\", \"/addP\", \"/projectsViewXR/:id\", \"/projectsXR/:id\", \"/addPXR\"]}\n                component={Project} >\n                <AccessControlService ComposedClass={Project} />\n            </Route>\n\n            <Route exact path={[\"/dossiers\", \"/dossiers/project/:projectId\",\n                                            \"/dossiers/project/:projectId/:docCategory\"]} component={DossiersList} >\n                <AccessControlService ComposedClass={DossiersList} />\n            </Route>\n\n            <Route exact path={[\"/forms\"]} component={FormsList} >\n                <AccessControlService ComposedClass={FormsList} />\n            </Route>\n\n            {/*\n            <Route exact path=\"/addF\" component={AddForm} />\n            */}\n            <Route path={[\"/forms/:id\", \"/formsView/:id\", \"/addF\"]} component={Form} >\n                <AccessControlService ComposedClass={Form} />\n            </Route>\n\n            <Route exact path={[\"/responses\", \"/responses/form/:formId\", \"/responses/school/:schoolId\",\n                                \"/responses/user/:userId\"]} component={ResponsesList} >\n                <AccessControlService ComposedClass={ResponsesList} />\n            </Route>\n\n            {/*}\n            <Route path=\"/addR/:id\" component={AddResponse} />\n            */}\n            <Route path={[\"/responses/:id\", \"/responsesView/:id\", \"/addR/:id\"]} component={Response} >\n                <AccessControlService ComposedClass={Response} />\n            </Route>\n\n            <Route exact path={[\"/attachments\", \"/attachments/response/:responseId\"]} component={AttachmentsList} >\n                <AccessControlService ComposedClass={AttachmentsList} />\n            </Route>\n\n            {/*}\n            <Route path=\"/addA/:id\" component={AddAttachment} />\n            <Route path=\"/attachments/:id\" component={Attachment} />\n            */}\n\n            <Route exact path={[\"/users\", \"/users/school/:schoolId\"]} component={UsersList} >\n                <AccessControlService ComposedClass={UsersList} />\n            </Route>\n\n            <Route path={[\"/addU\", \"/users/:id\", \"/usersView/:id\"]} component={Register} >\n                <AccessControlService ComposedClass={Register} />\n            </Route>\n\n          </Switch>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default withRouter(App);\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n\nconst isLocalhost = Boolean(\n    window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n        /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n    if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n        // The URL constructor is available in all browsers that support SW.\n        const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n        if (publicUrl.origin !== window.location.origin) {\n            // Our service worker won't work if PUBLIC_URL is on a different origin\n            // from what our page is served on. This might happen if a CDN is used to\n            // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n            return;\n        }\n\n        window.addEventListener('load', () => {\n            const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n            if (isLocalhost) {\n                // This is running on localhost. Let's check if a service worker still exists or not.\n                checkValidServiceWorker(swUrl, config);\n\n                // Add some additional logging to localhost, pointing developers to the\n                // service worker/PWA documentation.\n                navigator.serviceWorker.ready.then(() => {\n                    console.log(\n                        'This web app is being served cache-first by a service '\n                    );\n                });\n            } else {\n                // Is not localhost. Just register service worker\n                registerValidSW(swUrl, config);\n            }\n        });\n    }\n}\n\nfunction registerValidSW(swUrl, config) {\n    navigator.serviceWorker\n        .register(swUrl)\n        .then(registration => {\n            registration.onupdatefound = () => {\n                const installingWorker = registration.installing;\n                if (installingWorker == null) {\n                    return;\n                }\n                installingWorker.onstatechange = () => {\n                    if (installingWorker.state === 'installed') {\n                        if (navigator.serviceWorker.controller) {\n                            // At this point, the updated precached content has been fetched,\n                            // but the previous service worker will still serve the older\n                            // content until all client tabs are closed.\n                            console.log(\n                                'New content is available and will be used when all '\n                            );\n\n                            // Execute callback\n                            if (config && config.onUpdate) {\n                                config.onUpdate(registration);\n                            }\n                        } else {\n                            // At this point, everything has been precached.\n                            // It's the perfect time to display a\n                            // \"Content is cached for offline use.\" message.\n                            console.log('Content is cached for offline use.');\n\n                            // Execute callback\n                            if (config && config.onSuccess) {\n                                config.onSuccess(registration);\n                            }\n                        }\n                    }\n                };\n            };\n        })\n        .catch(error => {\n            console.error('Error during service worker registration:', error);\n        });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n    // Check if the service worker can be found. If it can't reload the page.\n    fetch(swUrl, {\n            headers: {\n                'Service-Worker': 'script'\n            },\n        })\n        .then(response => {\n            // Ensure service worker exists, and that we really are getting a JS file.\n            const contentType = response.headers.get('content-type');\n            if (\n                response.status === 404 ||\n                (contentType != null && contentType.indexOf('javascript') === -1)\n            ) {\n                // No service worker found. Probably a different app. Reload the page.\n                navigator.serviceWorker.ready.then(registration => {\n                    registration.unregister().then(() => {\n                        window.location.reload();\n                    });\n                });\n            } else {\n                // Service worker found. Proceed as normal.\n                registerValidSW(swUrl, config);\n            }\n        })\n        .catch(() => {\n            console.log(\n                'No internet connection found. App is running in offline mode.'\n            );\n        });\n}\n\nexport function unregister() {\n    if ('serviceWorker' in navigator) {\n        navigator.serviceWorker.ready\n            .then(registration => {\n                registration.unregister();\n            })\n            .catch(error => {\n                console.error(error.message);\n            });\n    }\n}","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { BrowserRouter } from \"react-router-dom\";\n\nimport App from \"./App\";\nimport * as serviceWorker from \"./serviceWorker\";\n\nReactDOM.render(\n  <BrowserRouter>\n    <App />\n  </BrowserRouter>,\n  document.getElementById(\"root\")\n);\n\nserviceWorker.unregister();","import http from \"../http-common\";\nimport authHeader from './auth-header';\n\nclass ResponseDataService {\n\n  getAll2(data) {\n    return http.post(\"/responses/all\", data, { headers: authHeader() });\n  }\n\n  getAll(params) {\n    return http.get(\"/responses\", { params }, { headers: authHeader() });\n      /**\n    return http.get(\"/responses\", {\n        params: { params } ,\n        headers: authHeader()\n      }\n    );\n    */\n  }\n\n/**\n  getAll() {\n    return http.get(\"/responses\", { headers: authHeader() });\n  }\n*/\n\n  get(id) {\n    return http.get(`/responses/${id}`, { headers: authHeader() });\n  }\n\n  create(data) {\n    return http.post(\"/responses\", data, { headers: authHeader() });\n  }\n\n  update(id, data) {\n    return http.put(`/responses/${id}`, data, { headers: authHeader() });\n  }\n\n  delete(id) {\n    return http.delete(`/responses/${id}`, { headers: authHeader() });\n  }\n\n  deleteAll() {\n    return http.delete(`/responses`, { headers: authHeader() });\n  }\n\n  findByTitle(title) {\n    return http.get(`/responses?title=${title}`, { headers: authHeader() });\n  }\n\n  uploadAttachments(id, data, onUploadProgress) {\n    const user = JSON.parse(localStorage.getItem('user'));\n    return http.post(`/attachments-upload/${id}`, data, {\n        headers: {\n            'content-type': 'multipart/form-data',\n            'x-access-token':  (user && user.accessToken) ? user.accessToken : null\n            //authHeader()\n        },\n        onUploadProgress,\n    });\n  }\n}\n\nexport default new ResponseDataService();\n","import http from \"../http-common\";\nimport authHeader from './auth-header';\n\nclass DocumentDataService {\n\n  getAll2(data) {\n    return http.post(\"/documents/all\", data, { headers: authHeader() });\n  }\n\n  getAll(params) {\n    return http.get(\"/documents\", { params }, { headers: authHeader() });\n      /**\n    return http.get(\"/documents\", {\n        params: { params } ,\n        headers: authHeader()\n      }\n    );\n    */\n  }\n\n/**\n  getAll() {\n    return http.get(\"/documents\", { headers: authHeader() });\n  }\n*/\n\n  get(id) {\n    return http.get(`/documents/${id}`, { headers: authHeader() });\n  }\n\n  getContent(id) {\n    const user = JSON.parse(localStorage.getItem('user'));\n    return http.get(`/documentsContent/${id}`, {\n        headers: {\n          'x-access-token':  (user && user.accessToken) ? user.accessToken : null\n        },\n        responseType: 'arraybuffer'\n      });\n  }\n\n  getDocCategories() {\n    return http.get(`/documents/categories`, { headers: authHeader() });\n  }\n\n  getCount(id) {\n    return http.get(`/documentsCount/${id}`, { headers: authHeader() });\n  }\n\n  create(data) {\n    return http.post(\"/documents\", data, { headers: authHeader() });\n  }\n\n  update(id, data) {\n    return http.put(`/documents/${id}`, data, { headers: authHeader() });\n  }\n\n  delete(id) {\n    return http.delete(`/documents/${id}`, { headers: authHeader() });\n  }\n\n  deleteAll() {\n    return http.delete(`/documents`, { headers: authHeader() });\n  }\n\n  findByTitle(title) {\n    return http.get(`/documents?title=${title}`, { headers: authHeader() });\n  }\n}\n\nexport default new DocumentDataService();\n","import http from \"../http-common\";\nimport authHeader from './auth-header';\n\nclass AttachmentDataService {\n\n  getAll2(data) {\n    return http.post(\"/attachments/all\", data, { headers: authHeader() });\n  }\n\n  getAll(params) {\n    return http.get(\"/attachments\", { params }, { headers: authHeader() });\n      /**\n    return http.get(\"/attachments\", {\n        params: { params } ,\n        headers: authHeader()\n      }\n    );\n    */\n  }\n\n/**\n  getAll() {\n    return http.get(\"/attachments\", { headers: authHeader() });\n  }\n*/\n\n  get(id) {\n    return http.get(`/attachments/${id}`, { headers: authHeader() });\n  }\n\n  getContent(id) {\n    const user = JSON.parse(localStorage.getItem('user'));\n    return http.get(`/attachmentsContent/${id}`, {\n        headers: {\n          'x-access-token':  (user && user.accessToken) ? user.accessToken : null\n        },\n        responseType: 'arraybuffer'\n      });\n  }\n\n  getCount(id) {\n    return http.get(`/attachmentsCount/${id}`, { headers: authHeader() });\n  }\n\n  create(data) {\n    return http.post(\"/attachments\", data, { headers: authHeader() });\n  }\n\n  update(id, data) {\n    return http.put(`/attachments/${id}`, data, { headers: authHeader() });\n  }\n\n  delete(id) {\n    return http.delete(`/attachments/${id}`, { headers: authHeader() });\n  }\n\n  deleteAll() {\n    return http.delete(`/attachments`, { headers: authHeader() });\n  }\n\n  findByTitle(title) {\n    return http.get(`/attachments?title=${title}`, { headers: authHeader() });\n  }\n}\n\nexport default new AttachmentDataService();\n","import http from \"../http-common\";\nimport authHeader from './auth-header';\n\nclass DossierDataService {\n\n  getAll2(data) {\n    return http.post(\"/dossiers/all\", data, { headers: authHeader() });\n  }\n\n  getAll(params) {\n    return http.get(\"/dossiers\", { params }, { headers: authHeader() });\n      /**\n    return http.get(\"/dossiers\", {\n        params: { params } ,\n        headers: authHeader()\n      }\n    );\n    */\n  }\n\n/**\n  getAll() {\n    return http.get(\"/dossiers\", { headers: authHeader() });\n  }\n*/\n\n  get(id) {\n    return http.get(`/dossiers/${id}`, { headers: authHeader() });\n  }\n\n  getContent(id) {\n    const user = JSON.parse(localStorage.getItem('user'));\n    return http.get(`/dossiersContent/${id}`, {\n        headers: {\n          'x-access-token':  (user && user.accessToken) ? user.accessToken : null\n        },\n        responseType: 'arraybuffer'\n      });\n  }\n\n  getDocCategories() {\n    return http.get(`/dossiers/categories`, { headers: authHeader() });\n  }\n\n  getCount(id) {\n    return http.get(`/dossiersCount/${id}`, { headers: authHeader() });\n  }\n\n  create(data) {\n    return http.post(\"/dossiers\", data, { headers: authHeader() });\n  }\n\n  update(id, data) {\n    return http.put(`/dossiers/${id}`, data, { headers: authHeader() });\n  }\n\n  delete(id) {\n    return http.delete(`/dossiers/${id}`, { headers: authHeader() });\n  }\n\n  deleteAll() {\n    return http.delete(`/dossiers`, { headers: authHeader() });\n  }\n\n  findByTitle(title) {\n    return http.get(`/dossiers?title=${title}`, { headers: authHeader() });\n  }\n}\n\nexport default new DossierDataService();\n","import React, { Component } from \"react\";\nimport ResponseDataService from \"../services/response.service\";\nimport AttachmentDataService from \"../services/attachment.service\";\nimport AuthService from \"../services/auth.service\";\nimport ProjectDataService from \"../services/project.service\";\n\nimport { Link } from \"react-router-dom\";\nimport Pagination from \"@material-ui/lab/Pagination\";\nimport { useState, useEffect, useMemo, useRef } from \"react\";\nimport { useTable, useSortBy } from \"react-table\";\n\nimport YearPicker from 'react-single-year-picker';\n\nconst ResponsesList = (props) => {\n  const [responses, setResponses] = useState([]);\n  const [currentResponse, setCurrentResponse] = useState(null);\n  const [currentIndex, setCurrentIndex] = useState(-1);\n  const [searchTitle, setSearchTitle] = useState(\"\");\n  const [searchCode, setSearchCode] = useState(\"\");\n  const [searchStartAt, setSearchStartAt] = useState(\"\");\n\n  const [formId, setFormId] = useState(props.match? props.match.params.formId : props.formId);\n  const [title, setTitle] = useState(null);\n\n  const [schoolId, setSchoolId] = useState(props.match? props.match.params.schoolId : props.schoolId);\n  const [userId, setUserId] = useState(props.match? props.match.params.userId : props.userId);\n\n  const [orderby, setOrderby] = useState([]);\n\n  const [exportResponses, setExportResponses] = useState([]);\n\n  const [readonly, setReadonly] = useState(props.readonly ? props.readonly : false);\n\n  const [embedded, setEmbedded] = useState(props.embedded ? props.embedded : false);\n\n  const responsesRef = useRef();\n  responsesRef.current = responses;\n\n  const [totalItems, setTotalItems] = useState(0);\n\n  const [page, setPage] = useState(1);\n  const [count, setCount] = useState(0);\n  const [pageSize, setPageSize] = useState(30);\n\n  const pageSizes = [20, 30, 50];\n\n  const onChangeSearchTitle = (e) => {\n    const searchTitle = e.target.value;\n    setSearchTitle(searchTitle);\n  };\n\n  const onChangeSearchCode = (e) => {\n    const searchCode = e.target.value;\n    setSearchCode(searchCode);\n  };\n\n  const onChangeSearchStartAt = (e) => {\n    const searchStartAt = e; // e.target.value;\n    setSearchStartAt(searchStartAt);\n  };\n\n  const onChangeSearchInputStartAt = (e) => {\n    const searchStartAt = e; //e.target.value;\n    setSearchStartAt(searchStartAt);\n  };\n\n  const getRequestParams = (/*searchTitle, page, pageSize, formId, schoolId, userId, orderby*/exportFlag = false) => {\n    //const user = AuthService.getCurrentUser();\n\n    let params = {};\n\n    if (searchTitle) {\n      params[\"title\"] = searchTitle;\n    }\n\n    if (searchCode) {\n      params[\"code\"] = searchCode;\n    }\n\n    if (searchStartAt) {\n      params[\"startAt\"] = searchStartAt;\n    }\n\n    if (page) {\n      params[\"page\"] = page - 1;\n    }\n\n    if (pageSize) {\n      params[\"size\"] = pageSize;\n    }\n\n    if (formId) {\n      params[\"formId\"] = formId;\n    }\n\n    if (schoolId) {\n      params[\"schoolId\"] = schoolId;\n    }\n\n    if (orderby) {\n      params[\"orderby\"] = orderby;\n    }\n\n    if (userId) {\n      params[\"userId\"] = userId;\n    }\n\n    if (exportFlag) {\n      params[\"exportFlag\"] = exportFlag;\n    }\n\n    return params;\n  };\n\n  const onClearSearch = (e) => {\n    setSearchTitle(\"\");\n    setSearchCode(\"\");\n    setSearchStartAt(\"\");\n    setOrderby([]);\n    setExportResponses([]);\n\n    setPage(1);\n  };\n\n  const getAttachmentsCount = async (responseId) => {\n    await AttachmentDataService.getAttachmentsCount(responseId)\n      .then((response) => {\n        console.log(response.data);\n        return response.data;\n      })\n      .catch((e) => {\n        console.log(e);\n      });\n\n    return 0;\n  };\n\n  const getFDataColumns = (responses) => {\n    if (!responses || responses.length == 0) return [];\n    let fdata = responses[0].fdata;\n    if (!fdata || fdata.length === 0) return [];\n    let result = [];\n    for (var i = 0; i < fdata.length; i++) {\n      if (fdata[i].type === 'file') continue;\n\n      result.push({Header: fdata[i].label, accessor: fdata[i].label});\n      //let userData = fdata[i].userData;\n    }\n    return result;\n  }\n\n  const flattenUserData = (userData) => {\n    if (!userData || userData.length === 0) return '';\n    let result = userData[0];\n    for (var i = 1; i < userData.length; i++) {\n      result = result + ', ' + userData[i];\n    }\n    return result;\n  }\n\n  const flattenFData = (fdata) => {\n    if (!fdata || fdata.length === 0) return {};\n    let result = {};\n    for (var i = 0; i < fdata.length; i++) {\n      if (fdata[i].type === 'file') continue;\n\n      result[fdata[i].label] = flattenUserData(fdata[i].userData);\n    }\n\n    return result;\n  }\n\n  const flatten = (responses) => {\n    if (!responses || responses.length == 0) return [];\n    let result = [];\n    for (var i = 0; i < responses.length; i++) {\n      const {fdata, ...others} = responses[i];\n      let f = flattenFData(fdata);\n      result.push({...others, ...f});\n    }\n    return result;\n  }\n\n  const retrieveExportResponses = () => {\n    const params = getRequestParams(true);\n\n    ResponseDataService.getAll2(params)\n      .then((response) => {\n        const { responses, totalPages, totalItems } = response.data;\n\n        const fColumns = getFDataColumns(responses);\n\n        const csv = ProjectDataService.exportCSV(flatten(responses), [...columns, ... exportColumns, ...fColumns]);\n\n        const url = window.URL.createObjectURL(new Blob([csv]));\n\n        const link = document.createElement('a');\n        link.href = url;\n        link.setAttribute('download',\n                'response.csv'\n        );\n        document.body.appendChild(link);\n        link.click();\n        link.remove();\n\n        console.log(response.data);\n      })\n      .catch((e) => {\n        console.log(e);\n      });\n  };\n\n  const retrieveResponses = () => {\n    const params = getRequestParams();\n\n    ResponseDataService.getAll2(params)\n      .then((response) => {\n        const { responses, totalPages, totalItems } = response.data;\n\n        setResponses(responses);\n        setCount(totalPages);\n        setTotalItems(totalItems);\n\n        if (formId && responses[0] && responses[0].title) { // in old system, responseTitle is: formTitle-schoolNumber\n          const index = responses[0].title.indexOf(\"-\");\n          setTitle((index > 0) ? responses[0].title.substring(0, index) : responses[0].title);\n        }\n\n        console.log(response.data);\n      })\n      .catch((e) => {\n        console.log(e);\n      });\n  };\n\n  useEffect(retrieveResponses, [page, pageSize, orderby, searchTitle, searchCode, searchStartAt]);\n\n  const refreshList = () => {\n    retrieveResponses();\n  };\n\n  const removeAllResponses = () => {\n    ResponseDataService.deleteAll()\n      .then((response) => {\n        console.log(response.data);\n        refreshList();\n      })\n      .catch((e) => {\n        console.log(e);\n      });\n  };\n\n\n  const openResponse = (rowIndex) => {\n    const id = responsesRef.current[rowIndex].id;\n\n    props.history.push(\"/responses/\" + id);\n  };\n\n  const deleteResponse = (rowIndex) => {\n    const id = responsesRef.current[rowIndex].id;\n\n    ResponseDataService.delete(id)\n      .then((response) => {\n        //props.history.push(\"/responses\");\n\n        let newResponses = [...responsesRef.current];\n        newResponses.splice(rowIndex, 1);\n\n        setResponses(newResponses);\n      })\n      .catch((e) => {\n        console.log(e);\n      });\n  };\n\n  const renderSchool = (rowIdx) => {\n    let r = \"\";\n    if (responsesRef.current[rowIdx].school) {\n      r = responsesRef.current[rowIdx].school.region + \"/\" + responsesRef.current[rowIdx].school.name;\n    }\n    return r;\n  }\n\n  const exportColumns = [\n    {\n      Header: \"市\",\n      accessor: \"school.surveys.city\",\n    },\n    {\n      Header: \"区/县\",\n      accessor: \"school.surveys.county\",\n    },\n    {\n      Header: \"乡/镇\",\n      accessor: \"school.surveys.community\",\n    },\n    {\n      Header: \"教育局校名\",\n      accessor: \"school.surveys.schoolBoardRegisteredName\",\n    },\n    {\n      Header: \"学校类型\",\n      accessor: \"school.category\",\n    },\n    {\n      Header: \"学生人数\",\n      accessor: \"school.studentsCount\",\n    },\n    {\n      Header: \"教师人数\",\n      accessor: \"school.teachersCount\",\n    },\n  ];\n\n  const columns = useMemo(\n    () => [\n      {\n        Header: \"项目年份\",\n        accessor: \"startAt\",\n        Cell: (props) => {\n          const rowIdx = props.row.id;\n            var d = null;\n            if ((responsesRef.current[rowIdx].startAt)) d = new Date(responsesRef.current[rowIdx].startAt);\n            return (\n              <div>\n                {d ? d.getUTCFullYear() : ''\n                /* d.toLocaleDateString('zh-cn', { hour12: true, hour: \"2-digit\", minute: \"2-digit\", second: \"2-digit\" })*/\n                }\n              </div>\n            );\n        }\n      },\n      {\n        Header: \"标题\",\n        accessor: \"title\",\n      },\n      {\n        Header: \"申请人\",\n        accessor: 'user.chineseName',\n        disableSortBy: true,\n        Cell: (props) => {\n          const rowIdx = props.row.id;\n          return (\n            <div>\n            { (responsesRef.current[rowIdx].user) ? (\n              <Link\n                to={\"/usersView/\" + responsesRef.current[rowIdx].user.id}\n                className=\"badge badge-success\"\n              >\n                {responsesRef.current[rowIdx].user.chineseName}\n              </Link>\n            ) : ''}\n            </div>\n          );\n        },\n      },\n      {\n        Header: \"修改时间\",\n        accessor: \"updatedAt\",\n        Cell: (props) => {\n          const rowIdx = props.row.id;\n            const d = new Date(responsesRef.current[rowIdx].updatedAt);\n            return (\n              <div>\n                {d.toLocaleDateString('zh-cn', { hour12: true, hour: \"2-digit\", minute: \"2-digit\", second: \"2-digit\" })}\n              </div>\n            );\n        }\n      },\n      {\n        Header: \"学校编号\",\n        accessor: 'school.code',\n        Cell: (props) => {\n          const rowIdx = props.row.id;\n          return (\n            <div>\n            { (responsesRef.current[rowIdx].school) ? (\n              <Link\n                to={\"/schoolsView/\" + responsesRef.current[rowIdx].school.id}\n                className=\"badge badge-success\"\n              >\n                {responsesRef.current[rowIdx].school.code}\n              </Link>\n            ) : ''}\n            </div>\n          );\n        },\n      },\n      {\n        Header: \"学校名称\",\n        accessor: 'school.name',\n        Cell: (props) => {\n          const rowIdx = props.row.id;\n          return (\n            <div>\n            { (responsesRef.current[rowIdx].school) ? (\n              <Link\n                to={\"/schoolsView/\" + responsesRef.current[rowIdx].school.id}\n                className=\"badge badge-success\"\n              >\n                {responsesRef.current[rowIdx].school.name}\n              </Link>\n            ) : ''}\n            </div>\n          );\n        },\n      },\n      {\n        Header: \"省（直辖市）\",\n        accessor: 'school.region',\n      },\n/**\n      {\n        Header: \"附件数目\",\n        accessor: \"attachmentsCount\",\n        disableSortBy: true,\n        Cell: (props) => {\n          const rowIdx = props.row.id;\n          return (\n            <div>\n              <Link\n                to={\"/attachments/response/\" + responsesRef.current[rowIdx].id}\n                className=\"badge badge-success\"\n              >\n                {responsesRef.current[rowIdx].attachmentsCount}\n              </Link>\n            </div>\n          );\n        },\n      },\n*/\n      {\n        Header: \"操作\",\n        accessor: \"actions\",\n        disableSortBy: true,\n        Cell: (props) => {\n          const rowIdx = props.row.id;\n          return (\n            <div>\n              <Link\n                to={\"/responsesView/\" + responsesRef.current[rowIdx].id}\n              >\n                <i className=\"fas fa-eye action mr-2\"></i>\n              </Link>\n              {!readonly && (<Link\n                to={\"/responses/\" + responsesRef.current[rowIdx].id}\n              >\n                <i className=\"far fa-edit action mr-2\"></i>\n              </Link>)}\n\n              {!readonly && (<span onClick={() => window.confirm(\"您确定要删除吗 ?\") && deleteResponse(rowIdx)}>\n                <i className=\"fas fa-trash action\"></i>\n              </span>)}\n            </div>\n          );\n        },\n      },\n    ],\n    []\n  );\n\n  const formKnownColumns = ['title'];\n\n  const schoolKnownColumns = ['school.region', 'school.code', 'school.name'];\n\n  var hiddenColumns = [];\n  if (embedded || schoolId) hiddenColumns = schoolKnownColumns;\n  if (formId) hiddenColumns = [...hiddenColumns, ...formKnownColumns];\n\n  const {\n    getTableProps,\n    getTableBodyProps,\n    headerGroups,\n    rows,\n    prepareRow,\n    state: {sortBy},\n  } = useTable({\n    columns,\n    data: responses,\n    disableSortRemove: true,\n    manualSortBy: true,\n    initialState: {\n      hiddenColumns: hiddenColumns,\n      sortBy: [\n        {\n          id: 'startAt',\n          //id: 'school.code',\n          desc: true\n        }\n      ]\n    },\n  },\n  useSortBy);\n\n  const findByTitle = () => {\n    setPage(1);\n    retrieveResponses();\n  };\n\n  const handlePageChange = (event, value) => {\n    setPage(value);\n  };\n\n  const handlePageSizeChange = (event) => {\n    setPageSize(event.target.value);\n    setPage(1);\n  };\n\n  useEffect(() => {\n    if (sortBy && sortBy[0])\n      setOrderby(sortBy);\n  }, [sortBy]);\n\n  return (\n    <div className=\"list row\">\n      <div className=\"col-sm-8\">\n        <h4>\n          {schoolId && !embedded && (<a href={'/schoolsView/' + schoolId}>学校{(schoolId) + '-'}</a>)}\n          {title ? (title + '-') : ''}\n          项目申请列表(总数：{totalItems})\n        </h4>\n        <div className=\"input-group mb-3\">\n          <input\n            type=\"text\"\n            readonly=\"\"\n            className=\"form-control\"\n            placeholder=\"项目年份\"\n            value={searchStartAt}\n            onChange={onChangeSearchInputStartAt}\n          />\n          <YearPicker\n            yearArray={['2019', '2020']}\n            value={searchStartAt}\n            onSelect={onChangeSearchStartAt}\n            hideInput={true}\n            minRange={1995}\n            maxRange={2022}\n          />\n\n          {!formId && (<input\n            type=\"text\"\n            className=\"form-control ml-2\"\n            placeholder=\"标题查找\"\n            value={searchTitle}\n            onChange={onChangeSearchTitle}\n          />)}\n\n          {!embedded && (<input\n            type=\"text\"\n            className=\"form-control ml-2\"\n            placeholder=\"学校编码\"\n            value={searchCode}\n            onChange={onChangeSearchCode}\n          />)}\n\n          <div>\n            <button\n              className=\"btn btn-primary ml-2\"\n              type=\"button\"\n              onClick={onClearSearch}\n            >\n              清空\n            </button>\n          </div>\n        </div>\n\n        <div className=\"input-group mb-3\">\n          <button\n            className=\"btn btn-primary \"\n            type=\"button\"\n            onClick={findByTitle}\n          >\n            查询\n          </button>\n\n          {formId && (<button\n            className=\"btn btn-primary ml-2\"\n            type=\"button\"\n            onClick={retrieveExportResponses}\n          >\n            导出\n          </button>)}\n\n        </div>\n      </div>\n\n      <div className=\"col-sm-4 mt-3\">\n        {\"每页显示行数: \"}\n        <select onChange={handlePageSizeChange} value={pageSize}>\n          {pageSizes.map((size) => (\n            <option key={size} value={size}>\n              {size}\n            </option>\n          ))}\n        </select>\n        <Pagination\n          className=\"my-3\"\n          count={count}\n          page={page}\n          siblingCount={1}\n          boundaryCount={1}\n          variant=\"outlined\"\n          shape=\"rounded\"\n          onChange={handlePageChange}\n        />\n      </div>\n\n      <div className=\"col-sm-12 list\">\n\n        <table\n          className=\"table table-striped table-bordered\"\n          {...getTableProps()}\n        >\n          <thead>\n            {headerGroups.map((headerGroup) => (\n              <tr {...headerGroup.getHeaderGroupProps()}>\n                {headerGroup.headers.map((column) => (\n                // Add the sorting props to control sorting. For this example\n                // we can add them into the header props\n                  <th {...column.getHeaderProps(column.getSortByToggleProps())}>\n                    {column.render('Header')}\n                    {/* Add a sort direction indicator */}\n                      <span>\n                        {/*column.isSorted*/ (column.id === 'school.region' || column.id === 'school.code' ||\n                        column.id === 'school.name' || column.id === 'startAt' || column.id === 'updatedAt' ||\n                        column.id === 'title')\n                          ? column.isSortedDesc\n                            ? ' 🔽'\n                            : ' 🔼'\n                          : ''}\n                      </span>\n                  </th>\n                ))}\n              </tr>\n            ))}\n          </thead>\n          <tbody {...getTableBodyProps()}>\n            {rows.map((row, i) => {\n              prepareRow(row);\n              return (\n                <tr {...row.getRowProps()}>\n                  {row.cells.map((cell) => {\n                    return (\n                      <td {...cell.getCellProps()}>{cell.render(\"Cell\")}</td>\n                    );\n                  })}\n                </tr>\n              );\n            })}\n          </tbody>\n        </table>\n      </div>\n    </div>\n  );\n};\n\nexport default ResponsesList;","import React, { Component } from \"react\";\nimport ProjectDataService from \"../services/project.service\";\nimport { Link } from \"react-router-dom\";\nimport Pagination from \"@material-ui/lab/Pagination\";\n\nimport { useState, useEffect, useMemo, useRef, useCallback } from \"react\";\nimport { useTable, useSortBy } from \"react-table\";\n\nimport YearPicker from 'react-single-year-picker';\n\nconst ProjectsList = (props) => {\n  const [projects, setProjects] = useState([]);\n  const [exportProjects, setExportProjects] = useState([]);\n\n  const [currentProject, setCurrentProject] = useState(null);\n  const [currentUser, setCurrentUser] = useState(localStorage.getItem('user'));\n\n  const [currentIndex, setCurrentIndex] = useState(-1);\n  const [searchName, setSearchName] = useState(\"\");\n  const [searchCode, setSearchCode] = useState(\"\");\n  const [searchRegion, setSearchRegion] = useState(\"\");\n  const [searchStartAt, setSearchStartAt] = useState(\"\");\n\n  const [schoolId, setSchoolId] = useState(props.match? props.match.params.schoolId : props.schoolId);\n\n  const [embedded, setEmbedded] = useState(props.embedded ? props.embedded : false);\n\n  const [readonly, setReadonly] = useState(props.readonly ? props.readonly : false);\n\n  const projectsRef = useRef();\n  projectsRef.current = projects;\n\n  const [page, setPage] = useState(1);\n  const [count, setCount] = useState(0);\n  const [pageSize, setPageSize] = useState(30);\n\n  const [totalItems, setTotalItems] = useState(0);\n\n  const pageSizes = [20, 30, 50];\n\n  const [orderby, setOrderby] = useState([]);\n\n  const [regions, setRegions] = useState([]);\n\n  const [startAt, setStartAt] = useState(\n  []\n  );\n\n  const [xr, setXR] = useState(window.location.pathname.includes('XR')\n    ? window.location.pathname.includes('XR')\n    : props.xr);\n\n  const onChangeSearchName = (e) => {\n    const searchName = e.target.value;\n    setSearchName(searchName);\n  };\n\n  const onChangeSearchCode = (e) => {\n    const searchCode = e.target.value;\n    setSearchCode(searchCode);\n  };\n\n  const onChangeSearchRegion = (e) => {\n    const searchRegion = e.target.value;\n    setSearchRegion(searchRegion);\n  };\n\n  const onChangeSearchStartAt = (e) => {\n    const searchStartAt = e; // e.target.value;\n    setSearchStartAt(searchStartAt);\n  };\n\n  const onChangeSearchInputStartAt = (e) => {\n    const searchStartAt = e; //e.target.value;\n    setSearchStartAt(searchStartAt);\n  };\n\n  const onClearSearch = (e) => {\n    setSearchName(\"\");\n    setSearchCode(\"\");\n    setSearchRegion(\"\");\n    setSearchStartAt(\"\");\n    setOrderby([]);\n    setExportProjects([]);\n  };\n\n\n  const getRequestParams = (/*searchName, page, pageSize, orderby,\n    searchCode, searchRegion, searchStartAt, schoolId, */exportFlag) => {\n    let params = {};\n\n    if (searchName) {\n      params[\"name\"] = searchName;\n    }\n\n    if (page) {\n      params[\"page\"] = page - 1;\n    }\n\n    if (pageSize) {\n      params[\"size\"] = pageSize;\n    }\n\n    if (orderby) {\n      params[\"orderby\"] = orderby;\n    }\n\n    if (searchCode) {\n      params[\"code\"] = searchCode;\n    }\n\n    if (searchRegion) {\n      params[\"region\"] = searchRegion;\n    }\n\n    if (searchStartAt) {\n      params[\"startAt\"] = searchStartAt;\n    }\n\n    if (schoolId) {\n      params[\"schoolId\"] = schoolId;\n    }\n\n    params[\"xr\"] = xr;\n\n    if (exportFlag) {\n      params[\"exportFlag\"] = exportFlag;\n    }\n\n    return params;\n  };\n\n\n  const getRegions = () => {\n    if (regions.length == 0) {\n      ProjectDataService.getRegions()\n        .then(response => {\n          setRegions(response.data);\n          console.log(response);\n        })\n        .catch(e => {\n          console.log(e);\n        });\n    }\n  }\n\n  useEffect(getRegions, [orderby]);\n\n  const retrieveProjects = () => {\n    const params = getRequestParams(/*searchName, page, pageSize, orderby,\n        searchCode, searchRegion, searchStartAt, schoolId, */false);\n\n    ProjectDataService.getAll2(params)\n      .then((response) => {\n        const { projects, totalPages, totalItems } = response.data;\n\n        setProjects(projects);\n        setCount(totalPages);\n        setTotalItems(totalItems);\n\n        console.log(response.data);\n      })\n      .catch((e) => {\n        console.log(e);\n      });\n  };\n\n  const retrieveExportProjects = () => {\n    const params = getRequestParams(/*searchName, page, pageSize, orderby,\n        searchCode, searchRegion, searchStartAt, schoolId, */true);\n\n    ProjectDataService.getAll2(params)\n      .then((response) => {\n        const { projects, totalPages, totalItems } = response.data;\n        setExportProjects(projects);\n        console.log(response.data);\n\n        const csv = ProjectDataService.exportCSV(projects, columns);\n        const url = window.URL.createObjectURL(new Blob([csv]));\n\n        const link = document.createElement('a');\n        link.href = url;\n        link.setAttribute('download',\n                'project.csv'\n        );\n        document.body.appendChild(link);\n        link.click();\n        link.remove();\n\n      })\n      .catch((e) => {\n\n        console.log(e);\n      });\n  };\n\n  useEffect(retrieveProjects, [page, pageSize, orderby, searchCode, searchName, searchStartAt, searchRegion]);\n\n  const refreshList = () => {\n    retrieveProjects();\n  };\n\n  const removeAllProjects = () => {\n    ProjectDataService.deleteAll()\n      .then((response) => {\n        console.log(response.data);\n        refreshList();\n      })\n      .catch((e) => {\n        console.log(e);\n      });\n  };\n\n\n  const openProject = (rowIndex) => {\n    const id = projectsRef.current[rowIndex].id;\n\n    props.history.push(\"/projects/\" + id);\n  };\n\n  const deleteProject = (rowIndex) => {\n    const id = projectsRef.current[rowIndex].id;\n\n    ProjectDataService.delete(id)\n      .then((response) => {\n\n        //props.history.push(\"/projects\");\n\n        let newProjects = [...projectsRef.current];\n        newProjects.splice(rowIndex, 1);\n\n        setProjects(newProjects);\n      })\n      .catch((e) => {\n        console.log(e);\n      });\n  };\n\n  const renderSchool = (rowIdx) => {\n    let r = \"\";\n    if (projectsRef.current[rowIdx].school) {\n      r = projectsRef.current[rowIdx].school.code + \"/\" + projectsRef.current[rowIdx].school.name;\n    }\n    return r;\n  }\n\n  const columns = useMemo(\n    () => [\n      {\n        Header: \"项目年份\",\n        accessor: \"startAt\",\n        Cell: (props) => {\n          const rowIdx = props.row.id;\n            const d = new Date(projectsRef.current[rowIdx].startAt);\n            return (\n              <div>\n                {/*d.toLocaleDateString('zh-cn', { hour12: true, hour: \"2-digit\", minute: \"2-digit\", second: \"2-digit\" })*/\n                d.getUTCFullYear()\n                }\n              </div>\n            );\n        }\n      },\n      {\n        Header: \"项目状态\",\n        accessor: \"status\",\n      },\n      {\n        Header: \"项目名称\",\n        accessor: \"name\",\n      },\n      {\n        Header: \"项目申请\",\n        accessor: \"response.title\",\n        disableSortBy: true,\n        Cell: (props) => {\n          const rowIdx = props.row.id;\n          return (\n            <div>\n            {(projectsRef.current[rowIdx].response) ? (\n              <Link\n                to={\"/responsesView/\" + projectsRef.current[rowIdx].response.id}\n              >\n                {projectsRef.current[rowIdx].response.title}\n              </Link>\n              ) : ''}\n            </div>\n          );\n        },\n      },\n\n      {\n        Header: \"项目描述\",\n        accessor: \"description\",\n        disableSortBy: true,\n      },\n      {\n        Header: \"学校编号\",\n        accessor: \"school.code\",\n        Cell: (props) => {\n          const rowIdx = props.row.id;\n          return (\n            <div>\n            {(projectsRef.current[rowIdx].school) ? (\n              <Link\n                to={\"/schoolsView/\" + projectsRef.current[rowIdx].school.id}\n              >\n                {projectsRef.current[rowIdx].school.code}\n              </Link>\n              ) : ''}\n            </div>\n          );\n        },\n      },\n      {\n        Header: \"省（直辖市）\",\n        accessor: \"school.region\",\n      },\n      {\n        Header: \"学校名称\",\n        accessor: \"school.name\",\n        Cell: (props) => {\n          const rowIdx = props.row.id;\n          return (\n            <div>\n            {(projectsRef.current[rowIdx].school) ? (\n              <Link\n                to={\"/schoolsView/\" + projectsRef.current[rowIdx].school.id}\n              >\n                {projectsRef.current[rowIdx].school.name}\n              </Link>\n              ) : ''}\n            </div>\n          );\n        },\n      },\n      {\n        Header: \"学生数\",\n        accessor: 'school.studentsCount',\n        disableSortBy: true,\n      },\n      {\n        Header: \"教师数\",\n        accessor: 'school.teachersCount',\n        disableSortBy: true,\n      },\n\n      {\n        Header: \"学校类型\",\n        accessor: 'school.category',\n        disableSortBy: true,\n      },\n      {\n        Header: \"项目费用\",\n        accessor: \"budget\",\n        disableSortBy: true,\n      },\n      {\n        Header: \"操作\",\n        accessor: \"actions\",\n        disableSortBy: true,\n        Cell: (props) => {\n          const rowIdx = props.row.id;\n          return (\n            <div>\n              {currentUser && (<Link\n                to={\"/projectsView\" + (xr ? 'XR' : '') + \"/\" + projectsRef.current[rowIdx].id}\n              >\n                <i className=\"fas fa-eye action mr-2\"></i>\n              </Link>)}\n\n              {!readonly && currentUser && (<Link\n                to={\"/projects\" + (xr ? 'XR' : '') + \"/\" + projectsRef.current[rowIdx].id}\n              >\n                <i className=\"far fa-edit action mr-2\"></i>\n              </Link>)}\n\n              {!readonly && currentUser && (<span onClick={() => window.confirm(\"您确定要删除吗 ?\") && deleteProject(rowIdx)}>\n                <i className=\"fas fa-trash action\"></i>\n              </span>)}\n            </div>\n          );\n        },\n      },\n    ],\n    []\n  );\n\n  const schoolKnownColumns =\n    ['id', 'school.region', 'school.code', 'school.name'];\n\n  const exportOnlyColumns =\n    ['school.studentsCount', 'school.teachersCount', 'school.category'];\n\n  var hiddenColumns = (embedded || schoolId)\n    ? [...schoolKnownColumns, ...exportOnlyColumns]\n    : [];\n\n  const xrColumns =\n    [\"response.title\", \"status\"];\n\n  hiddenColumns = xr\n    ? [...hiddenColumns, ...xrColumns]\n    : hiddenColumns;\n\n  const {\n    getTableProps,\n    getTableBodyProps,\n    headerGroups,\n    rows,\n    prepareRow,\n    state,\n    state: {sortBy},\n  } = useTable({\n    columns,\n    data: projects,\n    disableSortRemove: true,\n    manualSortBy: true,\n    initialState: {\n      hiddenColumns: hiddenColumns,\n      sortBy: [\n        {\n          id: 'startAt',\n          //id: 'school.code',\n          desc: true\n        }\n      ]\n    },\n  },\n  useSortBy,\n  );\n\n  const search = () => {\n    setPage(1);\n    retrieveProjects();\n  };\n\n  const handlePageChange = (event, value) => {\n    setPage(value);\n  };\n\n  const handlePageSizeChange = (event) => {\n    setPageSize(event.target.value);\n    setPage(1);\n  };\n\n  useEffect(() => {\n    if (sortBy && sortBy[0])\n      setOrderby(sortBy);\n  }, [sortBy]);\n\n\n  return (\n    <div className=\"list row\">\n      <div className=\"col-sm-9\">\n        <h4>\n          {schoolId && !embedded && (<a href={'/schoolsView/' + schoolId}>学校{(schoolId) + '-'}</a>)}\n          {xr && '向荣支持'}项目列表(总数：{totalItems})\n        </h4>\n        <div className=\"input-group mb-3 \">\n\n          <input\n            type=\"text\"\n            className=\"form-control mr-2\"\n            placeholder=\"项目名称\"\n            value={searchName}\n            onChange={onChangeSearchName}\n          />\n\n          <input\n            type=\"text\"\n            readonly=\"\"\n            className=\"form-control ml-2\"\n            placeholder=\"项目年份\"\n            value={searchStartAt}\n          />\n          <YearPicker\n            yearArray={['2019', '2020']}\n            value={searchStartAt}\n            onSelect={onChangeSearchStartAt}\n            hideInput={true}\n            minRange={1995}\n            maxRange={2022}\n          />\n\n          {!embedded && (<input\n            type=\"text\"\n            className=\"form-control ml-2\"\n            placeholder=\"学校编号\"\n            value={searchCode}\n            onChange={onChangeSearchCode}\n          />)}\n\n          <select\n            className=\"form-control ml-2\"\n            placeholder=\"....\"\n            value={searchRegion}\n            onChange={onChangeSearchRegion}\n          >\n            <option value=\"\">省/自治区</option>\n            {regions.map((option) => (\n            <option value={option}>\n            {option}\n            </option>\n            ))}\n          </select>\n\n          <div>\n            <button\n              className=\"btn btn-primary ml-2\"\n              type=\"button\"\n              onClick={onClearSearch}\n            >\n              清空\n            </button>\n          </div>\n\n        </div>\n\n\n        <div className=\"input-group mb-4\">\n          <div>\n            <button\n              className=\"btn btn-primary \"\n              type=\"button\"\n              onClick={search}\n            >\n              查询\n            </button>\n          </div>\n\n          <div hidden={!currentUser}>\n            <button\n              className=\"btn btn-primary ml-2\"\n              type=\"button\"\n              onClick={retrieveExportProjects}\n            >\n              导出\n            </button>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"mt-3 col-sm-3\">\n        {\"每页显示行数: \"}\n        <select onChange={handlePageSizeChange} value={pageSize}>\n          {pageSizes.map((size) => (\n            <option key={size} value={size}>\n              {size}\n            </option>\n          ))}\n        </select>\n\n        <Pagination\n          className=\"my-3\"\n          count={count}\n          page={page}\n          siblingCount={1}\n          boundaryCount={1}\n          variant=\"outlined\"\n          shape=\"rounded\"\n          onChange={handlePageChange}\n        />\n      </div>\n\n        <div class=\"w-100\"></div>\n\n      <div className=\"col-sm-12 list\">\n        <table\n          className=\"table table-striped table-bordered\"\n          {...getTableProps()}\n        >\n          <thead>\n            {headerGroups.map((headerGroup) => (\n              <tr {...headerGroup.getHeaderGroupProps()}>\n                {headerGroup.headers.map((column) => (\n                  // Add the sorting props to control sorting. For this example\n                  // we can add them into the header props\n                  <th {...column.getHeaderProps(column.getSortByToggleProps())}>\n                    {column.render('Header')}\n                    {/* Add a sort direction indicator */}\n                    <span>\n                      {/*column.isSorted*/ (column.id === 'school.region' || column.id === 'school.code' ||\n                      column.id === 'school.name' || column.id === 'startAt' || column.id === 'status'\n                      || column.id === 'name' )\n                      ? column.isSortedDesc\n                        ? ' 🔽'\n                        : ' 🔼'\n                      : ''}\n                    </span>\n                  </th>\n                ))}\n              </tr>\n            ))}\n          </thead>\n          <tbody {...getTableBodyProps()}>\n            {rows.map((row, i) => {\n              prepareRow(row);\n              return (\n                <tr {...row.getRowProps()}>\n                  {row.cells.map((cell) => {\n                    return (\n                      <td {...cell.getCellProps()}>{cell.render(\"Cell\")}</td>\n                    );\n                  })}\n                </tr>\n              );\n            })}\n          </tbody>\n        </table>\n      </div>\n\n      <div className=\"mt-3 col-sm-\">\n        {\"每页显示行数: \"}\n        <select onChange={handlePageSizeChange} value={pageSize}>\n          {pageSizes.map((size) => (\n            <option key={size} value={size}>\n              {size}\n            </option>\n          ))}\n        </select>\n\n        <Pagination\n          className=\"my-3\"\n          count={count}\n          page={page}\n          siblingCount={1}\n          boundaryCount={1}\n          variant=\"outlined\"\n          shape=\"rounded\"\n          onChange={handlePageChange}\n        />\n      </div>\n\n    </div>\n  );\n};\n\nexport default ProjectsList;","import axios from \"axios\";\nimport authHeader from './auth-header';\nconst API_URL = \"/api/auth/\";\n//const API_URL = \"http://localhost:8080/api/auth/\";\n\nclass AuthService {\n  login(username, password) {\n    return axios\n      .post(API_URL + \"signin\", {\n        username,\n        password\n      });\n\n/**\n      .then(response => {\n        if (response.data.accessToken) {\n          localStorage.setItem(\"user\", JSON.stringify(response.data));\n        }\n\n        return response.data;\n      });\n*/\n  }\n\n  reset(email, password) {\n    return axios\n      .post(API_URL + \"reset\", {\n        email,\n        password\n      });\n/*\n      .then(response => {\n        return response.data;\n      })\n      .catch(err => {\n      });\n*/\n  }\n\n  findByEmail(email) {\n    return axios\n      .post(API_URL + \"findByEmail\", {\n        email,\n      });\n  }\n\n  logout() {\n    if (!localStorage.getItem('user')) return;\n\n    const username = JSON.parse(localStorage.getItem('user')).username;\n    localStorage.removeItem(\"user\");\n\n    return axios\n      .post(API_URL + \"signout\", {\n        username,\n      })\n      .then(response => {\n        return response.data;\n      })\n      .catch(err => {\n        console.log(err);\n      });\n  }\n\n  register(username, email, password, roles, schoolId,\n              chineseName, phone, wechat, startAt, title) {\n    return axios.post(API_URL + \"signup\", {\n      username,\n      email,\n      password,\n      roles,\n      schoolId,\n      chineseName,\n      phone,\n      wechat,\n      startAt,\n      title\n    });\n  }\n\n  createContactOnly(data) {\n    return axios.post(API_URL + \"createContactOnly\", data, { headers: authHeader() });\n  }\n\n  updateContactOnly(id, data) {\n    return axios.put(API_URL + \"users/updateContactOnly/\" + `${id}`, data, { headers: authHeader() });\n  }\n\n  getCurrentUser() {\n    return JSON.parse(localStorage.getItem('user'));\n  }\n\n  isValid() {\n    if (!localStorage.getItem('user'))\n      return false;\n\n    const user = JSON.parse(localStorage.getItem('user'));\n\n    if (!user.thisLogin || !user.validity)\n        return true;\n\n    return (user.thisLogin + user.validity) > Math.floor(Date.now()/1000);\n  }\n\n  getRoles() {\n    return axios.get(API_URL + \"roles\");\n  }\n\n  getAll2(data) {\n    return axios.post(API_URL + \"users\", data, { headers: authHeader() });\n  }\n\n  getAllSimple(data) {\n    return axios.post(API_URL + \"usersSimple\", data, { headers: authHeader() });\n  }\n\n  delete(id) {\n    return axios.delete(API_URL + \"users/\" + `${id}`, { headers: authHeader() });\n  }\n\n  get(id) {\n    return axios.get(API_URL + \"users/\" + `${id}`, { headers: authHeader() });\n  }\n\n\n  update(id, data) {\n    return axios.put(API_URL + \"users/update/\" + `${id}`, data, { headers: authHeader() });\n  }\n\n  getUserTitles() {\n    return axios.get(API_URL + \"userTitles\");\n  }\n}\n\nexport default new AuthService();\n","import React, { Component } from \"react\";\nimport DocumentDataService from \"../services/document.service\";\nimport { Link } from \"react-router-dom\";\nimport Pagination from \"@material-ui/lab/Pagination\";\n\nimport { useState, useEffect, useMemo, useRef } from \"react\";\nimport { useTable, useSortBy } from \"react-table\";\n\nconst DocumentsList = (props) => {\n  const [documents, setDocuments] = useState([]);\n  const [currentDocument, setCurrentDocument] = useState(null);\n  const [currentIndex, setCurrentIndex] = useState(-1);\n  const [searchOriginalname, setSearchOriginalname] = useState(\"\");\n  const [schoolId, setSchoolId] = useState(props.match? props.match.params.schoolId : props.schoolId);\n  const [docCategory, setDocCategory] = useState(props.match? props.match.params.docCategory : props.docCategory);\n\n  const [readonly, setReadonly] = useState(props.readonly ? props.readonly : false);\n\n  const [embedded, setEmbedded] = useState(props.embedded ? props.embedded : false);\n\n  const documentsRef = useRef();\n  documentsRef.current = documents;\n\n  const [page, setPage] = useState(1);\n  const [count, setCount] = useState(0);\n  const [pageSize, setPageSize] = useState(5);\n\n  const pageSizes = [5, 10, 20];\n\n  const onChangeSearchOriginalname = (e) => {\n    const searchOriginalname = e.target.value;\n    setSearchOriginalname(searchOriginalname);\n  };\n\n  const getRequestParams = (/*searchOriginalname, page, pageSize, schoolId, docCategory*/) => {\n    let params = {};\n\n    if (searchOriginalname) {\n      params[\"originalname\"] = searchOriginalname;\n    }\n\n    if (page) {\n      params[\"page\"] = page - 1;\n    }\n\n    if (pageSize) {\n      params[\"size\"] = pageSize;\n    }\n\n    if (schoolId) {\n      params[\"schoolId\"] = schoolId;\n    }\n\n    if (docCategory) {\n      params[\"docCategory\"] = docCategory;\n    }\n\n    return params;\n  };\n\n  const retrieveDocuments = () => {\n    const params = getRequestParams(/*searchOriginalname, page, pageSize, schoolId, docCategory*/);\n\n    DocumentDataService.getAll2(params)\n      .then((response) => {\n        const { documents, totalPages } = response.data;\n\n        setDocuments(documents);\n        setCount(totalPages);\n\n        console.log(response.data);\n      })\n      .catch((e) => {\n        console.log(e);\n      });\n  };\n\n  useEffect(retrieveDocuments, [page, pageSize]);\n\n  const refreshList = () => {\n    retrieveDocuments();\n  };\n\n  const removeAllDocuments = () => {\n    DocumentDataService.deleteAll()\n      .then((response) => {\n        console.log(response.data);\n        refreshList();\n      })\n      .catch((e) => {\n        console.log(e);\n      });\n  };\n\n\n  const openDocument = (rowIndex) => {\n    const id = documentsRef.current[rowIndex].id;\n\n    props.history.push(\"/documents/\" + id);\n  };\n\n  const deleteDocument = (rowIndex) => {\n    const id = documentsRef.current[rowIndex].id;\n\n    DocumentDataService.delete(id)\n      .then((response) => {\n        //props.history.push(\"/documents\");\n\n        let newDocuments = [...documentsRef.current];\n        newDocuments.splice(rowIndex, 1);\n\n        setDocuments(newDocuments);\n      })\n      .catch((e) => {\n        console.log(e);\n      });\n  };\n\n  const columns = useMemo(\n    () => [\n      {\n        Header: \"时间\",\n        accessor: \"createdAt\",\n        Cell: (props) => {\n          const rowIdx = props.row.id;\n          const d = new Date(documentsRef.current[rowIdx].createdAt);\n          return (\n            <div>\n              {d.toLocaleDateString('zh-cn', { hour12: true, hour: \"2-digit\", minute: \"2-digit\", second: \"2-digit\" })}\n            </div>\n          );\n        },\n      },\n      {\n        Header: \"文档名\",\n        accessor: \"originalname\",\n      },\n      {\n        Header: \"类别\",\n        accessor: \"docCategory\",\n      },\n      {\n        Header: \"学校\",\n        accessor: 'school',\n        disableSortBy: true,\n        Cell: (props) => {\n          const rowIdx = props.row.id;\n          return (\n            <div>\n              <Link\n                to={\"/schoolsView/\" + documentsRef.current[rowIdx].schoolId}\n                className=\"badge badge-success\"\n              >\n                {\"点击查看学校\"}\n              </Link>\n            </div>\n          );\n        }\n      },\n      {\n        Header: \"操作\",\n        accessor: \"actions\",\n        disableSortBy: true,\n        Cell: (props) => {\n          const rowIdx = props.row.id;\n          return (\n            <div>\n              {(documentsRef.current[rowIdx].mimetype.startsWith('image') ||\n                documentsRef.current[rowIdx].mimetype.indexOf('pdf') > 0) && (\n              <a href=\"#\" onClick={() => download(documentsRef.current[rowIdx].id,\n                                                documentsRef.current[rowIdx].originalname,\n                                                documentsRef.current[rowIdx].mimetype, true)} >\n                <i className=\"fas fa-eye action mr-2\"></i>\n              </a>\n              )}\n              \n              <a href=\"#\" onClick={() => download(documentsRef.current[rowIdx].id,\n                                                documentsRef.current[rowIdx].originalname,\n                                                documentsRef.current[rowIdx].mimetype, false)} >\n                <i className=\"fas fa-download action mr-2\"></i>\n              </a>\n\n              {!readonly && (<span onClick={() => window.confirm(\"您确定要删除吗 ?\") && deleteDocument(rowIdx)}>\n                <i className=\"fas fa-trash action\"></i>\n              </span>)}\n            </div>\n          );\n        },\n      },\n    ],\n    []\n  );\n\n  const hiddenColumns = embedded\n    ? ['school']\n    : [];\n\n  const {\n    getTableProps,\n    getTableBodyProps,\n    headerGroups,\n    rows,\n    prepareRow,\n  } = useTable({\n    columns,\n    data: documents,\n    disableSortRemove: true,\n    initialState: {\n      hiddenColumns: hiddenColumns,\n      sortBy: [\n        {\n          id: 'createdAt',\n          desc: false\n        }\n      ]\n    },\n  },\n  useSortBy);\n\n  const findByOriginalname = () => {\n    setPage(1);\n    retrieveDocuments();\n  };\n\n  const handlePageChange = (event, value) => {\n    setPage(value);\n  };\n\n  const handlePageSizeChange = (event) => {\n    setPageSize(event.target.value);\n    setPage(1);\n  };\n\n  const download = (id, originalname, mimetype, previewOnly) => {\n    DocumentDataService.getContent(id)\n\t  .then(response => {\n        console.log(response.data);\n\n        const url = window.URL.createObjectURL(new Blob([response.data], { type: mimetype }));\n        const link = document.createElement('a');\n        link.href = url; //+ originalname.substring(originalname.lastIndexOf('.'));\n\n        if (!previewOnly)\n          link.setAttribute('download',\n            originalname\n          );\n\n        document.body.appendChild(link);\n        link.click();\n        link.remove();\n\t  })\n\t  .catch((e) => {\n\t    alert(e);\n        console.log(e);\n      });\n  }\n\n  return (\n    <div className=\"list row\">\n      {!embedded && (<div className=\"col-sm-8\">\n        <h4>附件列表</h4>\n        <div className=\"input-group mb-3\">\n          <input\n            type=\"text\"\n            className=\"form-control\"\n            placeholder=\"Search by originalname\"\n            value={searchOriginalname}\n            onChange={onChangeSearchOriginalname}\n          />\n          <div className=\"input-group-append\">\n            <button\n              className=\"btn btn-outline-secondary\"\n              type=\"button\"\n              onClick={findByOriginalname}\n            >\n              Search\n            </button>\n          </div>\n        </div>\n\n        {\"每页显示行数: \"}\n        <select onChange={handlePageSizeChange} value={pageSize}>\n          {pageSizes.map((size) => (\n            <option key={size} value={size}>\n              {size}\n            </option>\n          ))}\n        </select>\n\n        <Pagination\n          className=\"my-3\"\n          count={count}\n          page={page}\n          siblingCount={1}\n          boundaryCount={1}\n          variant=\"outlined\"\n          shape=\"rounded\"\n          onChange={handlePageChange}\n        />\n      </div>)}\n\n      <div className=\"col-sm-12 list\">\n        <table\n          className=\"table table-striped table-bordered\"\n          {...getTableProps()}\n        >\n          <thead>\n            {headerGroups.map((headerGroup) => (\n              <tr {...headerGroup.getHeaderGroupProps()}>\n                {headerGroup.headers.map((column) => (\n                // Add the sorting props to control sorting. For this example\n                // we can add them into the header props\n                  <th {...column.getHeaderProps(column.getSortByToggleProps())}>\n                    {column.render('Header')}\n                    {/* Add a sort direction indicator */}\n                      <span>\n                        {column.isSorted\n                        ? column.isSortedDesc\n                          ? ' 🔽'\n                          : ' 🔼'\n                        : ''}\n                      </span>\n                    </th>\n                ))}\n              </tr>\n            ))}\n          </thead>\n          <tbody {...getTableBodyProps()}>\n            {rows.map((row, i) => {\n              prepareRow(row);\n              return (\n                <tr {...row.getRowProps()}>\n                  {row.cells.map((cell) => {\n                    return (\n                      <td {...cell.getCellProps()}>{cell.render(\"Cell\")}</td>\n                    );\n                  })}\n                </tr>\n              );\n            })}\n          </tbody>\n        </table>\n      </div>\n\n      <div className=\"col-sm-8\">\n      </div>\n    </div>\n  );\n};\n\nexport default DocumentsList;","import React, { Component } from \"react\";\n\nimport \"bootstrap/dist/css/bootstrap.min.css\";\n\nimport $ from \"jquery\"; //Load jquery\nimport { Link } from \"react-router-dom\";\nimport Divider from '@material-ui/core/Divider';\n\nimport Select from 'react-select';\n\nimport UserDataService from \"../services/auth.service\";\nimport SurveyDataService from \"../services/survey.service\";\nimport SchoolDataService from \"../services/school.service\";\nimport DocumentDataService from \"../services/document.service\";\n\nimport YearPicker from 'react-single-year-picker';\n\nexport default class Survey extends Component {\n  constructor(props) {\n    super(props);\n/**\n    this.onChangeName = this.onChangeName.bind(this);\n    this.onChangeCode = this.onChangeCode.bind(this);\n    this.onChangeDescription = this.onChangeDescription.bind(this);\n    this.onChangePrincipal = this.onChangePrincipal.bind(this);\n    this.onChangeAddress = this.onChangeAddress.bind(this);\n    this.onChangePhone = this.onChangePhone.bind(this);\n    this.onChangeEmail = this.onChangeEmail.bind(this);\n    this.onChangeStudentsCount = this.onChangeStudentsCount.bind(this);\n    this.onChangeTeachersCount = this.onChangeTeachersCount.bind(this);\n    this.onChangeRegion = this.onChangeRegion.bind(this);\n    this.onChangeDocCategory = this.onChangeDocCategory.bind(this);\n\n\n    this.onChangePrincipal = this.onChangePrincipal.bind(this);\n    this.onChangePrincipalCell = this.onChangePrincipalCell.bind(this);\n    this.onChangePrincipalWechat = this.onChangePrincipalWechat.bind(this);\n    this.onChangeSchoolBoardRegisteredName = this.onChangeSchoolBoardRegisteredName.bind(this);\n    this.onChangeSchoolBoard = this.onChangeSchoolBoard.bind(this);\n\n    this.onChangeContact = this.onChangeContact.bind(this);\n    this.onChangeContactCell = this.onChangeContactCell.bind(this);\n    this.onChangeContactWechat = this.onChangeContactWechat.bind(this);\n\n    this.onChangeStage = this.onChangeStage.bind(this);\n    this.onChangeStatus = this.onChangeStatus.bind(this);\n    this.onChangeRequest = this.onChangeRequest.bind(this);\n    this.onChangeCategory = this.onChangeCategory.bind(this);\n*/\n    this.onChangeGenerics = this.onChangeGenerics.bind(this);\n\n    this.getSurvey = this.getSurvey.bind(this);\n    this.updateSurvey = this.updateSurvey.bind(this);\n    this.deleteSurvey = this.deleteSurvey.bind(this);\n    this.onChangeDocFiles = this.onChangeDocFiles.bind(this);\n\n    this.onChangeSchoolId = this.onChangeSchoolId.bind(this);\n    this.onChangePrincipalId = this.onChangePrincipalId.bind(this);\n    this.onChangeContactId = this.onChangeContactId.bind(this);\n\n    this.saveSurvey = this.saveSurvey.bind(this);\n    this.newSurvey = this.newSurvey.bind(this);\n\n    this.state = {\n      currentSurvey: {\n        id: null,\n        schoolId: null,\n        docFiles: [],\n        docCategory: \"\",\n\n        status: \"\",\n        request: \"\",\n        category: \"\",\n        principal: \"\",\n        principalCell: null,\n        principalWechat: null,\n        contact: \"\",\n        contactCell: null,\n        contactWechat: null,\n        schoolBoard: null,\n        schoolBoardRegisteredName: null,\n        region: \"\",\n        city: \"\",\n        county: \"\",\n        community: \"\",\n        address: \"\",\n        phone: \"\",\n        email: \"\",\n        studentsCount: 0,\n        teachersCount: 0,\n        description: \"\",\n        principalId: null,\n        contactId: null,\n\n        stayBehindCount: 0,\n        boarderCount: 0,\n        kClassesCount: 0,\n        g1ClassesCount: 0,\n        g2ClassesCount: 0,\n        g3ClassesCount: 0,\n        g4ClassesCount: 0,\n        g5ClassesCount: 0,\n        g6ClassesCount: 0,\n        kStudentsCount: 0,\n        g1StudentsCount: 0,\n        g2StudentsCount: 0,\n        g3StudentsCount: 0,\n        g4StudentsCount: 0,\n        g5StudentsCount: 0,\n        g6StudentsCount: 0,\n        mStudentsCount: 0,\n        computersCount: 0,\n        computerRoomExists: false,\n        computerRoomCount: 0,\n        internetExists: false,\n        multimediaSystemsCount: 0,\n        libraryExists: false,\n        bookCornersCount: 0,\n        booksCount: 0,\n\n      },\n\n      embedded: false,\n      newsurvey: true,\n      readonly: true,\n      regions: [],\n      docCategories: [],\n\n      users: [],\n\n      schools: [],\n      stages: [],\n      statuses: [],\n      requests: [],\n      categories: [],\n\n      message: \"\",\n      submitted: false\n    };\n  }\n\n  componentDidMount() {\n    const newsurvey = window.location.pathname.includes('add');\n    this.setState({newsurvey: newsurvey});\n\n    //this.setState({readonly: window.location.pathname.includes('View')});\n    const readonly = this.props.match? this.props.match.params.readonly : this.props.readonly;\n    this.setState({readonly: readonly});\n\n    var schoolId = this.props.match? this.props.match.params.schoolId : this.props.schoolId;\n    const id = this.props.match? this.props.match.params.id : this.props.id;\n    schoolId = schoolId ? schoolId : id;\n    this.setState(prevState => ({\n      currentSurvey: {\n        ...prevState.currentSurvey,\n        schoolId: schoolId\n      }\n    }));\n\n    const embedded = this.props.match? this.props.match.params.embedded : this.props.embedded;\n    this.setState({embedded: embedded});\n\n    if (!newsurvey) {\n      this.getSurvey(schoolId);\n    }\n\n    this.getSchools();\n\n    this.getRegions();\n    this.getDocCategories();\n\n    this.getCategories();\n    this.getRequests();\n    this.getStatuses();\n    this.getStages();\n    this.getUsers(schoolId);\n  }\n\n\n  convertUser(users) {\n    const result = [];\n    if (users) {\n    for (var i = 0; i < users.length; i++) {\n      result.push({value: users[i].id,\n        label: users[i].chineseName });\n    }\n    return result;\n    }\n  }\n\n  displayUser(userId) {\n    if (this.state.users) {\n      for (var i = 0; i < this.state.users.length; i++) {\n        if (this.state.users[i].value == userId)\n          return this.state.users[i];\n      }\n      return [];\n    }\n  }\n\n  displayNameUser(userId) {\n    if (this.state.users) {\n      for (var i = 0; i < this.state.users.length; i++) {\n        if (this.state.users[i].value == userId)\n          return this.state.users[i].label ? this.state.users[i].label : '中文名';\n      }\n      return '';\n    }\n  }\n\n  displayNameSchool(schoolId) {\n    if (this.state.schools) {\n      for (var i = 0; i < this.state.schools.length; i++) {\n        if (this.state.schools[i].value == schoolId)\n          return this.state.schools[i].label ? this.state.schools[i].label : '学校名';\n      }\n      return '';\n    }\n  }\n\n  getUsers(schoolId) {\n    //UserDataService.getAll2({schoolId: this.state.currentSurvey.schoolId})\n    UserDataService.getAllSimple({schoolId: schoolId})\n      .then(response => {\n        this.setState({\n          users: this.convertUser(response.data)\n        });\n        console.log(response);\n      })\n      .catch(e => {\n        console.log(e);\n      });\n  }\n\n  getSchools() {\n    SchoolDataService.getAllSimple()\n      .then(response => {\n        this.setState({\n          schools: this.convert(response.data)\n        });\n        console.log(response);\n      })\n      .catch(e => {\n        console.log(e);\n      });\n  }\n\n  getCategories() {\n    SchoolDataService.getCategories()\n      .then(response => {\n        this.setState({\n          categories: response.data\n        });\n        console.log(response);\n      })\n      .catch(e => {\n        console.log(e);\n      });\n  }\n\n  getRequests() {\n    SchoolDataService.getRequests()\n      .then(response => {\n        this.setState({\n          requests: response.data\n        });\n        console.log(response);\n      })\n      .catch(e => {\n        console.log(e);\n      });\n  }\n\n  getStatuses() {\n    SchoolDataService.getStatuses()\n      .then(response => {\n        this.setState({\n          statuses: response.data\n        });\n        console.log(response);\n      })\n      .catch(e => {\n        console.log(e);\n      });\n  }\n\n  getStages() {\n    SchoolDataService.getStages()\n      .then(response => {\n        this.setState({\n          stages: response.data\n        });\n        console.log(response);\n      })\n      .catch(e => {\n        console.log(e);\n      });\n  }\n\n  getRegions() {\n    SchoolDataService.getRegions()\n      .then(response => {\n        this.setState({\n          regions: response.data\n        });\n        console.log(response);\n      })\n      .catch(e => {\n        console.log(e);\n      });\n  }\n\n  getDocCategories() {\n    DocumentDataService.getDocCategories()\n      .then(response => {\n        this.setState({\n          docCategories: response.data\n        });\n        console.log(response);\n      })\n      .catch(e => {\n        console.log(e);\n      });\n  }\n\n  display(schoolId) {\n    if (this.state.schools) {\n      for (var i = 0; i < this.state.schools.length; i++) {\n        if (this.state.schools[i].value == schoolId)\n          return this.state.schools[i];\n      }\n      return [];\n    }\n  }\n\n  convert(schools) {\n    const result = [];\n    if (schools) {\n    for (var i = 0; i < schools.length; i++) {\n      result.push({value: schools[i].id,\n        label: schools[i].code + \"-\" + schools[i].name + \"-\" + schools[i].region});\n    }\n    return result;\n    }\n  }\n\n  onChangeSchoolId(e) {\n    const schoolId = e.value; //.target.value;\n\n    this.setState(prevState => ({\n      currentSurvey: {\n        ...prevState.currentSurvey,\n        schoolId: schoolId\n      }\n    }));\n  }\n\n/**\n  onChangeSchoolBoardRegisteredName(e) {\n    const schoolBoardRegisteredName = e.target.value;\n\n    this.setState(function(prevState) {\n      return {\n        currentSurvey: {\n          ...prevState.currentSurvey,\n          schoolBoardRegisteredName: schoolBoardRegisteredName\n        }\n      };\n    });\n  }\n\n  onChangeSchoolBoard(e) {\n    const schoolBoard = e.target.value;\n\n    this.setState(function(prevState) {\n      return {\n        currentSurvey: {\n          ...prevState.currentSurvey,\n          schoolBoard: schoolBoard\n        }\n      };\n    });\n  }\n\n\n  onChangePrincipal(e) {\n    const principal = e.target.value;\n\n    this.setState(prevState => ({\n      currentSurvey: {\n        ...prevState.currentSurvey,\n        principal: principal\n      }\n    }));\n  }\n\n  onChangePrincipalCell(e) {\n    const principalCell = e.target.value;\n\n    this.setState(prevState => ({\n      currentSurvey: {\n        ...prevState.currentSurvey,\n        principalCell: principalCell\n      }\n    }));\n  }\n\n  onChangePrincipalWechat(e) {\n    const principalWechat = e.target.value;\n\n    this.setState(prevState => ({\n      currentSurvey: {\n        ...prevState.currentSurvey,\n        principalWechat: principalWechat\n      }\n    }));\n  }\n\n  onChangeContact(e) {\n    const contact = e.target.value;\n\n    this.setState(prevState => ({\n      currentSurvey: {\n        ...prevState.currentSurvey,\n        contact: contact\n      }\n    }));\n  }\n\n  onChangeContactCell(e) {\n    const contactCell = e.target.value;\n\n    this.setState(prevState => ({\n      currentSurvey: {\n        ...prevState.currentSurvey,\n        contactCell: contactCell\n      }\n    }));\n  }\n\n  onChangeContactWechat(e) {\n    const contactWechat = e.target.value;\n\n    this.setState(prevState => ({\n      currentSurvey: {\n        ...prevState.currentSurvey,\n        contactWechat: contactWechat\n      }\n    }));\n  }\n\n  onChangeStage(e) {\n    const stage = e.target.value;\n\n    this.setState(prevState => ({\n      currentSurvey: {\n        ...prevState.currentSurvey,\n        stage: stage\n      }\n    }));\n  }\n\n  onChangeStatus(e) {\n    const status = e.target.value;\n\n    this.setState(prevState => ({\n      currentSurvey: {\n        ...prevState.currentSurvey,\n        status: status\n      }\n    }));\n  }\n\n  onChangeRequest(e) {\n    const request = e.target.value;\n\n    this.setState(prevState => ({\n      currentSurvey: {\n        ...prevState.currentSurvey,\n        request: request\n      }\n    }));\n  }\n\n  onChangeCategory(e) {\n    const category = e.target.value;\n\n    this.setState(prevState => ({\n      currentSurvey: {\n        ...prevState.currentSurvey,\n        category: category\n      }\n    }));\n  }\n\n  onChangeName(e) {\n    const name = e.target.value;\n\n    this.setState(function(prevState) {\n      return {\n        currentSurvey: {\n          ...prevState.currentSurvey,\n          name: name\n        }\n      };\n    });\n  }\n\n  onChangeDocCategory(e) {\n    const docCategory = e.target.value;\n\n    this.setState(function(prevState) {\n      return {\n        currentSurvey: {\n          ...prevState.currentSurvey,\n          docCategory: docCategory\n        }\n      };\n    });\n  }\n\n  onChangeCode(e) {\n    const code = e.target.value;\n\n    this.setState(function(prevState) {\n      return {\n        currentSurvey: {\n          ...prevState.currentSurvey,\n          code: code\n        }\n      };\n    });\n  }\n\n  onChangeDescription(e) {\n    const description = e.target.value;\n\n    this.setState(prevState => ({\n      currentSurvey: {\n        ...prevState.currentSurvey,\n        description: description\n      }\n    }));\n  }\n\n  onChangePrincipal(e) {\n    const principal = e.target.value;\n\n    this.setState(prevState => ({\n      currentSurvey: {\n        ...prevState.currentSurvey,\n        principal: principal\n      }\n    }));\n  }\n\n\n  onChangeAddress(e) {\n    const address = e.target.value;\n\n    this.setState(prevState => ({\n      currentSurvey: {\n        ...prevState.currentSurvey,\n        address: address\n      }\n    }));\n  }\n\n  onChangeRegion(e) {\n    const region = e.target.value;\n\n    this.setState(prevState => ({\n      currentSurvey: {\n        ...prevState.currentSurvey,\n        region: region\n      }\n    }));\n  }\n\n  onChangePhone(e) {\n    const phone = e.target.value;\n\n    this.setState(prevState => ({\n      currentSurvey: {\n        ...prevState.currentSurvey,\n        phone: phone\n      }\n    }));\n  }\n\n  onChangeEmail(e) {\n    const email = e.target.value;\n\n    this.setState(prevState => ({\n      currentSurvey: {\n        ...prevState.currentSurvey,\n        email: email\n      }\n    }));\n  }\n\n  onChangeTeachersCount(e) {\n    const teachersCount = e.target.value;\n\n    this.setState(prevState => ({\n      currentSurvey: {\n        ...prevState.currentSurvey,\n        teachersCount: teachersCount\n      }\n    }));\n  }\n\n  onChangeStudentsCount(e) {\n    const studentsCount = e.target.value;\n\n    this.setState(prevState => ({\n      currentSurvey: {\n        ...prevState.currentSurvey,\n        studentsCount: studentsCount\n      }\n    }));\n  }\n*/\n\n  onChangePrincipalId(e) {\n    this.setState(prevState => ({\n      currentSurvey: {\n        ...prevState.currentSurvey,\n        principalId: e.value //.target.value\n      }\n    }));\n  }\n\n  onChangeContactId(e) {\n    this.setState(prevState => ({\n      currentSurvey: {\n        ...prevState.currentSurvey,\n        contactId: e.value //.target.value\n      }\n    }));\n  }\n\n  onChangeGenerics(e) {\n    const name = e.target.name;\n    const type = e.target.type;\n    const value = (type === \"checkbox\") ? e.target.checked : e.target.value;\n\n    this.setState(prevState => ({\n      currentSurvey: {\n        ...prevState.currentSurvey,\n        [name]: value\n      }\n    }));\n  }\n\n  getSurvey(id) {\n    SurveyDataService.get(id)\n      .then(response => {\n        this.setState({\n          currentSurvey: response.data\n        });\n\n        //this.getSurveyPhoto(id);\n        console.log(response.data);\n      })\n      .catch(e => {\n        console.log(e);\n      });\n  }\n\n\n  newSurvey() {\n  this.setState(prevState => ({\n    currentSurvey: {\n      ...prevState.currentSurvey,\n      id: null,\n      name: \"\",\n      code: \"\",\n      description: \"\",\n      principal: \"\",\n\n      region: \"\",\n      address: \"\",\n      phone: \"\",\n      studentsCount: 0,\n      teachersCount: 0,\n      docFiles: [],\n      docCategory: \"\",\n\n      stage: \"\",\n      status: \"\",\n      request: \"\",\n      category: \"\",\n      },\n\n      submitted: false\n    }));\n\n  }\n\n  saveSurvey() {\n\n    SurveyDataService.create(this.state.currentSurvey)\n      .then(response => {\n        this.setState(prevState => ({\n\n          currentSurvey: {\n            ...prevState.currentSurvey,\n            id: response.data.id,\n          },\n\n          message: \"学校信息成功提交!\",\n          submitted: true\n        }));\n\n        if (this.state.currentSurvey.docFiles) // docs\n          this.uploadDocuments();\n\n        console.log(response.data);\n      })\n      .catch(e => {\n        const resMessage =\n          (e.response &&\n            e.response.data &&\n            e.response.data.message) ||\n          e.message ||\n          e.toString();\n\n        this.setState({\n          message: \"学校信息保存失败! \" + resMessage\n        });\n        console.log(e);\n      });\n\n      //$('input[name=\"surveyId\"]').attr('value', this.state.currentSurvey.id );\n      //this.refs.formToSubmit.submit();\n  }\n\n  updateSurvey() {\n\n    SurveyDataService.update(\n      this.state.currentSurvey.schoolId,\n      this.state.currentSurvey\n      //this.state.currentSurvey\n    )\n      .then(response => {\n        console.log(response.data);\n\n        if (this.state.currentSurvey.docFiles) // docs\n          this.uploadDocuments();\n\n        this.setState({\n          message: \"学校信息成功修改!\",\n          submitted: true\n        });\n\n      })\n      .catch(e => {\n        const resMessage =\n          (e.response &&\n            e.response.data &&\n            e.response.data.message) ||\n          e.message ||\n          e.toString();\n\n        this.setState({\n          message: \"学校信息修改失败! \" + resMessage\n        });\n        console.log(e);\n      });\n\n  }\n\n\n  uploadDocuments() {\n    var data = new FormData();\n    for (var i = 0; i < this.state.currentSurvey.docFiles.length; i++) {\n      data.append('multi-files', this.state.currentSurvey.docFiles[i],\n        this.state.currentSurvey.docFiles[i].name);\n    }\n    data.append('docCategory', this.state.currentSurvey.docCategory);\n    SchoolDataService.uploadDocuments(this.state.currentSurvey.schoolId, data)\n    .then(response => {\n      this.setState(prevState => ({\n        message: prevState.message + \" 学校信息附件成功上传!\"\n      }));\n\n      console.log(response.data);\n    })\n    .catch(e => {\n      console.log(e);\n    });\n  }\n\n  deleteSurvey() {\n    SurveyDataService.delete(this.state.currentSurvey.id)\n      .then(response => {\n        console.log(response.data);\n        this.props.history.push('/surveys')\n      })\n      .catch(e => {\n        console.log(e);\n      });\n  }\n\n\n\n  onChangeDocFiles(e) {\n    e.preventDefault();\n    var docFiles = e.target.files;\n    this.setState(prevState => ({\n          currentSurvey: {\n            ...prevState.currentSurvey,\n            docFiles: docFiles\n          }\n        }));\n  }\n\n  renderUpdates() {\n    return (\n            <div>\n            <button\n              className=\"badge badge-danger mr-2\"\n              onClick={this.deleteSurvey}\n            >\n              Delete\n            </button>\n\n            <button\n              type=\"submit\"\n              className=\"badge badge-success\"\n              onClick={this.updateSurvey}\n            >\n              Update\n            </button>\n\n            <p>{this.state.message}</p>\n            </div>\n    );\n  }\n\n  render() {\n    const { currentSurvey } = this.state;\n\n    return (\n      <div>\n        {(this.state.submitted /*&& this.state.newsurvey*/) ? (\n          <div>\n            <h4>{this.state.message}</h4>\n\n            <a href={\"/surveysView/\" + currentSurvey.schoolId} class=\"btn btn-success\">返回</a>\n{/*}\n            <h4>学校信息成功提交!</h4>\n            <button class=\"btn btn-success\" onClick={this.newSurvey}>\n              Add\n            </button>\n*/}\n          </div>\n        ) : (\n          <div class=\"row\">\n            <div class=\"col-sm-3\">\n              <div class=\"row\">\n              {!this.state.embedded &&\n              (<div>\n                <h4>学校详情</h4>\n                <div class=\"form-group\" >\n                  <label htmlFor=\"schoolId\">学校</label>\n                  <Link\n                    to={ \"/schoolsView/\" + currentSurvey.schoolId}\n                    id=\"schoolId\"\n                    name=\"schoolId\"\n                    target=\"_blank\"\n                  >\n                    {this.displayNameSchool(currentSurvey.schoolId)}\n                  </Link>\n                </div>\n\n                <div class=\"form-group\">\n                <label htmlFor=\"schoolBoardRegisteredName\">教育局校名</label>\n                <textarea\n                readonly={this.state.readonly?\"\":false}\n                cols=\"31\"\n                class=\"form-control\"\n                id=\"schoolBoardRegisteredName\"\n                required\n                value={currentSurvey.schoolBoardRegisteredName}\n                onChange={this.onChangeGenerics}\n                name=\"schoolBoardRegisteredName\"\n                />\n                </div>\n\n                <div class=\"form-group\">\n                <label htmlFor=\"schoolBoard\">教育局</label>\n                <textarea\n                readonly={this.state.readonly?\"\":false}\n                cols=\"31\"\n                class=\"form-control\"\n                id=\"schoolBoard\"\n                required\n                value={currentSurvey.schoolBoard}\n                onChange={this.onChangeGenerics}\n                name=\"schoolBoard\"\n                />\n                </div>\n\n                <form ref=\"formToSubmit\"\n                  action=\"http://localhost:8080/api/documents-upload\" method=\"POST\" enctype=\"multipart/form-data\">\n                  <div class=\"form-group input-group\">\n                  <label for=\"input-multi-files\">上传文件:</label>\n                  <input type=\"file\" name=\"multi-files\"\n                  multiple\n                  id=\"input-multi-files\"\n                  class=\"form-control-file border\"\n                  onChange={e => this.onChangeDocFiles(e)}\n                />\n\n                <select\n                  className=\"form-control input-group-append\"\n                  placeholder=\"\"\n                  name=\"docCategory\" id=\"docCategory\"\n                  value={currentSurvey.docCategory}\n                  onChange={e => this.onChangeGenerics(e)}\n                >\n                  <option value=\"\">附件类别</option>\n                  {this.state.docCategories.map((option) => (\n                    <option value={option}>\n                      {option}\n                    </option>\n                  ))}\n                </select>\n                <input type=\"hidden\" name=\"surveyId\" id=\"surveyId\"/>\n                </div>\n                </form>\n\n                <div class=\"w-100\"></div>\n\n                <button onClick={this.saveSurvey}\n                  class=\"btn btn-success\"\n                  hidden={!this.state.newsurvey}>\n                  提交\n                </button>\n                <button hidden={this.state.newsurvey}\n                  type=\"submit\"\n                  className=\"btn btn-success\"\n                  onClick={this.updateSurvey}\n                >\n                  更新\n                </button>\n\n                <p>{this.state.message}</p>\n\n              </div>)}\n\n\n                <div class=\"w-100\"></div>\n\n              </div>\n            </div>\n\n            <div class=\"col-md-9\">\n\n              {!this.state.embedded &&\n              (<div class=\"row\">\n\n                <div class=\"w-100\"></div>\n\n                <div class=\"col-md-4\">\n                </div>\n\n                <div class=\"select-container form-group col-md-4\">\n                <label htmlFor=\"status\">学校状态</label>\n                <select\n                readonly={this.state.readonly?\"\":false}\n                class=\"form-control\"\n                id=\"status\"\n                required\n                value={currentSurvey.status}\n                onChange={this.onChangeGenerics}\n                name=\"status\"\n                >\n                <option value=\"\">{this.state.readonly ? '' : '请选择' }</option>\n                {this.state.statuses.map((option) => (\n                  <option value={option}>{option}</option>\n                ))}\n                </select>\n                </div>\n\n                <div class=\"select-container form-group col-md-4\">\n                <label htmlFor=\"request\">学校需求状态</label>\n                <select\n                readonly={this.state.readonly?\"\":false}\n                class=\"form-control\"\n                id=\"request\"\n                required\n                value={currentSurvey.request}\n                onChange={this.onChangeGenerics}\n                name=\"request\"\n                >\n                <option value=\"\">{this.state.readonly ? '' : '请选择' }</option>\n                {this.state.requests.map((option) => (\n                  <option value={option}>{option}</option>\n                ))}\n                </select>\n                </div>\n\n                <div class=\"w-100\"></div>\n\n                <div class=\"select-container form-group col-md-3\">\n                <label htmlFor=\"region\">省/自治区/直辖市</label>\n                <select\n                readonly={this.state.readonly?\"\":false}\n                class=\"form-control\"\n                id=\"region\"\n                required\n                value={currentSurvey.region}\n                onChange={this.onChangeGenerics}\n                name=\"region\"\n                >\n                <option value=\"\">{this.state.readonly ? '' : '请选择' }</option>\n                {this.state.regions.map((option) => (\n                  <option value={option}>{option}</option>\n                ))}\n                </select>\n                </div>\n\n\n                <div class=\"form-group col-md-3\">\n                <label htmlFor=\"city\">市</label>\n                <input\n                readonly={this.state.readonly?\"\":false}\n                type=\"text\"\n                class=\"form-control\"\n                id=\"city\"\n                required\n                value={currentSurvey.city}\n                onChange={this.onChangeGenerics}\n                name=\"city\"\n                />\n                </div>\n\n                <div class=\"form-group col-md-3\">\n                <label htmlFor=\"county\">区/县</label>\n                <input\n                readonly={this.state.readonly?\"\":false}\n                type=\"text\"\n                class=\"form-control\"\n                id=\"county\"\n                required\n                value={currentSurvey.county}\n                onChange={this.onChangeGenerics}\n                name=\"county\"\n                />\n                </div>\n\n                <div class=\"form-group col-md-3\">\n                <label htmlFor=\"community\">乡/镇</label>\n                <input\n                readonly={this.state.readonly?\"\":false}\n                type=\"text\"\n                class=\"form-control\"\n                id=\"community\"\n                required\n                value={currentSurvey.community}\n                onChange={this.onChangeGenerics}\n                name=\"community\"\n                />\n                </div>\n\n                <div class=\"form-group col-md-12\">\n                <label htmlFor=\"address\">地址</label>\n                <input\n                readonly={this.state.readonly?\"\":false}\n                type=\"text\"\n                class=\"form-control\"\n                id=\"address\"\n                required\n                value={currentSurvey.address}\n                onChange={this.onChangeGenerics}\n                name=\"address\"\n                />\n                </div>\n\n                <div class=\"w-100\"></div>\n\n                <div class=\"form-group col-md-5\">\n                <label htmlFor=\"phone\">学校电话</label>\n                <input\n                readonly={this.state.readonly?\"\":false}\n                type=\"text\"\n                class=\"form-control\"\n                id=\"phone\"\n                required\n                value={currentSurvey.phone}\n                onChange={this.onChangeGenerics}\n                name=\"phone\"\n                />\n                </div>\n\n\n                <div class=\"form-group col-md-5\">\n                <label htmlFor=\"email\">学校电子邮箱</label>\n                <input\n                readonly={this.state.readonly?\"\":false}\n                type=\"text\"\n                class=\"form-control\"\n                id=\"email\"\n                required\n                value={currentSurvey.email}\n                onChange={this.onChangeGenerics}\n                name=\"email\"\n                />\n                </div>\n\n                <div class=\"w-100\"></div>\n\n                <div class=\"form-group col-md-4\">\n                <label htmlFor=\"studentsCount\">学生人数</label>\n                <input\n                readonly={this.state.readonly?\"\":false}\n                type=\"number\"\n                class=\"form-control\"\n                id=\"studentsCount\"\n                required\n                value={currentSurvey.studentsCount}\n                onChange={this.onChangeGenerics}\n                name=\"studentsCount\"\n                />\n                </div>\n\n                <div class=\"form-group col-md-4\">\n                <label htmlFor=\"teachersCount\">教师人数</label>\n                <input\n                readonly={this.state.readonly?\"\":false}\n                type=\"number\"\n                class=\"form-control\"\n                id=\"teachersCount\"\n                required\n                value={currentSurvey.teachersCount}\n                onChange={this.onChangeGenerics}\n                name=\"teachersCount\"\n                />\n                </div>\n\n                <div class=\"select-container form-group col-md-4\">\n                <label htmlFor=\"category\">学校类型</label>\n                <select\n                readonly={this.state.readonly?\"\":false}\n                class=\"form-control\"\n                id=\"category\"\n                required\n                value={currentSurvey.category}\n                onChange={this.onChangeGenerics}\n                name=\"category\"\n                >\n                <option value=\"\">{this.state.readonly ? '' : '请选择' }</option>\n                {this.state.categories.map((option) => (\n                  <option value={option}>{option}</option>\n                ))}\n                </select>\n                </div>\n\n                <div class=\"w-100\"></div>\n\n                <div class=\"form-group col-md-4\">\n                  <label htmlFor=\"principalId\">校长</label>\n                  {!this.state.readonly\n                  ? (<Select onChange={this.onChangePrincipalId.bind(this)}\n                    readonly={this.state.readonly?\"\":false}\n                    class=\"form-control\"\n                    id=\"principalId\"\n                    value={this.displayUser(currentSurvey.principalId)}\n                    name=\"principalId\"\n                    options={this.state.users}\n                  />)\n                  : (<Link\n                    to={ \"/usersView/\" + currentSurvey.principalId}\n                    id=\"principalId\"\n                    name=\"principalId\"\n                  >\n                    {this.displayNameUser(currentSurvey.principalId)}\n                  </Link>)}\n                </div>\n\n                <div class=\"form-group col-md-4\">\n                  <label htmlFor=\"contactId\">联络人</label>\n                  {!this.state.readonly\n                  ? (<Select onChange={this.onChangeContactId.bind(this)}\n                    readonly={this.state.readonly?\"\":false}\n                    class=\"form-control\"\n                    id=\"contactId\"\n                    value={this.displayUser(currentSurvey.contactId)}\n                    name=\"contactId\"\n                    options={this.state.users}\n                  />)\n                  : (<Link\n                    to={ \"/usersView/\" + currentSurvey.contactId}\n                    id=\"contactId\"\n                    name=\"contactId\"\n                  >\n                    {this.displayNameUser(currentSurvey.contactId)}\n                  </Link>)}\n                </div>\n\n                <div class=\"w-100\"></div>\n\n                <div class=\"form-group col-md-12\">\n                <label htmlFor=\"description\">简介</label>\n                <textarea\n                readonly={this.state.readonly?\"\":false}\n                class=\"form-control\"\n                id=\"description\"\n                required\n                value={currentSurvey.description}\n                onChange={this.onChangeGenerics}\n                name=\"description\"\n                />\n                </div>\n\n              </div>)}\n\n\n              <div class=\"row\">\n                <div class=\"w-100\"></div>\n\n                <div class=\"form-group col-md-2\">\n                <label htmlFor=\"stayBehindCount\">留守儿童人数</label>\n                <input\n                readonly={this.state.readonly?\"\":false}\n                type=\"number\"\n                class=\"form-control\"\n                id=\"stayBehindCount\"\n                required\n                value={currentSurvey.stayBehindCount}\n                onChange={this.onChangeGenerics}\n                name=\"stayBehindCount\"\n                />\n                </div>\n\n                <div class=\"form-group col-md-2\">\n                <label htmlFor=\"boarderCount\">学生住宿人数</label>\n                <input\n                readonly={this.state.readonly?\"\":false}\n                type=\"number\"\n                class=\"form-control\"\n                id=\"boarderCount\"\n                required\n                value={currentSurvey.boarderCount}\n                onChange={this.onChangeGenerics}\n                name=\"boarderCount\"\n                />\n                </div>\n\n                <div class=\"form-group col-md-2\">\n                <label htmlFor=\"kClassesCount\">学前班级数</label>\n                <input\n                readonly={this.state.readonly?\"\":false}\n                type=\"number\"\n                class=\"form-control\"\n                id=\"kClassesCount\"\n                required\n                value={currentSurvey.kClassesCount}\n                onChange={this.onChangeGenerics}\n                name=\"kClassesCount\"\n                />\n                </div>\n\n                <div class=\"form-group col-md-2\">\n                <label htmlFor=\"kStudentsCount\">学前学生数</label>\n                <input\n                readonly={this.state.readonly?\"\":false}\n                type=\"number\"\n                class=\"form-control\"\n                id=\"kStudentsCount\"\n                required\n                value={currentSurvey.kStudentsCount}\n                onChange={this.onChangeGenerics}\n                name=\"kStudentsCount\"\n                />\n                </div>\n\n                <div class=\"form-group col-md-2\">\n                <label htmlFor=\"mStudentsCount\">初中学生数</label>\n                <input\n                readonly={this.state.readonly?\"\":false}\n                type=\"number\"\n                class=\"form-control\"\n                id=\"mStudentsCount\"\n                required\n                value={currentSurvey.mStudentsCount}\n                onChange={this.onChangeGenerics}\n                name=\"mStudentsCount\"\n                />\n                </div>\n\n                <div class=\"w-100\"></div>\n\n                <div class=\"form-group col-md-2\">\n                <label htmlFor=\"g1ClassesCount\">一年级班级数</label>\n                <input\n                readonly={this.state.readonly?\"\":false}\n                type=\"number\"\n                class=\"form-control\"\n                id=\"g1ClassesCount\"\n                required\n                value={currentSurvey.g1ClassesCount}\n                onChange={this.onChangeGenerics}\n                name=\"g1ClassesCount\"\n                />\n                </div>\n\n                <div class=\"form-group col-md-2\">\n                <label htmlFor=\"g2ClassesCount\">二年级班级数</label>\n                <input\n                readonly={this.state.readonly?\"\":false}\n                type=\"number\"\n                class=\"form-control\"\n                id=\"g2ClassesCount\"\n                required\n                value={currentSurvey.g2ClassesCount}\n                onChange={this.onChangeGenerics}\n                name=\"g2ClassesCount\"\n                />\n                </div>\n\n                <div class=\"form-group col-md-2\">\n                <label htmlFor=\"g3ClassesCount\">三年级班级数</label>\n                <input\n                readonly={this.state.readonly?\"\":false}\n                type=\"number\"\n                class=\"form-control\"\n                id=\"g3ClassesCount\"\n                required\n                value={currentSurvey.g3ClassesCount}\n                onChange={this.onChangeGenerics}\n                name=\"g3ClassesCount\"\n                />\n                </div>\n\n                <div class=\"form-group col-md-2\">\n                <label htmlFor=\"g4ClassesCount\">四年级班级数</label>\n                <input\n                readonly={this.state.readonly?\"\":false}\n                type=\"number\"\n                class=\"form-control\"\n                id=\"g4ClassesCount\"\n                required\n                value={currentSurvey.g4ClassesCount}\n                onChange={this.onChangeGenerics}\n                name=\"g4ClassesCount\"\n                />\n                </div>\n\n                <div class=\"form-group col-md-2\">\n                <label htmlFor=\"g5ClassesCount\">五年级班级数</label>\n                <input\n                readonly={this.state.readonly?\"\":false}\n                type=\"number\"\n                class=\"form-control\"\n                id=\"g5ClassesCount\"\n                required\n                value={currentSurvey.g5ClassesCount}\n                onChange={this.onChangeGenerics}\n                name=\"g5ClassesCount\"\n                />\n                </div>\n\n                <div class=\"form-group col-md-2\">\n                <label htmlFor=\"g6ClassesCount\">六年级班级数</label>\n                <input\n                readonly={this.state.readonly?\"\":false}\n                type=\"number\"\n                class=\"form-control\"\n                id=\"g6ClassesCount\"\n                required\n                value={currentSurvey.g6ClassesCount}\n                onChange={this.onChangeGenerics}\n                name=\"g6ClassesCount\"\n                />\n                </div>\n\n                <div class=\"w-100\"></div>\n\n\n                <div class=\"form-group col-md-2\">\n                <label htmlFor=\"g1StudentsCount\">一年级学生数</label>\n                <input\n                readonly={this.state.readonly?\"\":false}\n                type=\"number\"\n                class=\"form-control\"\n                id=\"g1StudentsCount\"\n                required\n                value={currentSurvey.g1StudentsCount}\n                onChange={this.onChangeGenerics}\n                name=\"g1StudentsCount\"\n                />\n                </div>\n\n                <div class=\"form-group col-md-2\">\n                <label htmlFor=\"g2StudentsCount\">二年级学生数</label>\n                <input\n                readonly={this.state.readonly?\"\":false}\n                type=\"number\"\n                class=\"form-control\"\n                id=\"g2StudentsCount\"\n                required\n                value={currentSurvey.g2StudentsCount}\n                onChange={this.onChangeGenerics}\n                name=\"g2StudentsCount\"\n                />\n                </div>\n\n                <div class=\"form-group col-md-2\">\n                <label htmlFor=\"g3StudentsCount\">三年级学生数</label>\n                <input\n                readonly={this.state.readonly?\"\":false}\n                type=\"number\"\n                class=\"form-control\"\n                id=\"g3StudentsCount\"\n                required\n                value={currentSurvey.g3StudentsCount}\n                onChange={this.onChangeGenerics}\n                name=\"g3StudentsCount\"\n                />\n                </div>\n\n                <div class=\"form-group col-md-2\">\n                <label htmlFor=\"g4StudentsCount\">四年级学生数</label>\n                <input\n                readonly={this.state.readonly?\"\":false}\n                type=\"number\"\n                class=\"form-control\"\n                id=\"g4StudentsCount\"\n                required\n                value={currentSurvey.g4StudentsCount}\n                onChange={this.onChangeGenerics}\n                name=\"g4StudentsCount\"\n                />\n                </div>\n\n                <div class=\"form-group col-md-2\">\n                <label htmlFor=\"g5StudentsCount\">五年级学生数</label>\n                <input\n                readonly={this.state.readonly?\"\":false}\n                type=\"number\"\n                class=\"form-control\"\n                id=\"g5StudentsCount\"\n                required\n                value={currentSurvey.g5StudentsCount}\n                onChange={this.onChangeGenerics}\n                name=\"g5StudentsCount\"\n                />\n                </div>\n\n                <div class=\"form-group col-md-2\">\n                <label htmlFor=\"g6StudentsCount\">六年级学生数</label>\n                <input\n                readonly={this.state.readonly?\"\":false}\n                type=\"number\"\n                class=\"form-control\"\n                id=\"g6StudentsCount\"\n                required\n                value={currentSurvey.g6StudentsCount}\n                onChange={this.onChangeGenerics}\n                name=\"g6StudentsCount\"\n                />\n                </div>\n\n                <div class=\"form-group col-md-2\">\n                <label htmlFor=\"internetExists\">可否上网</label>\n                <input\n                disabled={this.state.readonly?\"disabled\":false}\n                type=\"checkbox\"\n                class=\"form-control\"\n                id=\"internetExists\"\n                required\n                checked={currentSurvey.internetExists}\n                onChange={this.onChangeGenerics}\n                name=\"internetExists\"\n                />\n                </div>\n\n                <div class=\"form-group col-md-2\">\n                <label htmlFor=\"computerRoomExists\">是否有电脑室</label>\n                <input\n                disabled={this.state.readonly?\"disabled\":false}\n                type=\"checkbox\"\n                class=\"form-control\"\n                id=\"computerRoomExists\"\n                required\n                checked={currentSurvey.computerRoomExists}\n                onChange={this.onChangeGenerics}\n                name=\"computerRoomExists\"\n                />\n                </div>\n\n                <div class=\"form-group col-md-2\">\n                <label htmlFor=\"computerRoomCount\">电脑室电脑数</label>\n                <input\n                readonly={this.state.readonly?\"\":false}\n                type=\"number\"\n                class=\"form-control\"\n                id=\"computerRoomCount\"\n                required\n                value={currentSurvey.computerRoomCount}\n                onChange={this.onChangeGenerics}\n                name=\"computerRoomCount\"\n                />\n                </div>\n\n                <div class=\"form-group col-md-2\">\n                <label htmlFor=\"computersCount\">办公电脑数</label>\n                <input\n                readonly={this.state.readonly?\"\":false}\n                type=\"number\"\n                class=\"form-control\"\n                id=\"computersCount\"\n                required\n                value={currentSurvey.computersCount}\n                onChange={this.onChangeGenerics}\n                name=\"computersCount\"\n                />\n                </div>\n\n                <div class=\"form-group col-md-2\">\n                <label htmlFor=\"multimediaSystemsCount\">多媒体一体机数</label>\n                <input\n                readonly={this.state.readonly?\"\":false}\n                type=\"number\"\n                class=\"form-control\"\n                id=\"multimediaSystemsCount\"\n                required\n                value={currentSurvey.multimediaSystemsCount}\n                onChange={this.onChangeGenerics}\n                name=\"multimediaSystemsCount\"\n                />\n                </div>\n\n                <div class=\"w-100\"></div>\n\n                <div class=\"form-group col-md-2\">\n                <label htmlFor=\"libraryExists\">是否有图书室</label>\n                <input\n                disabled={this.state.readonly?\"disabled\":false}\n                type=\"checkbox\"\n                class=\"form-control\"\n                id=\"libraryExists\"\n                required\n                checked={currentSurvey.libraryExists}\n                onChange={this.onChangeGenerics}\n                name=\"libraryExists\"\n                />\n                </div>\n\n                <div class=\"form-group col-md-2\">\n                <label htmlFor=\"bookCornersCount\">图书角数量</label>\n                <input\n                readonly={this.state.readonly?\"\":false}\n                type=\"number\"\n                class=\"form-control\"\n                id=\"bookCornersCount\"\n                required\n                value={currentSurvey.bookCornersCount}\n                onChange={this.onChangeGenerics}\n                name=\"bookCornersCount\"\n                />\n                </div>\n\n                <div class=\"form-group col-md-2\">\n                <label htmlFor=\"booksCount\">图书册数</label>\n                <input\n                readonly={this.state.readonly?\"\":false}\n                type=\"number\"\n                class=\"form-control\"\n                id=\"booksCount\"\n                required\n                value={currentSurvey.booksCount}\n                onChange={this.onChangeGenerics}\n                name=\"booksCount\"\n                />\n                </div>\n\n              </div>\n            </div>\n\n            <div class=\"w-100\"></div>\n\n          </div>\n        ) }\n      </div>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport DossierDataService from \"../services/dossier.service\";\nimport { Link } from \"react-router-dom\";\nimport Pagination from \"@material-ui/lab/Pagination\";\n\nimport { useState, useEffect, useMemo, useRef } from \"react\";\nimport { useTable, useSortBy } from \"react-table\";\n\nconst DossiersList = (props) => {\n  const [dossiers, setDossiers] = useState([]);\n  const [currentDossier, setCurrentDossier] = useState(null);\n  const [currentIndex, setCurrentIndex] = useState(-1);\n  const [searchOriginalname, setSearchOriginalname] = useState(\"\");\n  const [projectId, setProjectId] = useState(props.match? props.match.params.projectId : props.projectId);\n  const [docCategory, setDocCategory] = useState(props.match? props.match.params.docCategory : props.docCategory);\n\n  const [readonly, setReadonly] = useState(props.readonly ? props.readonly : false);\n\n  const [embedded, setEmbedded] = useState(props.embedded ? props.embedded : false);\n\n  const dossiersRef = useRef();\n  dossiersRef.current = dossiers;\n\n  const [page, setPage] = useState(1);\n  const [count, setCount] = useState(0);\n  const [pageSize, setPageSize] = useState(5);\n\n  const pageSizes = [5, 10, 20];\n\n  const onChangeSearchOriginalname = (e) => {\n    const searchOriginalname = e.target.value;\n    setSearchOriginalname(searchOriginalname);\n  };\n\n  const getRequestParams = (/*searchOriginalname, page, pageSize, projectId, docCategory*/) => {\n    let params = {};\n\n    if (searchOriginalname) {\n      params[\"originalname\"] = searchOriginalname;\n    }\n\n    if (page) {\n      params[\"page\"] = page - 1;\n    }\n\n    if (pageSize) {\n      params[\"size\"] = pageSize;\n    }\n\n    if (projectId) {\n      params[\"projectId\"] = projectId;\n    }\n\n    if (docCategory) {\n      params[\"docCategory\"] = docCategory;\n    }\n\n    return params;\n  };\n\n  const retrieveDossiers = () => {\n    const params = getRequestParams(/*searchOriginalname, page, pageSize, projectId, docCategory*/);\n\n    DossierDataService.getAll2(params)\n      .then((response) => {\n        const { dossiers, totalPages } = response.data;\n\n        setDossiers(dossiers);\n        setCount(totalPages);\n\n        console.log(response.data);\n      })\n      .catch((e) => {\n        console.log(e);\n      });\n  };\n\n  useEffect(retrieveDossiers, [page, pageSize]);\n\n  const refreshList = () => {\n    retrieveDossiers();\n  };\n\n  const removeAllDossiers = () => {\n    DossierDataService.deleteAll()\n      .then((response) => {\n        console.log(response.data);\n        refreshList();\n      })\n      .catch((e) => {\n        console.log(e);\n      });\n  };\n\n\n  const openDossier = (rowIndex) => {\n    const id = dossiersRef.current[rowIndex].id;\n\n    props.history.push(\"/dossiers/\" + id);\n  };\n\n  const deleteDossier = (rowIndex) => {\n    const id = dossiersRef.current[rowIndex].id;\n\n    DossierDataService.delete(id)\n      .then((response) => {\n        //props.history.push(\"/dossiers\");\n\n        let newDossiers = [...dossiersRef.current];\n        newDossiers.splice(rowIndex, 1);\n\n        setDossiers(newDossiers);\n      })\n      .catch((e) => {\n        console.log(e);\n      });\n  };\n\n  const columns = useMemo(\n    () => [\n      {\n        Header: \"时间\",\n        accessor: \"createdAt\",\n        Cell: (props) => {\n          const rowIdx = props.row.id;\n          const d = new Date(dossiersRef.current[rowIdx].createdAt);\n          return (\n            <div>\n              {d.toLocaleDateString('zh-cn', { hour12: true, hour: \"2-digit\", minute: \"2-digit\", second: \"2-digit\" })}\n            </div>\n          );\n        },\n      },\n      {\n        Header: \"文档名\",\n        accessor: \"originalname\",\n      },\n      {\n        Header: \"类别\",\n        accessor: \"docCategory\",\n      },\n      {\n        Header: \"操作\",\n        accessor: \"actions\",\n        disableSortBy: true,\n        Cell: (props) => {\n          const rowIdx = props.row.id;\n          return (\n            <div>\n              {(dossiersRef.current[rowIdx].mimetype.startsWith('image') ||\n                dossiersRef.current[rowIdx].mimetype.indexOf('pdf') > 0) && (\n              <a href=\"#\" onClick={() => download(dossiersRef.current[rowIdx].id,\n                                                dossiersRef.current[rowIdx].originalname,\n                                                dossiersRef.current[rowIdx].mimetype, true)} >\n                <i className=\"fas fa-eye action mr-2\"></i>\n              </a>\n              )}\n\n              <a href=\"#\" onClick={() => download(dossiersRef.current[rowIdx].id,\n                                                dossiersRef.current[rowIdx].originalname,\n                                                dossiersRef.current[rowIdx].mimetype, false)} >\n                <i className=\"fas fa-download action mr-2\"></i>\n              </a>\n\n              {!readonly && (<span onClick={() => window.confirm(\"您确定要删除吗 ?\") && deleteDossier(rowIdx)}>\n                <i className=\"fas fa-trash action\"></i>\n              </span>)}\n            </div>\n          );\n        },\n      },\n    ],\n    []\n  );\n\n  const {\n    getTableProps,\n    getTableBodyProps,\n    headerGroups,\n    rows,\n    prepareRow,\n  } = useTable({\n    columns,\n    data: dossiers,\n    disableSortRemove: true,\n  },\n  useSortBy);\n\n  const findByOriginalname = () => {\n    setPage(1);\n    retrieveDossiers();\n  };\n\n  const handlePageChange = (event, value) => {\n    setPage(value);\n  };\n\n  const handlePageSizeChange = (event) => {\n    setPageSize(event.target.value);\n    setPage(1);\n  };\n\n  const download = (id, originalname, mimetype, previewOnly) => {\n    DossierDataService.getContent(id)\n\t  .then(response => {\n        console.log(response.data);\n\n        const url = window.URL.createObjectURL(new Blob([response.data], { type: mimetype }));\n        const link = document.createElement('a');\n        link.href = url;\n        if (!previewOnly)\n          link.setAttribute('download',\n            originalname\n          ); //or any other extension\n        document.body.appendChild(link);\n        link.click();\n        link.remove();\n\t  })\n\t  .catch((e) => {\n\t  alert(e);\n        console.log(e);\n      });\n  }\n\n  return (\n    <div className=\"list row\">\n      {!embedded && (<div className=\"col-sm-8\">\n        <h4>附件列表</h4>\n        <div className=\"input-group mb-3\">\n          <input\n            type=\"text\"\n            className=\"form-control\"\n            placeholder=\"Search by originalname\"\n            value={searchOriginalname}\n            onChange={onChangeSearchOriginalname}\n          />\n          <div className=\"input-group-append\">\n            <button\n              className=\"btn btn-outline-secondary\"\n              type=\"button\"\n              onClick={findByOriginalname}\n            >\n              Search\n            </button>\n          </div>\n        </div>\n\n        {\"每页显示行数: \"}\n        <select onChange={handlePageSizeChange} value={pageSize}>\n          {pageSizes.map((size) => (\n            <option key={size} value={size}>\n              {size}\n            </option>\n          ))}\n        </select>\n\n        <Pagination\n          className=\"my-3\"\n          count={count}\n          page={page}\n          siblingCount={1}\n          boundaryCount={1}\n          variant=\"outlined\"\n          shape=\"rounded\"\n          onChange={handlePageChange}\n        />\n      </div>)}\n\n      <div className=\"col-sm-12 list\">\n\n        <table\n          className=\"table table-striped table-bordered\"\n          {...getTableProps()}\n        >\n          <thead>\n            {headerGroups.map((headerGroup) => (\n              <tr {...headerGroup.getHeaderGroupProps()}>\n                {headerGroup.headers.map((column) => (\n                // Add the sorting props to control sorting. For this example\n                // we can add them into the header props\n                  <th {...column.getHeaderProps(column.getSortByToggleProps())}>\n                    {column.render('Header')}\n                    {/* Add a sort direction indicator */}\n                    <span>\n                      {column.isSorted\n                      ? column.isSortedDesc\n                        ? ' 🔽'\n                        : ' 🔼'\n                      : ''}\n                    </span>\n                  </th>\n                ))}\n              </tr>\n            ))}\n          </thead>\n          <tbody {...getTableBodyProps()}>\n            {rows.map((row, i) => {\n              prepareRow(row);\n              return (\n                <tr {...row.getRowProps()}>\n                  {row.cells.map((cell) => {\n                    return (\n                      <td {...cell.getCellProps()}>{cell.render(\"Cell\")}</td>\n                    );\n                  })}\n                </tr>\n              );\n            })}\n          </tbody>\n        </table>\n      </div>\n\n      <div className=\"col-sm-8\">\n      </div>\n    </div>\n  );\n};\n\nexport default DossiersList;","import http from \"../http-common\";\nimport authHeader from './auth-header';\n\nclass CommentDataService {\n\n  getAll2(data) {\n    return http.post(\"/comments/all\", data, { headers: authHeader() });\n  }\n\n  getAll(params) {\n    return http.get(\"/comments\", { params }, { headers: authHeader() });\n      /**\n    return http.get(\"/comments\", {\n        params: { params } ,\n        headers: authHeader()\n      }\n    );\n    */\n  }\n\n/**\n  getAll() {\n    return http.get(\"/comments\", { headers: authHeader() });\n  }\n*/\n\n  get(id) {\n    return http.get(`/comments/${id}`, { headers: authHeader() });\n  }\n\n  getContent(id) {\n    const user = JSON.parse(localStorage.getItem('user'));\n    return http.get(`/commentsContent/${id}`, {\n        headers: {\n          'x-access-token':  (user && user.accessToken) ? user.accessToken : null\n        },\n        responseType: 'arraybuffer'\n      });\n  }\n\n  getDocCategories() {\n    return http.get(`/comments/categories`, { headers: authHeader() });\n  }\n\n  getCount(id) {\n    return http.get(`/commentsCount/${id}`, { headers: authHeader() });\n  }\n\n  create(data) {\n    return http.post(\"/comments\", data, { headers: authHeader() });\n  }\n\n  update(id, data) {\n    return http.put(`/comments/${id}`, data, { headers: authHeader() });\n  }\n\n  delete(id) {\n    return http.delete(`/comments/${id}`, { headers: authHeader() });\n  }\n\n  deleteAll() {\n    return http.delete(`/comments`, { headers: authHeader() });\n  }\n\n  findByTitle(title) {\n    return http.get(`/comments?title=${title}`, { headers: authHeader() });\n  }\n}\n\nexport default new CommentDataService();\n","import React, { Component } from \"react\";\nimport CommentDataService from \"../services/comment.service\";\nimport AuthService from \"../services/auth.service\";\n\nimport { Link } from \"react-router-dom\";\nimport Pagination from \"@material-ui/lab/Pagination\";\n\nimport { useState, useEffect, useMemo, useRef } from \"react\";\nimport { useTable, useFlexLayout, useBlockLayout, useResizeColumns, useSortBy } from \"react-table\";\n\nconst CommentsList = (props) => {\n  const [comments, setComments] = useState([]);\n  const [currentComment, setCurrentComment] = useState(null);\n  const [currentIndex, setCurrentIndex] = useState(-1);\n  const [text, setText] = useState(\"\");\n  const [searchText, setSearchText] = useState(\"\");\n  const [schoolId, setSchoolId] = useState(props.match? props.match.params.schoolId : props.schoolId);\n  const [userId, setUserId] = useState(AuthService.getCurrentUser() ? AuthService.getCurrentUser().id : null);\n\n  const [orderby, setOrderby] = useState([]);\n\n  const [readonly, setReadonly] = useState(props.readonly ? props.readonly : false);\n\n  const commentsRef = useRef();\n  commentsRef.current = comments;\n\n  const [page, setPage] = useState(1);\n  const [count, setCount] = useState(0);\n  const [pageSize, setPageSize] = useState(5);\n\n  const pageSizes = [5, 10, 20];\n\n  const onChangeText = (e) => {\n    const text = e.target.value;\n    setText(text);\n  };\n\n  const onChangeSearchText = (e) => {\n    const searchText = e.target.value;\n    setSearchText(searchText);\n  };\n\n  const getRequestParams = (/*searchText, page, pageSize, schoolId, orderby*/) => {\n    let params = {};\n\n    if (searchText) {\n      params[\"text\"] = searchText;\n    }\n\n    if (page) {\n      params[\"page\"] = page - 1;\n    }\n\n    if (pageSize) {\n      params[\"size\"] = pageSize;\n    }\n\n    if (schoolId) {\n      params[\"schoolId\"] = schoolId;\n    }\n\n    if (orderby) {\n      params[\"orderby\"] = orderby;\n    }\n\n    return params;\n  };\n\n  const retrieveComments = () => {\n    const params = getRequestParams(/*searchText, page, pageSize, schoolId, orderby*/);\n\n    CommentDataService.getAll2(params)\n      .then((response) => {\n        const { comments, totalPages } = response.data;\n\n        setComments(comments);\n        setCount(totalPages);\n\n        console.log(response.data);\n      })\n      .catch((e) => {\n        console.log(e);\n      });\n  };\n\n  useEffect(retrieveComments, [page, pageSize, orderby]);\n\n  const refreshList = () => {\n    retrieveComments();\n    setText(\"\");\n  };\n\n\n  const save = (e) => {\n\n    var data = {\n      text: text,\n      userId: userId,\n      schoolId: schoolId\n    };\n\n    CommentDataService.create(data)\n      .then(response => {\n        refreshList();\n        console.log(response.data);\n      })\n      .catch(e => {\n        console.log(e);\n      });\n  }\n\n  const removeAllComments = () => {\n    CommentDataService.deleteAll()\n      .then((response) => {\n        console.log(response.data);\n        refreshList();\n      })\n      .catch((e) => {\n        console.log(e);\n      });\n  };\n\n  const deleteComment = (rowIndex) => {\n    const id = commentsRef.current[rowIndex].id;\n\n    CommentDataService.delete(id)\n      .then((response) => {\n        //props.history.push(\"/comments\");\n\n        let newComments = [...commentsRef.current];\n        newComments.splice(rowIndex, 1);\n\n        setComments(newComments);\n      })\n      .catch((e) => {\n        console.log(e);\n      });\n  };\n\n  const columns = useMemo(\n    () => [\n      {\n        Header: \"评论\",\n        accessor: \"text\",\n        maxWidth: 400,\n        minWidth: 140,\n        width: 300,\n        disableSortBy: true,\n      },\n      {\n        Header: \"时间\",\n        accessor: \"createdAt\",\n        maxWidth: 50,\n        minWidth: 10,\n        width: 50,\n        Cell: (props) => {\n          const rowIdx = props.row.id;\n            const d = new Date(commentsRef.current[rowIdx].createdAt);\n            return (\n              <div>\n                {d.toLocaleDateString('zh-cn', { hour12: true, hour: \"2-digit\", minute: \"2-digit\", second: \"2-digit\" })}\n              </div>\n            );\n        }\n      },\n      {\n        Header: \"评论人\",\n        accessor: 'user.username',\n        maxWidth: 40,\n        minWidth: 10,\n        width: 40,\n        Cell: (props) => {\n          const rowIdx = props.row.id;\n          return (\n            <div>\n            { (commentsRef.current[rowIdx].user) ? (\n              <Link\n                to={\"/usersView/\" + commentsRef.current[rowIdx].user.id}\n                className=\"badge badge-success\"\n              >\n                {commentsRef.current[rowIdx].user.chineseName\n                  ? commentsRef.current[rowIdx].user.chineseName\n                  : commentsRef.current[rowIdx].user.username\n                }\n              </Link>\n            ) : ''}\n            </div>\n          );\n        },\n      },\n      {\n        Header: \"删除\",\n        accessor: \"actions\",\n        maxWidth: 30,\n        minWidth: 10,\n        width: 20,\n        disableSortBy: true,\n        Cell: (props) => {\n          const rowIdx = props.row.id;\n          return (\n            <div>\n              {!readonly && (<span onClick={() => window.confirm(\"您确定要删除吗 ?\") && deleteComment(rowIdx)}>\n                <i className=\"fas fa-trash action\"></i>\n              </span>)}\n            </div>\n          );\n        },\n      },\n    ],\n    []\n  );\n\n  const defaultColumn = React.useMemo(\n    () => ({\n      minWidth: 30,\n      width: 150,\n      maxWidth: 400,\n    }),\n    []\n  );\n\n  const {\n    getTableProps,\n    getTableBodyProps,\n    headerGroups,\n    rows,\n    prepareRow,\n    //state,\n    //resetResizing,\n    state: {sortBy},\n  } = useTable({\n    columns,\n    data: comments,\n    //defaultColumn,\n    disableSortRemove: true,\n    manualSortBy: true,\n    initialState: {\n      sortBy: [\n        {\n          id: 'createdAt',\n          desc: true\n        }\n      ]\n    },\n  },\n  //useBlockLayout,\n  useFlexLayout,\n  //useResizeColumns,\n  useSortBy);\n\n  const search = () => {\n    setPage(1);\n    retrieveComments();\n  };\n\n  const handlePageChange = (event, value) => {\n    setPage(value);\n  };\n\n  const handlePageSizeChange = (event) => {\n    setPageSize(event.target.value);\n    setPage(1);\n  };\n\n  useEffect(() => {\n    if (sortBy && sortBy[0])\n      setOrderby(sortBy);\n  }, [sortBy]);\n\n  return (\n    <div className=\"list row\">\n\n      <div class=\"form-group col-sm-12\" >\n        <label htmlFor=\"text\"><h4>评论</h4></label>\n        <textarea\n          rows=\"4\"\n          class=\"form-control\"\n          id=\"text\"\n          name=\"text\"\n          value={text}\n          onChange={onChangeText}\n        />\n        <button className=\"btn btn-primary badge-success mb-5\" onClick={save}>\n          提交\n        </button>\n      </div>\n\n      <div class=\"w-100\"></div>\n\n\n      <div className=\"col-sm-6\">\n        <h6>评论列表</h6>\n        <div className=\"input-group mb-3\">\n          <input\n            type=\"text\"\n            className=\"form-control\"\n            placeholder=\"搜索 。。。\"\n            value={searchText}\n            onChange={onChangeSearchText}\n          />\n          <div className=\"input-group-append\">\n            <button\n              className=\"btn btn-outline-secondary\"\n              type=\"button\"\n              onClick={search}\n            >\n              查找\n            </button>\n          </div>\n        </div>\n\n        <div className=\"col-sm-6 mt-3\">\n          {\"每页显示行数: \"}\n          <select onChange={handlePageSizeChange} value={pageSize}>\n            {pageSizes.map((size) => (\n              <option key={size} value={size}>\n                {size}\n              </option>\n            ))}\n          </select>\n\n          <Pagination\n            className=\"my-3\"\n            count={count}\n            page={page}\n            siblingCount={1}\n            boundaryCount={1}\n            variant=\"outlined\"\n            shape=\"rounded\"\n            onChange={handlePageChange}\n          />\n        </div>\n      </div>\n\n      <div class=\"w-100\"></div>\n\n      <div className=\"col-sm-12 list\">\n        <table\n          className=\"table table-striped table-bordered\"\n          {...getTableProps()}\n        >\n          <thead>\n            {headerGroups.map((headerGroup) => (\n              <tr {...headerGroup.getHeaderGroupProps()}>\n                {headerGroup.headers.map((column) => (\n                // Add the sorting props to control sorting. For this example\n                // we can add them into the header props\n                <th {...column.getHeaderProps(column.getSortByToggleProps(), {\n                /*\n                  style: {\n                      minWidth: column.minWidth,\n                      width: column.width,\n                    },\n                */\n                  })}\n                >\n                  {column.render('Header')}\n                  {/* Add a sort direction indicator */}\n                  <span>\n                    {/*column.isSorted*/ (column.id === 'createdAt' || column.id === 'user.username')\n                     ? column.isSortedDesc\n                       ? ' 🔽'\n                       : ' 🔼'\n                     : ''}\n                  </span>\n                </th>\n                ))}\n              </tr>\n            ))}\n          </thead>\n          <tbody {...getTableBodyProps()}>\n            {rows.map((row, i) => {\n              prepareRow(row);\n              return (\n                <tr {...row.getRowProps()}>\n                  {row.cells.map((cell) => {\n                    return (\n                      <td {...cell.getCellProps({\n\n                          style: {\n                            minWidth: cell.column.minWidth,\n                            width: cell.column.width,\n                            whiteSpace: 'pre-wrap'\n                          },\n\n                        })}>\n                        {cell.render(\"Cell\")}\n                      </td>\n                    );\n                  })}\n                </tr>\n              );\n            })}\n          </tbody>\n        </table>\n      </div>\n\n      <div className=\"col-sm-8\">\n      </div>\n    </div>\n  );\n};\n\nexport default CommentsList;"],"sourceRoot":""}